(this["webpackJsonpvolca-sampler"]=this["webpackJsonpvolca-sampler"]||[]).push([[0],{11:function(q,ce,v){q.exports={"form-switch":"SampleList_form-switch__17ijL","form-check-input":"SampleList_form-check-input__3yTwH","nav-pills":"SampleList_nav-pills__DLID5","nav-item":"SampleList_nav-item__2lSgQ","nav-link":"SampleList_nav-link__sUmO0",active:"SampleList_active__4LCL3",modal:"SampleList_modal__J3ctB","modal-dialog":"SampleList_modal-dialog__3VaNW","modal-content":"SampleList_modal-content__1R10B","modal-body":"SampleList_modal-body__1INLi",waveformContainer:"SampleList_waveformContainer__2xxew",playbackActive:"SampleList_playbackActive__jKTC1",noSelect:"SampleList_noSelect__Xqj8q",listItem:"SampleList_listItem__1w0uC",sampleTitle:"SampleList_sampleTitle__QV9QT",name:"SampleList_name__37cpF",slot:"SampleList_slot__3rbFM",multiSelector:"SampleList_multiSelector__21u8u",multiSelect:"SampleList_multiSelect__3CSet",playbackButton:"SampleList_playbackButton__j3RJ-",emptyListMessage:"SampleList_emptyListMessage__3ji4v"}},12:function(q,ce,v){q.exports={"form-switch":"WaveformEdit_form-switch__2DZid","form-check-input":"WaveformEdit_form-check-input__2TImp","nav-pills":"WaveformEdit_nav-pills__3uv7V","nav-item":"WaveformEdit_nav-item__1Cy-X","nav-link":"WaveformEdit_nav-link__rjUB_",active:"WaveformEdit_active__3qc2K",modal:"WaveformEdit_modal__18zXt","modal-dialog":"WaveformEdit_modal-dialog__3Bo89","modal-content":"WaveformEdit_modal-content___UGgZ","modal-body":"WaveformEdit_modal-body__33fKo",waveformAdjacentControls:"WaveformEdit_waveformAdjacentControls__12b8z",waveformContainer:"WaveformEdit_waveformContainer__Qq3MI",normalizeOnlySelection:"WaveformEdit_normalizeOnlySelection__-aGBS",cursor:"WaveformEdit_cursor__1Ntb3",trim:"WaveformEdit_trim__1GV76",playbackActive:"WaveformEdit_playbackActive__hTwgX",bar:"WaveformEdit_bar__1KFgt",handle:"WaveformEdit_handle__23NoG",time:"WaveformEdit_time__YX5rg",left:"WaveformEdit_left__3Jfpn",right:"WaveformEdit_right__35CjW",waveformOverlay:"WaveformEdit_waveformOverlay__3oZfw",clippingAlert:"WaveformEdit_clippingAlert__-Ql4y"}},122:function(q,ce,v){q.exports={"form-switch":"PluginConfirmModal_form-switch__6SPhH","form-check-input":"PluginConfirmModal_form-check-input__1-YhM","nav-pills":"PluginConfirmModal_nav-pills__3I1wv","nav-item":"PluginConfirmModal_nav-item__sR62x","nav-link":"PluginConfirmModal_nav-link__2zdbT",active:"PluginConfirmModal_active__2-vio",modal:"PluginConfirmModal_modal___snnS","modal-dialog":"PluginConfirmModal_modal-dialog__ijXTK","modal-content":"PluginConfirmModal_modal-content__2T-uY","modal-body":"PluginConfirmModal_modal-body__yz3QS",pluginConfirmModal:"PluginConfirmModal_pluginConfirmModal__LIuet"}},13:function(q,ce,v){q.exports={"form-switch":"VolcaTransferControl_form-switch__1ZS81","form-check-input":"VolcaTransferControl_form-check-input__REQsM","nav-pills":"VolcaTransferControl_nav-pills__8dM77","nav-item":"VolcaTransferControl_nav-item__1lZOI","nav-link":"VolcaTransferControl_nav-link__3vJ08",active:"VolcaTransferControl_active__39Z84",modal:"VolcaTransferControl_modal__2ltkP","modal-dialog":"VolcaTransferControl_modal-dialog__oCJNH","modal-content":"VolcaTransferControl_modal-content__2DCx8","modal-body":"VolcaTransferControl_modal-body__3hAAt",transferInfoBox:"VolcaTransferControl_transferInfoBox__1Oduz",summary:"VolcaTransferControl_summary__2d9XG",transferInfoForModal:"VolcaTransferControl_transferInfoForModal___j7Z5",cannotTransfer:"VolcaTransferControl_cannotTransfer__2DUlP",errors:"VolcaTransferControl_errors__27gS3",invalidMessage:"VolcaTransferControl_invalidMessage__-m8Xq",transferButton:"VolcaTransferControl_transferButton__11MBQ",preTransferModal:"VolcaTransferControl_preTransferModal__fLiiV",subtask:"VolcaTransferControl_subtask__1Xm5N",secondaryProgress:"VolcaTransferControl_secondaryProgress__2QWZh",progressAnnotation:"VolcaTransferControl_progressAnnotation__2zJ9A"}},146:function(q,ce,v){q.exports={waveformContainer:"WaveformReadonly_waveformContainer__RARS4"}},147:function(q,ce,v){q.exports={"form-switch":"ImportFromZip_form-switch__11vsE","form-check-input":"ImportFromZip_form-check-input__nSsxR","nav-pills":"ImportFromZip_nav-pills__5ylxp","nav-item":"ImportFromZip_nav-item__rt-U5","nav-link":"ImportFromZip_nav-link__f--MO",active:"ImportFromZip_active__2N89o",modal:"ImportFromZip_modal__3d38F","modal-dialog":"ImportFromZip_modal-dialog__3eRYb","modal-content":"ImportFromZip_modal-content__2u8pM","modal-body":"ImportFromZip_modal-body__3cNEr",importModal:"ImportFromZip_importModal__3hcGq"}},16:function(q,ce,v){q.exports={sampleMenuButtonFullWidth:"SampleMenu_sampleMenuButtonFullWidth__2B3CW",sampleMenuButtonsContainer:"SampleMenu_sampleMenuButtonsContainer__MPO05",exporting:"SampleMenu_exporting__g3lZ0",progress:"SampleMenu_progress__1AD9e",search:"SampleMenu_search__2EscQ",clearSearch:"SampleMenu_clearSearch__17ySf",offcanvasBody:"SampleMenu_offcanvasBody__1rgj6",listGroup:"SampleMenu_listGroup__IWtv7",accordion:"SampleMenu_accordion__1Igxo",accordionItem:"SampleMenu_accordionItem__1GO98",accordionBody:"SampleMenu_accordionBody__yBt0g",deleteModalForm:"SampleMenu_deleteModalForm__23Hzj",deleteModalHeader:"SampleMenu_deleteModalHeader__2DcST"}},161:function(q,ce,v){},162:function(q,ce,v){},200:function(q,ce,v){"use strict";v.r(ce);var i=v(0),e=v.n(i),Jt=v(15),wr=v.n(Jt),Mi=v(161),Ii=v(162),yt=v(203),qe=v(148),Sr=v(36),He=v.n(Sr),_r=e.a.memo(function({onHeaderClick:t}){return e.a.createElement("div",{className:He.a.titleBar},e.a.createElement(yt.a,{fluid:"sm",className:He.a.titleContainer},e.a.createElement("h1",{className:He.a.title,onClick:t},e.a.createElement("span",{className:He.a.titleText,"data-text":"Volca Sample"},"Volca Sample",e.a.createElement("span",{className:He.a.titleR},"r"),e.a.createElement("svg",{viewBox:"0 0 150 150",preserveAspectRatio:"none",className:He.a.titleStarburst},Array(24).fill().map((n,r,{length:o})=>e.a.createElement("polygon",{key:r,points:"75,70 75,80 150,75","transform-origin":"75 75",style:{"--rotation":`${r*360/o}deg`}})))),e.a.createElement("div",{className:He.a.titleGraphic},e.a.createElement("img",{src:"volca_sample.png",alt:""})),e.a.createElement("div",{className:He.a.tagline},e.a.createElement("h2",null,"for volca sample")))),e.a.createElement("svg",{width:0,height:0},e.a.createElement("filter",{id:"outline"},e.a.createElement("feMorphology",{in:"SourceAlpha",result:"DILATED",operator:"dilate",radius:"1"}),e.a.createElement("feFlood",{floodColor:"var(--stroke-color)",floodOpacity:"1",result:"PINK"}),e.a.createElement("feComposite",{in:"PINK",in2:"DILATED",operator:"in",result:"OUTLINE"}),e.a.createElement("feMerge",null,e.a.createElement("feMergeNode",{in:"OUTLINE"}),e.a.createElement("feMergeNode",{in:"SourceGraphic"})))))}),Ie=v(213),Ae=v(135),La=v(208),Ne=v(151),V=v(93),A=v(210),oe=v(211),Xt=v(56),Cr=v(82),Wa=v.n(Cr),Pr=v(152),Or=v(27),Ve=v.n(Or),Rt=v(215),Ha=v(121);const je=31250;function qt(a){return a.toLocaleString([],{dateStyle:"medium",timeStyle:"short"})}function Et(a,t){return`0:${a.toFixed(t).padStart(3+t,"0")}`}function ea(a){return`${Math.floor(a/60)}m ${Math.floor(a%60)}s`}const bt=(()=>{if(typeof window=="undefined")return"windows";const a=navigator.userAgent.toLowerCase();return a.includes("iphone")||a.includes("ipad")||a.includes("mac")&&navigator.maxTouchPoints>1?"ios":a.includes("android")?"android":a.includes("mac")?"mac":a.includes("linux")?"linux":"windows"})();var Va=(a,t,n)=>new Promise((r,o)=>{var s=l=>{try{c(n.next(l))}catch(m){o(m)}},u=l=>{try{c(n.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,u);c((n=n.apply(a,t)).next())});const it=6,ta=it*44;function aa(a,t){const n=Math.floor(it*a.length/t);if(n===0)return{positive:new Float32Array,negative:new Float32Array};const r=new Float32Array(Math.floor(a.length/n)),o=new Float32Array(Math.floor(a.length/n));for(let s=0;s<r.length;s++){const u=new Float32Array(a.buffer,a.byteOffset+s*n*4,n);let c=0,l=0;for(const m of u)m>c&&(c=m),m<l&&(l=m);r[s]=c,o[s]=l}return{positive:r,negative:o}}function wt(a,t){return Va(this,null,function*(){const n=Ft(a,t);return aa(n,ta)})}function za(a,t=Symbol.for("")){const[n,r]=Object(i.useState)(null),o=Object(i.useRef)(a);o.current=a,Object(i.useEffect)(()=>{let u=!1;return(()=>Va(this,null,function*(){if(!u)try{const c=yield da(o.current);if(u)return;r([a.id,c])}catch(c){const l=yield Ge(a.metadata.sourceFileId,Boolean(a.metadata.userFileInfo));if(u)return;r([a.id,l])}}))(),()=>{u=!0}},[a.id,a.metadata.plugins,a.metadata.sourceFileId,a.metadata.userFileInfo,t]);const s=Object(i.useRef)(a);return n&&a.id===n[0]&&(s.current=a),{sample:s.current,pluginProcessedAudioBuffer:n&&n[1]}}function Ua(a){const t=Object(i.useMemo)(()=>a?Ft(a,[0,0]):new Float32Array,[a]),[n,r]=Object(i.useState)(null),[o,s]=Object(i.useState)({width:0,height:0}),u=Object(i.useMemo)(()=>n&&(o.width||n.offsetWidth),[n,o]),c=Object(i.useMemo)(()=>!u||!t.length?{positive:new Float32Array,negative:new Float32Array}:aa(t,u),[u,t]);return{monoSamples:t,waveformRef:r,pixelWidth:u,peaks:c,onResize:s}}function na(a,t=!1){const{playAudioBuffer:n,iOSPrepareForAudio:r}=un(),o=Object(i.useRef)(()=>{}),[s,u]=Object(i.useState)(null);Object(i.useEffect)(()=>{a&&s&&(u(null),s.fn())},[a,s]);const[c,l]=Object(i.useState)(0),[m,f]=Object(i.useState)(!1),[p,d]=Object(i.useState)("");Object(i.useEffect)(()=>{a&&d(Et(m?c*a.duration:a.duration,1))},[a,m,c]);const g=Object(i.useCallback)(E=>{if(m)o.current();else if(a)o.current=n(a,{onTimeUpdate(y){l(y/a.duration)},onEnded(){f(!1)}}),l(0),f(!0);else{bt==="ios"&&r();const y=E.target;u({fn:()=>y.dispatchEvent(E)})}},[m,n,a,r]);Object(i.useEffect)(()=>{if(!t)return;function E(y){document.querySelector('[role="dialog"]')||y.key===" "&&!(y.target instanceof HTMLInputElement)&&(y.preventDefault(),g(y))}return document.addEventListener("keydown",E,!0),()=>document.removeEventListener("keydown",E,!0)},[t,g]);const h=Object(i.useCallback)(()=>o.current(),[]);return{isPlaybackActive:m,playbackProgress:c,displayedTime:p,togglePlayback:g,stopPlayback:h}}var kr=Object.defineProperty,Mr=Object.defineProperties,Ir=Object.getOwnPropertyDescriptors,Tt=Object.getOwnPropertySymbols,Ga=Object.prototype.hasOwnProperty,Qa=Object.prototype.propertyIsEnumerable,ra=(a,t,n)=>t in a?kr(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,me=(a,t)=>{for(var n in t||(t={}))Ga.call(t,n)&&ra(a,n,t[n]);if(Tt)for(var n of Tt(t))Qa.call(t,n)&&ra(a,n,t[n]);return a},_e=(a,t)=>Mr(a,Ir(t)),ze=(a,t)=>{var n={};for(var r in a)Ga.call(a,r)&&t.indexOf(r)<0&&(n[r]=a[r]);if(a!=null&&Tt)for(var r of Tt(a))t.indexOf(r)<0&&Qa.call(a,r)&&(n[r]=a[r]);return n},Dt=(a,t,n)=>(ra(a,typeof t!="symbol"?t+"":t,n),n),de=(a,t,n)=>new Promise((r,o)=>{var s=l=>{try{c(n.next(l))}catch(m){o(m)}},u=l=>{try{c(n.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,u);c((n=n.apply(a,t)).next())});const St=Ve.a.createInstance({name:"audio_file_data",driver:Ve.a.INDEXEDDB}),_t=Ve.a.createInstance({name:"sample_metadata",driver:Ve.a.INDEXEDDB});function $a(a){return de(this,null,function*(){return(yield St.keys()).includes(a)})}function Ya(a,t){return de(this,null,function*(){if(t&&(yield $a(t)))throw new Error("Cannot store audio source file at already used id");const n=t||Object(Rt.a)();return yield St.setItem(n,a),n})}const la="0.9.0",Ar={"0.1.0":a=>{const t=a,{clip:n}=t,r=ze(t,["clip"]);return _e(me({},r),{trimFrames:n.map(s=>Math.round(s*je)),metadataVersion:"0.2.0"})},"0.2.0":a=>de(void 0,null,function*(){const t=a,{trimFrames:n}=t,r=ze(t,["trimFrames"]),o=yield Ge(r.sourceFileId,!1),s=yield wt(o,n),u={frames:n,waveformPeaks:s};return _e(me({},r),{trim:u,metadataVersion:"0.3.0"})}),"0.3.0":a=>{const t=a,{dateSampled:n,dateModified:r}=t,o=ze(t,["dateSampled","dateModified"]);return _e(me({},o),{dateSampled:new Date(n).toISOString(),dateModified:new Date(r).toISOString(),metadataVersion:"0.4.0"})},"0.4.0":a=>de(void 0,null,function*(){const t=a,{scaleCoefficient:n,trim:{frames:r,waveformPeaks:o}}=t,s=ze(t,["scaleCoefficient","trim"]),u=yield Ge(s.sourceFileId,!1),c=Ft(u,r),l=at(c);return _e(me({},s),{normalize:n!==1,trim:{frames:r,waveformPeaks:_e(me({},o),{normalizationCoefficient:1/l})},metadataVersion:"0.5.0"})}),"0.5.0":a=>{const t=a,{normalize:n}=t,r=ze(t,["normalize"]),o=n?"selection":null;return _e(me({},r),{normalize:o,metadataVersion:"0.6.0"})},"0.6.0":a=>_e(me({},a),{pitchAdjustment:1,metadataVersion:"0.7.0"}),"0.7.0":a=>de(void 0,null,function*(){const t=a,{trim:{frames:n,waveformPeaks:r}}=t,o=ze(t,["trim"]),s=yield Ge(o.sourceFileId,!1),u={waveformPeaks:r,duration:s.duration-(n[0]+n[1])/je,srcDuration:s.duration};return _e(me({},o),{trim:{frames:n},cachedInfo:u,metadataVersion:"0.8.0"})}),"0.8.0":(a,t)=>{const n=a,{cachedInfo:r}=n,o=ze(n,["cachedInfo"]),s={waveformPeaks:r.waveformPeaks,postPluginFrameCount:Math.round(r.srcDuration*je),duration:r.duration,failedPluginIndex:-1};return t(s),_e(me({},o),{plugins:[],metadataVersion:"0.9.0"})}},Ka={"0.6.0":a=>de(void 0,null,function*(){const t=a,{trim:{frames:n}}=t,r=ze(t,["trim"]),o=yield Ge(a.sourceFileId,!1),s=yield wt(o,n);return _e(me({},r),{trim:{frames:n,waveformPeaks:s}})}),"0.7.0":a=>Ka["0.6.0"](a),"0.8.0":a=>de(void 0,null,function*(){const t=a,n=yield Ge(a.sourceFileId,!1),o={waveformPeaks:yield wt(n,t.trim.frames),postPluginFrameCount:n.length,duration:n.duration-(t.trim.frames[0]+t.trim.frames[1])/je,srcDuration:n.duration};return _e(me({},t),{cachedInfo:o})}),"0.9.0":a=>de(void 0,null,function*(){return a})};let xt=typeof window!="undefined"&&new URLSearchParams(window.location.search).has("reloaded_to_upgrade");function Nr(){const a=new URL(window.location.href),t=new URLSearchParams(window.location.search);t.set("reloaded_to_upgrade","true"),a.search=t.toString(),window.location.replace(a.href)}function Za(){const a=new URL(window.location.href),t=new URLSearchParams(window.location.search);t.delete("reloaded_to_upgrade"),a.search=t.toString(),window.history.replaceState({},"",a),xt=!1}function oa(a,t){return de(this,null,function*(){let n=a,r=null;const o=s=>{r=s};for(;n.metadataVersion!==la;){const s=Ar[n.metadataVersion];if(!s){if(t)throw new Error("Could not upgrade");xt||Nr(),console.warn(`Failed to properly upgrade metadata for sample "${n.name}"`),n={name:n.name,sourceFileId:n.sourceFileId,metadataVersion:la};break}n=yield s(n,o)}return{upgradedMetadata:n,cachedInfo:r}})}const Ue=class{constructor({name:a,sourceFileId:t,trim:n,id:r=Object(Rt.a)(),userFileInfo:o=null,slotNumber:s=0,dateSampled:u=new Date().toISOString(),dateModified:c=u,useCompression:l=!0,qualityBitDepth:m=16,normalize:f="selection",pitchAdjustment:p=1,plugins:d=[]}){this.id=r,this.metadata={name:a,sourceFileId:t,trim:n,userFileInfo:o,slotNumber:s,dateSampled:u,dateModified:c,useCompression:l,qualityBitDepth:m,normalize:f,pitchAdjustment:p,plugins:d,metadataVersion:la}}duplicate(a){const t=new Ue.Mutable(_e(me({},this.metadata),{name:`${this.metadata.name} (copy)`,dateModified:new Date().toISOString()}));return t.persist().then(()=>a&&a(t.id)),t}static cacheSourceFileData(a,t){this.sourceFileData.set(a,t),this.recentlyCachedSourceFileIds=[a,...this.recentlyCachedSourceFileIds.filter(r=>r!==a)];const n=this.recentlyCachedSourceFileIds.slice(this.MAX_CACHED);for(const r of n)this.sourceFileData.delete(r);this.recentlyCachedSourceFileIds=this.recentlyCachedSourceFileIds.slice(0,this.MAX_CACHED)}static getSourceFileData(a,t){return de(this,null,function*(){if(!t){const r=this.sourceFileData.get(a);if(r)return r}if(a.includes(".")){const r=yield fetch(a);if(r.status>=400)return Promise.reject(new Error(`Failed to fetch source file "${a}"`));const o=yield r.arrayBuffer(),s=new Uint8Array(o);return t||this.cacheSourceFileData(a,s),s}const n=yield St.getItem(a);return n?n instanceof Uint8Array?(t||this.cacheSourceFileData(a,n),n):Promise.reject("Source data is of unexpected type"):Promise.reject("Missing source data")})}static getAllMetadataFromStore(){return de(this,null,function*(){const a=new Map,t=new Map,n=[];return yield _t.iterate((r,o)=>{r&&n.push(oa(r).then(({upgradedMetadata:s,cachedInfo:u})=>{a.set(o,s),u&&t.set(o,u)}).catch(s=>{console.error(s),console.warn(`Failed to upgrade metadata "${o}" (${r.name}); ignoring.`)}))}),yield Promise.all(n),xt&&Za(),{sampleMetadata:a,cachedInfos:t}})}static getAllFromStorage(){return de(this,null,function*(){const{sampleMetadata:a,cachedInfos:t}=yield this.getAllMetadataFromStore(),n=yield Ja(),r=(yield St.keys()).concat(n.map(({sourceFileId:s})=>s));return{sampleContainers:[...a].map(([s,u])=>{const{sourceFileId:c}=u;return r.includes(c)?new Ue.Mutable(me({id:s},u)):(console.warn(`Found metadata "${u.name||s}" with missing data "${c}; ignoring.`),null)}).filter(Boolean).sort(st),cachedInfos:t}})}static getByIdsFromStorage(a){return de(this,null,function*(){return Promise.all(a.map(t=>de(this,null,function*(){const n=yield _t.getItem(t),{upgradedMetadata:r}=yield oa(n),o=new Ue.Mutable(me({id:t},r)),{sourceFileId:s}=o.metadata;return this.recentlyCachedSourceFileIds.filter(u=>u!==s),this.sourceFileData.delete(s),xt&&Za(),o})))})}static importToStorage(a,t){return de(this,null,function*(){const n=Ka[t.metadataVersion];if(!n)throw console.error("Failed to import metadata",t),new Error("Failed to import metadata with no import migration");const r=yield n(t),{upgradedMetadata:o}=yield oa(r,!0),s=new Ue.Mutable(me({id:a},o));return yield s.persist(),s})}};let ie=Ue;Dt(ie,"Mutable",class extends Ue{constructor(t){super(t);setTimeout(()=>de(this,null,function*(){(yield _t.keys()).includes(this.id)||console.warn(`Expected sample metadata container ${this.id} to be persisted`)}))}persist(){return de(this,null,function*(){yield _t.setItem(this.id,this.metadata)})}update(t,n){const{id:r,metadata:o}=this,s=typeof t=="function"?t(o):t;if(Object.keys(s).every(l=>s[l]===o[l]))return this;const u=_e(me(me({},o),s),{dateModified:new Date().toISOString()}),c=new Ue.Mutable(me({id:r},u));return c.persist().then(n),c}remove(){return de(this,null,function*(){if(yield _t.removeItem(this.id),this.metadata.sourceFileId.includes("."))return;const{sampleMetadata:t}=yield Ue.getAllMetadataFromStore();for(const[,{sourceFileId:n}]of t)if(n===this.metadata.sourceFileId)return;yield St.removeItem(this.metadata.sourceFileId)})}}),Dt(ie,"sourceFileData",new Map),Dt(ie,"recentlyCachedSourceFileIds",[]),Dt(ie,"MAX_CACHED",10);let ia;function Ja(){return ia||(ia=fetch("factory-samples.json").then(a=>a.json())),ia}function jr(){return de(this,null,function*(){const a=yield Ja();return new Map(a.map(t=>[t.id,{sampleContainer:new ie(_e(me({},t),{normalize:null,trim:{frames:[t.trim.frames[0],t.trim.frames[1]]}})),cachedInfo:{waveformPeaks:{positive:new Float32Array(Object(Ha.a)(t.cachedInfo.waveformPeaks.positive)),negative:new Float32Array(Object(Ha.a)(t.cachedInfo.waveformPeaks.negative))},postPluginFrameCount:t.cachedInfo.postPluginFrameCount,duration:t.cachedInfo.duration,failedPluginIndex:t.cachedInfo.failedPluginIndex}}]))})}function st(a,t){return a.metadata.dateModified>t.metadata.dateModified?-1:t.metadata.dateModified>a.metadata.dateModified?1:0}var Ct=(a,t,n)=>new Promise((r,o)=>{var s=l=>{try{c(n.next(l))}catch(m){o(m)}},u=l=>{try{c(n.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,u);c((n=n.apply(a,t)).next())});const Xa=10,Rr=typeof window=="undefined"?"":window.location.protocol==="http:"?"http://localhost:3001":`https://plugin.${window.location.host}`,De=typeof window=="undefined"?{}:document.createElement("div");typeof window!="undefined"&&(De.id="plugins",document.body.appendChild(De));class sa extends Error{}const et={};function Pt(a,t){return Ct(this,null,function*(){const n=document.createElement("iframe");n.id=a,n.hidden=!0,n.title="plugin-context",n.setAttribute("sandbox","allow-scripts"),n.src=`${Rr}${window.location.pathname}plugin-context.html`;let r=()=>{},o=()=>{};if(et[a]=new Promise((c,l)=>{r=c,o=l}),De.appendChild(n),yield new Promise(c=>n.addEventListener("load",c,{once:!0})),!n.contentWindow)throw new Error("Expected iframe content window");const s=Object(Rt.a)();n.contentWindow.postMessage({messageType:"pluginInstall",messageId:s,pluginSource:t},"*");let u={};try{yield new Promise((c,l)=>{let m;const f=({source:p,data:d})=>{if(p===n.contentWindow&&d.messageId===s){if(d.messageType==="receivedMessage"){m=setTimeout(()=>{console.error("Plugin took too long to install:",a),l(),window.removeEventListener("message",f)},Xa);return}d.messageType==="pluginInstall"&&(d.error?(console.error("Plugin failed to install:",a),l()):(u=d.params,c()),clearTimeout(m),window.removeEventListener("message",f))}};window.addEventListener("message",f)})}catch(c){throw o(),De.removeChild(n),c}r(u)})}function Tr(a,t,n){return Ct(this,null,function*(){if(!a.contentWindow)throw new Error("Expected iframe content window");const r=t.getChannelData(0),{sampleRate:o}=t,s=Object(Rt.a)();a.contentWindow.postMessage({messageType:"sampleTransform",messageId:s,audioData:r,sampleRate:o,params:n},"*");let u;try{u=yield new Promise((l,m)=>{let f;const p=({source:d,data:g})=>{if(d===a.contentWindow&&g.messageId===s){if(g.messageType==="receivedMessage"){f=setTimeout(()=>{console.error("Plugin took too long to run:",a.id),m(new sa("Plugin took too long to return")),window.removeEventListener("message",p)},Xa);return}g.messageType==="sampleTransform"&&(g.error?g.error==="Invalid parameters"?(console.error("Invalid plugin input:",a.id),m(new Error("Invalid plugin input"))):(console.error("Plugin call failed:",a.id),m(new sa("Plugin failed to run"))):l(g.newAudioData),clearTimeout(f),window.removeEventListener("message",p))}};window.addEventListener("message",p)})}catch(l){throw l instanceof Error&&l.message==="Invalid plugin input"||(a.dispatchEvent(new Event("plugin-error",{bubbles:!0})),De.removeChild(a)),l}const c=new AudioBuffer({length:u.length,sampleRate:o});return c.copyToChannel(u,0),c})}function ct(a){return{getParams(){return et[a]},sampleTransform(t,n){return Ct(this,null,function*(){yield et[a];let r=document.getElementById(a);if(r&&r instanceof HTMLIFrameElement)return Tr(r,t,n);throw new Error("Expected plugin to exist")})},onPluginError(t){Promise.resolve(et[a]).catch(t);const n=r=>{r.target instanceof HTMLIFrameElement&&r.target.id===a&&t()};return De.addEventListener("plugin-error",n),()=>{De.removeEventListener("plugin-error",n)}},replaceSource(t){return Ct(this,null,function*(){let n=document.getElementById(a);const r=et[a];if(n&&n instanceof HTMLIFrameElement){n.id="";try{yield Pt(a,t)}catch(s){throw n.id=a,et[a]=r,s}De.removeChild(n);let o=document.getElementById(a);o&&o.dispatchEvent(new Event("sourceUpdate",{bubbles:!0}))}else throw new Error("Expected plugin to exist")})},remove(){let t=document.getElementById(a);if(t&&t instanceof HTMLIFrameElement)De.removeChild(t),delete et[a];else throw new Error("Expected plugin to exist")}}}function qa(a){return Ct(this,null,function*(){const t=new TextEncoder().encode(a),n=yield crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map(o=>o.toString(16).padStart(2,"0")).join("")})}function ca(a){const t=document.getElementById(a);return Boolean(t&&t instanceof HTMLIFrameElement)}function Dr(a){const t={};for(const[n,r]of Object.entries(a))t[n]=r.value;return t}var en=Math.pow,tt=(a,t,n)=>new Promise((r,o)=>{var s=l=>{try{c(n.next(l))}catch(m){o(m)}},u=l=>{try{c(n.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,u);c((n=n.apply(a,t)).next())});function Ot(a,t){if(t[0]+t[1]>=a.length)return new Float32Array(1);const n=4,r=a.byteOffset+t[0]*n,o=a.length-t[0]-t[1];return new Float32Array(a.buffer,r,o)}function Ft(a,t,n){const r=a.length-t[0]-t[1],o=n||new Float32Array(r),s=Array(a.numberOfChannels).fill().map((u,c)=>Ot(a.getChannelData(c),t));for(let u=0;u<r;u++){let c=0;for(let l=0;l<s.length;l++)c+=s[l][u];c/=s.length,o[u]=c}return o}function at(a){let t=0;for(const n of a){const r=Math.abs(n);r>t&&(t=r)}return t}function xr(a,t){if(t!==1)for(let n=0;n<a.length;n++)a[n]*=t}function tn(a){const t=at(a);return xr(a,1/t),t}function Fr(a,t){const n=en(2,t-1);for(let r=0;r<a.length;r++)a[r]=Math.round(a[r]*n)/n}function an(a){for(let t=0;t<a.length;t++)a[t]>1?a[t]=1:a[t]<-1&&(a[t]=-1)}function Br(a){const t=a.length,n=a[0].length,r=new Float32Array(t*n);for(let o=0;o<r.length;o++){const s=t*o;for(let u=0;u<t;u++)r[s+u]=a[u][o]}return r}function nn(a){const t=new Int16Array(a.length),n=en(2,15);for(let r=0;r<a.length;r++)t[r]=Math.max(Math.min(n-1,n*a[r]),-n);return t}function rn(){return window.AudioContext||window.webkitAudioContext}let ln;function on(){const a=rn();return ln=ln||new a({sampleRate:je})}function ut(a){return tt(this,null,function*(){const t=new Uint8Array(a);return yield new Promise((r,o)=>{on().decodeAudioData(t.buffer,r,o)})})}function Ge(a,t){return tt(this,null,function*(){const n=yield ie.getSourceFileData(a),r=yield ut(n);if(t)for(let o=0;o<r.numberOfChannels;o++)an(r.getChannelData(o));return r})}class ua extends Error{constructor(t,n){super(t);this.pluginIndex=n}}const ma=new WeakMap;function da(a){return tt(this,null,function*(){{const r=ma.get(a);if(r)return r}const t=(()=>tt(this,null,function*(){const{sourceFileId:r,userFileInfo:o,plugins:s}=a.metadata,u=yield Ge(r,Boolean(o));let c;u.numberOfChannels===1?c=u:(c=new AudioBuffer({length:u.length,sampleRate:u.sampleRate,numberOfChannels:1}),Ft(u,[0,0],c.getChannelData(0)));let l=c,m=0;for(const{pluginName:f,pluginParams:p,isBypassed:d}of s){if(!d){const g=ct(f);try{l=yield g.sampleTransform(l,p)}catch(h){throw h instanceof sa?new ua(h&&h instanceof Error&&h.message?h.message:"Plugin failed",m):h}}m++}return l}))();ma.set(a,t);let n;try{n=yield t}finally{setTimeout(()=>{ma.delete(a)},100)}return n})}const fa=new WeakMap;function sn(a,t,n){return tt(this,null,function*(){if(n){const s=fa.get(a);if(s)return s}const r=(()=>tt(this,null,function*(){const{qualityBitDepth:s,normalize:u,trim:{frames:c},pitchAdjustment:l}=a.metadata;if(s<8||s>16||!Number.isInteger(s))throw new Error(`Expected bit depth between 8 and 16. Received: ${s}`);const m=u==="all"?t.getChannelData(0):Ot(t.getChannelData(0),c);u==="all"&&tn(m);const f=u==="all"?Ot(m,c):m;u==="selection"&&tn(f);const p=aa(f,ta),g=!isNaN(l)&&l!==1&&l>=.5&&l<=2?new Float32Array(Object(Pr.a)(f,je,Math.round(je/l))):f;n&&s<16&&Fr(g,s);const h=nn(g),E=h.length*2,y=Wa()({channels:1,sampleRate:t.sampleRate,bitDepth:16,dataLength:E}),b=new Uint8Array(y.length+E);return b.set(y),b.set(new Uint8Array(h.buffer),y.length),{data:b,sampleRate:16,cachedInfo:{waveformPeaks:p,postPluginFrameCount:t.length,duration:h.length/t.sampleRate,failedPluginIndex:-1}}}))();n&&fa.set(a,r);let o;try{o=yield r}finally{n&&setTimeout(()=>{fa.delete(a)},100)}return o})}function pa(a,t){return tt(this,null,function*(){const n=yield da(a);return sn(a,n,t)})}function Lr(){if(bt!=="ios")return document.createElement("audio");function a(o,s){let u=s;for(;o>1;o--)u+=s;return u}const t="data:audio/mpeg;base64,//uQx"+a(23,"A")+"WGluZwAAAA8AAAACAAACcQCA"+a(16,"gICA")+a(66,"/")+"8AAABhTEFNRTMuMTAwA8MAAAAAAAAAABQgJAUHQQAB9AAAAnGMHkkI"+a(320,"A")+"//sQxAADgnABGiAAQBCqgCRMAAgEAH"+a(15,"/")+"7+n/9FTuQsQH//////2NG0jWUGlio5gLQTOtIoeR2WX////X4s9Atb/JRVCbBUpeRUq"+a(18,"/")+"9RUi0f2jn/+xDECgPCjAEQAABN4AAANIAAAAQVTEFNRTMuMTAw"+a(97,"V")+"Q==",n=document.createElement("div");n.innerHTML="<audio x-webkit-airplay='deny'></audio>";const r=n.children.item(0);return r.controls=!1,r.disableRemotePlayback=!0,r.preload="auto",r.src=t,r.loop=!0,r.load(),r}const Wr={playAudioBuffer(a,t){throw new Error("Must render AudioPlaybackContextProvider")},iOSPrepareForAudio(){throw new Error("Must render AudioPlaybackContextProvider")}},cn=Object(i.createContext)(Wr);function Hr({children:a}){const[t]=Object(i.useState)(Lr),n=Object(i.useRef)(u=>{}),r=Object(i.useCallback)((u,{onTimeUpdate:c=()=>null,onEnded:l=()=>null}={})=>{n.current(!0);const m=on(),f=m.createBufferSource();f.buffer=u,f.connect(m.destination);let p=0;function d(){f.start();const y=m.currentTime;c(0),p=requestAnimationFrame(b);function b(){c(m.currentTime-y),p=requestAnimationFrame(b)}}bt==="ios"?t.play().then(d):d();let g=!1;function h(y){l(),!y&&bt==="ios"&&t.pause()}f.addEventListener("ended",()=>{g||(c(u.duration),h()),cancelAnimationFrame(p)});function E(y){g||(f.stop(),cancelAnimationFrame(p),h(y),g=!0)}return n.current=E,E},[t]),o=Object(i.useCallback)(()=>{t.play()},[t]),s=Object(i.useMemo)(()=>({playAudioBuffer:r,iOSPrepareForAudio:o}),[r,o]);return Object(i.createElement)(cn.Provider,{value:s},a)}function un(){return Object(i.useContext)(cn)}var Vr=v(133),zr=v(134),Ur=Object.defineProperty,mn=Object.getOwnPropertySymbols,Gr=Object.prototype.hasOwnProperty,Qr=Object.prototype.propertyIsEnumerable,dn=(a,t,n)=>t in a?Ur(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,fn=(a,t)=>{for(var n in t||(t={}))Gr.call(t,n)&&dn(a,n,t[n]);if(mn)for(var n of mn(t))Qr.call(t,n)&&dn(a,n,t[n]);return a};const $r=Vr.a.canvas({width:"100%",height:"100%",display:"block",imageRendering:"pixelated",backgroundColor:({$opaque:a})=>a?"white":"unset"});function Yr(a,t){function n(o,s){a.width=o,a.height=s}n(a.offsetWidth,a.offsetHeight),t({width:a.offsetWidth,height:a.offsetHeight});const r=new zr.a(([o])=>{const{width:s,height:u}=o.contentRect;n(s,u),t({width:s,height:u})});return r.observe(a),()=>r.disconnect()}function Kr(a,t,n){const r=getComputedStyle(document.documentElement),o=r.getPropertyValue("--bs-primary"),s=r.getPropertyValue("--bs-primary-darkened"),u=a.getContext("2d");u.imageSmoothingEnabled=!1;const{width:c,height:l}=a;u.clearRect(0,0,c,l);const m=Math.floor(l*(2/3))+1;u.fillStyle=o,t.positive.forEach((p,d)=>{const g=m*p,h=Math.max(Math.round(n*g),1);u.fillRect(d*it,m-h,it-1,h)});const f=l-m;u.fillStyle=s,t.negative.forEach((p,d)=>{const g=f*p*-1,h=Math.round(n*g);u.fillRect(d*it,m,it-1,h)})}function Zr({peaks:a,scaleCoefficient:t,waveformRef:n,opaque:r,onResize:o}){const s=Object(i.useRef)(null);Object(i.useImperativeHandle)(n,()=>s.current);const[u,c]=Object(i.useState)(Symbol()),l=Object(i.useRef)({width:0,height:0});return Object(i.useLayoutEffect)(()=>{if(!s.current)throw new Error("Canvas should be defined");return l.current.width=s.current.offsetWidth,l.current.height=s.current.offsetHeight,o&&o(fn({},l.current)),Yr(s.current,({width:m,height:f})=>{(m!==l.current.width||f!==l.current.height)&&(c(Symbol()),l.current.width=m,l.current.height=f,o&&o(fn({},l.current)))})},[o]),Object(i.useLayoutEffect)(()=>{const m=s.current;if(!m)throw new Error("Canvas should be defined");let f=requestAnimationFrame(()=>{f=requestAnimationFrame(()=>{Kr(m,a,t)})});return()=>cancelAnimationFrame(f)},[a,t,u]),e.a.createElement($r,{ref:s,$opaque:r})}var Bt=Zr,pn=v(83),hn=v(84),gn=v(85);function Lt(a,t){const n=URL.createObjectURL(a),r=document.createElement("a");r.href=n,r.download=t,r.style.display="none",document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(n)}var Jr=v(30),Qe=v.n(Jr),Xr=(a,t,n)=>new Promise((r,o)=>{var s=l=>{try{c(n.next(l))}catch(m){o(m)}},u=l=>{try{c(n.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,u);c((n=n.apply(a,t)).next())}),vn=e.a.memo(function({isPlaybackActive:t,playbackProgress:n,displayedTime:r,downloadFilename:o,wavFile:s,togglePlayback:u}){const c=Object(i.useCallback)(()=>Xr(this,null,function*(){if(s){const l=new Blob([s],{type:"audio/x-wav"});Lt(l,o)}}),[o,s]);return e.a.createElement(e.a.Fragment,null,e.a.createElement("div",{className:[Qe.a.playbackOverlay,t?Qe.a.playbackActive:""].join(" "),style:{"--playback-progress":`${100*n}%`}},e.a.createElement("div",{className:Qe.a.playback})),e.a.createElement("div",{className:Qe.a.playbackButtonContainer},e.a.createElement(Ie.a,{delay:{show:400,hide:0},overlay:e.a.createElement(Ae.a,null,"Preview how your sample will sound on the volca sample")},e.a.createElement(V.a,{variant:"dark",onClick:l=>u(l.nativeEvent)},t?e.a.createElement(hn.a,null):e.a.createElement(pn.a,null))),r&&e.a.createElement("span",null,r)),e.a.createElement(Ie.a,{delay:{show:400,hide:0},overlay:e.a.createElement(Ae.a,null,"Download a copy of the audio that will be transferred to the volca sample")},e.a.createElement(V.a,{className:Qe.a.downloadButton,type:"button",variant:"dark",size:"sm",onClick:c,disabled:!s},e.a.createElement(gn.a,null))))}),yn=v(204),En=v(205),qr=e.a.memo(function({sampleId:t,normalize:n,onSampleUpdate:r}){return e.a.createElement("div",null,e.a.createElement(Ie.a,{delay:{show:400,hide:0},overlay:e.a.createElement(Ae.a,null,"Normalization boosts your sample's volume so its peak is at the same level as your other normalized samples")},e.a.createElement(oe.a.Label,null,"Normalize")),e.a.createElement("br",null),e.a.createElement(yn.a,null,["off","all","selection"].map(o=>e.a.createElement(Ie.a,{key:o,delay:{show:400,hide:0},overlay:e.a.createElement(Ae.a,null,o==="all"?"Normalized with respect to peak amplitude for full sampled audio":o==="selection"?"Normalized with respect to peak amplitude for selected audio":"Kept at originally recorded volume")},e.a.createElement(En.a,{id:"normalizeType",type:"radio",size:"sm",variant:"outline-secondary",name:"normalize",value:o,checked:o==="off"?!n:o===n,onClick:()=>{r(t,{normalize:o==="off"?null:o})}},o==="all"?"All audio":o==="selection"?"Selected audio":"Off")))))}),el=Object.defineProperty,tl=Object.defineProperties,al=Object.getOwnPropertyDescriptors,bn=Object.getOwnPropertySymbols,nl=Object.prototype.hasOwnProperty,rl=Object.prototype.propertyIsEnumerable,ha=(a,t,n)=>t in a?el(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,ll=(a,t)=>{for(var n in t||(t={}))nl.call(t,n)&&ha(a,n,t[n]);if(bn)for(var n of bn(t))rl.call(t,n)&&ha(a,n,t[n]);return a},ol=(a,t)=>tl(a,al(t)),$e=(a,t,n)=>(ha(a,typeof t!="symbol"?t+"":t,n),n),xe=(a,t,n)=>new Promise((r,o)=>{var s=l=>{try{c(n.next(l))}catch(m){o(m)}},u=l=>{try{c(n.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,u);c((n=n.apply(a,t)).next())}),Wt;const kt=Ve.a.createInstance({name:"sample_cached_info",driver:Ve.a.INDEXEDDB}),mt=class{constructor({sampleContainer:a,cachedInfo:t}){this.sampleContainer=a,this.cachedInfo=t}getPreviewAudio(){return mt.getPreviewAudioData(this.sampleContainer)}static cachePreviewAudioData(a,t){return xe(this,null,function*(){const n=yield ut(t);this.previewWavData.set(a,t),this.previewAudioBuffers.set(a,n),this.recentlyBufferedSampleIds=[a,...this.recentlyBufferedSampleIds.filter(o=>o!==a)];const r=this.recentlyBufferedSampleIds.slice(this.MAX_CACHED);for(const o of r)this.previewWavData.delete(o),this.previewAudioBuffers.delete(o);this.recentlyBufferedSampleIds=this.recentlyBufferedSampleIds.slice(0,this.MAX_CACHED)})}static getPreviewAudioData(a){return xe(this,null,function*(){let t=this.previewWavData.get(a.id),n=this.previewAudioBuffers.get(a.id);if(!t){n=void 0;const{data:r}=yield pa(a,!0);t=r}return n||(n=yield ut(t)),this.previewWavData.set(a.id,t),this.previewAudioBuffers.set(a.id,n),{wavData:t,audioBuffer:n}})}static getAllCachedInfoFromStore(){return xe(this,null,function*(){const a=new Map;return yield kt.iterate((t,n)=>{try{t.waveformPeaks&&t.waveformPeaks.positive instanceof Float32Array&&t.waveformPeaks.negative instanceof Float32Array&&t.duration&&a.set(n,t)}catch(r){console.error(r)}}),a})}static getCachedInfoByIdsFromStorage(a){return xe(this,null,function*(){return Promise.all(a.map(t=>kt.getItem(t)))})}static importToStorage(a){return xe(this,null,function*(){let t;try{const{cachedInfo:r}=yield pa(a,!0);t=r}catch(r){const o=yield Ge(a.metadata.sourceFileId,!1),s=yield wt(o,a.metadata.trim.frames),{frames:u}=a.metadata.trim,{pitchAdjustment:c}=a.metadata;t={waveformPeaks:s,postPluginFrameCount:o.length,duration:(o.duration-(u[0]+u[1])/je)/c,failedPluginIndex:r instanceof ua?r.pluginIndex:-1}}const n=new mt.Mutable({sampleContainer:a,cachedInfo:t});return yield n.persist(),n})}};let ge=mt;$e(ge,"Mutable",(Wt=class extends mt{constructor({sampleContainer:a,cachedInfo:t}){super({sampleContainer:a,cachedInfo:t});$e(this,"showPersistenceWarning",!0),setTimeout(()=>xe(this,null,function*(){this.showPersistenceWarning&&((yield kt.keys()).includes(this.sampleContainer.id)||console.warn(`Expected cache for sample ${this.sampleContainer.id} to be persisted`))}))}persist(){return xe(this,null,function*(){yield kt.setItem(this.sampleContainer.id,this.cachedInfo)})}update(a){return xe(this,null,function*(){if(a===this.sampleContainer)return this;let t,n=a;try{const o=yield da(n);if(a instanceof ie.Mutable&&o.length!==this.cachedInfo.postPluginFrameCount){const c=o.length/this.cachedInfo.postPluginFrameCount;yield new Promise(l=>{n=a.update(({trim:m})=>({trim:{frames:[Math.round(m.frames[0]*c),Math.round(m.frames[1]*c)]}}),l)})}const{data:s,cachedInfo:u}=yield sn(n,o,!0);yield mt.cachePreviewAudioData(n.id,s),t=u}catch(o){t=ol(ll({},this.cachedInfo),{failedPluginIndex:o instanceof ua?o.pluginIndex:-1})}const r=new mt.Mutable({sampleContainer:n,cachedInfo:t});return yield r.persist(),r})}remove(){return xe(this,null,function*(){yield kt.removeItem(this.sampleContainer.id)})}},$e(Wt,"Upgraded",class extends Wt{constructor(){super(...arguments);$e(this,"showPersistenceWarning",!1)}}),Wt)),$e(ge,"previewWavData",new Map),$e(ge,"previewAudioBuffers",new Map),$e(ge,"recentlyBufferedSampleIds",[]),$e(ge,"MAX_CACHED",10);function ga(a,t=!0){const[n,r]=Object(i.useState)({});return Object(i.useEffect)(()=>{t&&(a==null||a.getPreviewAudio().then(r))},[a,t]),n}var wn;function va(){return va=Object.assign||function(a){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(a[r]=n[r])}return a},va.apply(this,arguments)}function il(a){return i.createElement("svg",va({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24},a),wn||(wn=i.createElement("path",{d:"M11 21H7v-2h4v2m4.5-2H17v2h-4v-2h.2l-1.4-6.1-2.5.6c-.1.5-.3.9-.5 1.3-.9 1.5-2.8 1.9-4.3 1-1.5-.9-1.9-2.8-1-4.3.9-1.5 2.8-1.9 4.3-1 .4.2.7.6.9.9l2.5-.6-.6-2.5c-.4-.1-.8-.3-1.2-.5C8 6.9 7.5 5 8.4 3.5c.9-1.5 2.8-1.9 4.3-1 1.5.9 1.9 2.8 1 4.3-.2.4-.6.7-.9.9L15.5 19M7 11.8c-.7-.5-1.7-.2-2.2.5-.5.7-.2 1.7.5 2.1.7.5 1.7.3 2.2-.5.4-.7.2-1.7-.5-2.1M12.4 6c.5-.7.2-1.7-.5-2.2-.7-.5-1.7-.2-2.2.5-.4.7-.2 1.7.6 2.2.7.4 1.7.2 2.1-.5m.4 5.3c-.2-.1-.4-.1-.5.1-.1.2-.1.4.1.5.2.1.4.1.5-.1.2-.2.1-.4-.1-.5M21 8.5L14.5 10l.5 2.2 7.5-1.8.5-.7-2-1.2M23 19h-4v2h4v-2M5 19H1v2h4v-2z"})))}var Ri=v.p+"static/media/scissors-cutting.e79733cb.svg",sl=v(12),ye=v.n(sl),cl=e.a.memo(function({sample:t,sampleCache:n,editCacheInvalidator:r,onSampleUpdate:o}){const{wavData:s,audioBuffer:u}=ga(n),{sample:{id:c,metadata:{name:l,trim:{frames:m},normalize:f}},pluginProcessedAudioBuffer:p}=za(t,r),{monoSamples:d,waveformRef:g,pixelWidth:h,peaks:E,onResize:y}=Ua(p),b=Object(i.useMemo)(()=>Math.max(at(E.negative),at(E.positive)),[E]),k=Object(i.useMemo)(()=>{if(!p)return 0;const O=Ot(d,m);return at(O)},[p,d,m]),I=f==="selection"?1/k:1/b,[R,z]=Object(i.useState)({trimFrames:m,cursor:null});Object(i.useEffect)(()=>{z({trimFrames:m,cursor:null})},[m]);const U=Object(i.useMemo)(()=>{if(!d.length||!h)return[0,0];const O=h/d.length;return R.trimFrames.map($=>$*O)},[h,d.length,R.trimFrames]),Q=Object(i.useRef)(R);Q.current=R;const H=Object(i.useRef)(t.id);H.current=t.id;const T=Object(i.useCallback)(()=>{if(c!==H.current)return;const{trimFrames:O}=Q.current;o(c,$=>$.trim.frames.every((J,ee)=>O[ee]===J)?$:{trim:{frames:O}})},[c,o]),j=Object(i.useRef)(!1);Object(i.useEffect)(()=>{j.current&&(T(),j.current=!1)},[R,T]);const w=Object(i.useCallback)(()=>{j.current=!0,z({trimFrames:[0,0],cursor:null})},[]),S=Object(i.useRef)(null),_=Object(i.useRef)(null),P=Object(i.useRef)(null);{const O=Object(i.useRef)(null),$=Object(i.useRef)(null),J=Object(i.useRef)(null),ee=Object(i.useRef)(!1),W=Object(i.useRef)(null);Object(i.useLayoutEffect)(()=>{W.current&&(clearTimeout(W.current),W.current=null)},[R]);const K=Object(i.useMemo)(()=>{if(!h||!d.length)return null;const N=Math.max(2e3,Math.ceil(10*d.length/h));return{pixelWidth:h,monoSamplesLength:d.length,minFrameWidth:N}},[h,d.length]);Object(i.useEffect)(()=>{if(!K||!S.current||!_.current||!P.current)return;const C=S.current,N=_.current,M=P.current,{pixelWidth:D,monoSamplesLength:F,minFrameWidth:G}=K;let te=0;function ue(){te=M.getBoundingClientRect().left}function X(L){L instanceof TouchEvent&&L.preventDefault(),document.body.style.userSelect="none";const{pageX:ne}=L instanceof MouseEvent?L:L.touches[0];O.current=ne}function we(L){L instanceof TouchEvent&&L.preventDefault(),document.body.style.userSelect="none";const{pageX:ne}=L instanceof MouseEvent?L:L.touches[0];$.current=ne}function pe(L){if(L instanceof TouchEvent&&L.preventDefault(),L.detail===2){w();return}document.body.style.userSelect="none";const{clientX:ne}=L instanceof MouseEvent?L:L.touches[0];ue();const Pe=Math.max(0,Math.min(D,ne-te)),ke=Pe/D,he=Math.round(F*ke),lt=he+G,ot=lt<F?lt:he-G;ot<0||(z({trimFrames:[Math.min(he,ot),F-1-Math.max(he,ot)],cursor:Pe-1}),J.current=he)}function Te(L){const ne=L/D,Pe=Math.round(F*ne);z(({trimFrames:ke})=>{let he=ke[0]+Pe;return he=Math.min(he,F-ke[1]-G),he=Math.max(he,0),{trimFrames:[he,ke[1]],cursor:null}})}function Xe(L){if(O.current===null)return;L instanceof TouchEvent&&L.preventDefault();const{pageX:ne}=L instanceof MouseEvent?L:L.touches[0],Pe=ne-O.current;Pe&&(Te(Pe),O.current=ne)}function rt(L){const ne=L/D,Pe=Math.round(F*ne);z(({trimFrames:ke})=>{let he=ke[1]+Pe;return he=Math.min(he,F-ke[0]-G),he=Math.max(he,0),{trimFrames:[ke[0],he],cursor:null}})}function gt(L){if($.current===null)return;L instanceof TouchEvent&&L.preventDefault();const{pageX:ne}=L instanceof MouseEvent?L:L.touches[0],Pe=$.current-ne;Pe&&(rt(Pe),$.current=ne)}let Zt=!1;function yr(L){if(O.current!==null)return;let ne=!0;switch(L.key){case"ArrowLeft":Te(-1);break;case"ArrowRight":Te(1);break;default:ne=!1;break}ne&&(L.stopPropagation(),L.preventDefault(),Zt=!0)}function Er(L){if($.current!==null)return;let ne=!0;switch(L.key){case"ArrowLeft":rt(1);break;case"ArrowRight":rt(-1);break;default:ne=!1;break}ne&&(L.stopPropagation(),L.preventDefault(),Zt=!0)}function xa(L){if(J.current===null)return;L instanceof TouchEvent&&L.preventDefault();const ne=J.current,{clientX:Pe}=L instanceof MouseEvent?L:L.touches[0],ke=Math.max(0,Math.min(D,Pe-te)),he=ke/D,lt=Math.max(0,Math.min(F-1,Math.round(F*he)));if(lt!==J.current){ee.current=!0;const ot=ne+G,Fa=ne-G,Ba=lt>ne?ot<F?Math.max(lt,ot):Fa:Fa>=0?Math.min(lt,Fa):ot;z({trimFrames:[Math.min(ne,Ba),F-1-Math.max(ne,Ba)],cursor:ne<Ba?ke:ke-1})}}function br(L){Xe(L),gt(L),xa(L)}function ve(L){(O.current!==null||$.current!==null||J.current!==null||Zt)&&((L instanceof TouchEvent||L instanceof KeyboardEvent)&&L.preventDefault(),J.current&&!ee.current&&L.detail===1?W.current=setTimeout(()=>{W.current=null,T()},250):T(),O.current=null,$.current=null,J.current=null,ee.current=!1,Zt=!1),document.body.style.userSelect="unset"}function vt(L){L.target instanceof Node&&M.contains(L.target)||W.current&&(clearTimeout(W.current),W.current=null,T())}return C.addEventListener("touchstart",X),C.addEventListener("mousedown",X),N.addEventListener("touchstart",we),N.addEventListener("mousedown",we),M.addEventListener("touchstart",pe),M.addEventListener("mousedown",pe),C.addEventListener("touchmove",Xe),N.addEventListener("touchmove",gt),C.addEventListener("keydown",yr),N.addEventListener("keydown",Er),M.addEventListener("touchmove",xa),window.addEventListener("mousemove",br),C.addEventListener("touchend",ve),C.addEventListener("touchcancel",ve),C.addEventListener("keyup",ve),N.addEventListener("touchend",ve),N.addEventListener("keyup",ve),N.addEventListener("touchcancel",ve),M.addEventListener("touchend",ve),M.addEventListener("touchcancel",ve),window.addEventListener("mouseup",ve),window.addEventListener("touchstart",vt,{capture:!0}),window.addEventListener("mousedown",vt,{capture:!0}),window.addEventListener("keydown",vt,{capture:!0}),()=>{C.removeEventListener("touchstart",X),C.removeEventListener("mousedown",X),N.removeEventListener("touchstart",we),N.removeEventListener("mousedown",we),M.removeEventListener("touchstart",pe),M.removeEventListener("mousedown",pe),C.removeEventListener("touchmove",Xe),N.removeEventListener("touchmove",gt),C.removeEventListener("keydown",yr),N.removeEventListener("keydown",Er),M.removeEventListener("touchmove",xa),window.removeEventListener("mousemove",br),C.removeEventListener("touchend",ve),C.removeEventListener("touchcancel",ve),C.removeEventListener("keyup",ve),N.removeEventListener("touchend",ve),N.removeEventListener("keyup",ve),N.removeEventListener("touchcancel",ve),M.removeEventListener("touchend",ve),M.removeEventListener("touchcancel",ve),window.removeEventListener("mouseup",ve),window.removeEventListener("touchstart",vt,{capture:!0}),window.removeEventListener("mousedown",vt,{capture:!0}),window.removeEventListener("keydown",vt,{capture:!0})}},[K,T,w])}const{isPlaybackActive:B,playbackProgress:x,displayedTime:Z,togglePlayback:re,stopPlayback:le}=na(u||null,!0);Object(i.useEffect)(()=>le,[t,R,le]);const fe=t.metadata.trim.frames.every(O=>O===0),Y=k*(f?I:1)>1;return e.a.createElement(e.a.Fragment,null,e.a.createElement(oe.a.Group,{className:ye.a.waveformAdjacentControls},e.a.createElement(qr,{sampleId:c,normalize:f,onSampleUpdate:o}),e.a.createElement(V.a,{type:"button",variant:"secondary",disabled:fe,onClick:w},fe?"All audio selected":"Select all audio")),e.a.createElement("div",{className:[ye.a.waveformContainer,B?ye.a.playbackActive:"",f==="selection"?ye.a.normalizeOnlySelection:""].join(" "),style:{"--cursor-display":R.cursor===null?"none":"unset","--cursor-left":`${R.cursor}px`,"--trim-pixels-left":`${U[0]}px`,"--trim-pixels-right":`${U[1]}px`}},e.a.createElement(Bt,{peaks:E,scaleCoefficient:1}),e.a.createElement(Bt,{waveformRef:g,peaks:E,scaleCoefficient:f?I:1,opaque:!0,onResize:y}),e.a.createElement(vn,{isPlaybackActive:B,playbackProgress:x,displayedTime:Z,downloadFilename:`${l}.volcasample.wav`,wavFile:s||null,togglePlayback:re}),e.a.createElement("div",{className:ye.a.cursor}),e.a.createElement("div",{className:[ye.a.trim,ye.a.left].join(" ")},e.a.createElement("div",{className:ye.a.bar}),e.a.createElement("div",{ref:S,className:ye.a.handle,tabIndex:0}),n&&Boolean(d.length)&&e.a.createElement("span",{className:ye.a.time},Et(n.cachedInfo.duration*R.trimFrames[0]/d.length,2))),e.a.createElement("div",{className:[ye.a.trim,ye.a.right].join(" ")},e.a.createElement("div",{className:ye.a.bar}),e.a.createElement("div",{ref:_,className:ye.a.handle,tabIndex:0}),n&&Boolean(d.length)&&e.a.createElement("span",{className:ye.a.time},Et(n.cachedInfo.duration*(d.length-1-R.trimFrames[1])/d.length,2))),e.a.createElement("div",{ref:P,className:ye.a.waveformOverlay}),Y&&e.a.createElement(Ie.a,{delay:{show:400,hide:0},overlay:e.a.createElement(Ae.a,null,"Audio is clipping - maybe normalize?")},e.a.createElement("div",{className:ye.a.clippingAlert},e.a.createElement(il,null)))))}),Ht=v(207),ul=v(137),Sn=(a,t,n)=>new Promise((r,o)=>{var s=l=>{try{c(n.next(l))}catch(m){o(m)}},u=l=>{try{c(n.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,u);c((n=n.apply(a,t)).next())});let _n;function Cn(){return Sn(this,null,function*(){return typeof window.CREATE_SYRO_BINDINGS!="function"?Promise.reject("Expected CREATE_SYRO_BINDINGS global function to exist"):_n=_n||window.CREATE_SYRO_BINDINGS().then(a=>Sn(this,null,function*(){return{allocateSyroData:a.cwrap("allocateSyroData","number",["number"]),createEmptySyroData:a.cwrap("createEmptySyroData",null,["number","number","number"]),createSyroDataFromWavData:a.cwrap("createSyroDataFromWavData",null,["number","number","array","number","number","number"]),getDeleteBufferFromSyroData:a.cwrap("getDeleteBufferFromSyroData","number",["number","number"]),prepareSampleBufferFromSyroData:a.cwrap("prepareSampleBufferFromSyroData","number",["number","number","number"]),getSampleBufferChunkPointer:a.cwrap("getSampleBufferChunkPointer","number",["number"]),getSampleBufferChunkSize:a.cwrap("getSampleBufferChunkSize","number",["number"]),getSampleBufferProgress:a.cwrap("getSampleBufferProgress","number",["number"]),getSampleBufferTotalSize:a.cwrap("getSampleBufferTotalSize","number",["number"]),getSampleBufferDataStartPointsPointer:a.cwrap("getSampleBufferDataStartPointsPointer","number",["number"]),freeDeleteBuffer:a.cwrap("freeDeleteBuffer",null,["number"]),cancelSampleBufferWork:a.cwrap("cancelSampleBufferWork",null,["number"]),registerUpdateCallback(n){return a.addFunction(n,"vi")},unregisterUpdateCallback(n){a.removeFunction(n)},heap8Buffer(){return a.HEAP8.buffer}}}))})}var Pn=(a,t,n)=>new Promise((r,o)=>{var s=l=>{try{c(n.next(l))}catch(m){o(m)}},u=l=>{try{c(n.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,u);c((n=n.apply(a,t)).next())});function ml(a,t){let n=!1,r=()=>{};return{cancelWork(){n=!0,r()},syroBufferPromise:(()=>Pn(this,null,function*(){const{allocateSyroData:o,createSyroDataFromWavData:s,prepareSampleBufferFromSyroData:u,getSampleBufferChunkPointer:c,getSampleBufferChunkSize:l,getSampleBufferProgress:m,getSampleBufferTotalSize:f,getSampleBufferDataStartPointsPointer:p,cancelSampleBufferWork:d,registerUpdateCallback:g,unregisterUpdateCallback:h,heap8Buffer:E}=yield Cn(),y={syroBuffer:new Uint8Array,dataStartPoints:[]};if(n)return y;const b=[];for(const H of a){const{data:T}=yield pa(H);if(n)return y;b.push(T)}let k,I=0;const R=new Uint32Array(a.length),z=g(H=>{if(n)return;const T=f(H);k||(k=new Uint8Array(T));const j=c(H),w=l(H),S=m(H);k.set(new Uint8Array(E(),j,w),S-w),I=S/T;const _=p(H);R.set(new Uint32Array(E(),_,a.length),0)}),U=o(a.length);a.forEach((H,T)=>{const j=b[T];s(U,T,j,j.length,H.metadata.slotNumber,H.metadata.qualityBitDepth,H.metadata.useCompression?1:0)});const Q=u(U,a.length,z);t(I);try{yield new Promise(H=>{let T;r=()=>{cancelAnimationFrame(T),d(Q),H()},j();function j(){if(I&&(t(I),I>=1)){H();return}T=requestAnimationFrame(j)}})}finally{r=()=>{},h(z)}if(n)return y;if(!k)throw new Error("Unexpected condition: syroBuffer should be defined");return{syroBuffer:k,dataStartPoints:[...R]}}))()}}function Di(a){return Pn(this,null,function*(){const{allocateSyroData:t,createEmptySyroData:n,getDeleteBufferFromSyroData:r,getSampleBufferChunkPointer:o,getSampleBufferChunkSize:s,getSampleBufferDataStartPointsPointer:u,freeDeleteBuffer:c,heap8Buffer:l}=yield Cn(),m=t(a.length);a.forEach((y,b)=>{n(m,b,y)});const f=r(m,a.length),p=o(f),d=s(f),g=new Uint8Array(new Uint8Array(l(),p,d)),h=u(f),E=[...new Uint32Array(l(),h,a.length)];return c(f),{syroBuffer:g,dataStartPoints:E}})}var dl=v(13),Ee=v.n(dl),On=v(116),kn=v.n(On),ya=v(117),Ea=v(118),fl=v(31),Fe=v.n(fl),Mn=Math.pow;function xi(a){const{error:t}=console;console.error=()=>null;const n=Object(Jt.findDOMNode)(a);return console.error=t,n}const pl=Jt.findDOMNode;On.Digit.defaultProps.offOpacity=0;const In=(a,t)=>Math.min(199,t+Mn(10,a)),An=(a,t)=>Math.max(0,t-Mn(10,a));var hl=e.a.memo(function({slotNumber:a,onSlotNumberUpdate:t}){const[n,r]=Object(i.useState)(a);Object(i.useEffect)(()=>{r(a)},[a]);const[o,s]=Object(i.useState)(null),u=Object(i.useCallback)(f=>{t(p=>In(f,p))},[t]),c=Object(i.useCallback)(f=>{t(p=>An(f,p))},[t]),l=Object(i.useRef)(null),m=Object(i.useRef)(null);{const f=Object(i.useRef)(o);f.current=o;const p=Object(i.useRef)(n);p.current=n;const d=Object(i.useRef)(t);d.current=t,Object(i.useEffect)(()=>{if(!m.current)throw new Error("Expected elements to exist");function g(j){const w=f.current===null?0:f.current;let S=!0;const _=()=>{s(w)};switch(j.key){case"ArrowDown":_(),r(P=>An(w,P));break;case"ArrowUp":_(),r(P=>In(w,P));break;case"ArrowLeft":_(),s(P=>P!==null&&P<2?P+1:P);break;case"ArrowRight":_(),s(P=>P&&P-1);break;case"Enter":case"Escape":s(null);break;default:S=!1;break}S&&j.preventDefault()}function h(j){const w=f.current===null?2:f.current;j.stopPropagation(),j.preventDefault();const S=p.current,_=d.current;if(isNaN(Number(j.key)))_(S);else{const P=String(S).padStart(3,"0").split("");P[2-w]=j.key;const B=Math.min(199,Math.max(0,Number(P.join(""))));s(w?w-1:null),_(B)}}const E=l.current;E.addEventListener("keydown",g,!0),E.addEventListener("keyup",h,!0);let y=0,b=!1,k=!1,I=0;function R(j){document.body.style.userSelect="none",y=j instanceof MouseEvent?j.pageY:j.touches[0].pageY,b=!0,k=!1,I=p.current}E.addEventListener("mousedown",R),E.addEventListener("touchstart",j=>{j.preventDefault(),R(j)});function z(j){if(!b)return;const{pageY:w}=j instanceof MouseEvent?j:j.touches[0],S=2,_=Math.round((y-w)/S);_&&(k=!0,r(Math.min(199,Math.max(0,I+_))))}window.addEventListener("mousemove",z),E.addEventListener("touchmove",z);function U(){document.body.style.userSelect="unset",b=!1,k&&d.current(p.current)}window.addEventListener("mouseup",U),E.addEventListener("touchend",U),E.addEventListener("touchcancel",()=>{document.body.style.userSelect="unset"});function Q(j){k||m.current&&m.current.some(w=>w.contains(j.target))||s(2)}E.addEventListener("click",Q),m.current.forEach((j,w)=>{const S=w;j.addEventListener("click",()=>{k||s(S)}),j.addEventListener("touchstart",_=>{_.preventDefault()})});function H(){b||s(2)}function T(){s(null)}return E.addEventListener("focus",H),E.addEventListener("blur",T),()=>{window.removeEventListener("mousemove",z),window.removeEventListener("mouseup",U)}},[])}return Object(i.useEffect)(()=>{if(!m.current)throw new Error("Expected elements to exist");m.current.forEach((f,p)=>{p===o?f.classList.add(Fe.a.active):f.classList.remove(Fe.a.active)})},[o]),e.a.createElement(e.a.Fragment,null,e.a.createElement(oe.a.Label,null,"Choose destination"),e.a.createElement("br",null),e.a.createElement("div",{className:Fe.a.slotNumberRow},e.a.createElement("div",{className:Fe.a.slotNumberContainer},e.a.createElement("div",{className:Fe.a.arrowControls},e.a.createElement("span",{onClick:()=>u(2)},e.a.createElement(ya.a,null)),e.a.createElement("span",{onClick:()=>u(1)},e.a.createElement(ya.a,null)),e.a.createElement("span",{onClick:()=>u(0)},e.a.createElement(ya.a,null))),e.a.createElement(Ie.a,{delay:{show:400,hide:0},placement:"right",overlay:e.a.createElement(Ae.a,null,"Slot ",n)},e.a.createElement("div",{className:Fe.a.slotNumber,ref:l,tabIndex:0},e.a.createElement(kn.a,{value:"8888",color:"var(--bs-gray-dark)",strokeColor:"transparent",digitCount:4}),e.a.createElement(kn.a,{ref:f=>{const p=pl(f);if(p){p.querySelectorAll("circle").forEach(g=>{p.removeChild(g)});const d=document.createElementNS("http://www.w3.org/2000/svg","circle");d.classList.add(Fe.a.point),d.setAttribute("cx","10.7"),d.setAttribute("cy","17"),d.setAttribute("r","1"),p.appendChild(d),m.current=[].slice.call(p.querySelectorAll("g")).reverse().slice(0,3)}},value:`5${String(n).padStart(3,"0")}`,digitProps:{color:"var(--bs-primary)"},digitCount:4}))),e.a.createElement("div",{className:Fe.a.arrowControls},e.a.createElement("span",{onClick:()=>c(2)},e.a.createElement(Ea.a,null)),e.a.createElement("span",{onClick:()=>c(1)},e.a.createElement(Ea.a,null)),e.a.createElement("span",{onClick:()=>c(0)},e.a.createElement(Ea.a,null)))),a>99&&n>99&&e.a.createElement(Ie.a,{placement:"auto-end",overlay:e.a.createElement(Ae.a,null,"To transfer to this destination, be sure you have a volca sample2. The original volca sample only supports slots 0-99.")},e.a.createElement("span",{className:Fe.a.warning},e.a.createElement(Xt.a,null)))))}),gl=v(206),Nn;function ba(){return ba=Object.assign||function(a){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(a[r]=n[r])}return a},ba.apply(this,arguments)}function vl(a){return i.createElement("svg",ba({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24},a),Nn||(Nn=i.createElement("path",{d:"M19 6V5a2 2 0 00-2-2h-2a2 2 0 00-2 2v1h-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v1H3v14h18V6z"})))}var Bi=v.p+"static/media/toy-brick.bcefc45f.svg",yl=v(49),nt=v.n(yl),Vt=e.a.memo(function({samples:t,selectedSampleIds:n,setSelectedSampleIds:r,sampleIdsWithPluginFails:o,highlightDuplicateSlots:s}){const u=[...t.keys()].every(p=>n.has(p)),c=!u&&[...t.keys()].every(p=>!n.has(p)),l=!u&&!c,m=Object(i.useRef)(null);m.current&&(m.current.indeterminate=l),Object(i.useLayoutEffect)(()=>{m.current&&(m.current.indeterminate=l)},[l]);const f=Object(i.useMemo)(()=>{if(!s)return new Set;const p=new Map;for(const[d,g]of t){if(!n.has(d))continue;const{slotNumber:h}=g instanceof ie?g.metadata:g;p.set(h,(p.get(h)||0)+1)}return new Set([...p].filter(([d,g])=>g>1).map(([d])=>d))},[t,n,s]);return e.a.createElement(gl.a,{className:nt.a.samplesTable},e.a.createElement("thead",null,e.a.createElement("tr",null,e.a.createElement("th",{className:nt.a.check},e.a.createElement("input",{ref:m,type:"checkbox",checked:!c,onChange:p=>{r(d=>{const g=new Set(d);if(p.target.checked)for(const[h]of t)g.add(h);else for(const[h]of t)g.delete(h);return g})}})),e.a.createElement("th",{className:nt.a.name},"Name"),e.a.createElement("th",{className:nt.a.slotNumber},"Slot"),e.a.createElement("th",{className:nt.a.updated},"Updated"),o&&e.a.createElement("th",{className:nt.a.pluginsOk,title:"Plugin status"},e.a.createElement(vl,null)))),e.a.createElement("tbody",null,[...t].map(([p,d])=>{const g=d instanceof ie?d.metadata:d;return e.a.createElement("tr",{key:p,onClick:h=>{const E=h.currentTarget.querySelector("input");E&&E!==h.target&&!E.contains(h.target)&&E.click()}},e.a.createElement("td",null,e.a.createElement("input",{type:"checkbox",checked:n.has(p),onChange:h=>{r(E=>{const y=new Set(E);return h.target.checked?y.add(p):y.delete(p),y})}})),e.a.createElement("td",{title:g.name},g.name),e.a.createElement("td",{className:f.has(g.slotNumber)&&n.has(p)?nt.a.duplicateSlot:void 0},g.slotNumber),e.a.createElement("td",{title:new Date(g.dateModified).toLocaleString()},new Date(g.dateModified).toLocaleDateString()),o&&e.a.createElement("td",null,o.includes(p)?"\u274C":d instanceof ie&&d.metadata.plugins.length?"OK":null))})))}),El=(a,t,n)=>new Promise((r,o)=>{var s=l=>{try{c(n.next(l))}catch(m){o(m)}},u=l=>{try{c(n.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,u);c((n=n.apply(a,t)).next())});function bl({samples:a,sampleCaches:t,justTheButton:n,showInfoBeforeTransfer:r,button:o,onSlotNumberUpdate:s}){const u=Object(i.useMemo)(()=>a instanceof Array?a:[a],[a]),c=Object(i.useMemo)(()=>new Map(u.map(W=>[W.id,W])),[u]),[l,m]=Object(i.useState)(c);Object(i.useEffect)(()=>{m(c)},[c]);const f=Object(i.useMemo)(()=>new Set(l.keys()),[l]),p=Object(i.useCallback)(W=>{m(K=>new Map(u.filter(C=>W(new Set(K.keys())).has(C.id)).map(C=>[C.id,C])))},[u]),d=Object(i.useMemo)(()=>{let W=0;for(const[K]of l){const C=t.get(K);C&&(W+=C.cachedInfo.duration)}return W},[l,t]),g=Object(i.useMemo)(()=>{const W=new Map;for(const[,K]of l){const{slotNumber:C}=K.metadata;W.set(C,(W.get(C)||0)+1)}return[...W].filter(([K,C])=>C>1).map(([K])=>K)},[l]),h=Object(i.useMemo)(()=>{const W=[];for(const[K]of l){const C=t.get(K);C&&C.cachedInfo.failedPluginIndex>-1&&W.push(K)}return W},[l,t]),[E,y]=Object(i.useState)(1),[b,k]=Object(i.useState)(0),[I,R]=Object(i.useState)(!1),[z,U]=Object(i.useState)(!1),[Q,H]=Object(i.useState)("idle");Object(i.useLayoutEffect)(()=>{if(Q==="transferring")return U(!1),()=>{setTimeout(()=>k(0),100)}},[Q]);const T=Object(i.useMemo)(()=>{let W=l.size*44;for(const[K]of l){const C=t.get(K);C&&(W+=C.cachedInfo.duration*je*2)}return W},[l,t]),[j,w]=Object(i.useState)([]),[S,_]=Object(i.useState)(null),[P,B]=Object(i.useState)(null);Object(i.useEffect)(()=>{S instanceof AudioBuffer&&P&&(B(null),P.fn())},[S,P]);const x=Object(i.useRef)(()=>{}),Z=Boolean(l.size&&!g.length&&!h.length&&l.size<=110);Object(i.useEffect)(()=>{if(!Z)return;let W=!1;y(0),H("idle"),_(null),B(null),x.current=()=>{W=!0};try{const{syroBufferPromise:K,cancelWork:C}=ml([...l.values()],N=>{W||y(N)});x.current=()=>{C(),W=!0},K.then(N=>El(this,[N],function*({syroBuffer:M,dataStartPoints:D}){if(W)return;x.current=()=>{W=!0},w(D.map(G=>G/M.length));const F=yield ut(M);W||_(F)}))}catch(K){console.error(K),_(new Error(String(K)))}return()=>x.current()},[l,Z]);const{playAudioBuffer:re}=un(),le=Object(i.useCallback)(W=>{if(!(S instanceof AudioBuffer)){if(!S){const{target:K,nativeEvent:C}=W;B({fn:()=>K.dispatchEvent(C)})}return}try{H("transferring");const K=re(S,{onTimeUpdate:C=>k(C/S.duration)});x.current=()=>{K(),H("idle")}}catch(K){console.error(K),H("error")}},[re,S]),fe=Object(i.useCallback)(()=>x.current(),[]),Y=Q==="transferring"&&b<1,O=e.a.createElement(e.a.Fragment,null,e.a.createElement("div",null,e.a.createElement("strong",null,"Sample length:")," ",Et(d,2)),e.a.createElement("div",null,e.a.createElement("strong",null,"Memory footprint:")," ",Object(ul.a)(T).toString()),e.a.createElement("div",null,e.a.createElement("strong",null,"Time to transfer:")," ",S instanceof AudioBuffer?ea(S.duration):S instanceof Error?"error":e.a.createElement("i",null,e.a.createElement("small",null,"Checking.."," ",E&&d>=10?`${(E*100).toFixed(0)}%`:"")))),{currentlyTransferringSample:$,currentSampleProgress:J,timeLeftUntilNextSample:ee}=Object(i.useMemo)(()=>{const W=[...l.values()];if(Q!=="transferring"||!(S instanceof AudioBuffer))return{currentlyTransferringSample:W[0],currentSampleProgress:0,timeLeftUntilNextSample:0};const K=j.findIndex(te=>te>b)-1,C=K>=0?K:W.length-1,N=W[C],M=j[C],D=j[C+1]||1,F=(b-M)/(D-M),G=(D-b)*S.duration;return{currentlyTransferringSample:N,currentSampleProgress:F,timeLeftUntilNextSample:G}},[l,j,Q,b,S]);return e.a.createElement(e.a.Fragment,null,!n&&e.a.createElement(e.a.Fragment,null,e.a.createElement("div",{className:Ee.a.transferInfoBox},O),e.a.createElement(hl,{slotNumber:u[0].metadata.slotNumber,onSlotNumberUpdate:s})),e.a.cloneElement(o||e.a.createElement(V.a,{className:Ee.a.transferButton,type:"button",variant:"primary"},"Transfer to volca sample"),{onClick(){r?R(!0):U(!0)}}),e.a.createElement(A.a,{onHide:()=>R(!1),className:Ee.a.preTransferModal,show:I,"aria-labelledby":"info-before-transfer-modal"},e.a.createElement(A.a.Header,null,e.a.createElement(A.a.Title,{id:"info-before-modal"},"Confirm samples to be transferred")),e.a.createElement(A.a.Body,null,e.a.createElement("div",{className:Ee.a.summary},e.a.createElement("p",{className:[Ee.a.transferInfoForModal,Z?"":Ee.a.cannotTransfer].join(" ")},O),!Z&&e.a.createElement("div",{className:Ee.a.errors},g.length>0?e.a.createElement("p",{className:Ee.a.invalidMessage},"You cannot transfer multiple samples to the same slot (slot",g.length>1&&"s"," ",e.a.createElement("strong",null,g.join(", ")),")."):h.length>0?e.a.createElement("p",{className:Ee.a.invalidMessage},"Please fix or unselect samples with broken plugins."):l.size?l.size>110?e.a.createElement("p",{className:Ee.a.invalidMessage},"You cannot transfer more than ",e.a.createElement("strong",null,"110")," samples at once."):null:e.a.createElement("p",{className:Ee.a.invalidMessage},"You must select at least one sample to transfer.")," ")),e.a.createElement(Vt,{samples:c,selectedSampleIds:f,setSelectedSampleIds:p,sampleIdsWithPluginFails:h,highlightDuplicateSlots:!0})),e.a.createElement(A.a.Footer,null,e.a.createElement(V.a,{type:"button",variant:"light",onClick:()=>R(!1)},"Cancel"),e.a.createElement(V.a,{type:"button",variant:"primary",disabled:!(S instanceof AudioBuffer)||!Z,onClick:()=>{U(!0),R(!1)}},"Continue"))),e.a.createElement(A.a,{onHide:()=>U(!1),className:Ee.a.preTransferModal,show:z,"aria-labelledby":"pre-transfer-modal"},e.a.createElement(A.a.Header,null,e.a.createElement(A.a.Title,{id:"pre-transfer-modal"},"Connect volca sample before continuing")),e.a.createElement(A.a.Body,null,e.a.createElement("figure",null,e.a.createElement("img",{src:"connection.png",alt:""}),e.a.createElement("figcaption",{className:"small"},"Source:"," ",e.a.createElement("a",{href:"https://github.com/korginc/volcasample#6-transferring-syrostream-to-your-volca-sample",target:"_blank",rel:"noreferrer"},"KORG"))),e.a.createElement("p",null,"Make sure your ",e.a.createElement("strong",null,"headphone output")," is connected to the volca sample's ",e.a.createElement("strong",null,"SYNC IN")," and adjust your output volume to a high (but not overdriven) level. Your volca wants to hear this, but you don't.")),e.a.createElement(A.a.Footer,null,e.a.createElement(V.a,{type:"button",variant:"light",onClick:()=>U(!1)},"Cancel"),e.a.createElement(V.a,{type:"button",variant:"primary",disabled:!(S instanceof AudioBuffer),onClick:le},"Transfer now"))),e.a.createElement(A.a,{show:Y,"aria-labelledby":"transfer-modal"},e.a.createElement(A.a.Header,null,e.a.createElement(A.a.Title,{id:"transfer-modal"},"Sample transfer in progress")),e.a.createElement(A.a.Body,null,l.size>1?e.a.createElement("p",null,"Transferring ",e.a.createElement("strong",null,l.size," samples")," to your volca sample. Don't disconnect anything."):[...l.values()][0]?e.a.createElement("p",null,"Transferring"," ",e.a.createElement("strong",null,[...l.values()][0].metadata.name)," ","to slot"," ",e.a.createElement("strong",null,[...l.values()][0].metadata.slotNumber)," ","on your volca sample. Don't disconnect anything."):null,e.a.createElement(Ht.a,{striped:!0,animated:!0,variant:"primary",now:100*b}),e.a.createElement("div",{className:Ee.a.progressAnnotation},S instanceof AudioBuffer&&ea(S.duration*(1-b))," ","remaining"),l.size>1&&e.a.createElement("div",{className:Ee.a.subtask},e.a.createElement("p",null,"(",[...l.values()].indexOf($)+1,"/",l.size,")"," ",e.a.createElement("strong",{className:Ee.a.name},$.metadata.name)," ","to slot"," ",e.a.createElement("strong",null,$.metadata.slotNumber)),e.a.createElement(Ht.a,{className:Ee.a.secondaryProgress,variant:"primary",now:100*J}),e.a.createElement("div",{className:Ee.a.progressAnnotation},ea(ee)," remaining"))),e.a.createElement(A.a.Footer,null,e.a.createElement(V.a,{type:"button",variant:"primary",onClick:fe},"Cancel"))),e.a.createElement(A.a,{onHide:fe,show:Q!=="idle"&&!Y,"aria-labelledby":"after-transfer-modal"},e.a.createElement(A.a.Header,null,e.a.createElement(A.a.Title,{id:"after-transfer-modal"},Q==="error"?"Error transferring":"Sample transfer complete")),e.a.createElement(A.a.Body,null,Q==="error"?e.a.createElement("p",null,"Something unexpected happening while transferring (on our end)."):e.a.createElement(e.a.Fragment,null,l.size>1?e.a.createElement("p",null,"Your samples were transferred to your volca sample."):[...l.values()][0]?e.a.createElement("p",null,e.a.createElement("strong",null,[...l.values()][0].metadata.name)," ","was transferred to slot"," ",e.a.createElement("strong",null,[...l.values()][0].metadata.slotNumber)," ","on your volca sample."):null,e.a.createElement("h5",null,"If you see ",e.a.createElement("strong",null,"[End]"),":"),e.a.createElement("p",null,"The transfer was successful. Press the blinking"," ",e.a.createElement("strong",null,"[FUNC]")," button to finish."),e.a.createElement("h5",null,"If you see ",e.a.createElement("strong",null,"[Err dcod]"),":"),e.a.createElement("p",null,"Check your volume level and make sure no other application is creating noise, then try again. If your volume is at a decent level but the transfer failed, you might also want to try a new audio cable."),e.a.createElement("h5",null,"If you see ",e.a.createElement("strong",null,"[Err FuLL]"),":"),e.a.createElement("p",null,"Free up some memory on the volca sample (or cut down your sample size), then try again."),e.a.createElement("p",null,"For more info, check out this"," ",e.a.createElement("a",{href:"https://www.korg.com/products/dj/volca_sample/faq.php",target:"_blank",rel:"noreferrer"},"FAQ")," ","from KORG."))),e.a.createElement(A.a.Footer,null,e.a.createElement(V.a,{type:"button",variant:"primary",onClick:fe},"Done"))))}var wa=bl,wl=v(35),Sl=v(97),Sa=v(212),Re=v(214),_a=v(153),_l=v(60),Ca=v.n(_l),Cl=v(138),Pl=v(139),Ol=v(140),kl=v(141),Ml=v(142),Il=v(143),jn=v(96),Al=v(144),Nl=v(145),Rn;function Pa(){return Pa=Object.assign||function(a){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(a[r]=n[r])}return a},Pa.apply(this,arguments)}function Oa(a){return i.createElement("svg",Pa({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24},a),Rn||(Rn=i.createElement("path",{d:"M19 6V5a2 2 0 00-2-2h-2a2 2 0 00-2 2v1h-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v1H3v14h10.09a5.47 5.47 0 01-.09-1 6 6 0 018-5.66V6m-1 9v3h3v2h-3v3h-2v-3h-3v-2h3v-3z"})))}var Wi=v.p+"static/media/toy-brick-plus.20ac8b7a.svg",jl=v(6),ae=v.n(jl);const Tn="tabUpdateEvent";function Ce(a,t,n){const r={dataType:a,ids:t,action:n,when:Date.now()};localStorage.setItem(Tn,JSON.stringify(r))}function zt(a,t){function n(r){if(r.key===Tn&&r.newValue){const o=JSON.parse(r.newValue);o.dataType===a&&t(o)}}return window.addEventListener("storage",n),()=>{window.removeEventListener("storage",n)}}var Rl=Object.defineProperty,Tl=Object.defineProperties,Dl=Object.getOwnPropertyDescriptors,Dn=Object.getOwnPropertySymbols,xl=Object.prototype.hasOwnProperty,Fl=Object.prototype.propertyIsEnumerable,xn=(a,t,n)=>t in a?Rl(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,Fn=(a,t)=>{for(var n in t||(t={}))xl.call(t,n)&&xn(a,n,t[n]);if(Dn)for(var n of Dn(t))Fl.call(t,n)&&xn(a,n,t[n]);return a},Bn=(a,t)=>Tl(a,Dl(t)),Oe=(a,t,n)=>new Promise((r,o)=>{var s=l=>{try{c(n.next(l))}catch(m){o(m)}},u=l=>{try{c(n.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,u);c((n=n.apply(a,t)).next())});const dt=Ve.a.createInstance({name:"plugin_store",driver:Ve.a.INDEXEDDB});function Mt(a){return dt.getItem(a)}function Bl(a,t){return dt.setItem(a,t)}function Ln(a){return dt.iterate(a)}function Ll(){return Oe(this,null,function*(){const a=new Map;return yield Ln(({params:t},n)=>{a.set(n,t)}),new Map([...a].sort(([t],[n])=>t>n?1:t<n?-1:1))})}function Wl(a){return Oe(this,arguments,function*({file:t,onConfirmName:n,onConfirmReplace:r}){if(t.size>5e6)throw new Error("Plugin is too big.");let o=t.name.toLowerCase();if(!o.endsWith(".js"))throw new Error("Expecting JavaScript file.");const s=yield t.text();return yield Ut({pluginName:o,pluginSource:s,onConfirmName:n,onConfirmReplace:r})})}function Ut(a){return Oe(this,arguments,function*({pluginName:t,pluginSource:n,onConfirmName:r,onConfirmReplace:o}){const s=yield qa(n),u=yield dt.keys();let c=t,l=!1;do{if(u.includes(c)){const{pluginSource:f}=(yield Mt(c))||{};if(!f)throw new Error("Expected plugin to be installed");if((yield qa(f))===s)return"exists";const d=yield o(c);if(d==="use-existing")return"used-existing";if(l=d==="replace",l)break;const g=c.replace(/\.js$/,"");let h=2;do c=`${g} ${h++}.js`;while(u.includes(c))}c!==t&&(c=yield r(c))}while(u.includes(c));l&&ca(c)?yield ct(c).replaceSource(n):yield Pt(c,n);const m=yield ct(c).getParams();return yield Bl(c,{pluginSource:n,params:m}),Ce("plugin",[c],l?"edit":"create"),l?"replaced":"added"})}function Gt(a,t=!1){return Oe(this,null,function*(){ct(a).remove(),t||(yield dt.removeItem(a),Ce("plugin",[a],"delete"))})}function ka(a){return Oe(this,null,function*(){const{pluginSource:t=null}=(yield Mt(a))||{};return t})}function Hl(a){return Oe(this,arguments,function*({oldPluginName:t,newPluginName:n,onConfirmName:r,onConfirmReplace:o,userSamples:s}){const u=yield ka(t);if(!u)throw new Error("Expected plugin to be installed");const c=yield Ut({pluginName:n,pluginSource:u,onConfirmName:r,onConfirmReplace:o});if(c==="used-existing"||c==="exists")return{updatedSamples:[],result:c};const l=[...s.values()].filter(f=>f.metadata.plugins.some(p=>p.pluginName===t));if(!l.length)return yield Gt(t),{updatedSamples:[],result:c};const m=l.map(f=>new ie.Mutable(Bn(Fn({id:f.id},f.metadata),{plugins:f.metadata.plugins.map(p=>Bn(Fn({},p),{pluginName:p.pluginName===t?n:p.pluginName}))})));return yield Promise.all(m.map(f=>f.persist())),yield Gt(t),{updatedSamples:m,result:c}})}let Qt=null;function Vl(){return Oe(this,null,function*(){Qt=Qt||(()=>Oe(this,null,function*(){zt("plugin",t=>Oe(this,[t],function*({action:n,ids:r}){for(const o of r)n==="create"&&(yield Hn(o)),n==="edit"&&(yield zl(o)),n==="delete"&&(yield Gt(o,!0))}));const a=[];yield Ln(({pluginSource:t},n)=>{a.push(Pt(n,t))}),yield Promise.all(a)}))(),yield Qt})}function Wn(a){return Oe(this,null,function*(){const{pluginSource:t=null}=(yield Mt(a))||{};if(!t)throw new Error("Expected plugin to be stored");yield Pt(a,t)})}function Hn(a){return Oe(this,null,function*(){const{pluginSource:t=null}=(yield Mt(a))||{};if(!t)throw new Error("Expected plugin to be stored");yield Pt(a,t)})}function zl(a){return Oe(this,null,function*(){if(!ca(a)){yield Hn(a);return}const{pluginSource:t=null}=(yield Mt(a))||{};if(!t)throw new Error("Expected plugin to be stored");yield ct(a).replaceSource(t)})}function Ul(...a){return Oe(this,null,function*(){yield Qt;const t=yield dt.keys();return a.map(n=>ca(n)?"installed":t.includes(n)?"broken":"missing")})}var Gl=Object.defineProperty,Ql=Object.defineProperties,$l=Object.getOwnPropertyDescriptors,Vn=Object.getOwnPropertySymbols,Yl=Object.prototype.hasOwnProperty,Kl=Object.prototype.propertyIsEnumerable,zn=(a,t,n)=>t in a?Gl(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,Be=(a,t)=>{for(var n in t||(t={}))Yl.call(t,n)&&zn(a,n,t[n]);if(Vn)for(var n of Vn(t))Kl.call(t,n)&&zn(a,n,t[n]);return a},Le=(a,t)=>Ql(a,$l(t)),Zl=(a,t,n)=>new Promise((r,o)=>{var s=l=>{try{c(n.next(l))}catch(m){o(m)}},u=l=>{try{c(n.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,u);c((n=n.apply(a,t)).next())});function Jl({sampleId:a,pluginIndex:t,isOff:n,paramName:r,paramValue:o,paramDef:s,onSampleUpdate:u}){const[c,l]=Object(i.useState)(o);Object(i.useEffect)(()=>{l(o)},[o]);const m=Object(i.useCallback)(h=>{const E=Number(h.target.value);l(E)},[]),f=Object(i.useCallback)(h=>{u(a,E=>Le(Be({},E),{plugins:E.plugins.map((y,b)=>b===t?Le(Be({},y),{pluginParams:Le(Be({},y.pluginParams),{[r]:h})}):y)}))},[a,t,r,u]),p=Object(i.useRef)(null),d=Object(i.useRef)(null);Object(i.useEffect)(()=>{const h=p.current;if(h){const E=()=>{f(Number(h.value))};return h.addEventListener("change",E),()=>{h.removeEventListener("change",E)}}},[f]),Object(i.useEffect)(()=>{const h=d.current;if(h){const E=()=>{f(Number(h.value))};return h.addEventListener("change",E),()=>{h.removeEventListener("change",E)}}},[f]);let g=1;if(s){const h=s.max-s.min;h<10?g=.01:h<100&&(g=.1)}return e.a.createElement(oe.a.Group,{className:ae.a.paramControl},e.a.createElement("div",{className:ae.a.paramControlInputGroup},e.a.createElement("div",null,e.a.createElement(oe.a.Label,null,s&&s.label||r),e.a.createElement(Ca.a,{variant:n?"secondary":"primary",disabled:!s,value:c,min:s?s.min:0,max:s?s.max:0,step:g,size:"sm",tooltip:"off",onChange:m,ref:p})),e.a.createElement(oe.a.Control,{type:"number",min:s?s.min:void 0,max:s?s.max:void 0,step:g,value:c,onChange:m,ref:d})))}function Xl({eventKey:a,disabled:t,callback:n}){const{activeEventKey:r}=Object(i.useContext)(wl.a),o=Object(Sl.b)(a,()=>n&&n(a)),s=r===a;return e.a.createElement("div",{title:t?"No params":s?"Hide params":"Edit params",className:[ae.a.actionIcon,t?ae.a.disabled:""].join(" "),onClick:t?void 0:o},e.a.createElement(kl.a,null))}const ql=e.a.forwardRef(({onClick:a},t)=>e.a.createElement("div",{className:ae.a.actionIcon,ref:t,onClick:n=>{n.preventDefault(),a(n)}},e.a.createElement(Ml.a,null)));function eo({eventKey:a,sampleId:t,pluginIndex:n,plugin:r,status:o,paramsDef:s,isFirst:u,isLast:c,onSampleUpdate:l,onOpenPluginManager:m}){const f=!r.isBypassed&&o==="ok",p=r.isBypassed?"ok":o;return e.a.createElement(Sa.a,{className:ae.a.pluginItem},e.a.createElement(Sa.a.Header,{className:ae.a.header},e.a.createElement("div",{className:ae.a.pluginName,title:r.pluginName},f?e.a.createElement("strong",null,r.pluginName):p!=="ok"?e.a.createElement("span",{className:ae.a.pluginHasError},r.pluginName):e.a.createElement("span",null,r.pluginName)),e.a.createElement("div",{className:ae.a.actions},e.a.createElement("div",{title:r.isBypassed?"Plugin is bypassed":"Plugin is active",className:[ae.a.actionIcon,ae.a.toggle,r.isBypassed?ae.a.off:ae.a.on].join(" "),onClick:()=>{l(t,d=>Le(Be({},d),{plugins:d.plugins.map((g,h)=>h===n?Le(Be({},g),{isBypassed:!g.isBypassed}):g)}))}},e.a.createElement(Cl.a,null)),e.a.createElement("div",{title:"Move up",className:[ae.a.actionIcon,u?ae.a.disabled:""].join(" "),onClick:()=>{l(t,d=>{if(n===0)return d;const g=[...d.plugins];return g[n-1]=d.plugins[n],g[n]=d.plugins[n-1],Le(Be({},d),{plugins:g})})}},e.a.createElement(Pl.a,null)),e.a.createElement("div",{title:"Move down",className:[ae.a.actionIcon,c?ae.a.disabled:""].join(" "),onClick:()=>{l(t,d=>{if(n===d.plugins.length-1)return d;const g=[...d.plugins];return g[n+1]=d.plugins[n],g[n]=d.plugins[n+1],Le(Be({},d),{plugins:g})})}},e.a.createElement(Ol.a,null)),e.a.createElement(Xl,{eventKey:a,disabled:!Object.keys(r.pluginParams).length}),e.a.createElement(Ne.a,null,e.a.createElement(Ne.a.Toggle,{as:ql}),e.a.createElement(Ne.a.Menu,null,e.a.createElement(Ne.a.Item,{onClick:()=>{l(t,d=>Le(Be({},d),{plugins:d.plugins.filter((g,h)=>h!==n)}))}},"Remove")))),(p==="broken"||p==="failed-previously")&&e.a.createElement("div",{title:"There was a problem running the plugin",className:ae.a.errorIcon},e.a.createElement(Al.a,null)),p==="missing"&&e.a.createElement("div",{title:"Plugin not found",className:ae.a.errorIcon,onClick:m},e.a.createElement(Nl.a,null))),e.a.createElement(Re.a.Collapse,{eventKey:a},e.a.createElement(Sa.a.Body,{className:ae.a.paramsList},Object.keys(s||r.pluginParams).map(d=>{const g=s&&s[d]||null;let h=r.pluginParams[d];return g&&typeof h!="number"&&(h=g.value),e.a.createElement(Jl,{key:d,sampleId:t,pluginIndex:n,isOff:!f,paramName:d,paramValue:h,paramDef:g,onSampleUpdate:l})}))))}var to=e.a.memo(function({sampleId:t,sampleCache:n,plugins:r,pluginParamsDefs:o,pluginStatusMap:s,onSampleUpdate:u,onOpenPluginManager:c,onRecheckPlugins:l,onRegenerateSampleCache:m}){const f=Object(i.useMemo)(()=>r.map((b,k)=>{const I=s.get(b.pluginName);return I!=="installed"?I||"ok":!b.isBypassed&&n&&n.cachedInfo.failedPluginIndex===k?"failed-previously":"ok"}),[r,s,n]),p=f.filter((b,k)=>!r[k].isBypassed).every(b=>b==="ok"),d={};let g=0,h=0;for(const b of r)d[b.pluginName]=0,b.isBypassed?h++:g++;const[E,y]=Object(i.useState)(()=>window.matchMedia("(min-width: 768px)").matches);return e.a.createElement(oe.a.Group,{className:[ae.a.pluginsControlWrapper,E?ae.a.expanded:""].join(" ")},e.a.createElement(Ie.a,{delay:{show:400,hide:0},overlay:e.a.createElement(Ae.a,null,"Plugins let you add custom pre-processing to your samples.")},e.a.createElement(oe.a.Label,{className:ae.a.label,onClick:()=>y(b=>!b),"aria-controls":"expand-plugins","aria-expanded":E},"Plugins",p&&e.a.createElement("span",{className:ae.a.previewValue},"\xA0",g," active, ",h," bypassed"),!p&&e.a.createElement("span",{className:ae.a.reloadPlugins,onClick:b=>Zl(this,null,function*(){b.stopPropagation(),yield Promise.allSettled(r.filter(k=>s.get(k.pluginName)==="broken").map(k=>Wn(k.pluginName))),l(),m(t)})},e.a.createElement(jn.a,null),e.a.createElement("span",null,"Reload")))),e.a.createElement(_a.a,{in:E},e.a.createElement("div",{id:"expand-plugins"},e.a.createElement("div",{className:ae.a.pluginsControl},e.a.createElement(Re.a,{hidden:!r.length,className:ae.a.pluginList},r.map((b,k)=>{const I=`${b.pluginName}-${d[b.pluginName]++}`;return e.a.createElement(eo,{key:I,eventKey:I,sampleId:t,pluginIndex:k,plugin:b,status:f[k],paramsDef:o.get(b.pluginName)||null,isFirst:k===0,isLast:k===r.length-1,onSampleUpdate:u,onOpenPluginManager:c})})),e.a.createElement("div",{className:ae.a.pluginOptions},e.a.createElement(La.a,{variant:"outline-secondary",title:e.a.createElement("span",{className:ae.a.addAPlugin},e.a.createElement(Oa,null),e.a.createElement("span",null,"Add a plugin"))},!o.size&&e.a.createElement(Ne.a.Item,{disabled:!0},"No plugins installed"),[...o].map(([b,k])=>e.a.createElement(Ne.a.Item,{key:b,onClick:()=>{u(t,I=>Le(Be({},I),{plugins:[...I.plugins,{pluginName:b,pluginParams:Dr(k),isBypassed:!1}]}))}},b))),e.a.createElement(V.a,{className:ae.a.managePlugins,variant:"outline-secondary",onClick:c},e.a.createElement(Il.a,null),e.a.createElement("span",null,"Plugins overview")))))))}),ao=v(37),Ye=v.n(ao),no=e.a.memo(function({sampleId:t,qualityBitDepth:n,onSampleUpdate:r}){const[o,s]=Object(i.useState)(n);Object(i.useEffect)(()=>{s(n)},[n]);const u=Object(i.useCallback)(f=>{const p=Number(f.target.value);s(p)},[]),c=Object(i.useRef)(null);Object(i.useEffect)(()=>{const f=c.current;if(f){const p=()=>{const d=Number(f.value);r(t,{qualityBitDepth:d})};return f.addEventListener("change",p),()=>{f.removeEventListener("change",p)}}},[t,r]);const[l,m]=Object(i.useState)(()=>window.matchMedia("(min-width: 768px)").matches);return e.a.createElement(oe.a.Group,{className:[Ye.a.qualityBitDepthWrapper,l?Ye.a.expanded:""].join(" ")},e.a.createElement(Ie.a,{delay:{show:400,hide:0},overlay:e.a.createElement(Ae.a,null,"Lowering quality reduces transfer time. It will ",e.a.createElement("i",null,"not")," reduce the memory footprint.")},e.a.createElement(oe.a.Label,{className:Ye.a.label,onClick:()=>m(f=>!f),"aria-controls":"expand-quality-bit-depth","aria-expanded":l},"Quality bit depth",e.a.createElement("span",{className:Ye.a.previewValue},"\xA0",n))),e.a.createElement(_a.a,{in:l},e.a.createElement("div",{id:"expand-quality-bit-depth"},e.a.createElement("div",{className:Ye.a.ticks},[8,9,10,11,12,13,14,15,16].map((f,p,{length:d})=>{const g=`calc(${p*100/(d-1)}% + ${12-3*p}px)`,h=o===f;return e.a.createElement(e.a.Fragment,{key:f},e.a.createElement("label",{className:["small",Ye.a.tickLabel].join(" "),style:{left:g,visibility:h?"hidden":void 0},onClick:()=>r(t,{qualityBitDepth:f})},f),e.a.createElement("span",{className:Ye.a.tickMark,style:{left:g,visibility:h?"hidden":void 0}}))})),e.a.createElement(Ca.a,{value:o,step:1,min:8,max:16,size:"lg",tooltip:"on",tooltipPlacement:"top",tooltipStyle:{zIndex:1020},onChange:u,ref:c}),e.a.createElement("div",{className:Ye.a.annotations},e.a.createElement("label",{className:"small"},"Faster transfer"),e.a.createElement("label",{className:"small"},"Higher quality")))))}),ro=v(32),We=v.n(ro),lo=e.a.memo(function({sampleId:t,pitchAdjustment:n,onSampleUpdate:r}){const[o,s]=Object(i.useState)(n);Object(i.useEffect)(()=>{s(n)},[n]);const u=Object(i.useCallback)(f=>{s(Number(f.target.value))},[]),c=Object(i.useRef)(null);Object(i.useEffect)(()=>{const f=c.current;if(f){const p=()=>{r(t,{pitchAdjustment:Number(f.value)})};return f.addEventListener("change",p),()=>{f.removeEventListener("change",p)}}},[t,r]);const[l,m]=Object(i.useState)(()=>window.matchMedia("(min-width: 768px)").matches);return e.a.createElement(oe.a.Group,{className:[We.a.pitchAdjustmentWrapper,l?We.a.expanded:""].join(" ")},e.a.createElement(Ie.a,{delay:{show:400,hide:0},overlay:e.a.createElement(Ae.a,null,"Pitching your audio up before transferring can save some space on your volca sample. You can pitch back down on the volca sample, but your sample rate will be reduced.")},e.a.createElement(oe.a.Label,{className:We.a.label,onClick:()=>m(f=>!f),"aria-controls":"expand-sample-pitch","aria-expanded":l},"Adjust sample pitch\xA0",e.a.createElement("span",{className:We.a.previewValue},Number(n.toFixed(2)),"x"))),e.a.createElement(_a.a,{in:l},e.a.createElement("div",{id:"expand-sample-pitch"},e.a.createElement("div",{className:We.a.ticks},[.5,1,1.5,2].map((f,p,{length:d})=>{const g=`calc(${p*100/(d-1)}% + ${12-8*p}px)`,h=o===f;return e.a.createElement(e.a.Fragment,{key:f},e.a.createElement("label",{className:["small",We.a.tickLabel].join(" "),style:{left:g,visibility:h?"hidden":void 0},onClick:()=>r(t,{pitchAdjustment:f})},f,"x"),e.a.createElement("span",{className:We.a.tickMark,style:{left:g,visibility:h?"hidden":void 0}}))})),e.a.createElement(Ca.a,{value:o,min:.5,max:2,step:.01,size:"lg",tooltip:"on",tooltipLabel:f=>`${Number(f.toFixed(2))}x`,tooltipPlacement:"top",tooltipStyle:{zIndex:1020},onChange:u,ref:c}),e.a.createElement("div",{className:We.a.annotations},e.a.createElement("label",{className:["small",o<1?We.a.warn:""].join(" ")},"Larger footprint"),e.a.createElement("label",{className:"small"},"Smaller footprint")))))}),oo=v(48),ft=v.n(oo),io=(a,t,n)=>new Promise((r,o)=>{var s=l=>{try{c(n.next(l))}catch(m){o(m)}},u=l=>{try{c(n.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,u);c((n=n.apply(a,t)).next())});const so=e.a.memo(function({sample:t,sampleCache:n,pluginParamsDefs:r,pluginStatusMap:o,editCacheInvalidator:s,onSampleUpdate:u,onSampleDuplicate:c,onSampleDelete:l,onOpenPluginManager:m,onRecheckPlugins:f,onRegenerateSampleCache:p}){const d=Object(i.useCallback)(h=>{u(t.id,({slotNumber:E})=>({slotNumber:typeof h=="function"?h(E):h}))},[t.id,u]),g=Object(i.useMemo)(()=>n?new Map().set(n.sampleContainer.id,n):new Map,[n]);return e.a.createElement(yt.a,{fluid:"sm"},e.a.createElement("h2",{className:ft.a.sampleName},e.a.createElement(Ie.a,{delay:{show:400,hide:0},placement:"top-start",overlay:e.a.createElement(Ae.a,null,t.metadata.name)},e.a.createElement("span",null,t.metadata.name)),e.a.createElement(co,{sampleId:t.id,name:t.metadata.name,sourceFileId:t.metadata.sourceFileId,userFileInfo:t.metadata.userFileInfo,onSampleUpdate:u,onSampleDuplicate:c,onSampleDelete:l})),e.a.createElement("p",null,e.a.createElement("strong",null,"Sampled:")," ",qt(new Date(t.metadata.dateSampled)),e.a.createElement("br",null),e.a.createElement("strong",null,"Updated:")," ",qt(new Date(t.metadata.dateModified))),e.a.createElement("h4",null,"Configure"),localStorage.getItem("enablePlugins")&&e.a.createElement(to,{sampleId:t.id,sampleCache:n,plugins:t.metadata.plugins,pluginParamsDefs:r,pluginStatusMap:o,onSampleUpdate:u,onOpenPluginManager:m,onRecheckPlugins:f,onRegenerateSampleCache:p}),e.a.createElement(no,{sampleId:t.id,qualityBitDepth:t.metadata.qualityBitDepth,onSampleUpdate:u}),e.a.createElement(lo,{sampleId:t.id,pitchAdjustment:t.metadata.pitchAdjustment,onSampleUpdate:u}),e.a.createElement(cl,{sample:t,sampleCache:n,editCacheInvalidator:s,onSampleUpdate:u}),e.a.createElement("h4",null,"Transfer"),e.a.createElement(wa,{samples:t,sampleCaches:g,onSlotNumberUpdate:d}))}),co=e.a.memo(({sampleId:a,name:t,sourceFileId:n,userFileInfo:r,onSampleUpdate:o,onSampleDuplicate:s,onSampleDelete:u})=>{const[c,l]=Object(i.useState)(!1),m=Object(i.useRef)(null),[f,p]=Object(i.useState)(t),[d,g]=Object(i.useState)(!1);Object(i.useEffect)(()=>{d&&(p(t),m.current&&m.current.select())},[d,t]);const h=f.trim(),E=Object(i.useCallback)(I=>{I.preventDefault(),h&&(o(a,{name:h}),g(!1))},[h,a,o]),y=Object(i.useCallback)(()=>s(a),[a,s]),b=Object(i.useCallback)(()=>io(void 0,null,function*(){const I=yield ie.getSourceFileData(n),R=new Blob([I],{type:r?r.type:"audio/x-wav"});Lt(R,`${t}${r?r.ext:".wav"}`)}),[t,n,r]),k=Object(i.useCallback)(I=>{I.preventDefault(),u(a),l(!1)},[a,u]);return e.a.createElement(e.a.Fragment,null,e.a.createElement(La.a,{className:ft.a.optionsButton,variant:"secondary",align:"end",title:"Actions"},e.a.createElement(Ne.a.Item,{onClick:()=>g(!0)},"Rename"),e.a.createElement(Ne.a.Item,{onClick:y},"Duplicate"),e.a.createElement(Ne.a.Item,{onClick:b},"Download source audio"),e.a.createElement(Ne.a.Divider,null),e.a.createElement(Ne.a.Item,{onClick:()=>l(!0)},"Delete")),e.a.createElement("div",{className:ft.a.actionButtons},e.a.createElement(V.a,{type:"button",variant:"outline-secondary",onClick:()=>g(!0)},"Rename"),e.a.createElement(V.a,{type:"button",variant:"outline-secondary",onClick:y},"Duplicate"),e.a.createElement(V.a,{type:"button",variant:"outline-secondary",onClick:b},"Download source audio"),e.a.createElement(V.a,{type:"button",variant:"outline-primary",onClick:()=>l(!0)},"Delete")),e.a.createElement(A.a,{onHide:()=>g(!1),show:d,"aria-labelledby":"rename-modal"},e.a.createElement(oe.a,{onSubmit:E},e.a.createElement(A.a.Header,null,e.a.createElement(A.a.Title,{id:"rename-modal"},"Renaming sample")),e.a.createElement(A.a.Body,null,e.a.createElement("p",null,"Choose a new name for the sample ",e.a.createElement("strong",null,t),":"),e.a.createElement(oe.a.Control,{ref:m,defaultValue:t,onChange:I=>p(I.target.value)})),e.a.createElement(A.a.Footer,null,e.a.createElement(V.a,{type:"button",variant:"light",onClick:()=>g(!1)},"Cancel"),e.a.createElement(V.a,{type:"submit",variant:"primary",disabled:!h},"Rename")))),e.a.createElement(A.a,{onHide:()=>l(!1),show:c,"aria-labelledby":"delete-modal"},e.a.createElement(oe.a,{onSubmit:k},e.a.createElement(A.a.Header,{className:ft.a.deleteModalHeader},e.a.createElement(Xt.a,null),e.a.createElement(A.a.Title,{id:"delete-modal"},"Deleting sample")),e.a.createElement(A.a.Body,null,e.a.createElement("p",null,"Are you sure you want to delete ",e.a.createElement("strong",null,t),"? This can't be undone.")),e.a.createElement(A.a.Footer,null,e.a.createElement(V.a,{type:"button",variant:"light",onClick:()=>l(!1)},"Cancel"),e.a.createElement(V.a,{type:"submit",variant:"primary"},"Delete")))))});var uo=so,$t=v(216),mo=v(146),fo=v.n(mo);function po({sample:a,sampleCache:t}){const{wavData:n,audioBuffer:r}=ga(t),{sample:{metadata:{name:o,normalize:s,trim:{frames:u}}},pluginProcessedAudioBuffer:c}=za(a),{monoSamples:l,waveformRef:m,peaks:f,onResize:p}=Ua(c),d=Object(i.useMemo)(()=>{if(!c)return 0;const I=Ot(l,u);return at(I)},[c,l,u]),g=1/d,{isPlaybackActive:h,playbackProgress:E,displayedTime:y,togglePlayback:b,stopPlayback:k}=na(r||null,!0);return Object(i.useEffect)(()=>k,[a,k]),e.a.createElement("div",{className:fo.a.waveformContainer},e.a.createElement(Bt,{waveformRef:m,peaks:f,scaleCoefficient:s?g:1,onResize:p}),e.a.createElement(vn,{isPlaybackActive:h,playbackProgress:E,displayedTime:y,downloadFilename:`${o}.volcasample.wav`,wavFile:n||null,togglePlayback:b}))}var ho=po,go=Object.defineProperty,vo=Object.defineProperties,yo=Object.getOwnPropertyDescriptors,Un=Object.getOwnPropertySymbols,Eo=Object.prototype.hasOwnProperty,bo=Object.prototype.propertyIsEnumerable,Gn=(a,t,n)=>t in a?go(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,wo=(a,t)=>{for(var n in t||(t={}))Eo.call(t,n)&&Gn(a,n,t[n]);if(Un)for(var n of Un(t))bo.call(t,n)&&Gn(a,n,t[n]);return a},So=(a,t)=>vo(a,yo(t));function _o(a){const t=a.metadata.slotNumber,[n,r]=Object(i.useState)(t);return Object(i.useEffect)(()=>{r(t)},[t]),{sample:Object(i.useMemo)(()=>a&&new ie(So(wo({id:a.id},a.metadata),{slotNumber:n})),[a,n]),setSlotNumber:r}}function Co({sample:a,sampleCache:t,onSampleDuplicate:n}){const{sample:r,setSlotNumber:o}=_o(a),s=Object(i.useMemo)(()=>t?new Map().set(t.sampleContainer.id,t):new Map,[t]);return e.a.createElement(yt.a,{fluid:"sm"},e.a.createElement("h2",{className:ft.a.sampleName},r.metadata.name),e.a.createElement("p",null,e.a.createElement("strong",null,"Sampled:")," ",qt(new Date(r.metadata.dateSampled))),e.a.createElement($t.a,{variant:"secondary"},e.a.createElement($t.a.Heading,null,"This is a factory sample."),e.a.createElement("p",null,"If you want to trim the audio, adjust quality, change the pitch or use plugins before transferring to the volca sample,"," ",e.a.createElement("span",{className:ft.a.buttonLink},e.a.createElement(V.a,{variant:"link",onClick:()=>n(r.id)},"make a duplicate"),"."))),e.a.createElement("h4",null,"Preview"),e.a.createElement(ho,{sample:r,sampleCache:t}),e.a.createElement("h4",null,"Transfer"),e.a.createElement(wa,{samples:r,sampleCaches:s,onSlotNumberUpdate:o}))}var Po=Co,Oo=v(209),It=v(218),ko=v(78),Yt=v.n(ko),Mo=Object.defineProperty,Io=(a,t,n)=>t in a?Mo(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,Ao=(a,t,n)=>(Io(a,typeof t!="symbol"?t+"":t,n),n);class No{constructor(){Ao(this,"unlockPromise",Promise.resolve())}lock(){let t=()=>{};const n=new Promise(o=>t=o),r=this.unlockPromise.then(()=>t);return this.unlockPromise=n,r}}var pt=(a,t,n)=>new Promise((r,o)=>{var s=l=>{try{c(n.next(l))}catch(m){o(m)}},u=l=>{try{c(n.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,u);c((n=n.apply(a,t)).next())});const Ma="volcasampler",Qn="user samples",Ia="plugins",$n="volcasampler.json";function jo(a,t){return pt(this,null,function*(){const n=a.filter(p=>p instanceof ie.Mutable?!0:(console.warn("Not exporting un-editable factory sample",p.id),!1)),r=new Yt.a,o=r.folder(Ma);if(!o)throw new Error("Failed to create root folder");const s=o.folder(Qn);if(!s)throw new Error("Failed to create samples folder");const u=o.folder(Ia);if(!u)throw new Error("Failed to create plugins folder");const c=n.reduce((p,d)=>(p[d.id]=d.metadata,p),{});o.file($n,JSON.stringify({samples:c},null,2),{binary:!1});const l=new Set,m=new Set;for(const p of n){const{sourceFileId:d,userFileInfo:g,name:h,plugins:E}=p.metadata;if(!l.has(d)){if(l.add(d),d.includes("."))continue;const y=`${h} - ${d}${g?g.ext:".wav"}`;s.file(y,ie.getSourceFileData(d,!0).then(b=>new Blob([b],{type:g?g.type:"audio/x-wav"})))}for(const{pluginName:y}of E)if(!m.has(y)){m.add(y);const b=yield ka(y);b&&u.file(y,new Blob([b],{type:"text/javascript"}))}}m.size||o.remove(Ia);const f=r.generateInternalStream({type:"blob",compression:"DEFLATE",compressionOptions:{level:9},streamFiles:!0});return f.on("data",(p,{percent:d})=>t(d/100)),f.accumulate()})}function Yn(a){return pt(this,null,function*(){const n=(a instanceof Yt.a?a:yield Yt.a.loadAsync(a)).folder(Ma);if(!n)throw new Error("Failed to access root folder");const r=n.file($n);if(!r)throw new Error("Missing expected volcasampler.json file");const{samples:o}=JSON.parse(yield r.async("text"));return o})}function Ro(a){return pt(this,arguments,function*({zipFile:t,idsToImport:n,onProgress:r,onConfirmPluginName:o,onConfirmPluginReplace:s}){const u=yield Yt.a.loadAsync(t),c=yield Yn(u),l=u.folder(Ma);if(!l)throw new Error("Failed to create root folder");const m=l.folder(Qn);if(!m)throw new Error("Failed to create samples folder");const f=l.folder(Ia);if(!f)throw new Error("Failed to create plugins folder");const p=new Map,d=new Map,g={},h=[],E=[],y=[],b=Array(n.length).fill(0),k=()=>r(b.reduce((R,z)=>R+z,0)/b.length),I=new No;return yield Promise.all(Object.entries(c).map((R,z)=>pt(this,[R,z],function*([U,Q],H){if(!!n.includes(U))try{const{sourceFileId:T,plugins:j=[]}=Q;p.has(T)||p.set(T,(()=>pt(this,null,function*(){if(!T.includes(".")&&!(yield $a(T))){const[P]=m.file(new RegExp(`${T}\\.\\w+$`));if(!P)throw new Error("Cannot find source file");const B=yield P.async("uint8array",({percent:x,currentFile:Z})=>{b[H]=x/100,k()});yield Ya(B,T)}}))());for(const{pluginName:_}of j)d.has(_)||d.set(_,(()=>pt(this,null,function*(){const P=f.file(_);if(!P)throw new Error("Cannot find plugin file");const B=yield P.async("string"),x=yield I.lock();try{(yield Ut({pluginName:_,pluginSource:B,onConfirmName:o,onConfirmReplace:s}))==="replaced"&&y.push(_),x()}catch(Z){throw x(),Z}}))());yield p.get(T),yield Promise.all(j.map(({pluginName:_})=>d.get(_)));const w=yield ie.importToStorage(U,Q);h.push(w);const S=yield ge.importToStorage(w);E.push(S)}catch(T){b[H]=1,g[U]={metadata:Q,error:T},k()}}))),r(1),{sampleContainers:h.slice().sort(st),sampleCaches:E,replacedPluginNames:y,failedImports:g}})}var To=v(147),Do=v.n(To),Aa=v(217),xo=v(136),Fo=v(122),Kn=v.n(Fo),Zn=e.a.memo(function({pluginName:t,variant:n,onConfirmName:r,onConfirmReplace:o,onCancelRename:s}){const[u,c]=Object(i.useState)(t.replace(/\.js$/,"").toLowerCase());return Object(i.useEffect)(()=>{c(t.replace(/\.js$/,"").toLowerCase())},[t]),e.a.createElement(A.a,{className:Kn.a.pluginConfirmModal,"aria-labelledby":"plugin-confirm-modal",show:!0,centered:!0,onHide:s},e.a.createElement(A.a.Header,null,e.a.createElement(A.a.Title,{id:"plugin-confirm-modal"},n==="confirm-name"&&"Confirm name of new plugin",n==="replace"&&"A plugin with this name exists",n==="rename"&&"Rename plugin")),e.a.createElement(A.a.Body,null,(n==="confirm-name"||n==="rename")&&e.a.createElement(Aa.a,null,e.a.createElement(xo.a,{defaultValue:u,onChange:l=>{c(l.target.value=l.target.value.toLowerCase())},placeholder:"Plugin name","aria-label":"Plugin name","aria-describedby":".js",autoFocus:!0}),e.a.createElement(Aa.a.Text,{id:".js"},".js")),n==="replace"&&e.a.createElement("p",null,"Do you want to replace the existing ",e.a.createElement("strong",null,t),"?")),e.a.createElement(A.a.Footer,{className:Kn.a.footer},n==="confirm-name"&&e.a.createElement(V.a,{type:"button",variant:"primary",disabled:!u,onClick:()=>{u&&r(`${u}.js`)}},"OK"),n==="replace"&&e.a.createElement(e.a.Fragment,null,e.a.createElement(V.a,{type:"button",variant:"light",onClick:()=>o("change-name")},"Choose new name"),e.a.createElement(V.a,{type:"button",variant:"light",onClick:()=>o("use-existing")},"Use existing"),e.a.createElement(V.a,{type:"button",variant:"primary",onClick:()=>o("replace")},"Replace")),n==="rename"&&e.a.createElement(e.a.Fragment,null,e.a.createElement(V.a,{type:"button",variant:"light",onClick:()=>s()},"Cancel"),e.a.createElement(V.a,{type:"button",variant:"primary",disabled:!u||t.replace(/\.js$/,"")===u,onClick:()=>{r(`${u}.js`)}},"Rename"))))}),Bo=Object.defineProperty,Jn=Object.getOwnPropertySymbols,Lo=Object.prototype.hasOwnProperty,Wo=Object.prototype.propertyIsEnumerable,Xn=(a,t,n)=>t in a?Bo(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,Ho=(a,t)=>{for(var n in t||(t={}))Lo.call(t,n)&&Xn(a,n,t[n]);if(Jn)for(var n of Jn(t))Wo.call(t,n)&&Xn(a,n,t[n]);return a},qn=(a,t,n)=>new Promise((r,o)=>{var s=l=>{try{c(n.next(l))}catch(m){o(m)}},u=l=>{try{c(n.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,u);c((n=n.apply(a,t)).next())}),Vo=e.a.memo(function({userSamples:t,onUpdatePluginList:n,onRegenerateSampleCache:r,onImport:o}){const s=Object(i.useRef)(null),u=Object(i.useRef)(null),[c,l]=Object(i.useState)(null),[m,f]=Object(i.useState)(null),{unknownSamples:p,knownSamplesNew:d,knownSamplesOld:g}=Object(i.useMemo)(()=>{const w=new Map,S=new Map,_=new Map;for(const[P,B]of Object.entries(m||{})){const x=t.get(P);x?x.metadata.dateModified>B.dateModified?_.set(P,B):S.set(P,B):w.set(P,B)}return{unknownSamples:w,knownSamplesNew:S,knownSamplesOld:_}},[t,m]),[h,E]=Object(i.useState)(new Set);Object(i.useEffect)(()=>{E(new Set([...p.keys(),...d.keys()]))},[p,d]);const[y,b]=Object(i.useState)(0),[k,I]=Object(i.useState)(null),[R,z]=Object(i.useState)(null),U=c===null;Object(i.useEffect)(()=>{U&&(f(null),I(null),z(null),u.current=null,s.current&&(s.current.value=""))},[U]);const[Q,H]=Object(i.useState)(null),T=Object(i.useRef)(t);T.current=t;const j=Object(i.useCallback)(w=>{const S=[...T.current.values()].filter(_=>_.metadata.plugins.some(P=>P.pluginName===w));for(const{id:_}of S)r(_)},[r]);{const w=c==="import",S=Object(i.useRef)(h);S.current=h,Object(i.useEffect)(()=>{if(!u.current||!w)return;let _=!1;return Ro({zipFile:u.current,idsToImport:[...S.current],onProgress(P){_||b(P)},onConfirmPluginName(P){return new Promise(B=>{H({pluginName:P,variant:"confirm-name",onConfirmName(x){B(x),H(null)},onConfirmReplace(){},onCancelRename(){}})})},onConfirmPluginReplace(P){return new Promise(B=>{H({pluginName:P,variant:"replace",onConfirmReplace(x){B(x),H(null)},onConfirmName(){},onCancelRename(){}})})}}).then(P=>qn(this,[P],function*({sampleContainers:B,sampleCaches:x,replacedPluginNames:Z,failedImports:re}){n();for(const le of Z)j(le);o(B,x),I(re),l("report")})).catch(P=>{console.error(P),z(P),l("unexpected-error")}),()=>{_=!0}},[w,o,n,j])}return e.a.createElement(e.a.Fragment,null,e.a.createElement(V.a,{type:"button",variant:"outline-secondary",onClick:w=>{const S=w.currentTarget.querySelector("input");S&&w.target!==S&&S.click()}},"Load from Volca Sampler backup",e.a.createElement("input",{hidden:!0,type:"file",accept:"*.zip",ref:s,onChange:w=>qn(this,null,function*(){const S=w.target.files&&w.target.files[0];if(!!S){u.current=S;try{const _=yield Yn(S);f(_),l("confirm")}catch(_){console.error(_),l("error-parsing")}}})})),e.a.createElement(A.a,{className:Do.a.importModal,onHide:c==="import"?void 0:()=>l(null),show:Boolean(c),"aria-labelledby":"import-modal"},e.a.createElement(A.a.Header,null,e.a.createElement(A.a.Title,{id:"import-modal"},c==="error-parsing"?"Error parsing zip archive":c==="confirm"?"Import samples to Volca Sampler":c==="import"?"Importing samples":c==="unexpected-error"?"Unexpected error while importing":c==="report"?"Sample import finished":null)),e.a.createElement(A.a.Body,null,c==="error-parsing"?e.a.createElement("p",null,"Please make sure you attached the correct file."):c==="confirm"?e.a.createElement(e.a.Fragment,null,e.a.createElement("p",null,"Please confirm the list of samples you wish to import."),g.size?e.a.createElement(e.a.Fragment,null,e.a.createElement("h5",null,"More recent versions exist (",[...h].filter(w=>g.has(w)).length," ","/ ",g.size,")"),e.a.createElement(Vt,{samples:g,selectedSampleIds:h,setSelectedSampleIds:E})):null,d.size?e.a.createElement(e.a.Fragment,null,e.a.createElement("h5",null,"Older versions exist (",[...h].filter(w=>d.has(w)).length," ","/ ",d.size,")"),e.a.createElement(Vt,{samples:d,selectedSampleIds:h,setSelectedSampleIds:E})):null,p.size?e.a.createElement(e.a.Fragment,null,e.a.createElement("h5",null,"New samples (",[...h].filter(w=>p.has(w)).length," ","/ ",p.size,")"),e.a.createElement(Vt,{samples:p,selectedSampleIds:h,setSelectedSampleIds:E})):null):c==="import"?e.a.createElement(Ht.a,{striped:!0,animated:!0,variant:"primary",now:100*y}):c==="unexpected-error"?e.a.createElement(e.a.Fragment,null,e.a.createElement("p",null,"An error occured. Please make sure the zip contains all the correct audio files."),R&&e.a.createElement("pre",null,R.message," ",JSON.stringify(R,null,1))):c==="report"?(()=>{const w=k&&Object.entries(k);return w&&w.length?e.a.createElement(e.a.Fragment,null,e.a.createElement("p",null,e.a.createElement("strong",null,w.length," /"," ",h.size," samples")," ","failed to import:"),w.map(([S,{metadata:_,error:P}])=>e.a.createElement("details",{key:S},e.a.createElement("summary",null,_.name),e.a.createElement("pre",null,P.message," ",JSON.stringify(P,null,1))))):e.a.createElement("p",null,"Your samples were imported successfully.")})():null),e.a.createElement(A.a.Footer,null,c==="confirm"&&e.a.createElement(e.a.Fragment,null,e.a.createElement(V.a,{type:"button",variant:"light",onClick:()=>l(null)},"Cancel"),e.a.createElement(V.a,{type:"button",variant:"primary",disabled:!h.size,onClick:()=>{b(0),l("import")}},"Import now")),c==="import"&&e.a.createElement(V.a,{type:"button",variant:"primary",onClick:()=>l(null)},"Cancel"),(c==="report"||c==="error-parsing"||c==="unexpected-error")&&e.a.createElement(V.a,{type:"button",variant:"primary",onClick:()=>l(null)},"OK"))),Q&&e.a.createElement(Zn,Ho({},Q)))}),At=(a,t,n)=>new Promise((r,o)=>{var s=l=>{try{c(n.next(l))}catch(m){o(m)}},u=l=>{try{c(n.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,u);c((n=n.apply(a,t)).next())});let er;function Na(){const a=rn();return er=er||new a(navigator.mediaDevices.getSupportedConstraints().sampleRate?{sampleRate:je}:{})}function zo(){return At(this,null,function*(){{const r=yield navigator.mediaDevices.getUserMedia({audio:!0,video:!1});for(const o of r.getTracks())o.stop()}const t=(yield navigator.mediaDevices.enumerateDevices()).filter(r=>r.kind==="audioinput"),n=[];for(const r of t){const o=yield navigator.mediaDevices.getUserMedia({audio:{deviceId:r.deviceId,channelCount:2},video:!1}),s=(yield navigator.mediaDevices.enumerateDevices()).find(({deviceId:c})=>r.deviceId===c).label;let u=1;{const c=o.getAudioTracks()[0],l=c.getSettings().channelCount;l?u=l:c.getCapabilities&&(u=(c.getCapabilities().channelCount||{}).max||u)}for(const c of o.getTracks())c.stop();n.push({device:{deviceId:r.deviceId,label:s},channelsAvailable:u})}return n})}let ja;function Uo(a){return At(this,arguments,function*({onData:t,onFinish:n}){const r=Na();ja=ja||r.audioWorklet.addModule("recorderWorkletProcessor.js"),yield ja;const o=new AudioWorkletNode(r,"recorder-worklet",{parameterData:{bufferSize:1024}});o.port.onmessage=u=>{if(u.data.eventType==="data"){const c=u.data.audioChannels;t(c)}u.data.eventType==="stop"&&n()};const s=o.parameters.get("isRecording");return s.setValueAtTime(1,r.currentTime),{recorderNode:o,stop(){s.setValueAtTime(0,r.currentTime)}}})}function Go({channelCount:a,onData:t,onFinish:n}){const o=Na().createScriptProcessor(1024,a,a);let s=!1;return o.onaudioprocess=u=>{const c=Array(a).fill().map((l,m)=>u.inputBuffer.getChannelData(m));t(c),s&&n()},{recorderNode:o,stop(){s=!0}}}function Qo(a){return At(this,null,function*(){return typeof AudioWorkletNode=="undefined"?Go(a):yield Uo(a)})}function $o(a){return At(this,arguments,function*({deviceId:t,channelCount:n,onStart:r,onUpdate:o}){const s=yield navigator.mediaDevices.getUserMedia({audio:{deviceId:t,channelCount:n,sampleRate:je,echoCancellation:!1,autoGainControl:!1,noiseSuppression:!1},video:!1}),u=Na(),c=u.createMediaStreamSource(s),{recorderNode:l,stop:m}=yield Qo({channelCount:n,onData:h,onFinish:I});c.connect(l),l.connect(u.destination);const f=65;r(u.sampleRate,f);const p=f*u.sampleRate;let d=0;const g=Array(n).fill([]);function h(R){let z=0;const U=[];for(let T=0;T<n;T++){const j=R[T],w=j.length,S=j.slice(0,Math.min(w,p-d));an(S),z||(z=S.length),U.push(S)}const Q=Br(U),H=nn(Q);g.push(H),d+=z,d>=p&&m(),o(U)}let E,y;const b=new Promise((R,z)=>{E=R,y=z});let k=!1;function I(){return At(this,null,function*(){if(k)return;try{const U=yield new Blob(g).arrayBuffer(),Q=new Float32Array(U),H=Wa()({channels:n,sampleRate:u.sampleRate,bitDepth:16,dataLength:Q.byteLength}),T=new Uint8Array(H.length+Q.byteLength);T.set(H),T.set(new Uint8Array(Q.buffer),H.length),E(T)}catch(z){y(z)}const R=s.getTracks();for(const z of R)z.stop();l.disconnect(u.destination),c.disconnect(l),k=!0})}return{stop:m,mediaRecording:b}})}var Yo=v(21),Me=v.n(Yo),Nt=(a,t,n)=>new Promise((r,o)=>{var s=l=>{try{c(n.next(l))}catch(m){o(m)}},u=l=>{try{c(n.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,u);c((n=n.apply(a,t)).next())});const tr="capture_device_preference";let ar=null;function Ko(a,t){const n=Object(i.useRef)(JSON.parse(localStorage.getItem(tr)||"null")),[r]=Object(i.useState)(n.current),[o,s]=Object(i.useState)(ar),[u,c]=Object(i.useState)(o?"ok":"pending"),[l,m]=Object(i.useState)(null),f=Object(i.useMemo)(()=>l?l.device.deviceId:"",[l]);Object(i.useEffect)(()=>{ar=o,c("ok")},[o]);const p=Object(i.useCallback)(()=>{let _=!1;return zo().then(P=>{_||P.length&&(s(new Map(P.map(B=>[B.device.deviceId,B]))),m(B=>{if(B)return n.current=null,B;if(n.current){const x=P.find(({device:Z})=>n.current.deviceId===Z.deviceId);if(x)return x}return n.current=null,P[0]}))}).catch(P=>{if(!_){if(P instanceof DOMException){if(P.name==="NotAllowedError"){c("denied");return}if(P.name==="NotFoundError"){c("unavailable");return}}throw P}}),()=>{_=!0}},[]),[d,g]=Object(i.useState)(1);Object(i.useEffect)(()=>{const _=o&&o.get(f);_&&(n.current&&n.current.deviceId===_.device.deviceId&&n.current.channelCount<=_.channelsAvailable?g(n.current.channelCount):g(_.channelsAvailable),n.current=null)},[o,f]),Object(i.useEffect)(()=>{l&&localStorage.setItem(tr,JSON.stringify({deviceId:l.device.deviceId,channelCount:d,label:l.device.label}))},[l,d]);const[h,E]=Object(i.useState)("ready"),[y,b]=Object(i.useState)(""),[k,I]=Object(i.useState)(!1);Object(i.useEffect)(()=>{h!=="ready"&&I(!1)},[h]);const R=Object(i.useCallback)(()=>{I(!1)},[]),[z,U]=Object(i.useState)({fn(_){}});Object(i.useEffect)(()=>z.fn,[z]);const[Q,H]=Object(i.useState)(1/0),[T,j]=Object(i.useState)(0),w=Object(i.useCallback)(()=>Nt(this,null,function*(){let _=!1;const P=(le,fe)=>$o({deviceId:le,channelCount:fe,onStart:(Y,O)=>{const $=O*Y;H(Y),j($),E("capturing")},onUpdate:a}),B=n.current,{mediaRecording:x,stop:Z}=yield B?(()=>Nt(this,null,function*(){try{return P(B.deviceId,B.channelCount)}catch(le){if(le instanceof DOMException&&le.name==="NotFoundError")return P(f,d);throw le}}))():P(f,d);U({fn(le){Z(),le&&(_=!0)}});let re;try{re=yield x}catch(le){b(String(le)),E("error");return}if(_)E("ready");else{E("finalizing");const le=yield t(re);_||(E("ready"),le==="silent"&&I(!0))}}),[f,d,a,t]),S=Object(i.useCallback)(_=>{if(_.target.files&&_.target.files.length){const P=_.target.files[0];P.arrayBuffer().then(B=>Nt(this,null,function*(){const x=new Uint8Array(B);let Z;try{Z=yield ut(x)}catch(le){alert("Unsupported audio format detected");return}if(Z.length>65*Z.sampleRate){alert("Please select an audio file no more than 65 seconds long");return}E("finalizing");const re=yield t(x,P);E("ready"),re==="silent"&&I(!0)}))}},[t]);return{captureDevices:o,accessState:u,selectedCaptureDevice:l,selectedChannelCount:d,captureDeviceFromStorage:r,captureState:h,recordingError:y,showSilenceWarning:k,sampleRate:Q,maxSamples:T,refreshCaptureDevices:p,setSelectedCaptureDevice:m,setSelectedChannelCount:g,beginRecording:w,stopRecording:z.fn,importFile:S,dismissSilenceWarning:R}}const Kt=3;function Zo({canvas:a,peaks:t,drawUntil:n,scaleCoefficient:r}){const o="#fff",s=a.getContext("2d");s.imageSmoothingEnabled=!1;const{width:u,height:c}=a;s.clearRect(0,0,u,c),s.fillStyle=o;for(let l=0;l<n&&l<t.length;l++){const m=t[l],f=c*m,p=Math.max(Math.round(r*f),2);s.fillRect(l*Kt,c-p,Kt-1,p)}a.style.left=`min(0px, calc(var(--record-ui-width) - ${n*Kt}px))`}function Jo({userSamples:a,onUpdatePluginList:t,onRegenerateSampleCache:n,onBulkImport:r,onRecordFinish:o}){const s=Object(i.useRef)(null),u=Object(i.useRef)(0),c=Object(i.useRef)(new Float32Array),l=Object(i.useRef)(0),m=Object(i.useRef)([]),f=Object(i.useRef)(1/0),p=Object(i.useRef)(0),[d,g]=Object(i.useState)(0),h=Object(i.useCallback)(Y=>Nt(this,null,function*(){const O=u.current,$=c.current,J=m.current;if(J.push(Y),p.current+=Y[0].length,g(Math.floor(p.current/f.current)),J.reduce((W,[{length:K}])=>W+K,0)>=O){const W=yield Promise.all(Y.map((C,N)=>J.reduce((M,D)=>[...M,D[N]],[])).map(C=>Nt(this,null,function*(){const N=yield new Blob(C).arrayBuffer();return new Float32Array(N)}))),K=W.map(C=>at(new Float32Array(C.buffer,0,O)));$[l.current++]=Math.max(...K),Zo({canvas:s.current,peaks:$,drawUntil:l.current,scaleCoefficient:.3}),m.current=[W.map(C=>C.slice(O))]}}),[]),{captureDevices:E,accessState:y,selectedCaptureDevice:b,selectedChannelCount:k,captureDeviceFromStorage:I,captureState:R,recordingError:z,showSilenceWarning:U,maxSamples:Q,sampleRate:H,refreshCaptureDevices:T,setSelectedCaptureDevice:j,setSelectedChannelCount:w,beginRecording:S,stopRecording:_,importFile:P,dismissSilenceWarning:B}=Ko(h,o);f.current=H,Object(i.useEffect)(()=>{const Y=s.current;Y&&(Y.width=Y.offsetWidth,Y.height=Y.offsetHeight)},[y]),Object(i.useLayoutEffect)(()=>{const Y=s.current;!Y||(R!=="finalizing"&&Y.getContext("2d").clearRect(0,0,Y.width,Y.height),R==="capturing"&&Q&&(u.current=Math.floor(Kt*Q/s.current.width),c.current=new Float32Array(Math.floor(Q/u.current)),l.current=0,m.current=[],f.current=1/0,p.current=0,g(0)))},[Q,R]);const[x,Z]=Object(i.useState)(!1);Object(i.useEffect)(()=>{x&&T()},[x,T]);const re=b?k:I?I.channelCount:k,[le,fe]=Object(i.useState)(!1);return e.a.createElement(yt.a,{fluid:"sm",className:Me.a.container},y==="denied"?e.a.createElement("p",null,"Looks like you didn't grant access to your audio input device. Please give Volca Sampler access, then"," ",e.a.createElement(V.a,{type:"button",variant:"secondary",onClick:T},"try again")):y==="unavailable"?e.a.createElement("p",null,"Volca Sampler couldn't find any audio input devices. Please connect one, then"," ",e.a.createElement(V.a,{type:"button",variant:"secondary",onClick:T},"try again")):e.a.createElement(e.a.Fragment,null,e.a.createElement("h2",null,"Send a new sound to your volca sample!"),U&&e.a.createElement("div",{className:Me.a.alertContainer},e.a.createElement($t.a,{dismissible:!0,variant:"warning",onClose:B},e.a.createElement($t.a.Heading,null,"Your recording was totally silent."),e.a.createElement("p",null,"Check the ",e.a.createElement("strong",null,"Audio input settings")," and your connections, then try again."))),e.a.createElement(V.a,{id:"record-button",className:Me.a.recordButton,type:"button",variant:"primary",size:"lg",onClick:R==="capturing"?()=>_():S,disabled:R==="finalizing"},e.a.createElement("canvas",{ref:s}),e.a.createElement("span",{className:Me.a.mainText},["capturing","finalizing"].includes(R)?"Finished recording":"Start recording"),["capturing","finalizing"].includes(R)&&e.a.createElement("span",{className:Me.a.timeRecorded},"0:",String(d).padStart(2,"0"))),R==="error"&&z&&e.a.createElement("p",null,"Recording error: ",z)||null,["capturing","finalizing"].includes(R)?e.a.createElement(e.a.Fragment,null,e.a.createElement(V.a,{size:"sm",type:"button",variant:"secondary",onClick:()=>_(!0)},"Cancel")):e.a.createElement(e.a.Fragment,null,e.a.createElement(Re.a,{activeKey:x?"audioInput":"nothing"},e.a.createElement(Re.a.Item,{eventKey:"audioInput"},e.a.createElement(Re.a.Header,{className:Me.a.audioInputHeader,onClick:()=>Z(Y=>!Y)},e.a.createElement("div",null,e.a.createElement("span",null,"Audio input settings"),(b||I)&&e.a.createElement(e.a.Fragment,null,e.a.createElement("p",{className:"small"},e.a.createElement("strong",null,"Capture device:")," ",b?b.device.label||b.device.deviceId:I?I.label:""),e.a.createElement("p",{className:"small"},e.a.createElement("strong",null,"Input channels:")," ",re===1?"Mono":"Stereo")))),e.a.createElement(Re.a.Body,null,e.a.createElement(oe.a.Group,null,e.a.createElement(oe.a.Label,null,"Capture device"),e.a.createElement(oe.a.Select,{value:b?b.device.deviceId:I?I.deviceId:"",onChange:Y=>E&&y==="ok"&&j(E.get(Y.target.value)||null)},E&&y==="ok"?[...E].map(([Y,{device:O}])=>e.a.createElement("option",{key:Y,value:Y},O.label||Y)):I?e.a.createElement("option",{value:I.deviceId,disabled:!0},I.label||I.deviceId):e.a.createElement("option",{value:"",disabled:!0},"Loading devices..."))),e.a.createElement(oe.a.Group,null,e.a.createElement(oe.a.Label,null,"Input channels"),e.a.createElement(yn.a,{className:Me.a.channelOptionSelect},[1,2].map(Y=>e.a.createElement(En.a,{id:"channels-toggle",key:Y,className:Me.a.channelOption,type:"radio",variant:"outline-secondary",name:"channels",value:Y,checked:Y===re,disabled:re!==Y&&(b?b.channelsAvailable:1)<Y,onClick:()=>w(Number(Y))},Y===1?"Mono":"Stereo")))),e.a.createElement("p",{className:["small",Me.a.stereoExplanation].join(" ")},"Stereo input is summed to mono.")))),e.a.createElement(V.a,{variant:"link",onClick:()=>fe(!0)},"Want to record your device's audio output?"))),!["capturing","finalizing"].includes(R)&&e.a.createElement(e.a.Fragment,null,e.a.createElement(V.a,{className:Me.a.importFileButton,type:"button",variant:"secondary",onClick:Y=>{const O=Y.currentTarget.querySelector("input");O&&Y.target!==O&&O.click()}},"Import an audio file",e.a.createElement("input",{hidden:!0,type:"file",accept:"audio/*,video/*,.wav,.mp3,.ogg",onChange:P})),e.a.createElement(Vo,{userSamples:a,onUpdatePluginList:t,onRegenerateSampleCache:n,onImport:r})),e.a.createElement(A.a,{show:le,"aria-labelledby":"system-record-modal",onHide:()=>fe(!1)},e.a.createElement(A.a.Header,null,e.a.createElement(A.a.Title,{id:"system-record-modal"},"Recording audio playing on your device")),e.a.createElement(A.a.Body,{onClick:Y=>{Y.target instanceof HTMLImageElement&&window.open(Y.target.src,"_blank","noreferrer")},className:Me.a.systemRecordModalBody},e.a.createElement(Oo.a,{defaultActiveKey:bt,className:Me.a.osTabs},e.a.createElement(It.a,{eventKey:"windows",title:"Windows"},e.a.createElement("p",null,"Windows has a built-in capture device called"," ",e.a.createElement("strong",null,"Stereo Mix")," for recording system audio, but it needs to be enabled."," ",e.a.createElement("a",{href:"https://allthings.how/how-to-enable-missing-stereo-mix-option-in-windows-10/",target:"_blank",rel:"noreferrer"},"Follow this tutorial")," ","to enable it."),e.a.createElement("p",null,"Once the ",e.a.createElement("strong",null,"Stereo Mix")," capture device has been enabled, you can select it from Volca Sampler's"," ",e.a.createElement("strong",null,"Audio input settings"),".")),e.a.createElement(It.a,{eventKey:"mac",title:"Mac"},e.a.createElement("p",null,"The easiest way to capture system audio on macOS is to install a free app called"," ",e.a.createElement("a",{href:"https://github.com/kyleneideck/BackgroundMusic/blob/master/README.md",target:"_blank",rel:"noreferrer"},"Background Music"),". Make sure you download the"," ",e.a.createElement("a",{href:"https://github.com/kyleneideck/BackgroundMusic/releases/tag/v0.4.0",target:"_blank",rel:"noreferrer"},"0.4.0")," ","version, since earlier versions don't work well with Volca Sampler."),e.a.createElement("p",null,"Once Background Music has been installed, you can select the"," ",e.a.createElement("strong",null,"Background Music (Virtual)")," capture device from Volca Sampler's ",e.a.createElement("strong",null,"Audio input settings"),".")),e.a.createElement(It.a,{eventKey:"linux",title:"Linux"},e.a.createElement("p",null,"Assuming you have PulseAudio installed on your Linux system, you can run the following command to create a capture device called"," ",e.a.createElement("strong",null,"System_Output"),":"),e.a.createElement("pre",null,e.a.createElement("code",null,`pactl \\
  load-module module-remap-source \\
  master="$( \\
    pactl list \\
    | grep -A2 '^Source #' \\
    | grep 'Name: .*\\.monitor$' \\
    | awk '{print $NF}' \\
    | tail -n1 \\
  )" \\
  source_name=systemout_monitor \\
  source_properties=device.description=System_Output`)),e.a.createElement("p",null,"Once the ",e.a.createElement("strong",null,"System_Output")," capture device has been created, you can select it from Volca Sampler's"," ",e.a.createElement("strong",null,"Audio input settings"),"."),e.a.createElement("p",null,"Note that the capture device will ",e.a.createElement("i",null,"not")," persist after reboot, so if you want it to always be available, you'll need to add the above command into a bash profile file like"," ",e.a.createElement("code",null,"~/.bashrc"),".")),e.a.createElement(It.a,{eventKey:"ios",title:"iOS"},e.a.createElement("p",null,"You can't record directly into Volca Sampler with iOS. Instead, you can capture a recording to be imported as a file. The instructions below show you how to record a screencapture video with iOS, convert it to the appropriate audio format, and import it."),e.a.createElement("h4",null,"Enable Screen Recording"),e.a.createElement("p",null,"First you'll need to go into ",e.a.createElement("strong",null,"Settings"),", choose"," ",e.a.createElement("strong",null,"Control Panel")," in the left-side menu, and tap the ",e.a.createElement("strong",null,'"+"')," button next to"," ",e.a.createElement("strong",null,"Screen Recording"),", which can be found under the"," ",e.a.createElement("strong",null,"More Controls")," list. If"," ",e.a.createElement("strong",null,"Screen Recording")," is already listed under"," ",e.a.createElement("strong",null,"Included Controls"),", you can skip this step."),e.a.createElement("img",{src:"ios_enable_screen_recording.png",alt:""}),e.a.createElement("h4",null,"Capture recording"),e.a.createElement("p",null,"Next, once you are ready to record, swipe down from the"," ",e.a.createElement("strong",null,"top-right")," and tap the"," ",e.a.createElement("strong",null,"Screen Recording")," button which will now appear in the ",e.a.createElement("strong",null,"Control Panel")," menu."),e.a.createElement("img",{src:"ios_record_start.png",alt:""}),e.a.createElement("p",null,"Once the recording has started, you'll see a small recording status button at the top of the screen. Tap this button when you've finished recording."),e.a.createElement("img",{src:"ios_stop_recording.png",alt:""}),e.a.createElement("p",null,"After finishing recording, tap the notification appearing at the top of the screen, which will take you to the"," ",e.a.createElement("strong",null,"Photos")," app to review your recording."),e.a.createElement("img",{src:"ios_go_to_saved_file.png",alt:""}),e.a.createElement("h4",null,"Trim recording"),e.a.createElement("p",null,"If your recorded video is longer than 65 seconds, you will need to trim it so it will be accepted by Volca Sampler's file import. Tap the ",e.a.createElement("strong",null,"Edit")," button..."),e.a.createElement("img",{src:"ios_edit_video_select.png",alt:""}),e.a.createElement("p",null,"...and adjust as needed, tapping ",e.a.createElement("strong",null,"Done")," to finish."),e.a.createElement("img",{src:"ios_edit_recording.png",alt:""}),e.a.createElement("h4",null,"Convert to WAV"),e.a.createElement("p",null,"You're almost done. Your video is likely saved in"," ",e.a.createElement("strong",null,"AIFF")," format, which is not supported by Volca Sampler. One of the best free iOS apps for converting AIFF video to ",e.a.createElement("strong",null,"WAV")," audio is"," ",e.a.createElement("a",{href:"https://apps.apple.com/ca/app/audio-converter-extract-mp3/id1393886341",target:"_blank",rel:"noreferrer"},"Audio Converter"),`. Don't confuse this with with "The Audio Converter", which requires payment to convert to WAV.`),e.a.createElement("p",null,"After installing and launching ",e.a.createElement("strong",null,"Audio Converter"),", tap the ",e.a.createElement("strong",null,'"+"')," button to the right and select"," ",e.a.createElement("strong",null,"Import videos")," to import your recording from your ",e.a.createElement("strong",null,"Photos")," library."),e.a.createElement("img",{src:"ios_import_video.png",alt:""}),e.a.createElement("p",null,"Tap the imported video and select ",e.a.createElement("strong",null,"Extract Audio"),"."),e.a.createElement("img",{src:"ios_extract_audio_select.png",alt:""}),e.a.createElement("p",null,"The only setting that needs to be configured is the"," ",e.a.createElement("strong",null,"Format"),", which should be ",e.a.createElement("strong",null,"wav"),". When this is selected, tap ",e.a.createElement("strong",null,"Start Conversion"),"."),e.a.createElement("img",{src:"ios_convert_to_wav.png",alt:""}),e.a.createElement("h4",null,"Import to Volca Sampler"),e.a.createElement("p",null,"Once the conversion to WAV has completed, you can choose your file for import in Volca Sampler.")),e.a.createElement(It.a,{eventKey:"android",title:"Android"},e.a.createElement("p",null,"You can't record directly into Volca Sampler with Android. Instead, you can capture a recording to be imported as a file. The instructions below show you how to record a screencapture video with Android, convert it to a trimmed WAV file, and import it."),e.a.createElement("p",null,e.a.createElement("strong",null,"Note:")," Some apps won't allow you to record their audio. Google Chrome and Spotify, for example, block audio capture. The way to find out if an app allows audio capture is to listen to recorded files and see whether the audio is muted."),e.a.createElement("h4",null,"Enable Screen record"),e.a.createElement("p",null,"First you'll need to swipe down from the top of the screen two times to see the list of ",e.a.createElement("strong",null,"Action Tiles")," and tap the ",e.a.createElement("strong",null,"Pencil")," icon shown at the bottom-left of the overlay, which will open the ",e.a.createElement("strong",null,"Edit Tiles")," screen."),e.a.createElement("img",{src:"android_edit_tiles.png",alt:""}),e.a.createElement("p",null,"Grab the ",e.a.createElement("strong",null,"Screen record")," tile and drag it up into the list of active tiles. If ",e.a.createElement("strong",null,"Screen record")," is already active, you can skip this step."),e.a.createElement("img",{src:"android_enable_screen_recording.png",alt:""}),e.a.createElement("h4",null,"Capture recording"),e.a.createElement("p",null,"Tap the back button to return to the screen of"," ",e.a.createElement("strong",null,"Action Tiles"),", which should now include"," ",e.a.createElement("strong",null,"Screen record"),". Tap"," ",e.a.createElement("strong",null,"Screen record"),"."),e.a.createElement("img",{src:"android_selection_screen_recording.png",alt:""}),e.a.createElement("p",null,"Before recording, change the audio source from"," ",e.a.createElement("strong",null,"Microphone")," to ",e.a.createElement("strong",null,"Device audio"),". Tap ",e.a.createElement("strong",null,"Start"),"."),e.a.createElement("img",{src:"android_start_recording.png",alt:""}),e.a.createElement("p",null,"Make sure to wait for the countdown at the top of the screen before starting to play your audio."),e.a.createElement("img",{src:"android_wait_for_recording.png",alt:""}),e.a.createElement("p",null,"To finish recording, swipe down from the top of the screen and tap the recording notification."),e.a.createElement("img",{src:"android_stop_recording.png",alt:""}),e.a.createElement("h4",null,"Trim and convert to WAV"),e.a.createElement("p",null,"You're almost done. Your video is likely saved in"," ",e.a.createElement("strong",null,"MP4")," format, which can be imported directly to Volca Sampler."),e.a.createElement("p",null,"However, if your video is longer than 65 seconds, you will need to trim it, and you might prefer to import the file in"," ",e.a.createElement("strong",null,"WAV")," format. One of the best free Android apps for converting MP4 video to WAV audio, and trimming it at the same time, is"," ",e.a.createElement("a",{href:"https://play.google.com/store/apps/details?id=com.psma.audioextractor",target:"_blank",rel:"noreferrer"},"Audio Extractor"),"."),e.a.createElement("img",{src:"android_extract_audio.png",alt:""}),e.a.createElement("h4",null,"Import to Volca Sampler"),e.a.createElement("p",null,"Once your recording has been trimmed and converted as needed, you can choose your file for import in Volca Sampler.")))),e.a.createElement(A.a.Footer,null,e.a.createElement(V.a,{type:"button",variant:"primary",onClick:()=>fe(!1)},"Close"))))}var Xo=Jo,ht=v(219),qo=e.a.memo(function({isPlaybackActive:t,playbackProgress:n}){return e.a.createElement("div",{className:[Qe.a.playbackOverlay,t?Qe.a.playbackActive:""].join(" "),style:{"--playback-progress":`${100*n}%`}},e.a.createElement("div",{className:Qe.a.playback}))}),ei=v(11),be=v.n(ei);const nr=typeof IntersectionObserver!="undefined",ti=e.a.memo(function({sample:t,sampleCache:n,selected:r,onSampleSelectClick:o}){const s=Object(i.useRef)(null),[u,c]=Object(i.useState)(!nr);Object(i.useLayoutEffect)(()=>{if(!nr)return;const E=s.current;if(!E)throw new Error("Waveform container should be defined");const y=E.getBoundingClientRect();if(y.top+y.height>=0&&y.bottom-y.height<=window.innerHeight){c(!0);return}const b=new IntersectionObserver(([k])=>{k.isIntersecting&&(c(!0),b.unobserve(E))});return b.observe(E),()=>b.disconnect()},[]);const[l,m]=Object(i.useState)(!1),{audioBuffer:f}=ga(n,l),{isPlaybackActive:p,playbackProgress:d,togglePlayback:g}=na(f||null),h=Object(i.useCallback)(E=>{g(E),m(!0)},[g]);return e.a.createElement("div",{className:["list-group-item",be.a.listItem,r?`active ${be.a.active}`:""].join(" "),tabIndex:-1,onClick:E=>{const y=E.currentTarget.querySelector("button");y&&y.contains(E.target)||o(t.id,E)}},e.a.createElement("span",{className:be.a.sampleTitle},e.a.createElement("div",{className:be.a.multiSelector},e.a.createElement("input",{readOnly:!0,type:"radio",checked:r})),e.a.createElement(V.a,{className:be.a.playbackButton,tabIndex:-1,variant:"dark",onClick:E=>{h(E.nativeEvent)}},p?e.a.createElement(hn.a,null):e.a.createElement(pn.a,null)),e.a.createElement("span",{className:be.a.name},t.metadata.name),e.a.createElement("span",{className:be.a.slot},"S.",t.metadata.slotNumber.toString().padStart(3,"0"))),e.a.createElement("div",{className:[be.a.waveformContainer,p?be.a.playbackActive:""].join(" "),style:{"--waveform-width":`${ta}px`},ref:s},u&&n&&e.a.createElement(e.a.Fragment,null,e.a.createElement(Bt,{peaks:n.cachedInfo.waveformPeaks,scaleCoefficient:1}),e.a.createElement(qo,{isPlaybackActive:p,playbackProgress:d}))))});function ai({samples:a,sampleCaches:t,selectedSampleId:n,multipleSelection:r,onSampleSelect:o}){const s=Object(i.useRef)(null),u=Object(i.useRef)(a);u.current=a;const c=Object(i.useCallback)(y=>{const b=u.current.findIndex(U=>U.id===y),k=s.current;if(!k||b===-1)return;const I=k.children[b],R=I.closest(".accordion-collapse");if(!R)return;(R.offsetTop+R.scrollTop>I.offsetTop||R.scrollTop+R.offsetHeight<I.offsetTop-I.offsetHeight)&&I.scrollIntoView({block:"nearest"})},[]);Object(i.useEffect)(()=>{n&&c(n)},[n,c]);const l=Object(i.useRef)(o);l.current=o;const m=Object(i.useRef)(r);m.current=r;const f=Object(i.useRef)(null),p=Object(i.useRef)(null);Object(i.useEffect)(()=>{f.current=null,p.current=null},[a.length]),Object(i.useEffect)(()=>{f.current&&(!r||!r.has(f.current))&&(f.current=null),p.current&&(!r||!r.has(p.current))&&(p.current=null)},[r]);const d=Object(i.useCallback)((y,b)=>{const k=u.current.map(z=>z.id),I=m.current;let R=-1;if(b.shiftKey&&f.current&&(!I||I.has(f.current))&&(R=k.indexOf(f.current))!==-1){const z=k.indexOf(y),U=k.slice(Math.min(R,z),Math.max(R,z)+1),Q=p.current?k.indexOf(p.current):-1;let H=[];return Q!==-1&&(H=k.slice(Math.min(Q,z),Math.max(Q,z)+1).filter(T=>!U.includes(T))),l.current(...U.filter(T=>!I||!I.has(T)),...H.filter(T=>I&&I.has(T))),p.current=y,c(y),!0}return!1},[c]),g=Object(i.useCallback)(y=>{if(!s.current||y.key!=="ArrowUp"&&y.key!=="ArrowDown"&&!(m.current&&y.key===" "))return;const b=y.target.closest(`.${be.a.listItem}`);if(b)if(y.preventDefault(),y.key===" "){y.stopPropagation();const k=b.querySelector(`.${be.a.playbackButton}`);k&&k.dispatchEvent(new MouseEvent("click",{bubbles:!0}))}else{const k=Array.prototype.indexOf.call(s.current.children,b);y.key==="ArrowUp"&&k>0&&b.previousElementSibling instanceof HTMLDivElement&&b.previousElementSibling.focus(),y.key==="ArrowDown"&&k+1<u.current.length&&b.nextElementSibling instanceof HTMLDivElement&&b.nextElementSibling.focus()}},[]),h=Object(i.useCallback)(y=>{if(!s.current||!(document.activeElement instanceof HTMLDivElement)||(m.current&&!y.shiftKey?y.key!=="Enter":y.key!=="ArrowUp"&&y.key!=="ArrowDown"))return;const b=Array.prototype.indexOf.call(s.current.children,document.activeElement);if(b===-1)return;y.preventDefault();const k=u.current[b];k&&(m.current&&y.shiftKey&&d(k.id,y)||l.current(k.id),c(k.id))},[d,c]),E=Object(i.useCallback)((y,b)=>{d(y,b)||(l.current(y),f.current=y,p.current=null,c(y))},[d,c]);return e.a.createElement("ul",{ref:s,className:["list-group list-group-flush",r?be.a.multiSelect:"",be.a.noSelect].join(" "),onKeyDown:g,onKeyUp:h},a.length?a.map(y=>e.a.createElement(ti,{key:y.id,sample:y,sampleCache:t.get(y.id)||null,selected:r?r.has(y.id):y.id===n,onSampleSelectClick:E})):e.a.createElement("li",{className:"list-group-item"},e.a.createElement(oe.a.Label,{className:be.a.emptyListMessage},"No samples found.")))}var ni=ai,ri=v(16),Se=v.n(ri),rr=(a,t,n)=>new Promise((r,o)=>{var s=l=>{try{c(n.next(l))}catch(m){o(m)}},u=l=>{try{c(n.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,u);c((n=n.apply(a,t)).next())});function lr(a,t){return t.length?a.filter(({metadata:{name:n,slotNumber:r}})=>{const o=n.toLowerCase();return t.every(s=>r===Number(s.replace(/^S\./i,""))||o.includes(s))}):a}var li=e.a.memo(function({loading:t,focusedSampleId:n,userSamples:r,factorySamples:o,userSampleCaches:s,factorySampleCaches:u,onSampleSelect:c,onSampleDelete:l}){const[m,f]=Object(i.useState)(""),p=m.trim().toLowerCase(),[d,g]=Object(i.useState)(null);{const O=Boolean(m);Object(i.useLayoutEffect)(()=>{g(n&&o.has(n)?"factory":r.size?"user":"factory")},[r,o,n,O])}const[h,E]=Object(i.useState)(["user","factory"]);Object(i.useLayoutEffect)(()=>{p&&E(["user","factory"])},[p]);const y=Object(i.useCallback)(O=>{E($=>$.includes(O)?$.filter(J=>J!==O):$.concat(O))},[]),b=Object(i.useCallback)(O=>{if(O.key==="ArrowDown"){O.preventDefault();const J=O.target.closest(`.${Se.a.accordionItem}`);if(!J){console.warn("Expected accordionItem class on parent.");return}const ee=J.querySelector("ul > div");ee&&ee.focus()}},[]),k=Object(i.useMemo)(()=>p?[...new Set(p.split(/\s+/).filter(Boolean))]:[],[p]),I=Object(i.useMemo)(()=>lr([...r.values()],k),[r,k]),R=Object(i.useMemo)(()=>lr([...o.values()],k),[o,k]),z=Object(i.useRef)(null);Object(i.useEffect)(()=>{const O=z.current;if(!O)return;const $=O.getElementsByClassName(be.a.name),J=O.getElementsByClassName(be.a.slot);if(!k.length){for(let ee=0;ee<$.length;ee++)$[ee].innerHTML=$[ee].textContent||"",J[ee].innerHTML=J[ee].textContent||"";return}for(let ee=0;ee<$.length;ee++){let W=$[ee].textContent||"";const K=J[ee].textContent||"",C=Number(K.slice(2));let N=!1;for(const M of k){const D=W.toLowerCase().indexOf(M);D!==-1&&(W=W.slice(0,D)+"<mark>"+W.slice(D,D+M.length)+"</mark>"+W.slice(D+M.length)),!N&&Number(M.replace(/^S\./i,""))===C&&(N=!0,J[ee].innerHTML="<mark>"+K+"</mark>")}$[ee].innerHTML=W}},[k]);const U=Object(i.useRef)(null),Q=Object(i.useRef)(null),H=Object(i.useRef)(!1),T=Object(i.useRef)(!1);Object(i.useEffect)(()=>{if(!U.current||!Q.current)return;function O(){H.current=!0}function $(){T.current=!0}function J(){H.current=!1,T.current=!1}const ee=U.current,W=Q.current;return ee.addEventListener("mousedown",O),W.addEventListener("mousedown",$),window.addEventListener("mouseup",J),()=>{ee.removeEventListener("mousedown",O),W.removeEventListener("mousedown",$),window.removeEventListener("mouseup",J)}},[t]);const[j,w]=Object(i.useState)(null),S=Boolean(j),_=Object(i.useCallback)((...O)=>{S||O.length>1?w($=>{const J=new Set($);for(const ee of O)$&&$.has(ee)?J.delete(ee):J.add(ee);return J}):c(O[0])},[S,c]),P=Object(i.useMemo)(()=>j&&[...j].map(O=>r.get(O)||o.get(O)).filter(Boolean).sort((O,$)=>O.metadata.slotNumber-$.metadata.slotNumber),[r,o,j]),B=Object(i.useMemo)(()=>P&&P.filter(O=>r.has(O.id)),[P,r]),x=Object(i.useRef)(()=>{}),[Z,re]=Object(i.useState)(null),[le,fe]=Object(i.useState)(!1),Y=Object(i.useMemo)(()=>new Map([...s,...u]),[s,u]);return e.a.createElement(e.a.Fragment,null,e.a.createElement(V.a,{hidden:S,className:Se.a.sampleMenuButtonFullWidth,type:"button",variant:"primary",onClick:()=>{c(null),requestAnimationFrame(()=>{const O=document.getElementById("record-button");O&&(O.focus(),requestAnimationFrame(()=>{document.activeElement!==O&&setTimeout(()=>{O.focus()},300)}))})}},"New sample"),e.a.createElement(V.a,{hidden:S,className:Se.a.sampleMenuButtonFullWidth,type:"button",variant:"outline-secondary",onClick:()=>w(new Set)},"Select multiple"),e.a.createElement(V.a,{hidden:!S,className:Se.a.sampleMenuButtonFullWidth,type:"button",variant:"secondary",onClick:()=>w(O=>O&&O.size?new Set:null)},j&&j.size?`Clear selection (${j.size})`:"Done"),e.a.createElement("div",{hidden:!S,className:Se.a.sampleMenuButtonsContainer},P&&e.a.createElement(wa,{samples:P,sampleCaches:Y,justTheButton:!0,showInfoBeforeTransfer:!0,button:e.a.createElement(V.a,{type:"button",disabled:!j||!j.size,variant:"outline-secondary"},"Transfer")})||null,e.a.createElement(V.a,{type:"button",className:Z===null?void 0:Se.a.exporting,disabled:!B||!B.length,variant:Z===null?"outline-secondary":"primary",onClick:()=>rr(this,null,function*(){if(!B)return;if(Z!==null){x.current();return}let O=!1;x.current=()=>{O=!0,re(null)};const $=yield jo(B,J=>{O||re(J)});O||(Lt($,"volcasampler.zip"),re(null))})},e.a.createElement("span",null,Z===null?"Backup":"Cancel"),Z!==null&&e.a.createElement(Ht.a,{className:Se.a.progress,striped:!0,animated:!0,variant:"primary",now:100*Z})),e.a.createElement(V.a,{type:"button",disabled:!B||!B.length,variant:"outline-primary",onClick:()=>fe(!0)},"Delete")),e.a.createElement(Aa.a,{className:Se.a.search},e.a.createElement(oe.a.Control,{placeholder:"Search for a sample...",value:m,onChange:O=>f(O.target.value)}),e.a.createElement("button",{hidden:!m,className:Se.a.clearSearch,type:"reset","aria-label":"Clear search",onClick:()=>f("")})),e.a.createElement(ht.a,{className:Se.a.listGroup,ref:z},!t&&[{eventKey:"user",filteredSamples:I,sampleCaches:s,headerRef:U,headerMouseDownRef:H},{eventKey:"factory",filteredSamples:R,sampleCaches:u,headerRef:Q,headerMouseDownRef:T}].map(({eventKey:O,filteredSamples:$,sampleCaches:J,headerRef:ee,headerMouseDownRef:W})=>e.a.createElement(Re.a,{key:O,style:{"--results-count":$.length,"--accordion-open":(p?h.includes(O):d===O)?"1":"0"},activeKey:p?h.filter(K=>K===O)[0]||"nothing":d===O?d:"nothing",className:Se.a.accordion},e.a.createElement(Re.a.Item,{eventKey:O,className:Se.a.accordionItem},e.a.createElement(Re.a.Header,{ref:ee,onClick:()=>{g(K=>K===O?null:O),p&&y(O)},onFocus:()=>!W.current&&g(O),onKeyDown:b},O==="user"?"Your samples":"Factory samples"),e.a.createElement(Re.a.Body,{className:Se.a.accordionBody},e.a.createElement(ni,{samples:$,sampleCaches:J,selectedSampleId:n,multipleSelection:j,onSampleSelect:_})))))),e.a.createElement(A.a,{onHide:()=>fe(!1),show:le,"aria-labelledby":"delete-modal"},e.a.createElement(oe.a,{className:Se.a.deleteModalForm,onSubmit:O=>rr(this,null,function*(){O.preventDefault(),B&&l(B.map($=>$.id)),w(null),fe(!1)})},e.a.createElement(A.a.Header,{className:Se.a.deleteModalHeader},e.a.createElement(Xt.a,null),e.a.createElement(A.a.Title,{id:"delete-modal"},"Deleting samples")),e.a.createElement(A.a.Body,null,e.a.createElement("p",null,"Are you sure you want to delete these samples? This can't be undone."),e.a.createElement("ul",null,(B||[]).map(O=>e.a.createElement("li",{key:O.id},e.a.createElement("strong",null,O.metadata.name)," (slot"," ",O.metadata.slotNumber,")")))),e.a.createElement(A.a.Footer,null,e.a.createElement(V.a,{type:"button",variant:"light",onClick:()=>fe(!1)},"Cancel"),e.a.createElement(V.a,{type:"submit",variant:"primary"},"Delete")))))}),oi=v(38),Ke=v.n(oi);const ii=e.a.memo(function(){const[t,n]=Object(i.useState)(!1);return e.a.createElement(e.a.Fragment,null,e.a.createElement("div",{className:Ke.a.footer},e.a.createElement("p",null,e.a.createElement("strong",null,"Volca Sampler")," is an app created by"," ",e.a.createElement("a",{href:"https://benwiley.org",target:"_blank",rel:"noreferrer"},"Ben Wiley"),"."),e.a.createElement("p",null,e.a.createElement("strong",null,"volca sample")," is a trademark of"," ",e.a.createElement("strong",null,"KORG Inc."),", who is not affiliated with this app."),e.a.createElement("p",null,"The source code can be found on"," ",e.a.createElement("a",{href:"https://github.com/benwiley4000/volca-sampler",target:"_blank",rel:"noreferrer"},"GitHub"),"."),e.a.createElement(V.a,{className:Ke.a.faqAndLicensesButton,type:"button",variant:"link",onClick:()=>n(!0)},"FAQ / Licenses"),e.a.createElement("div",{className:Ke.a.faqAndLicensesEmbedded},e.a.createElement(or,null))),e.a.createElement(A.a,{show:t,"aria-labelledby":"faq-modal",onHide:()=>n(!1)},e.a.createElement(A.a.Header,null,e.a.createElement(A.a.Title,{id:"faq-modal"},"About Volca Sampler")),e.a.createElement(A.a.Body,null,e.a.createElement(or,null)),e.a.createElement(A.a.Footer,null,e.a.createElement(V.a,{type:"button",variant:"primary",onClick:()=>n(!1)},"Close"))))});function or(){return e.a.createElement(e.a.Fragment,null,e.a.createElement("p",null,"This app relies on the open-source"," ",e.a.createElement("a",{href:"https://github.com/korginc/volcasample",target:"_blank",rel:"noreferrer"},"SYRO")," ","library published by ",e.a.createElement("strong",null,"KORG Inc."),", which encodes audio data to be sent to the ",e.a.createElement("strong",null,"volca sample"),"."),e.a.createElement("p",null,"Big thanks to Blairman and to"," ",e.a.createElement("a",{href:"https://soundcloud.com/southtechnique",target:"_blank",rel:"noreferrer"},"Costas Chris")," ","for helping to test the alpha version!"),e.a.createElement("p",null,"And thanks again to KORG for developing the"," ",e.a.createElement("a",{href:"https://apps.apple.com/us/app/audiopocket-for-volca-sample/id927415821",target:"_blank",rel:"noreferrer"},"AudioPocket")," ","app, which inspired the core functionality of Volca Sampler."),e.a.createElement("h3",null,"FAQ"),e.a.createElement("div",{className:Ke.a.qAndA},e.a.createElement("p",null,e.a.createElement("strong",null,"Q: What platforms are supported?")),e.a.createElement("p",null,"A: Anything that can run a modern web browser with a headphone output should work (PC, Mac, Linux, Android, iOS).")),e.a.createElement("div",{className:Ke.a.qAndA},e.a.createElement("p",null,e.a.createElement("strong",null,"Q: Is this compatible with the volca sample2?")),e.a.createElement("p",null,"A: Yes, but only the stereo cable connection is supported. There are no plans for supporting the USB connection.")),e.a.createElement("div",{className:Ke.a.qAndA},e.a.createElement("p",null,e.a.createElement("strong",null,"Q: Where will my samples be uploaded?")),e.a.createElement("p",null,"A: Nowhere. Everything is kept on your device, in your web browser's application files. SYRO (the code that converts your samples into something the volca sample can understand) is actually running inside your web browser.")),e.a.createElement("div",{className:Ke.a.qAndA},e.a.createElement("p",null,e.a.createElement("strong",null,"Q: Can I export my samples to another device?")),e.a.createElement("p",null,"A: You can download the audio for any sample (either the source audio or the optimized audio with your settings applied), but we don't currently support any type of bulk export of your samples and configurations. Some type of peer-to-peer syncing support might be coming in the near future if there's interest from users.")),e.a.createElement("div",{className:Ke.a.qAndA},e.a.createElement("p",null,e.a.createElement("strong",null,"Q: Where can I contact you?")),e.a.createElement("p",null,"A:"," ",e.a.createElement("a",{href:"mailto:therealbenwiley@gmail.com?subject=Volca Sampler",target:"_blank",rel:"noreferrer"},"Email")," ","to get in touch with me personally, or"," ",e.a.createElement("a",{href:"https://github.com/benwiley4000/volca-sampler/issues",target:"_blank",rel:"noreferrer"},"GitHub")," ","to file an issue with this app.")),e.a.createElement("h3",null,"Licenses"),e.a.createElement("h5",null,"SYRO"),e.a.createElement("p",null,"Copyright (c) 2014, KORG Inc. All rights reserved."),e.a.createElement("p",null,"Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:"),e.a.createElement("p",null,"Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer."),e.a.createElement("p",null,"Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution."),e.a.createElement("p",null,"Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission."),e.a.createElement("p",null,'THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.'),e.a.createElement("h5",null,"Other open source licenses"),e.a.createElement("p",null,"See the full list"," ",e.a.createElement("a",{href:"npm-licenses.html",target:"_blank",rel:"noreferrer"},"here"),"."))}var ir=ii,si=v(149),ci=v(150),sr;function Ra(){return Ra=Object.assign||function(a){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(a[r]=n[r])}return a},Ra.apply(this,arguments)}function ui(a){return i.createElement("svg",Ra({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24},a),sr||(sr=i.createElement("path",{d:"M19 6V5a2 2 0 00-2-2h-2a2 2 0 00-2 2v1h-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v1H3v14h10.09a5.47 5.47 0 01-.09-1 6 6 0 018-5.66V6m1.54 10.88L20.41 19l2.13 2.12-1.42 1.42L19 20.41l-2.12 2.13-1.42-1.42L17.59 19l-2.13-2.12 1.42-1.42L19 17.59l2.12-2.13z"})))}var Yi=v.p+"static/media/toy-brick-remove.69a35137.svg",mi=v(8),se=v.n(mi),Ta=(a,t,n)=>new Promise((r,o)=>{var s=l=>{try{c(n.next(l))}catch(m){o(m)}},u=l=>{try{c(n.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,u);c((n=n.apply(a,t)).next())});function di(a,t,n,r){return Ta(this,null,function*(){return(yield(yield fetch(`https://api.github.com/repos/${a}/${t}/contents/${r}?ref=${n}`)).json()).map(u=>u.name)})}function fi(a,t,n,r,o){return Ta(this,null,function*(){return yield(yield fetch(`https://raw.githubusercontent.com/${a}/${t}/${n}/${r}/${o}`)).text()})}const cr="benwiley4000",ur="volca-sampler-plugins",mr="master",dr="plugins";function pi(){return Ta(this,null,function*(){const a=yield di(cr,ur,mr,dr),t=yield Promise.all(a.map(n=>fi(cr,ur,mr,dr,n)));return a.map((n,r)=>({pluginName:n,pluginSource:t[r]}))})}function hi(a){return`https://github.com/benwiley4000/volca-sampler-plugins/blob/master/plugins/${a}`}var gi=Object.defineProperty,vi=Object.defineProperties,yi=Object.getOwnPropertyDescriptors,fr=Object.getOwnPropertySymbols,Ei=Object.prototype.hasOwnProperty,bi=Object.prototype.propertyIsEnumerable,pr=(a,t,n)=>t in a?gi(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,hr=(a,t)=>{for(var n in t||(t={}))Ei.call(t,n)&&pr(a,n,t[n]);if(fr)for(var n of fr(t))bi.call(t,n)&&pr(a,n,t[n]);return a},wi=(a,t)=>vi(a,yi(t)),jt=(a,t,n)=>new Promise((r,o)=>{var s=l=>{try{c(n.next(l))}catch(m){o(m)}},u=l=>{try{c(n.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,u);c((n=n.apply(a,t)).next())}),Si=e.a.memo(function({isOpen:t,pluginList:n,pluginStatusMap:r,userSamples:o,onUpdatePluginList:s,onSampleUpdate:u,onSampleBulkReplace:c,onRegenerateSampleCache:l,onClose:m}){const f=Object(i.useMemo)(()=>{const w={};for(const S of n)w[S]=0;for(const[,S]of o){const{plugins:_}=S.metadata;for(const P of n)_.some(B=>B.pluginName===P)&&w[P]++}return w},[n,o]),[p,d]=Object(i.useState)(null),[g,h]=Object(i.useState)(!1),[E,y]=Object(i.useState)(!1),b=Object(i.useRef)(o);b.current=o;const k=Object(i.useCallback)(w=>{const S=[...b.current.values()].filter(_=>_.metadata.plugins.some(P=>P.pluginName===w));for(const{id:_}of S)l(_)},[l]),I=Object(i.useCallback)(w=>jt(this,null,function*(){if(!w.target.files)return;const S=w.target.files.item(0);if(!S)return;let _=S.name;Wl({file:S,onConfirmName(P){return new Promise(B=>{d({pluginName:P,variant:"confirm-name",onConfirmName(x){_=x,B(x),d(null)},onConfirmReplace(){},onCancelRename(){}})})},onConfirmReplace(P){return new Promise(B=>{d({pluginName:P,variant:"replace",onConfirmReplace(x){B(x),d(null)},onConfirmName(){},onCancelRename(){}})})}}).then(P=>{s(),P==="exists"&&h(!0),P==="replaced"&&k(_)}).catch(()=>y(!0)),w.target.value=""}),[s,k]),R=Object(i.useCallback)((w,S)=>jt(this,null,function*(){let _=w;try{const P=yield Ut({pluginName:w,pluginSource:S,onConfirmName(B){return new Promise(x=>{d({pluginName:B,variant:"confirm-name",onConfirmName(Z){_=Z,x(Z),d(null)},onConfirmReplace(){},onCancelRename(){}})})},onConfirmReplace(B){return new Promise(x=>{d({pluginName:B,variant:"replace",onConfirmReplace(Z){x(Z),d(null)},onConfirmName(){},onCancelRename(){}})})}});s(),P==="exists"&&h(!0),P==="replaced"&&k(_)}catch(P){y(!0)}}),[s,k]),z=w=>jt(this,null,function*(){const S=yield new Promise(x=>{d({pluginName:w,variant:"rename",onConfirmName(Z){x(Z),d(null)},onConfirmReplace(){},onCancelRename(){x(""),d(null)}})});if(!S)return;let _=S;const{updatedSamples:P,result:B}=yield Hl({oldPluginName:w,newPluginName:S,onConfirmName(x){return new Promise(Z=>{d({pluginName:x,variant:"confirm-name",onConfirmName(re){_=re,Z(re),d(null)},onConfirmReplace(){},onCancelRename(){}})})},onConfirmReplace(x){return new Promise(Z=>{d({pluginName:x,variant:"replace",onConfirmReplace(re){Z(re),d(null)},onConfirmName(){},onCancelRename(){}})})},userSamples:o});s(),B==="replaced"&&k(_),c(P)}),[U,Q]=Object(i.useState)(""),[H,T]=Object(i.useState)([]);Object(i.useEffect)(()=>{pi().then(T)},[]);const j=Object(i.useMemo)(()=>H.filter(({pluginName:w})=>!n.includes(w)),[H,n]);return e.a.createElement(e.a.Fragment,null,e.a.createElement(A.a,{onHide:m,show:t,"aria-labelledby":"plugin-manager-modal"},e.a.createElement(A.a.Header,null,e.a.createElement(A.a.Title,{id:"plugin-manager-modal"},"Plugins overview")),e.a.createElement(A.a.Body,null,e.a.createElement("p",null,"Plugins use custom JavaScript to extend Volca Sampler's sample pre-processing capabilities. You only need"," ",e.a.createElement("strong",null,"basic programming knowledge")," to"," ",e.a.createElement("a",{href:"https://github.com/benwiley4000/volca-sampler-plugins",target:"_blank",rel:"noreferrer"},"get started writing your own plugins"),". You can share your plugins with others, and"," ",e.a.createElement("strong",null,"install plugins written by other Volca Sample owners"),"."),e.a.createElement("div",{className:se.a.pluginListTitle},e.a.createElement("h5",null,"Installed plugins"),e.a.createElement(V.a,{className:se.a.installPlugin,type:"button",variant:"primary",onClick:w=>{const S=w.currentTarget.querySelector("input");S&&w.target!==S&&S.click()}},e.a.createElement(Oa,null),e.a.createElement("span",null,"Install a plugin"),e.a.createElement("input",{hidden:!0,type:"file",accept:"text/javascript",onChange:I}))),e.a.createElement(ht.a,null,!n.length&&e.a.createElement(ht.a.Item,{className:se.a.noneInstalled},"There are no plugins installed."),n.map(w=>e.a.createElement(ht.a.Item,{key:w,className:se.a.pluginItem},e.a.createElement("div",{className:se.a.nameAndInfo},e.a.createElement("div",{className:se.a.name},e.a.createElement("span",{title:w},w),e.a.createElement("div",{className:se.a.rename,title:"Rename plugin",onClick:()=>z(w)},e.a.createElement(si.a,null))),e.a.createElement("div",{className:se.a.info},"Used by ",f[w]," sample(s)")),e.a.createElement("div",{className:se.a.actions},r.get(w)==="broken"&&e.a.createElement("div",{className:se.a.reloadPlugin,onClick:()=>jt(this,null,function*(){yield Wn(w),s()})},e.a.createElement(jn.a,null),"Reload plugin"),e.a.createElement("div",{title:"Download plugin",className:se.a.downloadPlugin,onClick:()=>jt(this,null,function*(){const S=yield ka(w);if(!S)return;const _=new Blob([S],{type:"text/javascript"});Lt(_,w)})},e.a.createElement(gn.a,null)),e.a.createElement("div",{title:"Uninstall plugin",className:se.a.uninstallButton,onClick:()=>Q(w)},e.a.createElement(ui,null)))))),Boolean(j.length)&&e.a.createElement(e.a.Fragment,null,e.a.createElement("h5",{className:se.a.suggestedPluginsTitle},"Suggested plugins"),e.a.createElement(ht.a,{className:se.a.suggestedPlugins},j.map(({pluginName:w,pluginSource:S})=>e.a.createElement(ht.a.Item,{key:w,className:se.a.pluginItem},e.a.createElement("div",{className:se.a.nameAndInfo},e.a.createElement("div",{className:se.a.name},e.a.createElement("span",{title:w},w))),e.a.createElement("div",{className:se.a.actions},e.a.createElement("a",{className:se.a.viewSource,href:hi(w),target:"_blank",rel:"noreferrer",title:"View Source"},e.a.createElement(ci.a,null)),e.a.createElement(V.a,{title:"Install plugin",className:se.a.installSuggestedPlugin,onClick:()=>R(w,S)},e.a.createElement(Oa,null)))))))),e.a.createElement(A.a.Footer,null,e.a.createElement(V.a,{type:"button",variant:"light",onClick:m},"Close"))),e.a.createElement(A.a,{className:se.a.uninstallModal,onHide:()=>Q(""),show:Boolean(U),"aria-labelledby":"uninstall-plugin-modal",centered:!0},e.a.createElement(A.a.Header,null,e.a.createElement(A.a.Title,{id:"uninstall-plugin-modal"},"Uninstalling plugin")),e.a.createElement(A.a.Body,null,e.a.createElement("p",null,"Are you sure you want to uninstall"," ",e.a.createElement("strong",null,U),"?"),f[U]?e.a.createElement("p",null,"The plugin will be"," ",e.a.createElement("strong",null,"removed from ",f[U]," ","sample(s)"),". This can't be undone."):null),e.a.createElement(A.a.Footer,null,e.a.createElement(V.a,{type:"button",variant:"light",onClick:()=>Q("")},"Cancel"),e.a.createElement(V.a,{type:"button",variant:"primary",onClick:()=>{const w=[...o.values()].filter(S=>S.metadata.plugins.some(_=>_.pluginName===U)).map(S=>S.id);w.length&&u(w,S=>wi(hr({},S),{plugins:S.plugins.filter(_=>_.pluginName!==U)})),Gt(U).then(s),Q("")}},"Uninstall"))),p&&e.a.createElement(Zn,hr({},p)),e.a.createElement(A.a,{className:se.a.alreadyInstalledModal,onHide:()=>h(!1),show:g,"aria-labelledby":"already-installed-plugin-modal",centered:!0},e.a.createElement(A.a.Header,null,e.a.createElement(A.a.Title,{id:"already-installed-plugin-modal"},"Plugin already installed")),e.a.createElement(A.a.Body,null,e.a.createElement("p",null,"This plugin has already been installed.")),e.a.createElement(A.a.Footer,null,e.a.createElement(V.a,{type:"button",variant:"primary",onClick:()=>h(!1)},"OK"))),e.a.createElement(A.a,{className:se.a.failedToInstallModal,onHide:()=>y(!1),show:E,"aria-labelledby":"failed-to-install-plugin-modal",centered:!0},e.a.createElement(A.a.Header,null,e.a.createElement(A.a.Title,{id:"failed-to-install-plugin-modal"},"Failed to install plugin")),e.a.createElement(A.a.Body,null,e.a.createElement("p",null,"Check the plugin source code for issues."),e.a.createElement("p",null,"You might find helpful stack traces and error logs in the browser JavaScript console (Win/Linux: ",e.a.createElement("code",null,"Ctrl+Shift+J"),", Mac:"," ",e.a.createElement("code",null,"Cmd+Option+J"),")."),e.a.createElement("p",null,"If you're not the plugin author, you can share this info with the author to help resolve the issue.")),e.a.createElement(A.a.Footer,null,e.a.createElement(V.a,{type:"button",variant:"primary",onClick:()=>y(!1)},"OK"))))});const gr=["Cool","Dope","Far-out","Chill","Wicked","Bomb","Superb","Choice","Exquisite","Righteous","Dank","Alright","Very Good","Ice Cold","Sick","Juicy","Gnarly","Grainy","Most-excellent","Fortuitous","Bodacious","Tubular","Fresh"],vr=["Sample","Cut","Quotation","Extract","Sound","Noise","Clip"];function _i(){const a=gr[Math.floor(Math.random()*gr.length)],t=vr[Math.floor(Math.random()*vr.length)];return`${a} ${t}`}var Ci=v(39),Ze=v.n(Ci),Je=(a,t,n)=>new Promise((r,o)=>{var s=l=>{try{c(n.next(l))}catch(m){o(m)}},u=l=>{try{c(n.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,u);c((n=n.apply(a,t)).next())});const Da="focused_sample_id";function Pi(){const[a,t]=Object(i.useState)(new Map),[n,r]=Object(i.useState)(new Map),[o,s]=Object(i.useState)(new Map),[u,c]=Object(i.useState)(new Map),l=Object(i.useMemo)(()=>new Map([...a,...o]),[a,o]);Object(i.useEffect)(()=>{jr().then(C=>{s(new Map([...C].map(([N,{sampleContainer:M}])=>[N,M]))),c(new Map([...C].map(([N,{sampleContainer:M,cachedInfo:D}])=>[N,new ge({sampleContainer:M,cachedInfo:D})])))}).catch(console.error)},[]);const m=sessionStorage.getItem(Da),[f,p]=Object(i.useState)(m&&typeof m=="string"?m:null);Object(i.useEffect)(()=>{f?sessionStorage.setItem(Da,f):sessionStorage.removeItem(Da)},[f]);const[d,g]=Object(i.useState)(!0);Object(i.useEffect)(()=>{ie.getAllFromStorage().then(C=>Je(this,[C],function*({sampleContainers:N,cachedInfos:M}){t(G=>{const te=new Map([...G,...N.map(ue=>[ue.id,ue])]);return new Map([...te].sort(([,ue],[,X])=>st(ue,X)))});const D=yield ge.getAllCachedInfoFromStore(),F=N.filter(G=>!M.has(G.id)&&!D.has(G.id));for(const G of F)ge.importToStorage(G).then(te=>{r(ue=>new Map(ue).set(G.id,te))});r(G=>new Map([...G,...N.filter(te=>D.has(te.id)||M.has(te.id)).map(te=>{const ue=M.get(te.id);return ue?[te.id,new ge.Mutable.Upgraded({sampleContainer:te,cachedInfo:ue})]:[te.id,new ge.Mutable({sampleContainer:te,cachedInfo:D.get(te.id)})]})]))})).finally(()=>{g(!1)})},[]);const h=Object(i.useCallback)((C,N)=>Je(this,null,function*(){const M=yield ut(C),D=[0,0],F=yield wt(M,D);if([...F.positive,...F.negative].every(pe=>pe===0))return"silent";const G=yield Ya(C);let te="",ue="";if(N){const pe=N.name.lastIndexOf(".");pe>0?(te=N.name.slice(0,pe),ue=N.name.slice(pe)):te=N.name}else te=_i();const X=new ie.Mutable({name:te,sourceFileId:G,trim:{frames:D},userFileInfo:N&&{type:N.type,ext:ue}});yield X.persist(),t(pe=>new Map([[X.id,X],...pe])),p(X.id),Promise.resolve().then(()=>Ce("sample",[X.id],"create"));const we=new ge.Mutable({sampleContainer:X,cachedInfo:{waveformPeaks:F,postPluginFrameCount:M.length,duration:M.duration,failedPluginIndex:-1}});return yield we.persist(),r(pe=>new Map(pe).set(X.id,we)),Promise.resolve().then(()=>Ce("cache",[X.id],"create")),"saved"}),[]),E=Object(i.useRef)(n);E.current=n;const y=Object(i.useCallback)((C,N)=>{const M=C instanceof Array?C:[C];t(D=>{const F=M.map(X=>{const we=D.get(X);return we&&we instanceof ie.Mutable&&we||null}).filter(Boolean);if(!F.length)return D;const G=[],te=F.map(X=>{if(!(X instanceof ie.Mutable))return X;let we=()=>{};G.push(new Promise(Te=>we=Te));const pe=X.update(N,we);return pe!==X&&Promise.resolve().then(()=>Je(this,null,function*(){const Te=E.current.get(X.id);if(!(Te&&Te instanceof ge.Mutable))return;yield Promise.all(G);const Xe=yield Te.update(pe);Xe!==Te&&(Xe.sampleContainer!==pe&&(t(rt=>{const gt=new Map(rt);return gt.delete(X.id),new Map([[X.id,Xe.sampleContainer],...gt])}),Ce("sample",[X.id],"edit")),r(rt=>new Map(rt).set(X.id,Xe)),Ce("cache",[X.id],"edit"))})),pe});if(te.every((X,we)=>F[we]===X))return D;Promise.all(G).then(()=>{Ce("sample",te.map(X=>X.id),"edit")});const ue=new Map(D);for(const{id:X}of te)ue.delete(X);return new Map([...te.slice().sort(st).map(X=>[X.id,X]),...ue])})},[]),b=Object(i.useCallback)((C,N)=>{t(M=>{const D=new Map([...M,...C.map(F=>[F.id,F])]);return new Map([...D].sort(([,F],[,G])=>st(F,G)))}),Ce("sample",C.map(M=>M.id),"create"),r(M=>new Map([...M,...N.map(D=>[D.sampleContainer.id,D])])),Ce("cache",N.map(M=>M.sampleContainer.id),"create"),_("sampleList")},[]),k=Object(i.useCallback)(C=>{t(N=>{const M=new Map(N);for(const[D,F]of N)M.has(D)&&M.set(D,F);return M}),Ce("sample",C.map(N=>N.id),"edit")},[]),I=Object(i.useRef)(l);I.current=l;const R=Object(i.useRef)(u);R.current=u;const z=Object(i.useCallback)(C=>{const N=I.current.get(C);if(N){const M=N.duplicate(F=>{Ce("sample",[F],"create")});t(F=>new Map([[M.id,M],...F]));const D=E.current.get(C)||R.current.get(C);if(D){const F=new ge.Mutable({sampleContainer:M,cachedInfo:D.cachedInfo});F.persist().then(()=>{Ce("cache",[M.id],"create")}),r(G=>new Map(G).set(M.id,F))}p(M.id)}},[]),U=Object(i.useRef)(a);U.current=a;const Q=Object(i.useRef)(f);Q.current=f;const H=Object(i.useCallback)((C,N)=>{const M=C instanceof Array?C:[C],D=U.current;if(Q.current&&M.includes(Q.current)){const F=[...D.values()],G=F.findIndex(X=>X.id===Q.current),te=F.slice(0,G).reverse().find(X=>!M.includes(X.id)),ue=te||F.slice(G+1).find(X=>!M.includes(X.id));p(ue?ue.id:null)}N||(Promise.all(M.map(F=>Je(this,null,function*(){const G=D.get(F);G&&G instanceof ie.Mutable&&(yield G.remove())}))).then(()=>Ce("sample",M,"delete")),Promise.all(M.map(F=>Je(this,null,function*(){const G=E.current.get(F);G&&G instanceof ge.Mutable&&(yield G.remove())}))).then(()=>Ce("cache",M,"delete"))),t(F=>{const G=new Map(F);for(const te of M)G.delete(te);return G}),r(F=>{const G=new Map(F);for(const te of M)G.delete(te);return G})},[]),[T,j]=Object(i.useState)(Symbol()),w=Object(i.useCallback)(C=>{const N=U.current.get(C);!N||(j(Symbol()),ge.importToStorage(N).then(M=>{r(D=>new Map(D).set(C,M))}))},[]);Object(i.useEffect)(()=>zt("sample",C=>Je(this,null,function*(){if(C.action==="delete")H(C.ids,!0);else{const N=yield ie.getByIdsFromStorage(C.ids);t(M=>{const D=new Map([...M,...N.map(F=>[F.id,F])]);return new Map([...D].sort(([,F],[,G])=>st(F,G)))})}})),[H]),Object(i.useEffect)(()=>zt("cache",C=>Je(this,null,function*(){if(C.action==="delete")r(N=>{const M=new Map(N);for(const D of C.ids)M.delete(D);return M});else{const N=yield ge.getCachedInfoByIdsFromStorage(C.ids);requestAnimationFrame(()=>{r(M=>{const D=U.current;return D?new Map([...M,...N.map((F,G)=>[C.ids[G],new ge.Mutable({cachedInfo:F,sampleContainer:D.get(C.ids[G])})])]):M})})}})),[]);const[S,_]=Object(i.useState)("currentSample"),P=Object(i.useCallback)(C=>{p(C),_("currentSample")},[]),B=Object(i.useCallback)(()=>{p(null),_("currentSample")},[]),x=f?l.get(f):null,Z=x&&(n.get(x.id)||u.get(x.id))||null,[re,le]=Object(i.useState)(!1),fe=Object(i.useCallback)(()=>le(!0),[]),Y=Object(i.useCallback)(()=>le(!1),[]),[O,$]=Object(i.useState)(new Map),J=Object(i.useCallback)(()=>Je(this,null,function*(){const C=yield Ll();$(C)}),[]);Object(i.useEffect)(()=>(J(),zt("plugin",J)),[J]);const ee=Object(i.useMemo)(()=>[...O.keys()],[O]),[W,K]=Object(i.useState)(new Map);return Object(i.useEffect)(()=>{const C=new Map;let N=!1;Ul(...ee).then(D=>{N||(ee.forEach((F,G)=>{C.set(F,D[G])}),K(C))});const M=ee.map(D=>ct(D).onPluginError(()=>K(F=>new Map(F).set(D,"broken"))));return()=>{N=!0;for(const D of M)D()}},[ee]),e.a.createElement("div",{className:Ze.a.app},e.a.createElement(_r,{onHeaderClick:B}),e.a.createElement("div",{className:`${Ze.a.mobileLayoutContainer} ${Ze.a[S]}`},e.a.createElement("div",{className:Ze.a.sampleListSidebar},e.a.createElement(li,{loading:d,focusedSampleId:f,userSamples:a,factorySamples:o,userSampleCaches:n,factorySampleCaches:u,onSampleSelect:P,onSampleDelete:H})),e.a.createElement("div",{className:Ze.a.mainLayout},x?x instanceof ie.Mutable?e.a.createElement(uo,{sample:x,sampleCache:Z,pluginParamsDefs:O,pluginStatusMap:W,editCacheInvalidator:T,onSampleUpdate:y,onSampleDuplicate:z,onSampleDelete:H,onOpenPluginManager:fe,onRecheckPlugins:J,onRegenerateSampleCache:w}):e.a.createElement(Po,{sample:x,sampleCache:Z,onSampleDuplicate:z}):null,!f&&e.a.createElement(Xo,{userSamples:a,onUpdatePluginList:J,onRegenerateSampleCache:w,onBulkImport:b,onRecordFinish:h}),(!f||x)&&e.a.createElement("div",{className:Ze.a.normalFooterContainer},e.a.createElement(ir,null))),e.a.createElement("div",{className:Ze.a.mobileFooterContainer},e.a.createElement(yt.a,{fluid:"sm"},e.a.createElement("h2",null,"About Volca Sampler"),e.a.createElement(ir,null)))),e.a.createElement(qe.a,{className:Ze.a.mobilePageNav,activeKey:S,variant:"underline"},e.a.createElement(qe.a.Item,{onClick:()=>_("sampleList")},e.a.createElement(qe.a.Link,{eventKey:"sampleList"},"List")),e.a.createElement(qe.a.Item,{onClick:()=>_("currentSample")},e.a.createElement(qe.a.Link,{eventKey:"currentSample"},"Sample")),e.a.createElement(qe.a.Item,{onClick:()=>_("about")},e.a.createElement(qe.a.Link,{eventKey:"about"},"About"))),e.a.createElement(Si,{isOpen:re,pluginList:ee,pluginStatusMap:W,userSamples:a,onUpdatePluginList:J,onSampleUpdate:y,onSampleBulkReplace:k,onRegenerateSampleCache:w,onClose:Y}))}var Oi=Pi,ki=a=>{a&&a instanceof Function&&v.e(3).then(v.bind(null,220)).then(({getCLS:t,getFID:n,getFCP:r,getLCP:o,getTTFB:s})=>{t(a),n(a),r(a),o(a),s(a)})};Blob.prototype.arrayBuffer||(Blob.prototype.arrayBuffer=function(){return new Response(this).arrayBuffer()}),typeof TouchEvent=="undefined"&&(window.TouchEvent=class extends Event{}),wr.a.render(e.a.createElement(e.a.StrictMode,null,e.a.createElement(Hr,null,e.a.createElement(Oi,null))),document.getElementById("root")),Vl(),ki()},21:function(q,ce,v){q.exports={"form-switch":"SampleRecord_form-switch__q05a7","form-check-input":"SampleRecord_form-check-input__2QPKW","nav-pills":"SampleRecord_nav-pills__13Twr","nav-item":"SampleRecord_nav-item__2ev6Y","nav-link":"SampleRecord_nav-link__2-Nbr",active:"SampleRecord_active__15Zfs",modal:"SampleRecord_modal__38Mx7","modal-dialog":"SampleRecord_modal-dialog__3j_d9","modal-content":"SampleRecord_modal-content__1rv-K","modal-body":"SampleRecord_modal-body__3BRoG",container:"SampleRecord_container__3bdq5",audioInputHeader:"SampleRecord_audioInputHeader__1Prbd",channelOptionSelect:"SampleRecord_channelOptionSelect__235gz",channelOption:"SampleRecord_channelOption__31f9w",stereoExplanation:"SampleRecord_stereoExplanation__3SWiA",alertContainer:"SampleRecord_alertContainer__vjGNP",recordButton:"SampleRecord_recordButton__3R-KX",mainText:"SampleRecord_mainText__2dca6",timeRecorded:"SampleRecord_timeRecorded__3FGTe",importFileButton:"SampleRecord_importFileButton__3Zl2W",osTabs:"SampleRecord_osTabs__1CZdV",systemRecordModalBody:"SampleRecord_systemRecordModalBody__15hmN"}},30:function(q,ce,v){q.exports={playbackOverlay:"WaveformPlayback_playbackOverlay__Er0Rh",playbackActive:"WaveformPlayback_playbackActive__1IHxg",playback:"WaveformPlayback_playback__2heRw",playbackButtonContainer:"WaveformPlayback_playbackButtonContainer__Lhahe",downloadButton:"WaveformPlayback_downloadButton__2s-L5"}},31:function(q,ce,v){q.exports={"form-switch":"SlotNumberInput_form-switch__39Wtl","form-check-input":"SlotNumberInput_form-check-input__oNf4Z","nav-pills":"SlotNumberInput_nav-pills__1RDi_","nav-item":"SlotNumberInput_nav-item__CuVVe","nav-link":"SlotNumberInput_nav-link__1C3wo",active:"SlotNumberInput_active__2zN4D",modal:"SlotNumberInput_modal__25tRB","modal-dialog":"SlotNumberInput_modal-dialog__1vyjC","modal-content":"SlotNumberInput_modal-content__cz3DI","modal-body":"SlotNumberInput_modal-body__ZzZE0",slotNumberRow:"SlotNumberInput_slotNumberRow__kQwOw",slotNumberContainer:"SlotNumberInput_slotNumberContainer__1q7P1",arrowControls:"SlotNumberInput_arrowControls__1LPAC",slotNumber:"SlotNumberInput_slotNumber__GC-i7",digitBlinkEffect:"SlotNumberInput_digitBlinkEffect__1_u8n",point:"SlotNumberInput_point__3pJD3",warning:"SlotNumberInput_warning__3NAeN"}},32:function(q,ce,v){q.exports={"form-switch":"PitchControl_form-switch__3fMsR","form-check-input":"PitchControl_form-check-input__3f8ZW","nav-pills":"PitchControl_nav-pills__1B_i9","nav-item":"PitchControl_nav-item__jG8v5","nav-link":"PitchControl_nav-link__3aIOu",active:"PitchControl_active__QhF5J",modal:"PitchControl_modal__11Ar5","modal-dialog":"PitchControl_modal-dialog__1Yqzr","modal-content":"PitchControl_modal-content__nU86c","modal-body":"PitchControl_modal-body__lJeYS",pitchAdjustmentWrapper:"PitchControl_pitchAdjustmentWrapper__3Mlmm",label:"PitchControl_label__2mPmc",previewValue:"PitchControl_previewValue__3l1yE",expanded:"PitchControl_expanded__2QAYx",ticks:"PitchControl_ticks__32ibh",tickLabel:"PitchControl_tickLabel__2HWfR",tickMark:"PitchControl_tickMark__OVi7b",annotations:"PitchControl_annotations__q4qkl",warn:"PitchControl_warn__OsYDG"}},36:function(q,ce,v){q.exports={"form-switch":"Header_form-switch__7m8-P","form-check-input":"Header_form-check-input__3V7ik","nav-pills":"Header_nav-pills__1-obW","nav-item":"Header_nav-item__7_0FE","nav-link":"Header_nav-link__1QKsk",active:"Header_active__1pE38",modal:"Header_modal__3A4xt","modal-dialog":"Header_modal-dialog__3oG5V","modal-content":"Header_modal-content__JA7jP","modal-body":"Header_modal-body__32J1e",titleBar:"Header_titleBar__3BLa-",title:"Header_title__R3bRx",titleText:"Header_titleText__3e5ME",titleR:"Header_titleR__3QRgv",titleStarburst:"Header_titleStarburst__1oLYP",titleGraphic:"Header_titleGraphic__3S89F",tagline:"Header_tagline__6mYkP"}},37:function(q,ce,v){q.exports={"form-switch":"QualityBitDepthControl_form-switch__3nCZi","form-check-input":"QualityBitDepthControl_form-check-input__2KgZ8","nav-pills":"QualityBitDepthControl_nav-pills__lvlTW","nav-item":"QualityBitDepthControl_nav-item__MdYNK","nav-link":"QualityBitDepthControl_nav-link__2ZJvk",active:"QualityBitDepthControl_active__1J60r",modal:"QualityBitDepthControl_modal__18Jly","modal-dialog":"QualityBitDepthControl_modal-dialog__24Z0E","modal-content":"QualityBitDepthControl_modal-content__22dUY","modal-body":"QualityBitDepthControl_modal-body__3QfIn",qualityBitDepthWrapper:"QualityBitDepthControl_qualityBitDepthWrapper__2qLOe",label:"QualityBitDepthControl_label___ohmN",previewValue:"QualityBitDepthControl_previewValue__2omZY",expanded:"QualityBitDepthControl_expanded__39f73",ticks:"QualityBitDepthControl_ticks__1u5GH",tickLabel:"QualityBitDepthControl_tickLabel__2jXRm",tickMark:"QualityBitDepthControl_tickMark__24xm0",annotations:"QualityBitDepthControl_annotations__3mXj2"}},38:function(q,ce,v){q.exports={"form-switch":"Footer_form-switch__IQ8fU","form-check-input":"Footer_form-check-input__2mYiO","nav-pills":"Footer_nav-pills__11ybY","nav-item":"Footer_nav-item__3oAU2","nav-link":"Footer_nav-link__2BtNN",active:"Footer_active__cHt7c",modal:"Footer_modal__1qM8m","modal-dialog":"Footer_modal-dialog__3LU5E","modal-content":"Footer_modal-content__1xGht","modal-body":"Footer_modal-body__1PrCR",footer:"Footer_footer__yR_13",faqAndLicensesButton:"Footer_faqAndLicensesButton__eLI1R",faqAndLicensesEmbedded:"Footer_faqAndLicensesEmbedded__rqK4H",qAndA:"Footer_qAndA__bDlJB"}},39:function(q,ce,v){q.exports={"form-switch":"App_form-switch__3Ht4D","form-check-input":"App_form-check-input__19Z6o","nav-pills":"App_nav-pills__16LAO","nav-item":"App_nav-item__2m-_e","nav-link":"App_nav-link__32PWp",active:"App_active__2jQ78",modal:"App_modal__tC7nw","modal-dialog":"App_modal-dialog__28D_0","modal-content":"App_modal-content__1KtJW","modal-body":"App_modal-body__1JjYd",app:"App_app__2ziFi",mobileLayoutContainer:"App_mobileLayoutContainer__xakbp",sampleListSidebar:"App_sampleListSidebar__3Ks2q",sampleList:"App_sampleList__WKnRo",mainLayout:"App_mainLayout__3UKwp",currentSample:"App_currentSample__nhOND",mobileFooterContainer:"App_mobileFooterContainer__1YP8t",about:"App_about__k-55R",normalFooterContainer:"App_normalFooterContainer__hzxSk",mobilePageNav:"App_mobilePageNav__3y_u-"}},48:function(q,ce,v){q.exports={"form-switch":"SampleDetail_form-switch__31CS2","form-check-input":"SampleDetail_form-check-input__1NWgi","nav-pills":"SampleDetail_nav-pills__1brjk","nav-item":"SampleDetail_nav-item__24L50","nav-link":"SampleDetail_nav-link__V6FsG",active:"SampleDetail_active__3mnV-",modal:"SampleDetail_modal__1w1ts","modal-dialog":"SampleDetail_modal-dialog__3hbcz","modal-content":"SampleDetail_modal-content__14DW-","modal-body":"SampleDetail_modal-body__2T5wL",sampleName:"SampleDetail_sampleName__1iNn9",optionsButton:"SampleDetail_optionsButton__k0UjV",actionButtons:"SampleDetail_actionButtons__nTnTP",deleteModalHeader:"SampleDetail_deleteModalHeader__3DiKA",normalizeControlWrapper:"SampleDetail_normalizeControlWrapper__1yc_t",slotNumber:"SampleDetail_slotNumber__3sgS6",point:"SampleDetail_point__3d7qL"}},49:function(q,ce,v){q.exports={"form-switch":"SampleSelectionTable_form-switch__25Smv","form-check-input":"SampleSelectionTable_form-check-input__2FloX","nav-pills":"SampleSelectionTable_nav-pills__1rfxT","nav-item":"SampleSelectionTable_nav-item__24ALs","nav-link":"SampleSelectionTable_nav-link__2FKrm",active:"SampleSelectionTable_active__3zFcz",modal:"SampleSelectionTable_modal__ydOej","modal-dialog":"SampleSelectionTable_modal-dialog__22pzO","modal-content":"SampleSelectionTable_modal-content__1SSm5","modal-body":"SampleSelectionTable_modal-body__Zy13v",samplesTable:"SampleSelectionTable_samplesTable__22wyB",check:"SampleSelectionTable_check__10k4A",slotNumber:"SampleSelectionTable_slotNumber__3EmqG",updated:"SampleSelectionTable_updated__3gISL",pluginsOk:"SampleSelectionTable_pluginsOk__2WwJQ",duplicateSlot:"SampleSelectionTable_duplicateSlot__3iAZw"}},6:function(q,ce,v){q.exports={"form-switch":"PluginsControl_form-switch__3fmtf","form-check-input":"PluginsControl_form-check-input__1Mkof","nav-pills":"PluginsControl_nav-pills__adctY","nav-item":"PluginsControl_nav-item__1SWdw","nav-link":"PluginsControl_nav-link__yhbJ-",active:"PluginsControl_active__1A5Hk",modal:"PluginsControl_modal__InGnV","modal-dialog":"PluginsControl_modal-dialog__3KCt7","modal-content":"PluginsControl_modal-content__1WdCY","modal-body":"PluginsControl_modal-body__1Uv3b",pluginsControlWrapper:"PluginsControl_pluginsControlWrapper__q5iAB",label:"PluginsControl_label__kLVrr",previewValue:"PluginsControl_previewValue__64ltB",expanded:"PluginsControl_expanded__24A6j",pluginsInfoIcon:"PluginsControl_pluginsInfoIcon__Gne2z",showOnExpanded:"PluginsControl_showOnExpanded__1TNSA",reloadPlugins:"PluginsControl_reloadPlugins__2k_Vv",pluginsErrorIcon:"PluginsControl_pluginsErrorIcon__3r2wc",pluginsControl:"PluginsControl_pluginsControl__ltvnS",pluginList:"PluginsControl_pluginList__27BYG",pluginItem:"PluginsControl_pluginItem__IoIKf",header:"PluginsControl_header__2yo7r",pluginName:"PluginsControl_pluginName__1ddse",pluginHasError:"PluginsControl_pluginHasError__2TUBF",actions:"PluginsControl_actions__3H5Yo",actionIcon:"PluginsControl_actionIcon__2Z6dO",disabled:"PluginsControl_disabled__2aZib",toggle:"PluginsControl_toggle__2Onzw",on:"PluginsControl_on__2G9RV",errorIcon:"PluginsControl_errorIcon__1JwZ0",paramsList:"PluginsControl_paramsList__2WFN_",paramControl:"PluginsControl_paramControl__1MpEL",paramControlInputGroup:"PluginsControl_paramControlInputGroup__3mVTF",pluginOptions:"PluginsControl_pluginOptions__n5aSd",addAPlugin:"PluginsControl_addAPlugin__2uhk_",managePlugins:"PluginsControl_managePlugins__1qg0X"}},8:function(q,ce,v){q.exports={"form-switch":"PluginManager_form-switch__2AjCp","form-check-input":"PluginManager_form-check-input__1Amq0","nav-pills":"PluginManager_nav-pills__1uWgb","nav-item":"PluginManager_nav-item__2CldT","nav-link":"PluginManager_nav-link__3frFE",active:"PluginManager_active__4B263",modal:"PluginManager_modal__1Bcfx","modal-dialog":"PluginManager_modal-dialog__IgRvW","modal-content":"PluginManager_modal-content__3qv8v","modal-body":"PluginManager_modal-body__3UE84",pluginListTitle:"PluginManager_pluginListTitle__3xXAW",installPlugin:"PluginManager_installPlugin__1Jc4T",noneInstalled:"PluginManager_noneInstalled__1Z0C1",pluginItem:"PluginManager_pluginItem__3nPlB",suggestedPlugins:"PluginManager_suggestedPlugins__C5JT2",nameAndInfo:"PluginManager_nameAndInfo__38PDg",name:"PluginManager_name__3zPbE",rename:"PluginManager_rename__2UyjF",info:"PluginManager_info__2PKgu",actions:"PluginManager_actions__2givK",reloadPlugin:"PluginManager_reloadPlugin__3KHMW",uninstallButton:"PluginManager_uninstallButton__l7bgA",uninstallModal:"PluginManager_uninstallModal__l23vs",alreadyInstalledModal:"PluginManager_alreadyInstalledModal__25bdp",failedToInstallModal:"PluginManager_failedToInstallModal__3LmeI",suggestedPluginsTitle:"PluginManager_suggestedPluginsTitle__klLsm",installSuggestedPlugin:"PluginManager_installSuggestedPlugin__3QX7g",viewSource:"PluginManager_viewSource__QbkyA",downloadPlugin:"PluginManager_downloadPlugin__1q79_"}}},[[200,1,2]]]);

//# sourceMappingURL=main.1e2fe5c3.chunk.js.map