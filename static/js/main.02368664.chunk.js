(this["webpackJsonpvolca-sampler"]=this["webpackJsonpvolca-sampler"]||[]).push([[0],{120:function(j,Q,p){j.exports={"form-switch":"NormalizeSwitch_form-switch__pmDx5","form-check-input":"NormalizeSwitch_form-check-input__trt4D","nav-pills":"NormalizeSwitch_nav-pills__1ruyA","nav-item":"NormalizeSwitch_nav-item__1nWyi","nav-link":"NormalizeSwitch_nav-link__3zD0e",active:"NormalizeSwitch_active__Rj-X-",modal:"NormalizeSwitch_modal__W4W97","modal-dialog":"NormalizeSwitch_modal-dialog__5EoUU","modal-content":"NormalizeSwitch_modal-content__B5Su2","modal-body":"NormalizeSwitch_modal-body__2_WMd",normalizeControlWrapper:"NormalizeSwitch_normalizeControlWrapper__3yf2V"}},123:function(j,Q,p){j.exports={waveformContainer:"WaveformReadonly_waveformContainer__RARS4"}},132:function(j,Q,p){},133:function(j,Q,p){},15:function(j,Q,p){j.exports={"form-switch":"SampleRecord_form-switch__q05a7","form-check-input":"SampleRecord_form-check-input__2QPKW","nav-pills":"SampleRecord_nav-pills__13Twr","nav-item":"SampleRecord_nav-item__2ev6Y","nav-link":"SampleRecord_nav-link__2-Nbr",active:"SampleRecord_active__15Zfs",modal:"SampleRecord_modal__38Mx7","modal-dialog":"SampleRecord_modal-dialog__3j_d9","modal-content":"SampleRecord_modal-content__1rv-K","modal-body":"SampleRecord_modal-body__3BRoG",container:"SampleRecord_container__3bdq5",audioInputHeader:"SampleRecord_audioInputHeader__1Prbd",channelOptionSelect:"SampleRecord_channelOptionSelect__235gz",channelOption:"SampleRecord_channelOption__31f9w",stereoExplanation:"SampleRecord_stereoExplanation__3SWiA",alertContainer:"SampleRecord_alertContainer__vjGNP",recordButton:"SampleRecord_recordButton__3R-KX",mainText:"SampleRecord_mainText__2dca6",timeRecorded:"SampleRecord_timeRecorded__3FGTe",importFileButton:"SampleRecord_importFileButton__3Zl2W",osTabs:"SampleRecord_osTabs__1CZdV",systemRecordModalBody:"SampleRecord_systemRecordModalBody__15hmN"}},169:function(j,Q,p){"use strict";p.r(Q);var c=p(0),e=p.n(c),Ot=p(9),Ra=p.n(Ot),Sr=p(132),wr=p(133),Le=p(173),be=p(125),Na=p(28),he=p.n(Na),Ia=e.a.memo(function({onHeaderClick:a}){return e.a.createElement("div",{className:he.a.titleBar},e.a.createElement(Le.a,{fluid:"sm",className:he.a.titleContainer},e.a.createElement("h1",{className:he.a.title,onClick:a},e.a.createElement("span",{className:he.a.titleText,"data-text":"Volca Sample"},"Volca Sample",e.a.createElement("span",{className:he.a.titleR},"r"),e.a.createElement("svg",{viewBox:"0 0 150 150",preserveAspectRatio:"none",className:he.a.titleStarburst},Array(24).fill().map((n,r,{length:l})=>e.a.createElement("polygon",{key:r,points:"75,70 75,80 150,75","transform-origin":"75 75",style:{"--rotation":`${r*360/l}deg`}})))),e.a.createElement("img",{className:he.a.titleGraphic,src:"volca_sample.png",alt:""}),e.a.createElement("div",{className:he.a.tagline},e.a.createElement("h2",null,"for volca sample")))),e.a.createElement("svg",{width:0,height:0},e.a.createElement("filter",{id:"outline"},e.a.createElement("feMorphology",{in:"SourceAlpha",result:"DILATED",operator:"dilate",radius:"1"}),e.a.createElement("feFlood",{floodColor:"var(--stroke-color)",floodOpacity:"1",result:"PINK"}),e.a.createElement("feComposite",{in:"PINK",in2:"DILATED",operator:"in",result:"OUTLINE"}),e.a.createElement("feMerge",null,e.a.createElement("feMergeNode",{in:"OUTLINE"}),e.a.createElement("feMergeNode",{in:"SourceGraphic"})))))}),me=p(182),de=p(119),La=p(177),Me=p(124),x=p(80),L=p(180),Y=p(179),At=p(69),Dt=p(174),Rt=p(175),Ma=p(70),Nt=p.n(Ma),Pa=p(62),xe=p.n(Pa),It=p(183),Lt=p(106);const We=31250;function rt(t){return t.toLocaleString([],{dateStyle:"medium",timeStyle:"short"})}function He(t,a){return`0:${t.toFixed(a).padStart(3+a,"0")}`}function Mt(t){return`${Math.floor(t/60)}m ${Math.floor(t%60)}s`}var Pt=(t,a,n)=>new Promise((r,l)=>{var u=o=>{try{s(n.next(o))}catch(m){l(m)}},i=o=>{try{s(n.throw(o))}catch(m){l(m)}},s=o=>o.done?r(o.value):Promise.resolve(o.value).then(u,i);s((n=n.apply(t,a)).next())});const ke=6,jt=ke*44;function Tt(t,a){const n=Math.floor(ke*t.length/a),r=new Float32Array(Math.floor(t.length/n)),l=new Float32Array(Math.floor(t.length/n));for(let o=0;o<r.length;o++){const m=new Float32Array(t.buffer,o*n*4,n);let f=0,E=0;for(const h of m)h>f&&(f=h),h<E&&(E=h);r[o]=Math.min(1,f),l[o]=Math.max(-1,E)}const u=t.length%n,i=new Float32Array(r.length+l.length+u);i.set(r,0),i.set(l,r.length),i.set(new Float32Array(t.buffer,(t.length-u)*4,u),r.length+l.length);const s=Oe(i);return{positive:r,negative:l,normalizationCoefficient:1/s}}function ot(t,a){return Pt(this,null,function*(){const n=Ye(t,a);return Tt(n,jt)})}function Bt(t){const[a,n]=Object(c.useState)(null);Object(c.useEffect)(()=>{let l=!1;return(()=>Pt(this,null,function*(){if(l)return;const u=yield $e(t.metadata.sourceFileId,Boolean(t.metadata.userFileInfo));l||n([t.metadata.sourceFileId,u])}))(),()=>{l=!0}},[t.metadata.sourceFileId,t.metadata.userFileInfo]);const r=Object(c.useRef)(t);return a&&t.metadata.sourceFileId===a[0]&&(r.current=t),{sample:r.current,sourceAudioBuffer:a&&a[1]}}function Ft(t){const a=Object(c.useMemo)(()=>t?Ye(t,[0,0]):new Float32Array,[t]),[n,r]=Object(c.useState)(null),[l,u]=Object(c.useState)({width:0,height:0}),i=Object(c.useMemo)(()=>n&&(l.width||n.offsetWidth),[n,l]),s=Object(c.useMemo)(()=>!i||!a.length?{positive:new Float32Array,negative:new Float32Array,normalizationCoefficient:1/0}:Tt(a,i),[i,a]);return{monoSamples:a,waveformRef:r,pixelWidth:i,peaks:s,onResize:u}}function lt(t,a=!1){const{playAudioBuffer:n}=Zt(),r=Object(c.useRef)(()=>{}),[l,u]=Object(c.useState)(null);Object(c.useEffect)(()=>{t&&l&&(u(null),l.fn())},[t,l]);const[i,s]=Object(c.useState)(0),[o,m]=Object(c.useState)(!1),[f,E]=Object(c.useState)("");Object(c.useEffect)(()=>{t&&E(He(o?i*t.duration:t.duration,1))},[t,o,i]);const h=Object(c.useCallback)(b=>{if(o)r.current();else if(t)r.current=n(t,{onTimeUpdate(v){s(v/t.duration)},onEnded(){m(!1)}}),s(0),m(!0);else{const v=b.target;u({fn:()=>v.dispatchEvent(b)})}},[o,n,t]);Object(c.useEffect)(()=>{if(!a)return;function b(v){document.querySelector('[role="dialog"]')||v.key===" "&&(v.preventDefault(),h(v))}return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[a,h]);const S=Object(c.useCallback)(()=>r.current(),[]);return{isPlaybackActive:o,playbackProgress:i,displayedTime:f,togglePlayback:h,stopPlayback:S}}var ja=Object.defineProperty,Ta=Object.defineProperties,Ba=Object.getOwnPropertyDescriptors,Ve=Object.getOwnPropertySymbols,xt=Object.prototype.hasOwnProperty,Wt=Object.prototype.propertyIsEnumerable,ct=(t,a,n)=>a in t?ja(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,te=(t,a)=>{for(var n in a||(a={}))xt.call(a,n)&&ct(t,n,a[n]);if(Ve)for(var n of Ve(a))Wt.call(a,n)&&ct(t,n,a[n]);return t},fe=(t,a)=>Ta(t,Ba(a)),ze=(t,a)=>{var n={};for(var r in t)xt.call(t,r)&&a.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Ve)for(var r of Ve(t))a.indexOf(r)<0&&Wt.call(t,r)&&(n[r]=t[r]);return n},Ue=(t,a,n)=>(ct(t,typeof a!="symbol"?a+"":a,n),n),le=(t,a,n)=>new Promise((r,l)=>{var u=o=>{try{s(n.next(o))}catch(m){l(m)}},i=o=>{try{s(n.throw(o))}catch(m){l(m)}},s=o=>o.done?r(o.value):Promise.resolve(o.value).then(u,i);s((n=n.apply(t,a)).next())});const Ge=xe.a.createInstance({name:"audio_file_data",driver:xe.a.INDEXEDDB}),Pe=xe.a.createInstance({name:"sample_metadata",driver:xe.a.INDEXEDDB});function Fa(t){return le(this,null,function*(){const a=Object(It.a)();return yield Ge.setItem(a,t),a})}const it="0.5.0",xa={"0.1.0":t=>{const a=t,{clip:n}=a,r=ze(a,["clip"]);return fe(te({},r),{trimFrames:n.map(u=>Math.round(u*We)),metadataVersion:"0.2.0"})},"0.2.0":t=>le(void 0,null,function*(){const a=t,{trimFrames:n}=a,r=ze(a,["trimFrames"]),l=yield $e(r.sourceFileId,!1),u=yield ot(l,n),i={frames:n,waveformPeaks:u};return fe(te({},r),{trim:i,metadataVersion:"0.3.0"})}),"0.3.0":t=>{const a=t,{dateSampled:n,dateModified:r}=a,l=ze(a,["dateSampled","dateModified"]);return fe(te({},l),{dateSampled:new Date(n).toISOString(),dateModified:new Date(r).toISOString(),metadataVersion:"0.4.0"})},"0.4.0":t=>le(void 0,null,function*(){const a=t,{scaleCoefficient:n,trim:{frames:r,waveformPeaks:l}}=a,u=ze(a,["scaleCoefficient","trim"]),i=yield $e(u.sourceFileId,!1),s=Ye(i,r),o=Oe(s);return fe(te({},u),{normalize:n!==1,trim:{frames:r,waveformPeaks:fe(te({},l),{normalizationCoefficient:1/o})},metadataVersion:"0.5.0"})})};let Qe=typeof window!="undefined"&&new URLSearchParams(window.location.search).has("reloaded_to_upgrade");function Wa(){const t=new URL(window.location.href),a=new URLSearchParams(window.location.search);a.set("reloaded_to_upgrade","true"),t.search=a.toString(),window.location.replace(t.href)}function Ht(){const t=new URL(window.location.href),a=new URLSearchParams(window.location.search);a.delete("reloaded_to_upgrade"),t.search=a.toString(),window.history.replaceState({},"",t),Qe=!1}function Vt(t){return le(this,null,function*(){let a=t;for(;a.metadataVersion!==it;){const n=xa[a.metadataVersion];if(!n){Qe||Wa(),console.warn(`Failed to properly upgrade metadata for sample "${a.name}"`),a={name:a.name,sourceFileId:a.sourceFileId,id:a.id,metadataVersion:it};break}a=yield n(a)}return a})}const Se=class{constructor({name:t,sourceFileId:a,trim:n,id:r=Object(It.a)(),userFileInfo:l=null,slotNumber:u=0,dateSampled:i=new Date().toISOString(),dateModified:s=i,useCompression:o=!0,qualityBitDepth:m=16,normalize:f=!0}){this.id=r,this.metadata={name:t,sourceFileId:a,trim:n,userFileInfo:l,slotNumber:u,dateSampled:i,dateModified:s,useCompression:o,qualityBitDepth:m,normalize:f,metadataVersion:it}}duplicate(t){const a=new Se.Mutable(fe(te({},this.metadata),{name:`${this.metadata.name} (copy)`,dateModified:new Date().toISOString()}));return a.persist().then(()=>t&&t(a.id)),a}static cacheSourceFileData(t,a){this.sourceFileData.set(t,a),this.recentlyCachedSourceFileIds=[t,...this.recentlyCachedSourceFileIds.filter(r=>r!==t)];const n=this.recentlyCachedSourceFileIds.slice(this.MAX_CACHED);for(const r of n)this.sourceFileData.delete(r);this.recentlyCachedSourceFileIds=this.recentlyCachedSourceFileIds.slice(0,this.MAX_CACHED)}static getSourceFileData(t){return le(this,null,function*(){{const n=this.sourceFileData.get(t);if(n)return n}if(t.includes(".")){const n=yield fetch(t);if(n.status>=400)return Promise.reject(new Error(`Failed to fetch source file "${t}"`));const r=yield n.arrayBuffer(),l=new Uint8Array(r);return this.cacheSourceFileData(t,l),l}const a=yield Ge.getItem(t);return a?a instanceof Uint8Array?(this.cacheSourceFileData(t,a),a):Promise.reject("Source data is of unexpected type"):Promise.reject("Missing source data")})}static getAllMetadataFromStore(){return le(this,null,function*(){const t=new Map,a=[];return yield Pe.iterate((n,r)=>{n&&a.push(Vt(n).then(l=>{t.set(r,l)}).catch(l=>{console.error(l),console.warn(`Failed to upgrade metadata "${r}" (${n.name}); ignoring.`)}))}),yield Promise.all(a),Qe&&Ht(),t})}static getAllFromStorage(){return le(this,null,function*(){const t=yield this.getAllMetadataFromStore(),a=yield zt(),n=(yield Ge.keys()).concat(a.map(({sourceFileId:l})=>l));return[...t].map(([l,u])=>{const{sourceFileId:i}=u;return n.includes(i)?new Se.Mutable(te({id:l},u)):(console.warn(`Found metadata "${u.name||l}" with missing data "${i}; ignoring.`),null)}).filter(Boolean).sort(({metadata:{dateModified:l}},{metadata:{dateModified:u}})=>l>u?-1:u>l?1:0)})}static getOneFromStorage(t){return le(this,null,function*(){const a=yield Pe.getItem(t),n=yield Vt(a),r=new Se.Mutable(te({id:t},n)),{sourceFileId:l}=r.metadata;return this.recentlyCachedSourceFileIds.filter(u=>u!==l),this.sourceFileData.delete(l),Qe&&Ht(),r})}};let Z=Se;Ue(Z,"Mutable",class extends Se{constructor(t){super(t);setTimeout(()=>le(this,null,function*(){(yield Pe.keys()).includes(this.id)||console.warn(`Expected sample metadata container ${this.id} to be persisted`)}))}persist(){return le(this,null,function*(){yield Pe.setItem(this.id,this.metadata)})}update(t,a){const{id:n,metadata:r}=this,l=typeof t=="function"?t(r):t;if(Object.keys(l).every(s=>l[s]===r[s]))return this;const u=fe(te(te({},r),l),{dateModified:new Date().toISOString()}),i=new Se.Mutable(te({id:n},u));return i.persist().then(a),i}remove(){return le(this,null,function*(){if(yield Pe.removeItem(this.id),this.metadata.sourceFileId.includes("."))return;const t=yield Se.getAllMetadataFromStore();for(const[,{sourceFileId:a}]of t)if(a===this.metadata.sourceFileId)return;yield Ge.removeItem(this.metadata.sourceFileId)})}}),Ue(Z,"sourceFileData",new Map),Ue(Z,"recentlyCachedSourceFileIds",[]),Ue(Z,"MAX_CACHED",10);let st;function zt(){return st||(st=fetch("factory-samples.json").then(t=>t.json())),st}function Ha(){return le(this,null,function*(){const t=yield zt();return new Map(t.map(a=>[a.id,new Z(fe(te({},a),{normalize:!1,trim:{frames:[a.trim.frames[0],a.trim.frames[1]],waveformPeaks:fe(te({},a.trim.waveformPeaks),{positive:new Float32Array(Object(Lt.a)(a.trim.waveformPeaks.positive)),negative:new Float32Array(Object(Lt.a)(a.trim.waveformPeaks.negative))})}}))]))})}var Ut=Math.pow,ut=(t,a,n)=>new Promise((r,l)=>{var u=o=>{try{s(n.next(o))}catch(m){l(m)}},i=o=>{try{s(n.throw(o))}catch(m){l(m)}},s=o=>o.done?r(o.value):Promise.resolve(o.value).then(u,i);s((n=n.apply(t,a)).next())});function Ke(t,a){const n=4,r=a[0]*n,l=t.length-a[0]-a[1];return new Float32Array(t.buffer,r,l)}function Ye(t,a){const n=t.length-a[0]-a[1],r=new Float32Array(n),l=Array(t.numberOfChannels).fill().map((u,i)=>Ke(t.getChannelData(i),a));for(let u=0;u<n;u++){let i=0;for(let s=0;s<l.length;s++)i+=l[s][u];i/=l.length,r[u]=i}return r}function Oe(t){let a=0;for(const n of t){const r=Math.abs(n);r>a&&(a=r)}return a}function Va(t,a){if(a!==1)for(let n=0;n<t.length;n++)t[n]*=a}function za(t){const a=Oe(t);Va(t,1/a)}function Ua(t,a){const n=Ut(2,a-1);for(let r=0;r<t.length;r++)t[r]=Math.round(t[r]*n)/n}function Gt(t){for(let a=0;a<t.length;a++)t[a]>1?t[a]=1:t[a]<-1&&(t[a]=-1)}function Ga(t){const a=t.length,n=t[0].length,r=new Float32Array(a*n);for(let l=0;l<r.length;l++){const u=a*l;for(let i=0;i<a;i++)r[u+i]=t[i][l]}return r}function Qt(t){const a=new Int16Array(t.length),n=Ut(2,15);for(let r=0;r<t.length;r++)a[r]=t[r]===1?n-1:n*t[r];return a}function Kt(){return window.AudioContext||window.webkitAudioContext}let Yt;function $t(){const t=Kt();return Yt=Yt||new t({sampleRate:We})}function je(t){return ut(this,null,function*(){const a=new Uint8Array(t);return yield new Promise((r,l)=>{$t().decodeAudioData(a.buffer,r,l)})})}function $e(t,a){return ut(this,null,function*(){const n=yield Z.getSourceFileData(t),r=yield je(n);if(a)for(let l=0;l<r.numberOfChannels;l++)Gt(r.getChannelData(l));return r})}function Xt(t,a){return ut(this,null,function*(){const{qualityBitDepth:n,sourceFileId:r,userFileInfo:l,normalize:u,trim:{frames:i}}=t.metadata;if(n<8||n>16||!Number.isInteger(n))throw new Error(`Expected bit depth between 8 and 16. Received: ${n}`);const s=yield $e(r,Boolean(l)),o=s.numberOfChannels===1?Ke(s.getChannelData(0),i):Ye(s,i);u&&za(o),a&&n<16&&Ua(o,n);const m=Qt(o),f=m.length*2,E=Nt()({channels:1,sampleRate:s.sampleRate,bitDepth:16,dataLength:f}),h=new Uint8Array(E.length+f);return h.set(E),h.set(new Uint8Array(m.buffer),E.length),{data:h,sampleRate:16}})}function mt(t,a=!0){const[n,r]=Object(c.useState)(null),[l,u]=Object(c.useState)(null);return Object(c.useEffect)(()=>{if(!a)return;r(null);let i=!1;Xt(t,!0).then(({data:s})=>{i||r(s)})},[t,a]),Object(c.useEffect)(()=>{if(u(null),n){let i=!1;je(n).then(s=>{i||u(s)})}},[n]),{wav:n,audioBuffer:l}}const Qa={playAudioBuffer(t,a){throw new Error("Must render AudioPlaybackContextProvider")}},Jt=Object(c.createContext)(Qa);function Ka({children:t}){const a=Object(c.useRef)(()=>{}),n=Object(c.useCallback)((l,{onTimeUpdate:u=()=>null,onEnded:i=()=>null}={})=>{a.current();const s=$t(),o=s.createBufferSource();o.buffer=l,o.connect(s.destination),o.start();const m=s.currentTime;u(0);let f=requestAnimationFrame(E);function E(){u(s.currentTime-m),f=requestAnimationFrame(E)}let h=!1;o.addEventListener("ended",()=>{h||(u(l.duration),i()),cancelAnimationFrame(f)});function S(){h||(o.stop(),cancelAnimationFrame(f),i(),h=!0)}return a.current=S,S},[]),r=Object(c.useMemo)(()=>({playAudioBuffer:n}),[n]);return Object(c.createElement)(Jt.Provider,{value:r},t)}function Zt(){return Object(c.useContext)(Jt)}var Ya=p(116),$a=p(117),Xa=Object.defineProperty,qt=Object.getOwnPropertySymbols,Ja=Object.prototype.hasOwnProperty,Za=Object.prototype.propertyIsEnumerable,ea=(t,a,n)=>a in t?Xa(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,ta=(t,a)=>{for(var n in a||(a={}))Ja.call(a,n)&&ea(t,n,a[n]);if(qt)for(var n of qt(a))Za.call(a,n)&&ea(t,n,a[n]);return t};const qa=Ya.a.canvas({width:"100%",height:"100%",display:"block",imageRendering:"pixelated"});function en(t,a){function n(l,u){t.width=l,t.height=u}n(t.offsetWidth,t.offsetHeight),a({width:t.offsetWidth,height:t.offsetHeight});const r=new $a.a(([l])=>{const{width:u,height:i}=l.contentRect;n(u,i),a({width:u,height:i})});return r.observe(t),()=>r.disconnect()}function tn(t,a,n){const r=getComputedStyle(document.documentElement),l=r.getPropertyValue("--bs-primary"),u=r.getPropertyValue("--bs-primary-darkened"),i=t.getContext("2d");i.imageSmoothingEnabled=!1;const{width:s,height:o}=t;i.clearRect(0,0,s,o);const m=Math.floor(o*(2/3))+1;i.fillStyle=l,a.positive.forEach((E,h)=>{const S=m*E,b=Math.max(Math.round(n*S),1);i.fillRect(h*ke,m-b,ke-1,b)});const f=o-m;i.fillStyle=u,a.negative.forEach((E,h)=>{const S=f*E*-1,b=Math.round(n*S);i.fillRect(h*ke,m,ke-1,b)})}function an({peaks:t,scaleCoefficient:a,waveformRef:n,onResize:r}){const l=Object(c.useRef)(null);Object(c.useImperativeHandle)(n,()=>l.current);const[u,i]=Object(c.useState)(Symbol()),s=Object(c.useRef)({width:0,height:0});return Object(c.useLayoutEffect)(()=>{if(!l.current)throw new Error("Canvas should be defined");return s.current.width=l.current.offsetWidth,s.current.height=l.current.offsetHeight,r&&r(ta({},s.current)),en(l.current,({width:o,height:m})=>{(o!==s.current.width||m!==s.current.height)&&(i(Symbol()),s.current.width=o,s.current.height=m,r&&r(ta({},s.current)))})},[r]),Object(c.useLayoutEffect)(()=>{const o=l.current;if(!o)throw new Error("Canvas should be defined");let m=requestAnimationFrame(()=>{m=requestAnimationFrame(()=>{tn(o,t,a===void 0?t.normalizationCoefficient:a)})});return()=>cancelAnimationFrame(m)},[t,a,u]),e.a.createElement(qa,{ref:l})}var dt=an,aa=p(71),na=p(72),nn=p(118);function ra(t,a){const n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=a,r.style.display="none",document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(n)}var rn=p(24),ve=p.n(rn),on=(t,a,n)=>new Promise((r,l)=>{var u=o=>{try{s(n.next(o))}catch(m){l(m)}},i=o=>{try{s(n.throw(o))}catch(m){l(m)}},s=o=>o.done?r(o.value):Promise.resolve(o.value).then(u,i);s((n=n.apply(t,a)).next())}),oa=e.a.memo(function({isPlaybackActive:a,playbackProgress:n,displayedTime:r,downloadFilename:l,wavFile:u,togglePlayback:i}){const s=Object(c.useCallback)(()=>on(this,null,function*(){if(u){const o=new Blob([u],{type:"audio/x-wav"});ra(o,l)}}),[l,u]);return e.a.createElement(e.a.Fragment,null,e.a.createElement("div",{className:[ve.a.playbackOverlay,a?ve.a.playbackActive:""].join(" "),style:{"--playback-progress":`${100*n}%`}},e.a.createElement("div",{className:ve.a.playback})),e.a.createElement("div",{className:ve.a.playbackButtonContainer},e.a.createElement(me.a,{delay:{show:400,hide:0},overlay:e.a.createElement(de.a,null,"Preview how your sample will sound on the volca sample")},e.a.createElement(x.a,{variant:"dark",onClick:o=>i(o.nativeEvent)},a?e.a.createElement(na.a,null):e.a.createElement(aa.a,null))),r&&e.a.createElement("span",null,r)),e.a.createElement(me.a,{delay:{show:400,hide:0},overlay:e.a.createElement(de.a,null,"Download a copy of the audio that will be transferred to the volca sample")},e.a.createElement(x.a,{className:ve.a.downloadButton,type:"button",variant:"dark",size:"sm",onClick:s,disabled:!u},e.a.createElement(nn.a,null))))}),ln=p(120),cn=p.n(ln),sn=e.a.memo(function({sampleId:a,normalize:n,onSampleUpdate:r}){return e.a.createElement(me.a,{delay:{show:400,hide:0},overlay:e.a.createElement(de.a,null,"Boosts your sample's volume so its peak is at the same level as your other normalized samples")},e.a.createElement("div",{className:cn.a.normalizeControlWrapper},e.a.createElement(Y.a.Switch,{label:e.a.createElement("span",{onClick:()=>r(a,l=>({normalize:!l.normalize}))},"Normalize"),checked:n,onChange:l=>r(a,{normalize:l.target.checked})})))}),un=p(8),X=p.n(un),mn=(t,a,n)=>new Promise((r,l)=>{var u=o=>{try{s(n.next(o))}catch(m){l(m)}},i=o=>{try{s(n.throw(o))}catch(m){l(m)}},s=o=>o.done?r(o.value):Promise.resolve(o.value).then(u,i);s((n=n.apply(t,a)).next())}),dn=e.a.memo(function({sample:a,onSampleUpdate:n}){const{wav:r,audioBuffer:l}=mt(a),{sample:{id:u,metadata:{name:i,trim:{frames:s},normalize:o}},sourceAudioBuffer:m}=Bt(a),{monoSamples:f,waveformRef:E,pixelWidth:h,peaks:S,onResize:b}=Ft(m),v=Object(c.useMemo)(()=>{if(!m)return 0;const I=Ke(f,s);return Oe(I)},[m,f,s]),_=1/v,[C,M]=Object(c.useState)({trimFrames:s,cursor:null});Object(c.useEffect)(()=>{M({trimFrames:s,cursor:null})},[s]);const O=Object(c.useMemo)(()=>{if(!f.length||!h)return[0,0];const I=h/f.length;return C.trimFrames.map(H=>H*I)},[h,f.length,C.trimFrames]),D=Object(c.useRef)(C);D.current=C;const d=Object(c.useRef)(a.id);d.current=a.id;const w=Object(c.useRef)(0),k=Object(c.useCallback)(()=>mn(this,null,function*(){if(!m||u!==d.current)return;let I=w.current=Math.random();const{trimFrames:H}=D.current,ne=yield ot(m,H);w.current===I&&n(u,re=>re.trim.frames.every(($,ie)=>H[ie]===$)?re:{trim:{frames:H,waveformPeaks:ne}})}),[u,m,n]),R=Object(c.useRef)(!1);Object(c.useEffect)(()=>{R.current&&(k(),R.current=!1)},[C,k]);const y=Object(c.useCallback)(()=>{R.current=!0,M({trimFrames:[0,0],cursor:null})},[]),F=Object(c.useRef)(null),T=Object(c.useRef)(null),P=Object(c.useRef)(null);{const I=Object(c.useRef)(null),H=Object(c.useRef)(null),ne=Object(c.useRef)(null),re=Object(c.useRef)(!1),$=Object(c.useRef)(null);Object(c.useLayoutEffect)(()=>{$.current&&(clearTimeout($.current),$.current=null)},[C]);const ie=Object(c.useMemo)(()=>{if(!h||!f.length)return null;const U=Math.max(2e3,Math.ceil(10*f.length/h));return{pixelWidth:h,monoSamplesLength:f.length,minFrameWidth:U}},[h,f.length]);Object(c.useEffect)(()=>{if(!ie||!F.current||!T.current||!P.current)return;const V=F.current,U=T.current,q=P.current,{pixelWidth:Re,monoSamplesLength:se,minFrameWidth:Ne}=ie;let yt=0;function br(){yt=q.getBoundingClientRect().left}function et(g){g instanceof TouchEvent&&g.preventDefault(),document.body.style.userSelect="none";const{pageX:W}=g instanceof MouseEvent?g:g.touches[0];I.current=W}function tt(g){g instanceof TouchEvent&&g.preventDefault(),document.body.style.userSelect="none";const{pageX:W}=g instanceof MouseEvent?g:g.touches[0];H.current=W}function at(g){if(g instanceof TouchEvent&&g.preventDefault(),g.detail===2){y();return}document.body.style.userSelect="none";const{clientX:W}=g instanceof MouseEvent?g:g.touches[0];br();const ee=Math.max(0,Math.min(Re,W-yt)),oe=ee/Re,z=Math.round(se*oe),_e=z+Ne,Ce=_e<se?_e:z-Ne;Ce<0||(M({trimFrames:[Math.min(z,Ce),se-1-Math.max(z,Ce)],cursor:ee-1}),ne.current=z)}function gt(g){const W=g/Re,ee=Math.round(se*W);M(({trimFrames:oe})=>{let z=oe[0]+ee;return z=Math.min(z,se-oe[1]-Ne),z=Math.max(z,0),{trimFrames:[z,oe[1]],cursor:null}})}function bt(g){if(I.current===null)return;g instanceof TouchEvent&&g.preventDefault();const{pageX:W}=g instanceof MouseEvent?g:g.touches[0],ee=W-I.current;ee&&(gt(ee),I.current=W)}function St(g){const W=g/Re,ee=Math.round(se*W);M(({trimFrames:oe})=>{let z=oe[1]+ee;return z=Math.min(z,se-oe[0]-Ne),z=Math.max(z,0),{trimFrames:[oe[0],z],cursor:null}})}function wt(g){if(H.current===null)return;g instanceof TouchEvent&&g.preventDefault();const{pageX:W}=g instanceof MouseEvent?g:g.touches[0],ee=H.current-W;ee&&(St(ee),H.current=W)}let nt=!1;function Oa(g){if(I.current!==null)return;let W=!0;switch(g.key){case"ArrowLeft":gt(-1);break;case"ArrowRight":gt(1);break;default:W=!1;break}W&&(g.stopPropagation(),g.preventDefault(),nt=!0)}function Aa(g){if(H.current!==null)return;let W=!0;switch(g.key){case"ArrowLeft":St(1);break;case"ArrowRight":St(-1);break;default:W=!1;break}W&&(g.stopPropagation(),g.preventDefault(),nt=!0)}function _t(g){if(ne.current===null)return;g instanceof TouchEvent&&g.preventDefault();const W=ne.current,{clientX:ee}=g instanceof MouseEvent?g:g.touches[0],oe=Math.max(0,Math.min(Re,ee-yt)),z=oe/Re,_e=Math.max(0,Math.min(se-1,Math.round(se*z)));if(_e!==ne.current){re.current=!0;const Ce=W+Ne,Ct=W-Ne,kt=_e>W?Ce<se?Math.max(_e,Ce):Ct:Ct>=0?Math.min(_e,Ct):Ce;M({trimFrames:[Math.min(W,kt),se-1-Math.max(W,kt)],cursor:W<kt?oe:oe-1})}}function Da(g){bt(g),wt(g),_t(g)}function G(g){(I.current!==null||H.current!==null||ne.current!==null||nt)&&((g instanceof TouchEvent||g instanceof KeyboardEvent)&&g.preventDefault(),ne.current&&!re.current&&g.detail===1?$.current=setTimeout(()=>{$.current=null,k()},250):k(),I.current=null,H.current=null,ne.current=null,re.current=!1,nt=!1),document.body.style.userSelect="unset"}function Ie(g){g.target instanceof Node&&q.contains(g.target)||$.current&&(clearTimeout($.current),$.current=null,k())}return V.addEventListener("touchstart",et),V.addEventListener("mousedown",et),U.addEventListener("touchstart",tt),U.addEventListener("mousedown",tt),q.addEventListener("touchstart",at),q.addEventListener("mousedown",at),V.addEventListener("touchmove",bt),U.addEventListener("touchmove",wt),V.addEventListener("keydown",Oa),U.addEventListener("keydown",Aa),q.addEventListener("touchmove",_t),window.addEventListener("mousemove",Da),V.addEventListener("touchend",G),V.addEventListener("touchcancel",G),V.addEventListener("keyup",G),U.addEventListener("touchend",G),U.addEventListener("keyup",G),U.addEventListener("touchcancel",G),q.addEventListener("touchend",G),q.addEventListener("touchcancel",G),window.addEventListener("mouseup",G),window.addEventListener("touchstart",Ie,{capture:!0}),window.addEventListener("mousedown",Ie,{capture:!0}),window.addEventListener("keydown",Ie,{capture:!0}),()=>{V.removeEventListener("touchstart",et),V.removeEventListener("mousedown",et),U.removeEventListener("touchstart",tt),U.removeEventListener("mousedown",tt),q.removeEventListener("touchstart",at),q.removeEventListener("mousedown",at),V.removeEventListener("touchmove",bt),U.removeEventListener("touchmove",wt),V.removeEventListener("keydown",Oa),U.removeEventListener("keydown",Aa),q.removeEventListener("touchmove",_t),window.removeEventListener("mousemove",Da),V.removeEventListener("touchend",G),V.removeEventListener("touchcancel",G),V.removeEventListener("keyup",G),U.removeEventListener("touchend",G),U.removeEventListener("keyup",G),U.removeEventListener("touchcancel",G),q.removeEventListener("touchend",G),q.removeEventListener("touchcancel",G),window.removeEventListener("mouseup",G),window.removeEventListener("touchstart",Ie,{capture:!0}),window.removeEventListener("mousedown",Ie,{capture:!0}),window.removeEventListener("keydown",Ie,{capture:!0})}},[ie,k,y])}const{isPlaybackActive:N,playbackProgress:B,displayedTime:J,togglePlayback:ae,stopPlayback:A}=lt(l,!0);Object(c.useEffect)(()=>A,[a,C,A]);const K=a.metadata.trim.frames.every(I=>I===0);return e.a.createElement(e.a.Fragment,null,e.a.createElement(me.a,{delay:{show:400,hide:0},overlay:e.a.createElement(de.a,null,"Normalization boosts your sample's volume so its peak is at the same level as your other normalized samples")},e.a.createElement(Y.a.Label,null,"Normalization basis")),e.a.createElement("br",null),e.a.createElement(Dt.a,null,["none","all","selection"].map(I=>e.a.createElement(me.a,{delay:{show:400,hide:0},overlay:e.a.createElement(de.a,null,I==="all"?"Normalized with respect to peak amplitude for full recorded audio":I==="selection"?"Normalized with respect to peak amplitude for selected audio":"Kept at originally recorded volume")},e.a.createElement(Rt.a,{key:I,type:"radio",size:"sm",variant:"outline-secondary",name:"normalize",value:I,checked:I==="none"},I==="all"?"Full recording":I==="selection"?"Selected audio":"None")))),e.a.createElement(Y.a.Group,{className:X.a.waveformAdjacentControls},e.a.createElement(sn,{sampleId:a.id,normalize:a.metadata.normalize,onSampleUpdate:n}),e.a.createElement(x.a,{type:"button",variant:"secondary",disabled:K,onClick:y},K?"All audio selected":"Select all audio")),e.a.createElement("div",{className:[X.a.waveformContainer,N?X.a.playbackActive:""].join(" "),style:{"--cursor-display":C.cursor===null?"none":"unset","--cursor-left":`${C.cursor}px`,"--trim-pixels-left":`${O[0]}px`,"--trim-pixels-right":`${O[1]}px`}},e.a.createElement(dt,{waveformRef:E,peaks:S,scaleCoefficient:o?_:1,onResize:b}),e.a.createElement(oa,{isPlaybackActive:N,playbackProgress:B,displayedTime:J,downloadFilename:`${i}.volcasample.wav`,wavFile:r,togglePlayback:ae}),e.a.createElement("div",{className:X.a.cursor}),e.a.createElement("div",{className:[X.a.trim,X.a.left].join(" ")},e.a.createElement("div",{className:X.a.bar}),e.a.createElement("div",{ref:F,className:X.a.handle,tabIndex:0}),m&&Boolean(f.length)&&e.a.createElement("span",{className:X.a.time},He(m.duration*C.trimFrames[0]/f.length,2))),e.a.createElement("div",{className:[X.a.trim,X.a.right].join(" ")},e.a.createElement("div",{className:X.a.bar}),e.a.createElement("div",{ref:T,className:X.a.handle,tabIndex:0}),m&&Boolean(f.length)&&e.a.createElement("span",{className:X.a.time},He(m.duration*(f.length-1-C.trimFrames[1])/f.length,2))),e.a.createElement("div",{ref:P,className:X.a.waveformOverlay})))}),fn=p(176),pn=p(121),la=(t,a,n)=>new Promise((r,l)=>{var u=o=>{try{s(n.next(o))}catch(m){l(m)}},i=o=>{try{s(n.throw(o))}catch(m){l(m)}},s=o=>o.done?r(o.value):Promise.resolve(o.value).then(u,i);s((n=n.apply(t,a)).next())});let ca;function hn(){return la(this,null,function*(){return typeof window.CREATE_SYRO_BINDINGS!="function"?Promise.reject("Expected CREATE_SYRO_BINDINGS global function to exist"):ca=ca||window.CREATE_SYRO_BINDINGS().then(t=>la(this,null,function*(){return{prepareSampleBufferFromWavData:t.cwrap("prepareSampleBufferFromWavData","number",["array","number","number","number","number"]),prepareSampleBufferFrom16BitPcmData(){throw new Error("This function does not work. Use prepareSampleBufferFromWavData.")},getSampleBufferChunkPointer:t.cwrap("getSampleBufferChunkPointer","number",["number"]),getSampleBufferChunkSize:t.cwrap("getSampleBufferChunkSize","number",["number"]),getSampleBufferProgress:t.cwrap("getSampleBufferProgress","number",["number"]),getSampleBufferTotalSize:t.cwrap("getSampleBufferTotalSize","number",["number"]),cancelSampleBufferWork:t.cwrap("cancelSampleBufferWork",null,["number"]),registerUpdateCallback(n){return t.addFunction(n,"vi")},unregisterUpdateCallback(n){t.removeFunction(n)},heap8Buffer(){return t.HEAP8.buffer}}}))})}var vn=(t,a,n)=>new Promise((r,l)=>{var u=o=>{try{s(n.next(o))}catch(m){l(m)}},i=o=>{try{s(n.throw(o))}catch(m){l(m)}},s=o=>o.done?r(o.value):Promise.resolve(o.value).then(u,i);s((n=n.apply(t,a)).next())});function En(t,a){let n=!1,r=()=>{};return{cancelWork(){n=!0,r()},sampleBufferPromise:(()=>vn(this,null,function*(){const{prepareSampleBufferFromWavData:l,getSampleBufferChunkPointer:u,getSampleBufferChunkSize:i,getSampleBufferProgress:s,getSampleBufferTotalSize:o,cancelSampleBufferWork:m,registerUpdateCallback:f,unregisterUpdateCallback:E,heap8Buffer:h}=yield hn(),S={sampleBuffer:new Uint8Array,dataSize:0};if(n)return S;const{data:b}=yield Xt(t);if(n)return S;let v,_=0;const C=f(O=>{if(n)return;const D=o(O);v||(v=new Uint8Array(D));const d=u(O),w=i(O),k=s(O);v.set(new Uint8Array(h(),d,w),k-w),_=k/D}),M=l(b,b.length,t.metadata.slotNumber,t.metadata.qualityBitDepth,t.metadata.useCompression?1:0,C);a(_);try{yield new Promise(O=>{let D;r=()=>{cancelAnimationFrame(D),m(M),O()},d();function d(){if(_&&(a(_),_>=1)){O();return}D=requestAnimationFrame(d)}})}finally{r=()=>{},E(C)}if(n)return S;if(!v)throw new Error("Unexpected condition: sampleBuffer should be defined");return{sampleBuffer:v,dataSize:b.length}}))()}}var yn=p(63),Xe=p.n(yn),ia=p(101),sa=p.n(ia),ft=p(102),pt=p(103),gn=p(25),pe=p.n(gn),ua=Math.pow;ia.Digit.defaultProps.offOpacity=0;const ma=(t,a)=>Math.min(199,a+ua(10,t)),da=(t,a)=>Math.max(0,a-ua(10,t));var bn=e.a.memo(function({slotNumber:t,onSlotNumberUpdate:a}){const[n,r]=Object(c.useState)(t);Object(c.useEffect)(()=>{r(t)},[t]);const[l,u]=Object(c.useState)(null),i=Object(c.useCallback)(f=>{a(E=>ma(f,E))},[a]),s=Object(c.useCallback)(f=>{a(E=>da(f,E))},[a]),o=Object(c.useRef)(null),m=Object(c.useRef)(null);{const f=Object(c.useRef)(l);f.current=l;const E=Object(c.useRef)(n);E.current=n,Object(c.useEffect)(()=>{if(!m.current)throw new Error("Expected elements to exist");function h(y){const F=f.current===null?0:f.current;let T=!0;const P=()=>{u(F)};switch(y.key){case"ArrowDown":P(),r(N=>da(F,N));break;case"ArrowUp":P(),r(N=>ma(F,N));break;case"ArrowLeft":P(),u(N=>N!==null&&N<2?N+1:N);break;case"ArrowRight":P(),u(N=>N&&N-1);break;case"Enter":case"Escape":u(null);break;default:T=!1;break}T&&y.preventDefault()}function S(y){const F=f.current===null?2:f.current;y.stopPropagation(),y.preventDefault();const T=E.current;if(isNaN(Number(y.key)))a(T);else{const P=String(T).padStart(3,"0").split("");P[2-F]=y.key;const N=Math.min(199,Math.max(0,Number(P.join(""))));u(F?F-1:null),a(N)}}const b=o.current;b.addEventListener("keydown",h,!0),b.addEventListener("keyup",S,!0);let v=0,_=!1,C=!1,M=0;function O(y){document.body.style.userSelect="none",v=y instanceof MouseEvent?y.pageY:y.touches[0].pageY,_=!0,C=!1,M=E.current}b.addEventListener("mousedown",O),b.addEventListener("touchstart",y=>{y.preventDefault(),O(y)});function D(y){if(!_)return;const{pageY:F}=y instanceof MouseEvent?y:y.touches[0],T=2,P=Math.round((v-F)/T);P&&(C=!0,r(Math.min(199,Math.max(0,M+P))))}window.addEventListener("mousemove",D),b.addEventListener("touchmove",D);function d(){document.body.style.userSelect="unset",_=!1,C&&a(E.current)}window.addEventListener("mouseup",d),b.addEventListener("touchend",d),b.addEventListener("touchcancel",()=>{document.body.style.userSelect="unset"});function w(y){C||m.current&&m.current.some(F=>F.contains(y.target))||u(2)}b.addEventListener("click",w),m.current.forEach((y,F)=>{const T=F;y.addEventListener("click",()=>{C||u(T)}),y.addEventListener("touchstart",P=>{P.preventDefault()})});function k(){_||u(2)}function R(){u(null)}return b.addEventListener("focus",k),b.addEventListener("blur",R),()=>{window.removeEventListener("mousemove",D),window.removeEventListener("mouseup",d)}},[a])}return Object(c.useEffect)(()=>{if(!m.current)throw new Error("Expected elements to exist");m.current.forEach((f,E)=>{E===l?f.classList.add(pe.a.active):f.classList.remove(pe.a.active)})},[l]),e.a.createElement(e.a.Fragment,null,e.a.createElement(Y.a.Label,null,"Choose destination"),e.a.createElement("br",null),e.a.createElement("div",{className:pe.a.slotNumberRow},e.a.createElement("div",{className:pe.a.slotNumberContainer},e.a.createElement("div",{className:pe.a.arrowControls},e.a.createElement("span",{onClick:()=>i(2)},e.a.createElement(ft.a,null)),e.a.createElement("span",{onClick:()=>i(1)},e.a.createElement(ft.a,null)),e.a.createElement("span",{onClick:()=>i(0)},e.a.createElement(ft.a,null))),e.a.createElement(me.a,{delay:{show:400,hide:0},placement:"right",overlay:e.a.createElement(de.a,null,"Slot ",n)},e.a.createElement("div",{className:pe.a.slotNumber,ref:o,tabIndex:0},e.a.createElement(sa.a,{value:"8888",color:"var(--bs-gray-dark)",strokeColor:"transparent",digitCount:4}),e.a.createElement(sa.a,{ref:f=>{const E=Object(Ot.findDOMNode)(f);if(E){E.querySelectorAll("circle").forEach(S=>{E.removeChild(S)});const h=document.createElementNS("http://www.w3.org/2000/svg","circle");h.classList.add(pe.a.point),h.setAttribute("cx","10.7"),h.setAttribute("cy","17"),h.setAttribute("r","1"),E.appendChild(h),m.current=[].slice.call(E.querySelectorAll("g")).reverse().slice(0,3)}},value:`5${String(n).padStart(3,"0")}`,digitProps:{color:"var(--bs-primary)"},digitCount:4}))),e.a.createElement("div",{className:pe.a.arrowControls},e.a.createElement("span",{onClick:()=>s(2)},e.a.createElement(pt.a,null)),e.a.createElement("span",{onClick:()=>s(1)},e.a.createElement(pt.a,null)),e.a.createElement("span",{onClick:()=>s(0)},e.a.createElement(pt.a,null)))),t>99&&n>99&&e.a.createElement(me.a,{placement:"auto-end",overlay:e.a.createElement(de.a,null,"To transfer to this destination, be sure you have a volca sample2. The original volca sample only supports slots 0-99.")},e.a.createElement("span",{className:pe.a.warning},e.a.createElement(At.a,null)))))}),Sn=(t,a,n)=>new Promise((r,l)=>{var u=o=>{try{s(n.next(o))}catch(m){l(m)}},i=o=>{try{s(n.throw(o))}catch(m){l(m)}},s=o=>o.done?r(o.value):Promise.resolve(o.value).then(u,i);s((n=n.apply(t,a)).next())});function wn({sample:t,onSlotNumberUpdate:a}){const[n,r]=Object(c.useState)(0),[l,u]=Object(c.useState)(!1),[i,s]=Object(c.useState)("idle");Object(c.useLayoutEffect)(()=>{i==="transferring"&&u(!1)},[i]);const[o,m]=Object(c.useState)(null),[f,E]=Object(c.useState)(null),[h,S]=Object(c.useState)(null);Object(c.useEffect)(()=>{f instanceof AudioBuffer&&h&&(S(null),h.fn())},[f,h]);const b=Object(c.useRef)(()=>{});Object(c.useEffect)(()=>{let O=!1;r(0),s("idle"),m(null),E(null),S(null),b.current=()=>{O=!0};try{const{sampleBufferPromise:D,cancelWork:d}=En(t,w=>{O||r(w)});b.current=()=>{d(),O=!0},D.then(w=>Sn(this,[w],function*({sampleBuffer:k,dataSize:R}){if(O)return;m(R),b.current=()=>{O=!0};const y=yield je(k);O||E(y)}))}catch(D){console.error(D),E(new Error(String(D)))}return()=>b.current()},[t]);const{playAudioBuffer:v}=Zt(),_=Object(c.useCallback)(O=>{if(!(f instanceof AudioBuffer)){if(!f){const{target:D,nativeEvent:d}=O;S({fn:()=>D.dispatchEvent(d)})}return}try{s("transferring");const D=v(f,{onTimeUpdate:d=>r(d/f.duration)});b.current=()=>{D(),s("idle")}}catch(D){console.error(D),s("error")}},[v,f]),C=Object(c.useCallback)(()=>b.current(),[]),M=i==="transferring"&&n<1;return e.a.createElement(e.a.Fragment,null,e.a.createElement("div",{className:Xe.a.transferInfo},e.a.createElement("strong",null,"Memory footprint:")," ",typeof o=="number"?Object(pn.a)(o).toString():"checking...",e.a.createElement("br",null),e.a.createElement("strong",null,"Time to transfer:")," ",f instanceof AudioBuffer?Mt(f.duration):f instanceof Error?"error":"checking..."),e.a.createElement(bn,{slotNumber:t.metadata.slotNumber,onSlotNumberUpdate:a}),e.a.createElement(x.a,{className:Xe.a.transferButton,type:"button",variant:"primary",onClick:()=>u(!0)},"Transfer to volca sample"),e.a.createElement(L.a,{onHide:()=>u(!1),className:Xe.a.preTransferModal,show:l,"aria-labelledby":"pre-transfer-modal"},e.a.createElement(L.a.Header,null,e.a.createElement(L.a.Title,{id:"pre-transfer-modal"},"Connect volca sample before continuing")),e.a.createElement(L.a.Body,null,e.a.createElement("figure",null,e.a.createElement("img",{src:"connection.png",alt:""}),e.a.createElement("figcaption",{className:"small"},"Source:"," ",e.a.createElement("a",{href:"https://github.com/korginc/volcasample#6-transferring-syrostream-to-your-volca-sample",target:"_blank",rel:"noreferrer"},"KORG"))),e.a.createElement("p",null,"Make sure your ",e.a.createElement("strong",null,"headphone output")," is connected to the volca sample's ",e.a.createElement("strong",null,"SYNC IN")," and adjust your output volume to a high (but not overdriven) level. Your volca wants to hear this, but you don't.")),e.a.createElement(L.a.Footer,null,e.a.createElement(x.a,{type:"button",variant:"light",onClick:()=>u(!1)},"Cancel"),e.a.createElement(x.a,{type:"button",variant:"primary",disabled:!(f instanceof AudioBuffer),onClick:_},"Transfer now"))),e.a.createElement(L.a,{show:M,"aria-labelledby":"transfer-modal"},e.a.createElement(L.a.Header,null,e.a.createElement(L.a.Title,{id:"transfer-modal"},"Sample transfer in progress")),e.a.createElement(L.a.Body,null,e.a.createElement("p",null,"Transferring ",e.a.createElement("strong",null,t.metadata.name)," to slot"," ",e.a.createElement("strong",null,t.metadata.slotNumber)," on your your volca sample. Don't disconnect anything."),e.a.createElement(fn.a,{striped:!0,animated:!0,variant:"primary",now:100*n}),e.a.createElement("div",{className:Xe.a.progressAnnotation},f instanceof AudioBuffer&&Mt(f.duration*(1-n))," ","remaining")),e.a.createElement(L.a.Footer,null,e.a.createElement(x.a,{type:"button",variant:"primary",onClick:C},"Cancel"))),e.a.createElement(L.a,{onHide:C,show:i!=="idle"&&!M,"aria-labelledby":"after-transfer-modal"},e.a.createElement(L.a.Header,null,e.a.createElement(L.a.Title,{id:"after-transfer-modal"},i==="error"?"Error transferring":"Sample transfer complete")),e.a.createElement(L.a.Body,null,i==="error"?e.a.createElement("p",null,"Something unexpected happening while transferring (on our end)."):e.a.createElement(e.a.Fragment,null,e.a.createElement("p",null,e.a.createElement("strong",null,t.metadata.name)," was transferred to slot"," ",e.a.createElement("strong",null,t.metadata.slotNumber)," on your volca sample."),e.a.createElement("h5",null,"If you see ",e.a.createElement("strong",null,"[End]"),":"),e.a.createElement("p",null,"The transfer was successful. Press the blinking"," ",e.a.createElement("strong",null,"[FUNC]")," button to finish."),e.a.createElement("h5",null,"If you see ",e.a.createElement("strong",null,"[Err dcod]"),":"),e.a.createElement("p",null,"Check your volume level and make sure no other application is creating noise, then try again. If your volume is at a decent level but the transfer failed, you might also want to try a new audio cable."),e.a.createElement("h5",null,"If you see ",e.a.createElement("strong",null,"[Err FuLL]"),":"),e.a.createElement("p",null,"Free up some memory on the volca sample (or cut down your sample size), then try again."),e.a.createElement("p",null,"For more info, check out this"," ",e.a.createElement("a",{href:"https://www.korg.com/products/dj/volca_sample/faq.php",target:"_blank",rel:"noreferrer"},"FAQ")," ","from KORG."))),e.a.createElement(L.a.Footer,null,e.a.createElement(x.a,{type:"button",variant:"primary",onClick:C},"Done"))))}var fa=wn,_n=p(122),Cn=p.n(_n),kn=p(42),Ae=p.n(kn),On=e.a.memo(function({sampleId:a,qualityBitDepth:n,onSampleUpdate:r}){const[l,u]=Object(c.useState)(n);Object(c.useEffect)(()=>{u(n)},[n]);const i=Object(c.useCallback)(o=>{const m=Number(o.target.value);u(m)},[]),s=Object(c.useRef)(null);return Object(c.useEffect)(()=>{const o=s.current;if(o){const m=()=>{const f=Number(o.value);r(a,{qualityBitDepth:f})};return o.addEventListener("change",m),()=>{o.removeEventListener("change",m)}}},[a,r]),e.a.createElement(Y.a.Group,{className:Ae.a.qualityBitDepthWrapper},e.a.createElement(me.a,{delay:{show:400,hide:0},overlay:e.a.createElement(de.a,null,"Lowering quality reduces transfer time. It will ",e.a.createElement("i",null,"not")," reduce the memory footprint.")},e.a.createElement(Y.a.Label,{className:Ae.a.label},"Quality bit depth")),e.a.createElement("div",{className:Ae.a.ticks},[8,9,10,11,12,13,14,15,16].map((o,m,{length:f})=>{const E=`calc(${m*100/(f-1)}% + ${12-3*m}px)`,h=l===o;return e.a.createElement(e.a.Fragment,{key:o},e.a.createElement("label",{className:["small",Ae.a.tickLabel].join(" "),style:{left:E,visibility:h?"hidden":void 0},onClick:()=>r(a,{qualityBitDepth:o})},o),e.a.createElement("span",{className:Ae.a.tickMark,style:{left:E,visibility:h?"hidden":void 0}}))})),e.a.createElement(Cn.a,{value:l,step:1,min:8,max:16,size:"lg",tooltip:"on",tooltipPlacement:"top",tooltipStyle:{zIndex:1020},onChange:i,ref:s}),e.a.createElement("div",{className:Ae.a.annotations},e.a.createElement("label",{className:"small"},"Faster transfer"),e.a.createElement("label",{className:"small"},"Higher quality")))}),An=p(38),De=p.n(An),Dn=(t,a,n)=>new Promise((r,l)=>{var u=o=>{try{s(n.next(o))}catch(m){l(m)}},i=o=>{try{s(n.throw(o))}catch(m){l(m)}},s=o=>o.done?r(o.value):Promise.resolve(o.value).then(u,i);s((n=n.apply(t,a)).next())});const Rn=e.a.memo(function({sample:a,onSampleUpdate:n,onSampleDuplicate:r,onSampleDelete:l}){const u=Object(c.useCallback)(i=>{n(a.id,({slotNumber:s})=>({slotNumber:typeof i=="function"?i(s):i}))},[a.id,n]);return e.a.createElement(Le.a,{fluid:"sm"},e.a.createElement("h2",{className:De.a.sampleName},e.a.createElement(me.a,{delay:{show:400,hide:0},placement:"right",overlay:e.a.createElement(de.a,null,a.metadata.name)},e.a.createElement("span",null,a.metadata.name)),e.a.createElement(Nn,{sampleId:a.id,name:a.metadata.name,sourceFileId:a.metadata.sourceFileId,userFileInfo:a.metadata.userFileInfo,onSampleUpdate:n,onSampleDuplicate:r,onSampleDelete:l})),e.a.createElement("p",null,e.a.createElement("strong",null,"Sampled:")," ",rt(new Date(a.metadata.dateSampled)),e.a.createElement("br",null),e.a.createElement("strong",null,"Updated:")," ",rt(new Date(a.metadata.dateModified))),e.a.createElement("h4",null,"Configure"),e.a.createElement(On,{sampleId:a.id,qualityBitDepth:a.metadata.qualityBitDepth,onSampleUpdate:n}),e.a.createElement(dn,{sample:a,onSampleUpdate:n}),e.a.createElement("h4",null,"Transfer"),e.a.createElement(fa,{sample:a,onSlotNumberUpdate:u}))}),Nn=e.a.memo(({sampleId:t,name:a,sourceFileId:n,userFileInfo:r,onSampleUpdate:l,onSampleDuplicate:u,onSampleDelete:i})=>{const[s,o]=Object(c.useState)(!1),m=Object(c.useRef)(null),[f,E]=Object(c.useState)(a),[h,S]=Object(c.useState)(!1);Object(c.useEffect)(()=>{h&&(E(a),m.current&&m.current.select())},[h,a]);const b=f.trim(),v=Object(c.useCallback)(O=>{O.preventDefault(),b&&(l(t,{name:b}),S(!1))},[b,t,l]),_=Object(c.useCallback)(()=>u(t),[t,u]),C=Object(c.useCallback)(()=>Dn(void 0,null,function*(){const O=yield Z.getSourceFileData(n),D=new Blob([O],{type:r?r.type:"audio/x-wav"});ra(D,`${a}${r?r.ext:".wav"}`)}),[a,n,r]),M=Object(c.useCallback)(O=>{O.preventDefault(),i(t),o(!1)},[t,i]);return e.a.createElement(e.a.Fragment,null,e.a.createElement(La.a,{className:De.a.optionsButton,variant:"secondary",align:"end",title:"Actions"},e.a.createElement(Me.a.Item,{onClick:()=>S(!0)},"Rename"),e.a.createElement(Me.a.Item,{onClick:_},"Duplicate"),e.a.createElement(Me.a.Item,{onClick:C},"Download source audio"),e.a.createElement(Me.a.Divider,null),e.a.createElement(Me.a.Item,{onClick:()=>o(!0)},"Delete")),e.a.createElement("div",{className:De.a.actionButtons},e.a.createElement(x.a,{type:"button",variant:"outline-secondary",onClick:()=>S(!0)},"Rename"),e.a.createElement(x.a,{type:"button",variant:"outline-secondary",onClick:_},"Duplicate"),e.a.createElement(x.a,{type:"button",variant:"outline-secondary",onClick:C},"Download source audio"),e.a.createElement(x.a,{type:"button",variant:"outline-primary",onClick:()=>o(!0)},"Delete")),e.a.createElement(L.a,{onHide:()=>S(!1),show:h,"aria-labelledby":"rename-modal"},e.a.createElement(Y.a,{onSubmit:v},e.a.createElement(L.a.Header,null,e.a.createElement(L.a.Title,{id:"rename-modal"},"Renaming sample")),e.a.createElement(L.a.Body,null,e.a.createElement("p",null,"Choose a new name for the sample ",e.a.createElement("strong",null,a),":"),e.a.createElement(Y.a.Control,{ref:m,defaultValue:a,onChange:O=>E(O.target.value)})),e.a.createElement(L.a.Footer,null,e.a.createElement(x.a,{type:"button",variant:"light",onClick:()=>S(!1)},"Cancel"),e.a.createElement(x.a,{type:"submit",variant:"primary",disabled:!b},"Rename")))),e.a.createElement(L.a,{onHide:()=>o(!1),show:s,"aria-labelledby":"delete-modal"},e.a.createElement(Y.a,{onSubmit:M},e.a.createElement(L.a.Header,{className:De.a.deleteModalHeader},e.a.createElement(At.a,null),e.a.createElement(L.a.Title,{id:"delete-modal"},"Deleting sample")),e.a.createElement(L.a.Body,null,e.a.createElement("p",null,"Are you sure you want to delete ",e.a.createElement("strong",null,a),"? This can't be undone.")),e.a.createElement(L.a.Footer,null,e.a.createElement(x.a,{type:"button",variant:"light",onClick:()=>o(!1)},"Cancel"),e.a.createElement(x.a,{type:"submit",variant:"primary"},"Delete")))))});var In=Rn,Je=p(184),Ln=p(123),Mn=p.n(Ln);function Pn({sample:t}){const{wav:a,audioBuffer:n}=mt(t),{sample:{metadata:{name:r,normalize:l,trim:{frames:u}}},sourceAudioBuffer:i}=Bt(t),{monoSamples:s,waveformRef:o,peaks:m,onResize:f}=Ft(i),E=Object(c.useMemo)(()=>{if(!i)return 0;const M=Ke(s,u);return Oe(M)},[i,s,u]),h=1/E,{isPlaybackActive:S,playbackProgress:b,displayedTime:v,togglePlayback:_,stopPlayback:C}=lt(n,!0);return Object(c.useEffect)(()=>C,[t,C]),e.a.createElement("div",{className:Mn.a.waveformContainer},e.a.createElement(dt,{waveformRef:o,peaks:m,scaleCoefficient:l?h:1,onResize:f}),e.a.createElement(oa,{isPlaybackActive:S,playbackProgress:b,displayedTime:v,downloadFilename:`${r}.volcasample.wav`,wavFile:a,togglePlayback:_}))}var jn=Pn,Tn=Object.defineProperty,Bn=Object.defineProperties,Fn=Object.getOwnPropertyDescriptors,pa=Object.getOwnPropertySymbols,xn=Object.prototype.hasOwnProperty,Wn=Object.prototype.propertyIsEnumerable,ha=(t,a,n)=>a in t?Tn(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,Hn=(t,a)=>{for(var n in a||(a={}))xn.call(a,n)&&ha(t,n,a[n]);if(pa)for(var n of pa(a))Wn.call(a,n)&&ha(t,n,a[n]);return t},Vn=(t,a)=>Bn(t,Fn(a));function zn(t){const a=t.metadata.slotNumber,[n,r]=Object(c.useState)(a);return Object(c.useEffect)(()=>{r(a)},[a]),{sample:Object(c.useMemo)(()=>t&&new Z(Vn(Hn({id:t.id},t.metadata),{slotNumber:n})),[t,n]),setSlotNumber:r}}function Un({sample:t,onSampleDuplicate:a}){const{sample:n,setSlotNumber:r}=zn(t);return e.a.createElement(Le.a,{fluid:"sm"},e.a.createElement("h2",{className:De.a.sampleName},n.metadata.name),e.a.createElement("p",null,e.a.createElement("strong",null,"Sampled:")," ",rt(new Date(n.metadata.dateSampled))),e.a.createElement(Je.a,{variant:"secondary"},e.a.createElement(Je.a.Heading,null,"This is a factory sample."),e.a.createElement("p",null,"If you want to trim the audio or adjust quality before transferring to the volca sample,"," ",e.a.createElement("span",{className:De.a.buttonLink},e.a.createElement(x.a,{variant:"link",onClick:()=>a(n.id)},"make a duplicate"),"."))),e.a.createElement("h4",null,"Preview"),e.a.createElement(jn,{sample:n}),e.a.createElement("h4",null,"Transfer"),e.a.createElement(fa,{sample:n,onSlotNumberUpdate:r}))}var Gn=Un,Ee=p(181),Qn=p(178),Te=p(185),Be=(t,a,n)=>new Promise((r,l)=>{var u=o=>{try{s(n.next(o))}catch(m){l(m)}},i=o=>{try{s(n.throw(o))}catch(m){l(m)}},s=o=>o.done?r(o.value):Promise.resolve(o.value).then(u,i);s((n=n.apply(t,a)).next())});let va;function ht(){const t=Kt();return va=va||new t(navigator.mediaDevices.getSupportedConstraints().sampleRate?{sampleRate:We}:{})}function Kn(){return Be(this,null,function*(){{const r=yield navigator.mediaDevices.getUserMedia({audio:!0,video:!1});for(const l of r.getTracks())l.stop()}const a=(yield navigator.mediaDevices.enumerateDevices()).filter(r=>r.kind==="audioinput"),n=[];for(const r of a){const l=yield navigator.mediaDevices.getUserMedia({audio:{deviceId:r.deviceId,channelCount:2},video:!1}),u=(yield navigator.mediaDevices.enumerateDevices()).find(({deviceId:s})=>r.deviceId===s).label;let i=1;{const s=l.getAudioTracks()[0],o=s.getSettings().channelCount;o?i=o:s.getCapabilities&&(i=(s.getCapabilities().channelCount||{}).max||i)}for(const s of l.getTracks())s.stop();n.push({device:{deviceId:r.deviceId,label:u},channelsAvailable:i})}return n})}let vt;function Yn(t){return Be(this,arguments,function*({onData:a,onFinish:n}){const r=ht();vt=vt||r.audioWorklet.addModule("recorderWorkletProcessor.js"),yield vt;const l=new AudioWorkletNode(r,"recorder-worklet",{parameterData:{bufferSize:1024}});l.port.onmessage=i=>{if(i.data.eventType==="data"){const s=i.data.audioChannels;a(s)}i.data.eventType==="stop"&&n()};const u=l.parameters.get("isRecording");return u.setValueAtTime(1,r.currentTime),{recorderNode:l,stop(){u.setValueAtTime(0,r.currentTime)}}})}function $n({channelCount:t,onData:a,onFinish:n}){const l=ht().createScriptProcessor(1024,t,t);let u=!1;return l.onaudioprocess=i=>{const s=Array(t).fill().map((o,m)=>i.inputBuffer.getChannelData(m));a(s),u&&n()},{recorderNode:l,stop(){u=!0}}}function Xn(t){return Be(this,null,function*(){return typeof AudioWorkletNode=="undefined"?$n(t):yield Yn(t)})}function Jn(t){return Be(this,arguments,function*({deviceId:a,channelCount:n,onStart:r,onUpdate:l}){const u=yield navigator.mediaDevices.getUserMedia({audio:{deviceId:a,channelCount:n,sampleRate:We,echoCancellation:!1,autoGainControl:!1,noiseSuppression:!1},video:!1}),i=ht(),s=i.createMediaStreamSource(u),{recorderNode:o,stop:m}=yield Xn({channelCount:n,onData:b,onFinish:O});s.connect(o),o.connect(i.destination);const f=65;r(i.sampleRate,f);const E=f*i.sampleRate;let h=0;const S=Array(n).fill([]);function b(D){let d=0;const w=[];for(let y=0;y<n;y++){const F=D[y],T=F.length,P=F.slice(0,Math.min(T,E-h));Gt(P),d||(d=P.length),w.push(P)}const k=Ga(w),R=Qt(k);S.push(R),h+=d,h>=E&&m(),l(w)}let v,_;const C=new Promise((D,d)=>{v=D,_=d});let M=!1;function O(){return Be(this,null,function*(){if(M)return;try{const w=yield new Blob(S).arrayBuffer(),k=new Float32Array(w),R=Nt()({channels:n,sampleRate:i.sampleRate,bitDepth:16,dataLength:k.byteLength}),y=new Uint8Array(R.length+k.byteLength);y.set(R),y.set(new Uint8Array(k.buffer),R.length),v(y)}catch(d){_(d)}const D=u.getTracks();for(const d of D)d.stop();o.disconnect(i.destination),s.disconnect(o),M=!0})}return{stop:m,mediaRecording:C}})}var Zn=p(15),ce=p.n(Zn),Fe=(t,a,n)=>new Promise((r,l)=>{var u=o=>{try{s(n.next(o))}catch(m){l(m)}},i=o=>{try{s(n.throw(o))}catch(m){l(m)}},s=o=>o.done?r(o.value):Promise.resolve(o.value).then(u,i);s((n=n.apply(t,a)).next())});const qn=(()=>{const t=navigator.userAgent.toLowerCase();return t.includes("iphone")||t.includes("ipad")||t.includes("mac")&&navigator.maxTouchPoints>1?"ios":t.includes("android")?"android":t.includes("mac")?"mac":t.includes("linux")?"linux":"windows"})(),Ea="capture_device_preference";let ya=null;function er(t,a){const n=Object(c.useRef)(JSON.parse(localStorage.getItem(Ea)||"null")),[r]=Object(c.useState)(n.current),[l,u]=Object(c.useState)(ya),[i,s]=Object(c.useState)(l?"ok":"pending"),[o,m]=Object(c.useState)(null),f=Object(c.useMemo)(()=>o?o.device.deviceId:"",[o]);Object(c.useEffect)(()=>{ya=l,s("ok")},[l]);const E=Object(c.useCallback)(()=>{let N=!1;return Kn().then(B=>{N||B.length&&(u(new Map(B.map(J=>[J.device.deviceId,J]))),m(J=>{if(J)return n.current=null,J;if(n.current){const ae=B.find(({device:A})=>n.current.deviceId===A.deviceId);if(ae)return ae}return n.current=null,B[0]}))}).catch(B=>{if(!N){if(B instanceof DOMException){if(B.name==="NotAllowedError"){s("denied");return}if(B.name==="NotFoundError"){s("unavailable");return}}throw B}}),()=>{N=!0}},[]),[h,S]=Object(c.useState)(1);Object(c.useEffect)(()=>{const N=l&&l.get(f);N&&(n.current&&n.current.deviceId===N.device.deviceId&&n.current.channelCount<=N.channelsAvailable?S(n.current.channelCount):S(N.channelsAvailable),n.current=null)},[l,f]),Object(c.useEffect)(()=>{o&&localStorage.setItem(Ea,JSON.stringify({deviceId:o.device.deviceId,channelCount:h,label:o.device.label}))},[o,h]);const[b,v]=Object(c.useState)("ready"),[_,C]=Object(c.useState)(""),[M,O]=Object(c.useState)(!1);Object(c.useEffect)(()=>{b!=="ready"&&O(!1)},[b]);const D=Object(c.useCallback)(()=>{O(!1)},[]),[d,w]=Object(c.useState)({fn(N){}});Object(c.useEffect)(()=>d.fn,[d]);const[k,R]=Object(c.useState)(1/0),[y,F]=Object(c.useState)(0),T=Object(c.useCallback)(()=>Fe(this,null,function*(){let N=!1;const B=(I,H)=>Jn({deviceId:I,channelCount:H,onStart:(ne,re)=>{const $=re*ne;R(ne),F($),v("capturing")},onUpdate:t}),J=n.current,{mediaRecording:ae,stop:A}=yield J?(()=>Fe(this,null,function*(){try{return B(J.deviceId,J.channelCount)}catch(I){if(I instanceof DOMException&&I.name==="NotFoundError")return B(f,h);throw I}}))():B(f,h);w({fn(I){A(),I&&(N=!0)}});let K;try{K=yield ae}catch(I){C(String(I)),v("error");return}if(N)v("ready");else{v("finalizing");const I=yield a(K);N||(v("ready"),I==="silent"&&O(!0))}}),[f,h,t,a]),P=Object(c.useCallback)(N=>{if(N.target.files&&N.target.files.length){const B=N.target.files[0];B.arrayBuffer().then(J=>Fe(this,null,function*(){const ae=new Uint8Array(J);let A;try{A=yield je(ae)}catch(I){alert("Unsupported audio format detected");return}if(A.length>65*A.sampleRate){alert("Please select an audio file no more than 65 seconds long");return}v("finalizing");const K=yield a(ae,B);v("ready"),K==="silent"&&O(!0)}))}},[a]);return{captureDevices:l,accessState:i,selectedCaptureDevice:o,selectedChannelCount:h,captureDeviceFromStorage:r,captureState:b,recordingError:_,showSilenceWarning:M,sampleRate:k,maxSamples:y,refreshCaptureDevices:E,setSelectedCaptureDevice:m,setSelectedChannelCount:S,beginRecording:T,stopRecording:d.fn,importFile:P,dismissSilenceWarning:D}}const Ze=3;function tr({canvas:t,peaks:a,drawUntil:n,scaleCoefficient:r}){const l="#fff",u=t.getContext("2d");u.imageSmoothingEnabled=!1;const{width:i,height:s}=t;u.clearRect(0,0,i,s),u.fillStyle=l;for(let o=0;o<n&&o<a.length;o++){const m=a[o],f=s*m,E=Math.max(Math.round(r*f),2);u.fillRect(o*Ze,s-E,Ze-1,E)}t.style.left=`min(0px, calc(var(--record-ui-width) - ${n*Ze}px))`}function ar({onRecordFinish:t}){const a=Object(c.useRef)(null),n=Object(c.useRef)(0),r=Object(c.useRef)(new Float32Array),l=Object(c.useRef)(0),u=Object(c.useRef)([]),i=Object(c.useRef)(1/0),s=Object(c.useRef)(0),[o,m]=Object(c.useState)(0),f=Object(c.useCallback)(A=>Fe(this,null,function*(){const K=n.current,I=r.current,H=u.current;if(H.push(A),s.current+=A[0].length,m(Math.floor(s.current/i.current)),H.reduce((re,[{length:$}])=>re+$,0)>=K){const re=yield Promise.all(A.map((ie,V)=>H.reduce((U,q)=>[...U,q[V]],[])).map(ie=>Fe(this,null,function*(){const V=yield new Blob(ie).arrayBuffer();return new Float32Array(V)}))),$=re.map(ie=>Oe(new Float32Array(ie.buffer,0,K)));I[l.current++]=Math.max(...$),tr({canvas:a.current,peaks:I,drawUntil:l.current,scaleCoefficient:.3}),u.current=[re.map(ie=>ie.slice(K))]}}),[]),{captureDevices:E,accessState:h,selectedCaptureDevice:S,selectedChannelCount:b,captureDeviceFromStorage:v,captureState:_,recordingError:C,showSilenceWarning:M,maxSamples:O,sampleRate:D,refreshCaptureDevices:d,setSelectedCaptureDevice:w,setSelectedChannelCount:k,beginRecording:R,stopRecording:y,importFile:F,dismissSilenceWarning:T}=er(f,t);i.current=D,Object(c.useEffect)(()=>{const A=a.current;A&&(A.width=A.offsetWidth,A.height=A.offsetHeight)},[h]),Object(c.useLayoutEffect)(()=>{const A=a.current;!A||(_!=="finalizing"&&A.getContext("2d").clearRect(0,0,A.width,A.height),_==="capturing"&&O&&(n.current=Math.floor(Ze*O/a.current.width),r.current=new Float32Array(Math.floor(O/n.current)),l.current=0,u.current=[],i.current=1/0,s.current=0,m(0)))},[O,_]);const[P,N]=Object(c.useState)(!1);Object(c.useEffect)(()=>{P&&d()},[P,d]);const B=S?b:v?v.channelCount:b,[J,ae]=Object(c.useState)(!1);return e.a.createElement(Le.a,{fluid:"sm",className:ce.a.container},h==="denied"?e.a.createElement("p",null,"Looks like you didn't grant access to your audio input device. Please give Volca Sampler access, then"," ",e.a.createElement(x.a,{type:"button",variant:"secondary",onClick:d},"try again")):h==="unavailable"?e.a.createElement("p",null,"Volca Sampler couldn't find any audio input devices. Please connect one, then"," ",e.a.createElement(x.a,{type:"button",variant:"secondary",onClick:d},"try again")):e.a.createElement(e.a.Fragment,null,e.a.createElement("h2",null,"Send a new sound to your volca sample!"),M&&e.a.createElement("div",{className:ce.a.alertContainer},e.a.createElement(Je.a,{dismissible:!0,variant:"warning",onClose:T},e.a.createElement(Je.a.Heading,null,"Your recording was totally silent."),e.a.createElement("p",null,"Check the ",e.a.createElement("strong",null,"Audio input settings")," and your connections, then try again."))),e.a.createElement(x.a,{id:"record-button",className:ce.a.recordButton,type:"button",variant:"primary",size:"lg",onClick:_==="capturing"?()=>y():R,disabled:_==="finalizing"},e.a.createElement("canvas",{ref:a}),e.a.createElement("span",{className:ce.a.mainText},["capturing","finalizing"].includes(_)?"Finished recording":"Start recording"),["capturing","finalizing"].includes(_)&&e.a.createElement("span",{className:ce.a.timeRecorded},"0:",String(o).padStart(2,"0"))),_==="error"&&C&&e.a.createElement("p",null,"Recording error: ",C)||null,["capturing","finalizing"].includes(_)?e.a.createElement(e.a.Fragment,null,e.a.createElement(x.a,{size:"sm",type:"button",variant:"secondary",onClick:()=>y(!0)},"Cancel")):e.a.createElement(e.a.Fragment,null,e.a.createElement(Ee.a,{activeKey:P?"audioInput":"nothing"},e.a.createElement(Ee.a.Item,{eventKey:"audioInput"},e.a.createElement(Ee.a.Header,{className:ce.a.audioInputHeader,onClick:()=>N(A=>!A)},e.a.createElement("div",null,e.a.createElement("span",null,"Audio input settings"),(S||v)&&e.a.createElement(e.a.Fragment,null,e.a.createElement("p",{className:"small"},e.a.createElement("strong",null,"Capture device:")," ",S?S.device.label||S.device.deviceId:v?v.label:""),e.a.createElement("p",{className:"small"},e.a.createElement("strong",null,"Input channels:")," ",B===1?"Mono":"Stereo")))),e.a.createElement(Ee.a.Body,null,e.a.createElement(Y.a.Group,null,e.a.createElement(Y.a.Label,null,"Capture device"),e.a.createElement(Y.a.Select,{value:S?S.device.deviceId:v?v.deviceId:"",onChange:A=>E&&h==="ok"&&w(E.get(A.target.value)||null)},E&&h==="ok"?[...E].map(([A,{device:K}])=>e.a.createElement("option",{key:A,value:A},K.label||A)):v?e.a.createElement("option",{value:v.deviceId,disabled:!0},v.label||v.deviceId):e.a.createElement("option",{value:"",disabled:!0},"Loading devices..."))),e.a.createElement(Y.a.Group,null,e.a.createElement(Y.a.Label,null,"Input channels"),e.a.createElement(Dt.a,{className:ce.a.channelOptionSelect},[1,2].map(A=>e.a.createElement(Rt.a,{key:A,className:ce.a.channelOption,type:"radio",variant:"outline-secondary",name:"channels",value:A,checked:A===B,disabled:B!==A&&(S?S.channelsAvailable:1)<A,onClick:()=>k(Number(A))},A===1?"Mono":"Stereo")))),e.a.createElement("p",{className:["small",ce.a.stereoExplanation].join(" ")},"Stereo input is summed to mono.")))),e.a.createElement(x.a,{variant:"link",onClick:()=>ae(!0)},"Want to record your device's audio output?"))),!["capturing","finalizing"].includes(_)&&e.a.createElement(x.a,{className:ce.a.importFileButton,type:"button",variant:"secondary",onClick:A=>{const K=A.currentTarget.querySelector("input");K&&A.target!==K&&K.click()}},"Or import an audio file",e.a.createElement("input",{hidden:!0,type:"file",accept:"audio/*,video/*,.wav,.mp3,.ogg",onChange:F})),e.a.createElement(L.a,{show:J,"aria-labelledby":"system-record-modal",onHide:()=>ae(!1)},e.a.createElement(L.a.Header,null,e.a.createElement(L.a.Title,{id:"system-record-modal"},"Recording audio playing on your device")),e.a.createElement(L.a.Body,{onClick:A=>{A.target instanceof HTMLImageElement&&window.open(A.target.src,"_blank","noreferrer")},className:ce.a.systemRecordModalBody},e.a.createElement(Qn.a,{defaultActiveKey:qn,className:ce.a.osTabs},e.a.createElement(Te.a,{eventKey:"windows",title:"Windows"},e.a.createElement("p",null,"Windows has a built-in capture device called"," ",e.a.createElement("strong",null,"Stereo Mix")," for recording system audio, but it needs to be enabled."," ",e.a.createElement("a",{href:"https://allthings.how/how-to-enable-missing-stereo-mix-option-in-windows-10/",target:"_blank",rel:"noreferrer"},"Follow this tutorial")," ","to enable it."),e.a.createElement("p",null,"Once the ",e.a.createElement("strong",null,"Stereo Mix")," capture device has been enabled, you can select it from Volca Sampler's"," ",e.a.createElement("strong",null,"Audio input settings"),".")),e.a.createElement(Te.a,{eventKey:"mac",title:"Mac"},e.a.createElement("p",null,"The easiest way to capture system audio on macOS is to install a free app called"," ",e.a.createElement("a",{href:"https://github.com/kyleneideck/BackgroundMusic/blob/master/README.md",target:"_blank",rel:"noreferrer"},"Background Music"),". Make sure you download the"," ",e.a.createElement("a",{href:"https://github.com/kyleneideck/BackgroundMusic/releases/tag/v0.4.0",target:"_blank",rel:"noreferrer"},"0.4.0")," ","version, since earlier versions don't work well with Volca Sampler."),e.a.createElement("p",null,"Once Background Music has been installed, you can select the"," ",e.a.createElement("strong",null,"Background Music (Virtual)")," capture device from Volca Sampler's ",e.a.createElement("strong",null,"Audio input settings"),".")),e.a.createElement(Te.a,{eventKey:"linux",title:"Linux"},e.a.createElement("p",null,"Assuming you have PulseAudio installed on your Linux system, you can run the following command to create a capture device called"," ",e.a.createElement("strong",null,"System_Output"),":"),e.a.createElement("pre",null,e.a.createElement("code",null,`pactl \\
  load-module module-remap-source \\
  master="$( \\
    pactl list \\
    | grep -A2 '^Source #' \\
    | grep 'Name: .*\\.monitor$' \\
    | awk '{print $NF}' \\
    | tail -n1 \\
  )" \\
  source_name=systemout_monitor \\
  source_properties=device.description=System_Output`)),e.a.createElement("p",null,"Once the ",e.a.createElement("strong",null,"System_Output")," capture device has been created, you can select it from Volca Sampler's"," ",e.a.createElement("strong",null,"Audio input settings"),"."),e.a.createElement("p",null,"Note that the capture device will ",e.a.createElement("i",null,"not")," persist after reboot, so if you want it to always be available, you'll need to add the above command into a bash profile file like"," ",e.a.createElement("code",null,"~/.bashrc"),".")),e.a.createElement(Te.a,{eventKey:"ios",title:"iOS"},e.a.createElement("p",null,"You can't record directly into Volca Sampler with iOS. Instead, you can capture a recording to be imported as a file. The instructions below show you how to record a screencapture video with iOS, convert it to the appropriate audio format, and import it."),e.a.createElement("h4",null,"Enable Screen Recording"),e.a.createElement("p",null,"First you'll need to go into ",e.a.createElement("strong",null,"Settings"),", choose"," ",e.a.createElement("strong",null,"Control Panel")," in the left-side menu, and tap the ",e.a.createElement("strong",null,'"+"')," button next to"," ",e.a.createElement("strong",null,"Screen Recording"),", which can be found under the"," ",e.a.createElement("strong",null,"More Controls")," list. If"," ",e.a.createElement("strong",null,"Screen Recording")," is already listed under"," ",e.a.createElement("strong",null,"Included Controls"),", you can skip this step."),e.a.createElement("img",{src:"ios_enable_screen_recording.png",alt:""}),e.a.createElement("h4",null,"Capture recording"),e.a.createElement("p",null,"Next, once you are ready to record, swipe down from the"," ",e.a.createElement("strong",null,"top-right")," and tap the"," ",e.a.createElement("strong",null,"Screen Recording")," button which will now appear in the ",e.a.createElement("strong",null,"Control Panel")," menu."),e.a.createElement("img",{src:"ios_record_start.png",alt:""}),e.a.createElement("p",null,"Once the recording has started, you'll see a small recording status button at the top of the screen. Tap this button when you've finished recording."),e.a.createElement("img",{src:"ios_stop_recording.png",alt:""}),e.a.createElement("p",null,"After finishing recording, tap the notification appearing at the top of the screen, which will take you to the"," ",e.a.createElement("strong",null,"Photos")," app to review your recording."),e.a.createElement("img",{src:"ios_go_to_saved_file.png",alt:""}),e.a.createElement("h4",null,"Trim recording"),e.a.createElement("p",null,"If your recorded video is longer than 65 seconds, you will need to trim it so it will be accepted by Volca Sampler's file import. Tap the ",e.a.createElement("strong",null,"Edit")," button..."),e.a.createElement("img",{src:"ios_edit_video_select.png",alt:""}),e.a.createElement("p",null,"...and adjust as needed, tapping ",e.a.createElement("strong",null,"Done")," to finish."),e.a.createElement("img",{src:"ios_edit_recording.png",alt:""}),e.a.createElement("h4",null,"Convert to WAV"),e.a.createElement("p",null,"You're almost done. Your video is likely saved in"," ",e.a.createElement("strong",null,"AIFF")," format, which is not supported by Volca Sampler. One of the best free iOS apps for converting AIFF video to ",e.a.createElement("strong",null,"WAV")," audio is"," ",e.a.createElement("a",{href:"https://apps.apple.com/ca/app/audio-converter-extract-mp3/id1393886341",target:"_blank",rel:"noreferrer"},"Audio Converter"),`. Don't confuse this with with "The Audio Converter", which requires payment to convert to WAV.`),e.a.createElement("p",null,"After installing and launching ",e.a.createElement("strong",null,"Audio Converter"),", tap the ",e.a.createElement("strong",null,'"+"')," button to the right and select"," ",e.a.createElement("strong",null,"Import videos")," to import your recording from your ",e.a.createElement("strong",null,"Photos")," library."),e.a.createElement("img",{src:"ios_import_video.png",alt:""}),e.a.createElement("p",null,"Tap the imported video and select ",e.a.createElement("strong",null,"Extract Audio"),"."),e.a.createElement("img",{src:"ios_extract_audio_select.png",alt:""}),e.a.createElement("p",null,"The only setting that needs to be configured is the"," ",e.a.createElement("strong",null,"Format"),", which should be ",e.a.createElement("strong",null,"wav"),". When this is selected, tap ",e.a.createElement("strong",null,"Start Conversion"),"."),e.a.createElement("img",{src:"ios_convert_to_wav.png",alt:""}),e.a.createElement("h4",null,"Import to Volca Sampler"),e.a.createElement("p",null,"Once the conversion to WAV has completed, you can choose your file for import in Volca Sampler.")),e.a.createElement(Te.a,{eventKey:"android",title:"Android"},e.a.createElement("p",null,"You can't record directly into Volca Sampler with Android. Instead, you can capture a recording to be imported as a file. The instructions below show you how to record a screencapture video with Android, convert it to a trimmed WAV file, and import it."),e.a.createElement("p",null,e.a.createElement("strong",null,"Note:")," Some apps won't allow you to record their audio. Google Chrome and Spotify, for example, block audio capture. The way to find out if an app allows audio capture is to listen to recorded files and see whether the audio is muted."),e.a.createElement("h4",null,"Enable Screen record"),e.a.createElement("p",null,"First you'll need to swipe down from the top of the screen two times to see the list of ",e.a.createElement("strong",null,"Action Tiles")," and tap the ",e.a.createElement("strong",null,"Pencil")," icon shown at the bottom-left of the overlay, which will open the ",e.a.createElement("strong",null,"Edit Tiles")," screen."),e.a.createElement("img",{src:"android_edit_tiles.png",alt:""}),e.a.createElement("p",null,"Grab the ",e.a.createElement("strong",null,"Screen record")," tile and drag it up into the list of active tiles. If ",e.a.createElement("strong",null,"Screen record")," is already active, you can skip this step."),e.a.createElement("img",{src:"android_enable_screen_recording.png",alt:""}),e.a.createElement("h4",null,"Capture recording"),e.a.createElement("p",null,"Tap the back button to return to the screen of"," ",e.a.createElement("strong",null,"Action Tiles"),", which should now include"," ",e.a.createElement("strong",null,"Screen record"),". Tap"," ",e.a.createElement("strong",null,"Screen record"),"."),e.a.createElement("img",{src:"android_selection_screen_recording.png",alt:""}),e.a.createElement("p",null,"Before recording, change the audio source from"," ",e.a.createElement("strong",null,"Microphone")," to ",e.a.createElement("strong",null,"Device audio"),". Tap ",e.a.createElement("strong",null,"Start"),"."),e.a.createElement("img",{src:"android_start_recording.png",alt:""}),e.a.createElement("p",null,"Make sure to wait for the countdown at the top of the screen before starting to play your audio."),e.a.createElement("img",{src:"android_wait_for_recording.png",alt:""}),e.a.createElement("p",null,"To finish recording, swipe down from the top of the screen and tap the recording notification."),e.a.createElement("img",{src:"android_stop_recording.png",alt:""}),e.a.createElement("h4",null,"Trim and convert to WAV"),e.a.createElement("p",null,"You're almost done. Your video is likely saved in"," ",e.a.createElement("strong",null,"MP4")," format, which can be imported directly to Volca Sampler."),e.a.createElement("p",null,"However, if your video is longer than 65 seconds, you will need to trim it, and you might prefer to import the file in"," ",e.a.createElement("strong",null,"WAV")," format. One of the best free Android apps for converting MP4 video to WAV audio, and trimming it at the same time, is"," ",e.a.createElement("a",{href:"https://play.google.com/store/apps/details?id=com.psma.audioextractor",target:"_blank",rel:"noreferrer"},"Audio Extractor"),"."),e.a.createElement("img",{src:"android_extract_audio.png",alt:""}),e.a.createElement("h4",null,"Import to Volca Sampler"),e.a.createElement("p",null,"Once your recording has been trimmed and converted as needed, you can choose your file for import in Volca Sampler.")))),e.a.createElement(L.a.Footer,null,e.a.createElement(x.a,{type:"button",variant:"primary",onClick:()=>ae(!1)},"Close"))))}var nr=ar,rr=p(186),or=e.a.memo(function({isPlaybackActive:a,playbackProgress:n}){return e.a.createElement("div",{className:[ve.a.playbackOverlay,a?ve.a.playbackActive:""].join(" "),style:{"--playback-progress":`${100*n}%`}},e.a.createElement("div",{className:ve.a.playback}))}),lr=p(21),ue=p.n(lr);const ga=typeof IntersectionObserver!="undefined",cr=e.a.memo(function({sample:a,selected:n,onSampleSelect:r}){const l=Object(c.useRef)(null),[u,i]=Object(c.useState)(!ga);Object(c.useLayoutEffect)(()=>{if(!ga)return;const v=l.current;if(!v)throw new Error("Waveform container should be defined");const _=v.getBoundingClientRect();if(_.top+_.height>=0&&_.bottom-_.height<=window.innerHeight){i(!0);return}const C=new IntersectionObserver(([M])=>{M.isIntersecting&&(i(!0),C.unobserve(v))});return C.observe(v),()=>C.disconnect()},[]);const s=Object(c.useRef)(null);Object(c.useEffect)(()=>{if(!n||!s.current)return;const v=s.current,_=v.closest(".accordion-collapse");if(!_)return;(_.scrollTop>v.offsetTop||_.scrollTop+_.offsetHeight<v.offsetTop-v.offsetHeight)&&v.scrollIntoView({block:"center"})},[n]);const[o,m]=Object(c.useState)(!1),{audioBuffer:f}=mt(a,o),{isPlaybackActive:E,playbackProgress:h,togglePlayback:S}=lt(f),b=Object(c.useCallback)(v=>{S(v),m(!0)},[S]);return e.a.createElement("div",{className:["list-group-item",ue.a.listItem,n?`active ${ue.a.active}`:""].join(" "),tabIndex:-1,onClick:v=>{const _=v.currentTarget.querySelector("button");_&&_.contains(v.target)||r(a.id)},ref:s},e.a.createElement("span",{className:ue.a.sampleTitle},e.a.createElement(x.a,{className:ue.a.playbackButton,tabIndex:-1,variant:"dark",onClick:v=>{b(v.nativeEvent)}},E?e.a.createElement(na.a,null):e.a.createElement(aa.a,null)),e.a.createElement("span",{className:ue.a.name},a.metadata.name),e.a.createElement("span",{className:ue.a.slot},"S.",a.metadata.slotNumber.toString().padStart(3,"0"))),e.a.createElement("div",{className:[ue.a.waveformContainer,E?ue.a.playbackActive:""].join(" "),style:{"--waveform-width":`${jt}px`},ref:l},u&&e.a.createElement(e.a.Fragment,null,e.a.createElement(dt,{peaks:a.metadata.trim.waveformPeaks,scaleCoefficient:a.metadata.normalize?void 0:1}),e.a.createElement(or,{isPlaybackActive:E,playbackProgress:h}))))});function ir({samples:t,selectedSampleId:a,onSampleSelect:n}){const r=Object(c.useRef)(null),l=Object(c.useCallback)(i=>{if(!r.current||i.key!=="ArrowUp"&&i.key!=="ArrowDown")return;const s=i.target.closest(`.${ue.a.listItem}`);if(s){i.preventDefault();const o=Array.prototype.indexOf.call(r.current.children,s);i.key==="ArrowUp"&&o>0&&s.previousElementSibling instanceof HTMLDivElement&&s.previousElementSibling.focus(),i.key==="ArrowDown"&&o+1<t.length&&s.nextElementSibling instanceof HTMLDivElement&&s.nextElementSibling.focus()}},[t]),u=Object(c.useCallback)(i=>{if(!r.current||!(document.activeElement instanceof HTMLDivElement)||i.key!=="ArrowUp"&&i.key!=="ArrowDown")return;const s=Array.prototype.indexOf.call(r.current.children,document.activeElement);if(s===-1)return;i.preventDefault();const o=t[s];o&&n(o.id)},[t,n]);return e.a.createElement("ul",{ref:r,className:"list-group list-group-flush",onKeyDown:l,onKeyUp:u},t.length?t.map(i=>e.a.createElement(cr,{key:i.id,sample:i,selected:i.id===a,onSampleSelect:n})):e.a.createElement("li",{className:"list-group-item"},e.a.createElement(Y.a.Label,{className:ue.a.emptyListMessage},"No samples found.")))}var sr=ir,ur=p(39),we=p.n(ur),mr=e.a.memo(function({loading:a,focusedSampleId:n,userSamples:r,factorySamples:l,onSampleSelect:u}){const[i,s]=Object(c.useState)(""),o=i.trim().toLowerCase(),[m,f]=Object(c.useState)(null);{const d=Boolean(i);Object(c.useLayoutEffect)(()=>{f(n&&l.has(n)?"factory":r.size?"user":"factory")},[r,l,n,d])}const[E,h]=Object(c.useState)(["user","factory"]);Object(c.useLayoutEffect)(()=>{o&&h(["user","factory"])},[o]);const S=Object(c.useCallback)(d=>{h(w=>w.includes(d)?w.filter(k=>k!==d):w.concat(d))},[]),b=Object(c.useCallback)(d=>{if(d.key==="ArrowDown"){d.preventDefault();const k=d.target.closest(`.${we.a.accordionItem}`);if(!k){console.warn("Expected accordionItem class on parent.");return}const R=k.querySelector("ul > div");R&&R.focus()}},[]),v=Object(c.useMemo)(()=>[...r.values()].filter(d=>!i||d.metadata.name.toLowerCase().includes(i)).sort((d,w)=>d.metadata.dateModified>w.metadata.dateModified?-1:1),[r,i]),_=Object(c.useMemo)(()=>[...l.values()].filter(d=>!i||d.metadata.name.toLowerCase().includes(i)),[l,i]),C=Object(c.useRef)(null),M=Object(c.useRef)(null),O=Object(c.useRef)(!1),D=Object(c.useRef)(!1);return Object(c.useEffect)(()=>{if(!C.current||!M.current)return;function d(){O.current=!0}function w(){D.current=!0}function k(){O.current=!1,D.current=!1}const R=C.current,y=M.current;return R.addEventListener("mousedown",d),y.addEventListener("mousedown",w),window.addEventListener("mouseup",k),()=>{R.removeEventListener("mousedown",d),y.removeEventListener("mousedown",w),window.removeEventListener("mouseup",k)}},[a]),e.a.createElement(e.a.Fragment,null,e.a.createElement(x.a,{className:we.a.newSampleButton,type:"button",variant:"primary",onClick:()=>{u(null),requestAnimationFrame(()=>{const d=document.getElementById("record-button");d&&(d.focus(),requestAnimationFrame(()=>{document.activeElement!==d&&setTimeout(()=>{d.focus()},300)}))})}},"New sample"),e.a.createElement(Y.a.Control,{className:we.a.search,placeholder:"Search for a sample...",value:i,onChange:d=>s(d.target.value)}),e.a.createElement(rr.a,{className:we.a.listGroup},!a&&[{eventKey:"user",filteredSamples:v,headerRef:C,headerMouseDownRef:O},{eventKey:"factory",filteredSamples:_,headerRef:M,headerMouseDownRef:D}].map(({eventKey:d,filteredSamples:w,headerRef:k,headerMouseDownRef:R})=>e.a.createElement(Ee.a,{key:d,style:{"--results-count":w.length,"--accordion-open":(o?E.includes(d):m===d)?"1":"0"},activeKey:o?E.filter(y=>y===d)[0]||"nothing":m===d?m:"nothing",className:we.a.accordion},e.a.createElement(Ee.a.Item,{eventKey:d,className:we.a.accordionItem},e.a.createElement(Ee.a.Header,{ref:k,onClick:()=>{f(y=>y===d?null:d),o&&S(d)},onFocus:()=>!R.current&&f(d),onKeyDown:b},d==="user"?"Your samples":"Factory samples"),e.a.createElement(Ee.a.Body,{className:we.a.accordionBody},e.a.createElement(sr,{samples:w,selectedSampleId:n,onSampleSelect:u})))))))}),dr=p(29),ye=p.n(dr);const fr=e.a.memo(function(){const[a,n]=Object(c.useState)(!1);return e.a.createElement(e.a.Fragment,null,e.a.createElement("div",{className:ye.a.footer},e.a.createElement("p",null,e.a.createElement("strong",null,"Volca Sampler")," is an app created by"," ",e.a.createElement("a",{href:"https://benwiley.org",target:"_blank",rel:"noreferrer"},"Ben Wiley"),"."),e.a.createElement("p",null,e.a.createElement("strong",null,"volca sample")," is a trademark of"," ",e.a.createElement("strong",null,"KORG Inc."),", who is not affiliated with this app."),e.a.createElement("p",null,"The source code can be found on"," ",e.a.createElement("a",{href:"https://github.com/benwiley4000/volca-sampler",target:"_blank",rel:"noreferrer"},"GitHub"),"."),e.a.createElement(x.a,{className:ye.a.faqAndLicensesButton,type:"button",variant:"link",onClick:()=>n(!0)},"FAQ / Licenses"),e.a.createElement("div",{className:ye.a.faqAndLicensesEmbedded},e.a.createElement(ba,null))),e.a.createElement(L.a,{show:a,"aria-labelledby":"faq-modal",onHide:()=>n(!1)},e.a.createElement(L.a.Header,null,e.a.createElement(L.a.Title,{id:"faq-modal"},"About Volca Sampler")),e.a.createElement(L.a.Body,null,e.a.createElement(ba,null)),e.a.createElement(L.a.Footer,null,e.a.createElement(x.a,{type:"button",variant:"primary",onClick:()=>n(!1)},"Close"))))});function ba(){return e.a.createElement(e.a.Fragment,null,e.a.createElement("p",null,"This app relies on the open-source"," ",e.a.createElement("a",{href:"https://github.com/korginc/volcasample",target:"_blank",rel:"noreferrer"},"SYRO")," ","library published by ",e.a.createElement("strong",null,"KORG Inc."),", which encodes audio data to be sent to the ",e.a.createElement("strong",null,"volca sample"),"."),e.a.createElement("p",null,"Big thanks to Blairman and to"," ",e.a.createElement("a",{href:"https://soundcloud.com/southtechnique",target:"_blank",rel:"noreferrer"},"Costas Chris")," ","for helping to test the alpha version!"),e.a.createElement("p",null,"And thanks again to KORG for developing the"," ",e.a.createElement("a",{href:"https://apps.apple.com/us/app/audiopocket-for-volca-sample/id927415821",target:"_blank",rel:"noreferrer"},"AudioPocket")," ","app, which inspired the core functionality of Volca Sampler."),e.a.createElement("h3",null,"FAQ"),e.a.createElement("div",{className:ye.a.qAndA},e.a.createElement("p",null,e.a.createElement("strong",null,"Q: What platforms are supported?")),e.a.createElement("p",null,"A: Anything that can run a modern web browser with a headphone output should work (PC, Mac, Linux, Android, iOS).")),e.a.createElement("div",{className:ye.a.qAndA},e.a.createElement("p",null,e.a.createElement("strong",null,"Q: Is this compatible with the volca sample2?")),e.a.createElement("p",null,"A: Yes, but only the stereo cable connection is supported. There are no plans for supporting the USB connection.")),e.a.createElement("div",{className:ye.a.qAndA},e.a.createElement("p",null,e.a.createElement("strong",null,"Q: Where will my samples be uploaded?")),e.a.createElement("p",null,"A: Nowhere. Everything is kept on your device, in your web browser's application files. SYRO (the code that converts your samples into something the volca sample can understand) is actually running inside your web browser.")),e.a.createElement("div",{className:ye.a.qAndA},e.a.createElement("p",null,e.a.createElement("strong",null,"Q: Can I export my samples to another device?")),e.a.createElement("p",null,"A: You can download the audio for any sample (either the source audio or the optimized audio with your settings applied), but we don't currently support any type of bulk export of your samples and configurations. Some type of peer-to-peer syncing support might be coming in the near future if there's interest from users.")),e.a.createElement("div",{className:ye.a.qAndA},e.a.createElement("p",null,e.a.createElement("strong",null,"Q: Where can I contact you?")),e.a.createElement("p",null,"A:"," ",e.a.createElement("a",{href:"mailto:therealbenwiley@gmail.com?subject=Volca Sampler",target:"_blank",rel:"noreferrer"},"Email")," ","to get in touch with me personally, or"," ",e.a.createElement("a",{href:"https://github.com/benwiley4000/volca-sampler/issues",target:"_blank",rel:"noreferrer"},"GitHub")," ","to file an issue with this app.")),e.a.createElement("h3",null,"Licenses"),e.a.createElement("h5",null,"SYRO"),e.a.createElement("p",null,"Copyright (c) 2014, KORG Inc. All rights reserved."),e.a.createElement("p",null,"Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:"),e.a.createElement("p",null,"Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer."),e.a.createElement("p",null,"Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution."),e.a.createElement("p",null,"Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission."),e.a.createElement("p",null,'THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.'),e.a.createElement("h5",null,"Other open source licenses"),e.a.createElement("p",null,"See the full list"," ",e.a.createElement("a",{href:"npm-licenses.html",target:"_blank",rel:"noreferrer"},"here"),"."))}var Sa=fr;const wa=["Cool","Dope","Far-out","Chill","Wicked","Bomb","Superb","Choice","Exquisite","Righteous","Dank","Alright","Very Good","Ice Cold","Sick","Juicy","Gnarly","Grainy","Most-excellent","Fortuitous","Bodacious","Tubular","Fresh"],_a=["Sample","Cut","Quotation","Extract","Sound","Noise","Clip"];function pr(){const t=wa[Math.floor(Math.random()*wa.length)],a=_a[Math.floor(Math.random()*_a.length)];return`${t} ${a}`}const Ca="sampleUpdateEvent";function qe(t,a){const n={sampleId:t,action:a,when:Date.now()};localStorage.setItem(Ca,JSON.stringify(n))}function hr(t){function a(n){if(n.key===Ca&&n.newValue){const r=JSON.parse(n.newValue);t(r)}}return window.addEventListener("storage",a),()=>{window.removeEventListener("storage",a)}}var vr=p(30),ge=p.n(vr),ka=(t,a,n)=>new Promise((r,l)=>{var u=o=>{try{s(n.next(o))}catch(m){l(m)}},i=o=>{try{s(n.throw(o))}catch(m){l(m)}},s=o=>o.done?r(o.value):Promise.resolve(o.value).then(u,i);s((n=n.apply(t,a)).next())});const Et="focused_sample_id";function Er(){const[t,a]=Object(c.useState)(new Map),[n,r]=Object(c.useState)(new Map),l=Object(c.useMemo)(()=>new Map([...t,...n]),[t,n]);Object(c.useEffect)(()=>{Ha().then(r).catch(console.error)},[]);const u=sessionStorage.getItem(Et),[i,s]=Object(c.useState)(u&&typeof u=="string"?u:null);Object(c.useEffect)(()=>{i?sessionStorage.setItem(Et,i):sessionStorage.removeItem(Et)},[i]);const[o,m]=Object(c.useState)(!0);Object(c.useEffect)(()=>{Z.getAllFromStorage().then(d=>{a(w=>new Map([...w,...d.map(k=>[k.id,k])]))}).finally(()=>{m(!1)})},[]);const f=Object(c.useCallback)((d,w)=>ka(this,null,function*(){const k=yield je(d),R=[0,0],y=yield ot(k,R);if([...y.positive,...y.negative].every(B=>B===0))return"silent";const F=yield Fa(d);let T="",P="";if(w){const B=w.name.lastIndexOf(".");B>0?(T=w.name.slice(0,B),P=w.name.slice(B)):T=w.name}else T=pr();const N=new Z.Mutable({name:T,sourceFileId:F,trim:{frames:R,waveformPeaks:y},userFileInfo:w&&{type:w.type,ext:P}});return yield N.persist(),a(B=>new Map([[N.id,N],...B])),s(N.id),Promise.resolve().then(()=>qe(N.id,"create")),"saved"}),[]),E=Object(c.useCallback)((d,w)=>{a(k=>{const R=k.get(d);if(R&&R instanceof Z.Mutable){const y=R.update(w,()=>{qe(R.id,"edit")});if(y!==R)return new Map(k).set(R.id,y)}return k})},[]),h=Object(c.useRef)(l);h.current=l;const S=Object(c.useCallback)(d=>{const w=h.current.get(d);if(w){const k=w.duplicate(R=>{qe(R,"create")});a(R=>new Map([[k.id,k],...R])),s(k.id)}},[]),b=Object(c.useRef)(t);b.current=t;const v=Object(c.useCallback)((d,w)=>{const k=b.current,R=k.get(d);if(R&&R instanceof Z.Mutable){w||R.remove().then(()=>{qe(R.id,"delete")});let y=null,F=!1;for(const[,T]of k){if(F){y=T.id;break}if(T.id===d){if(!y){F=!0;continue}break}y=T.id}s(y),a(T=>{const P=new Map(T);return P.delete(R.id),P})}},[]);Object(c.useEffect)(()=>hr(d=>ka(this,null,function*(){if(d.action==="delete")v(d.sampleId,!0);else{const w=yield Z.getOneFromStorage(d.sampleId);a(k=>new Map(k).set(w.id,w))}})),[v]);const[_,C]=Object(c.useState)("currentSample"),M=Object(c.useCallback)(d=>{s(d),C("currentSample")},[]),O=Object(c.useCallback)(()=>{s(null),C("currentSample")},[]),D=i?l.get(i):null;return e.a.createElement("div",{className:ge.a.app},e.a.createElement(Ia,{onHeaderClick:O}),e.a.createElement("div",{className:`${ge.a.mobileLayoutContainer} ${ge.a[_]}`},e.a.createElement("div",{className:ge.a.sampleListSidebar},e.a.createElement(mr,{loading:o,focusedSampleId:i,userSamples:t,factorySamples:n,onSampleSelect:M})),e.a.createElement("div",{className:ge.a.mainLayout},D?D instanceof Z.Mutable?e.a.createElement(In,{sample:D,onSampleUpdate:E,onSampleDuplicate:S,onSampleDelete:v}):e.a.createElement(Gn,{sample:D,onSampleDuplicate:S}):null,!i&&e.a.createElement(nr,{onRecordFinish:f}),(!i||D)&&e.a.createElement("div",{className:ge.a.normalFooterContainer},e.a.createElement(Sa,null))),e.a.createElement("div",{className:ge.a.mobileFooterContainer},e.a.createElement(Le.a,{fluid:"sm"},e.a.createElement("h2",null,"About Volca Sampler"),e.a.createElement(Sa,null)))),e.a.createElement(be.a,{className:ge.a.mobilePageNav,activeKey:_,variant:"underline"},e.a.createElement(be.a.Item,{onClick:()=>C("sampleList")},e.a.createElement(be.a.Link,{eventKey:"sampleList"},"List")),e.a.createElement(be.a.Item,{onClick:()=>C("currentSample")},e.a.createElement(be.a.Link,{eventKey:"currentSample"},"Sample")),e.a.createElement(be.a.Item,{onClick:()=>C("about")},e.a.createElement(be.a.Link,{eventKey:"about"},"About"))))}var yr=Er,gr=t=>{t&&t instanceof Function&&p.e(3).then(p.bind(null,187)).then(({getCLS:a,getFID:n,getFCP:r,getLCP:l,getTTFB:u})=>{a(t),n(t),r(t),l(t),u(t)})};Blob.prototype.arrayBuffer||(Blob.prototype.arrayBuffer=function(){return new Response(this).arrayBuffer()}),typeof TouchEvent=="undefined"&&(window.TouchEvent=class extends Event{}),Ra.a.render(e.a.createElement(e.a.StrictMode,null,e.a.createElement(Ka,null,e.a.createElement(yr,null))),document.getElementById("root")),gr()},21:function(j,Q,p){j.exports={"form-switch":"SampleList_form-switch__17ijL","form-check-input":"SampleList_form-check-input__3yTwH","nav-pills":"SampleList_nav-pills__DLID5","nav-item":"SampleList_nav-item__2lSgQ","nav-link":"SampleList_nav-link__sUmO0",active:"SampleList_active__4LCL3",modal:"SampleList_modal__J3ctB","modal-dialog":"SampleList_modal-dialog__3VaNW","modal-content":"SampleList_modal-content__1R10B","modal-body":"SampleList_modal-body__1INLi",waveformContainer:"SampleList_waveformContainer__2xxew",playbackActive:"SampleList_playbackActive__jKTC1",listItem:"SampleList_listItem__1w0uC",sampleTitle:"SampleList_sampleTitle__QV9QT",name:"SampleList_name__37cpF",slot:"SampleList_slot__3rbFM",playbackButton:"SampleList_playbackButton__j3RJ-",emptyListMessage:"SampleList_emptyListMessage__3ji4v"}},24:function(j,Q,p){j.exports={playbackOverlay:"WaveformPlayback_playbackOverlay__Er0Rh",playbackActive:"WaveformPlayback_playbackActive__1IHxg",playback:"WaveformPlayback_playback__2heRw",playbackButtonContainer:"WaveformPlayback_playbackButtonContainer__Lhahe",downloadButton:"WaveformPlayback_downloadButton__2s-L5"}},25:function(j,Q,p){j.exports={"form-switch":"SlotNumberInput_form-switch__39Wtl","form-check-input":"SlotNumberInput_form-check-input__oNf4Z","nav-pills":"SlotNumberInput_nav-pills__1RDi_","nav-item":"SlotNumberInput_nav-item__CuVVe","nav-link":"SlotNumberInput_nav-link__1C3wo",active:"SlotNumberInput_active__2zN4D",modal:"SlotNumberInput_modal__25tRB","modal-dialog":"SlotNumberInput_modal-dialog__1vyjC","modal-content":"SlotNumberInput_modal-content__cz3DI","modal-body":"SlotNumberInput_modal-body__ZzZE0",slotNumberRow:"SlotNumberInput_slotNumberRow__kQwOw",slotNumberContainer:"SlotNumberInput_slotNumberContainer__1q7P1",arrowControls:"SlotNumberInput_arrowControls__1LPAC",slotNumber:"SlotNumberInput_slotNumber__GC-i7",digitBlinkEffect:"SlotNumberInput_digitBlinkEffect__1_u8n",point:"SlotNumberInput_point__3pJD3",warning:"SlotNumberInput_warning__3NAeN"}},28:function(j,Q,p){j.exports={"form-switch":"Header_form-switch__7m8-P","form-check-input":"Header_form-check-input__3V7ik","nav-pills":"Header_nav-pills__1-obW","nav-item":"Header_nav-item__7_0FE","nav-link":"Header_nav-link__1QKsk",active:"Header_active__1pE38",modal:"Header_modal__3A4xt","modal-dialog":"Header_modal-dialog__3oG5V","modal-content":"Header_modal-content__JA7jP","modal-body":"Header_modal-body__32J1e",titleBar:"Header_titleBar__3BLa-",menuIcon:"Header_menuIcon__swn7p",title:"Header_title__R3bRx",titleText:"Header_titleText__3e5ME",titleR:"Header_titleR__3QRgv",titleStarburst:"Header_titleStarburst__1oLYP",titleGraphic:"Header_titleGraphic__3S89F",tagline:"Header_tagline__6mYkP"}},29:function(j,Q,p){j.exports={"form-switch":"Footer_form-switch__IQ8fU","form-check-input":"Footer_form-check-input__2mYiO","nav-pills":"Footer_nav-pills__11ybY","nav-item":"Footer_nav-item__3oAU2","nav-link":"Footer_nav-link__2BtNN",active:"Footer_active__cHt7c",modal:"Footer_modal__1qM8m","modal-dialog":"Footer_modal-dialog__3LU5E","modal-content":"Footer_modal-content__1xGht","modal-body":"Footer_modal-body__1PrCR",footer:"Footer_footer__yR_13",faqAndLicensesButton:"Footer_faqAndLicensesButton__eLI1R",faqAndLicensesEmbedded:"Footer_faqAndLicensesEmbedded__rqK4H",qAndA:"Footer_qAndA__bDlJB"}},30:function(j,Q,p){j.exports={"form-switch":"App_form-switch__3Ht4D","form-check-input":"App_form-check-input__19Z6o","nav-pills":"App_nav-pills__16LAO","nav-item":"App_nav-item__2m-_e","nav-link":"App_nav-link__32PWp",active:"App_active__2jQ78",modal:"App_modal__tC7nw","modal-dialog":"App_modal-dialog__28D_0","modal-content":"App_modal-content__1KtJW","modal-body":"App_modal-body__1JjYd",app:"App_app__2ziFi",mobileLayoutContainer:"App_mobileLayoutContainer__xakbp",sampleListSidebar:"App_sampleListSidebar__3Ks2q",sampleList:"App_sampleList__WKnRo",mainLayout:"App_mainLayout__3UKwp",currentSample:"App_currentSample__nhOND",mobileFooterContainer:"App_mobileFooterContainer__1YP8t",about:"App_about__k-55R",normalFooterContainer:"App_normalFooterContainer__hzxSk",mobilePageNav:"App_mobilePageNav__3y_u-"}},38:function(j,Q,p){j.exports={"form-switch":"SampleDetail_form-switch__31CS2","form-check-input":"SampleDetail_form-check-input__1NWgi","nav-pills":"SampleDetail_nav-pills__1brjk","nav-item":"SampleDetail_nav-item__24L50","nav-link":"SampleDetail_nav-link__V6FsG",active:"SampleDetail_active__3mnV-",modal:"SampleDetail_modal__1w1ts","modal-dialog":"SampleDetail_modal-dialog__3hbcz","modal-content":"SampleDetail_modal-content__14DW-","modal-body":"SampleDetail_modal-body__2T5wL",sampleName:"SampleDetail_sampleName__1iNn9",optionsButton:"SampleDetail_optionsButton__k0UjV",actionButtons:"SampleDetail_actionButtons__nTnTP",deleteModalHeader:"SampleDetail_deleteModalHeader__3DiKA",normalizeControlWrapper:"SampleDetail_normalizeControlWrapper__1yc_t",slotNumber:"SampleDetail_slotNumber__3sgS6",point:"SampleDetail_point__3d7qL"}},39:function(j,Q,p){j.exports={newSampleButton:"SampleMenu_newSampleButton__1VGxr",search:"SampleMenu_search__2EscQ",offcanvasBody:"SampleMenu_offcanvasBody__1rgj6",listGroup:"SampleMenu_listGroup__IWtv7",accordion:"SampleMenu_accordion__1Igxo",accordionItem:"SampleMenu_accordionItem__1GO98",accordionBody:"SampleMenu_accordionBody__yBt0g"}},42:function(j,Q,p){j.exports={"form-switch":"QualityBitDepthControl_form-switch__3nCZi","form-check-input":"QualityBitDepthControl_form-check-input__2KgZ8","nav-pills":"QualityBitDepthControl_nav-pills__lvlTW","nav-item":"QualityBitDepthControl_nav-item__MdYNK","nav-link":"QualityBitDepthControl_nav-link__2ZJvk",active:"QualityBitDepthControl_active__1J60r",modal:"QualityBitDepthControl_modal__18Jly","modal-dialog":"QualityBitDepthControl_modal-dialog__24Z0E","modal-content":"QualityBitDepthControl_modal-content__22dUY","modal-body":"QualityBitDepthControl_modal-body__3QfIn",qualityBitDepthWrapper:"QualityBitDepthControl_qualityBitDepthWrapper__2qLOe",label:"QualityBitDepthControl_label___ohmN",ticks:"QualityBitDepthControl_ticks__1u5GH",tickLabel:"QualityBitDepthControl_tickLabel__2jXRm",tickMark:"QualityBitDepthControl_tickMark__24xm0",annotations:"QualityBitDepthControl_annotations__3mXj2"}},63:function(j,Q,p){j.exports={"form-switch":"VolcaTransferControl_form-switch__1ZS81","form-check-input":"VolcaTransferControl_form-check-input__REQsM","nav-pills":"VolcaTransferControl_nav-pills__8dM77","nav-item":"VolcaTransferControl_nav-item__1lZOI","nav-link":"VolcaTransferControl_nav-link__3vJ08",active:"VolcaTransferControl_active__39Z84",modal:"VolcaTransferControl_modal__2ltkP","modal-dialog":"VolcaTransferControl_modal-dialog__oCJNH","modal-content":"VolcaTransferControl_modal-content__2DCx8","modal-body":"VolcaTransferControl_modal-body__3hAAt",transferInfo:"VolcaTransferControl_transferInfo__2pr1v",transferButton:"VolcaTransferControl_transferButton__11MBQ",preTransferModal:"VolcaTransferControl_preTransferModal__fLiiV",progressAnnotation:"VolcaTransferControl_progressAnnotation__2zJ9A"}},8:function(j,Q,p){j.exports={"form-switch":"WaveformEdit_form-switch__2DZid","form-check-input":"WaveformEdit_form-check-input__2TImp","nav-pills":"WaveformEdit_nav-pills__3uv7V","nav-item":"WaveformEdit_nav-item__1Cy-X","nav-link":"WaveformEdit_nav-link__rjUB_",active:"WaveformEdit_active__3qc2K",modal:"WaveformEdit_modal__18zXt","modal-dialog":"WaveformEdit_modal-dialog__3Bo89","modal-content":"WaveformEdit_modal-content___UGgZ","modal-body":"WaveformEdit_modal-body__33fKo",waveformAdjacentControls:"WaveformEdit_waveformAdjacentControls__12b8z",waveformContainer:"WaveformEdit_waveformContainer__Qq3MI",cursor:"WaveformEdit_cursor__1Ntb3",trim:"WaveformEdit_trim__1GV76",playbackActive:"WaveformEdit_playbackActive__hTwgX",bar:"WaveformEdit_bar__1KFgt",handle:"WaveformEdit_handle__23NoG",time:"WaveformEdit_time__YX5rg",left:"WaveformEdit_left__3Jfpn",right:"WaveformEdit_right__35CjW",waveformOverlay:"WaveformEdit_waveformOverlay__3oZfw"}}},[[169,1,2]]]);

//# sourceMappingURL=main.02368664.chunk.js.map