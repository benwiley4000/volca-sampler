(this["webpackJsonpvolca-sampler"]=this["webpackJsonpvolca-sampler"]||[]).push([[0],{125:function(x,z,E){"use strict";E.r(z);var d=E(0),o=E.n(d),Oe=E(8),ut=E.n(Oe),Hn=E(93),Vn=E(94),Z=E(25),dt=E(28),X=E.n(dt);function ft({onMenuOpen:e,onHeaderClick:t}){return o.a.createElement("h1",{className:X.a.title,onClick:t},o.a.createElement("span",{className:X.a.menuIcon,onClick:n=>{n.stopPropagation(),e()}},"\u2630"),o.a.createElement("span",{className:X.a.titleText,"data-text":"Volca Sample"},"Volca Sample",o.a.createElement("span",{className:X.a.titleR},"r"),o.a.createElement("div",{className:X.a.titleStarburst},Array(24).fill().map((n,a,{length:l})=>o.a.createElement("span",{key:a,style:{"--rotation":`${a*360/l}deg`}})))),o.a.createElement("img",{className:X.a.titleGraphic,src:"volca_sample.png",alt:""}),o.a.createElement("svg",{width:0,height:0},o.a.createElement("filter",{id:"outline"},o.a.createElement("feMorphology",{in:"SourceAlpha",result:"DILATED",operator:"dilate",radius:"1"}),o.a.createElement("feFlood",{floodColor:"var(--stroke-color)",floodOpacity:"1",result:"PINK"}),o.a.createElement("feComposite",{in:"PINK",in2:"DILATED",operator:"in",result:"OUTLINE"}),o.a.createElement("feMerge",null,o.a.createElement("feMergeNode",{in:"OUTLINE"}),o.a.createElement("feMergeNode",{in:"SourceGraphic"})))))}var mt=ft,q=E(139),pt=E(49),De=E.n(pt),ht=E(44),ee=E.n(ht),Pe=E(140),Ae=E(72);const te=31250;var vt=Object.defineProperty,gt=Object.defineProperties,yt=Object.getOwnPropertyDescriptors,ne=Object.getOwnPropertySymbols,ke=Object.prototype.hasOwnProperty,Me=Object.prototype.propertyIsEnumerable,se=(e,t,n)=>t in e?vt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,W=(e,t)=>{for(var n in t||(t={}))ke.call(t,n)&&se(e,n,t[n]);if(ne)for(var n of ne(t))Me.call(t,n)&&se(e,n,t[n]);return e},K=(e,t)=>gt(e,yt(t)),Re=(e,t)=>{var n={};for(var a in e)ke.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&ne)for(var a of ne(e))t.indexOf(a)<0&&Me.call(e,a)&&(n[a]=e[a]);return n},ae=(e,t,n)=>(se(e,typeof t!="symbol"?t+"":t,n),n),F=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{s(n.next(r))}catch(u){l(u)}},i=r=>{try{s(n.throw(r))}catch(u){l(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});const re=ee.a.createInstance({name:"audio_file_data",driver:ee.a.INDEXEDDB}),oe=ee.a.createInstance({name:"sample_metadata",driver:ee.a.INDEXEDDB});function bt(e){return F(this,null,function*(){const t=Object(Pe.a)();return yield re.setItem(t,e),t})}const ue="0.3.0",Et={"0.1.0":e=>{const t=e,{clip:n}=t,a=Re(t,["clip"]);return K(W({},a),{trimFrames:n.map(c=>Math.round(c*te)),metadataVersion:"0.2.0"})},"0.2.0":e=>F(void 0,null,function*(){const t=e,{trimFrames:n}=t,a=Re(t,["trimFrames"]),l=yield Xe(a.sourceFileId,n),c={frames:n,waveformPeaks:l};return K(W({},a),{trim:c,metadataVersion:"0.3.0"})})};function wt(e){return F(this,null,function*(){let t=e;for(;t.metadataVersion!==ue;){const n=Et[e.metadataVersion];if(!n){console.warn(`Failed to properly upgrade metadata for sample "${t.name}"`),t={name:t.name,sourceFileId:t.sourceFileId,id:t.id,metadataVersion:ue};break}t=yield n(t)}return t})}const $=class{constructor({name:e,sourceFileId:t,trim:n,id:a=Object(Pe.a)(),userFileInfo:l=null,slotNumber:c=0,dateSampled:i=Date.now(),dateModified:s=i,useCompression:r=!0,qualityBitDepth:u=16,scaleCoefficient:w=1}){this.id=a,this.metadata={name:e,sourceFileId:t,trim:n,userFileInfo:l,slotNumber:c,dateSampled:i,dateModified:s,useCompression:r,qualityBitDepth:u,scaleCoefficient:w,metadataVersion:ue}}duplicate(){const e=new $.Mutable(K(W({},this.metadata),{name:`${this.metadata.name} (copy)`,dateModified:Date.now()}));return e.persist(),e}static cacheSourceFileData(e,t){this.sourceFileData.set(e,t),this.recentlyCachedSourceFileIds=[e,...this.recentlyCachedSourceFileIds.filter(a=>a!==e)];const n=this.recentlyCachedSourceFileIds.slice(this.MAX_CACHED);for(const a of n)this.sourceFileData.delete(a);this.recentlyCachedSourceFileIds=this.recentlyCachedSourceFileIds.slice(0,this.MAX_CACHED)}static getSourceFileData(e){return F(this,null,function*(){{const n=this.sourceFileData.get(e);if(n)return n}if(e.includes(".")){const n=yield fetch(e);if(n.status>=400)return Promise.reject(new Error(`Failed to fetch source file "${e}"`));const a=yield n.arrayBuffer(),l=new Uint8Array(a);return this.cacheSourceFileData(e,l),l}const t=yield re.getItem(e);return t?t instanceof Uint8Array?(this.cacheSourceFileData(e,t),t):Promise.reject("Source data is of unexpected type"):Promise.reject("Missing source data")})}static getAllMetadataFromStore(){return F(this,null,function*(){const e=new Map,t=[];return yield oe.iterate((n,a)=>{n&&t.push(wt(n).then(l=>{e.set(a,l)}).catch(l=>{console.error(l),console.warn(`Failed to upgrade metadata "${a}" (${n.name}); ignoring.`)}))}),yield Promise.all(t),e})}static getAllFromStorage(){return F(this,null,function*(){const e=yield this.getAllMetadataFromStore(),t=yield je(),n=(yield re.keys()).concat(t.map(({sourceFileId:l})=>l));return[...e].map(([l,c])=>{const{sourceFileId:i}=c;return n.includes(i)?new $.Mutable(W({id:l},c)):(console.warn(`Found metadata "${c.name||l}" with missing data "${i}; ignoring.`),null)}).filter(Boolean).sort((l,c)=>c.metadata.dateModified-l.metadata.dateModified)})}};let N=$;ae(N,"Mutable",class extends ${constructor(e){super(e);setTimeout(()=>F(this,null,function*(){(yield oe.keys()).includes(this.id)||console.warn(`Expected sample metadata container ${this.id} to be persisted`)}))}persist(){return F(this,null,function*(){yield oe.setItem(this.id,this.metadata)})}update(e){const{id:t,metadata:n}=this,a=typeof e=="function"?e(n):e;if(Object.keys(a).every(i=>a[i]===n[i]))return this;const l=K(W(W({},n),a),{dateModified:Date.now()}),c=new $.Mutable(W({id:t},l));return c.persist(),c}remove(){return F(this,null,function*(){if(yield oe.removeItem(this.id),this.metadata.sourceFileId.includes("."))return;const e=yield $.getAllMetadataFromStore();for(const[,{sourceFileId:t}]of e)if(t===this.metadata.sourceFileId)return;yield re.removeItem(this.metadata.sourceFileId)})}}),ae(N,"sourceFileData",new Map),ae(N,"recentlyCachedSourceFileIds",[]),ae(N,"MAX_CACHED",10);let de;function je(){return de||(de=fetch("factory-samples.json").then(e=>e.json())),de}function St(){return F(this,null,function*(){const e=yield je();return new Map(e.map(t=>[t.id,new N(K(W({},t),{trim:{frames:[t.trim.frames[0],t.trim.frames[1]],waveformPeaks:{positive:new Float32Array(Object(Ae.a)(t.trim.waveformPeaks.positive)),negative:new Float32Array(Object(Ae.a)(t.trim.waveformPeaks.negative))}}}))]))})}var Ie=Math.pow,fe=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{s(n.next(r))}catch(u){l(u)}},i=r=>{try{s(n.throw(r))}catch(u){l(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});function me(e,t){const n=4,a=t[0]*n,l=e.length-t[0]-t[1];return new Float32Array(e.buffer,a,l)}function pe(e,t){const n=e.length-t[0]-t[1],a=new Float32Array(n),l=Array(e.numberOfChannels).fill().map((c,i)=>me(e.getChannelData(i),t));for(let c=0;c<n;c++){let i=0;for(let s=0;s<l.length;s++)i+=l[s][c];i/=l.length,a[c]=i}return a}function Be(e){let t=0;for(const n of e){const a=Math.abs(n);a>t&&(t=a)}return t}function Ct(e,t){if(t!==1)for(let n=0;n<e.length;n++)e[n]*=t}function Ot(e,t){const n=Ie(2,t-1);for(let a=0;a<e.length;a++)e[a]=Math.round(e[a]*n)/n}function Ne(e){for(let t=0;t<e.length;t++)e[t]>1?e[t]=1:e[t]<-1&&(e[t]=-1)}function Dt(e){const t=e.length,n=e[0].length,a=new Float32Array(t*n);for(let l=0;l<a.length;l++){const c=t*l;for(let i=0;i<t;i++)a[c+i]=e[i][l]}return a}function xe(e){const t=new Int16Array(e.length),n=Ie(2,15);for(let a=0;a<e.length;a++)t[a]=e[a]===1?n-1:n*e[a];return t}function Fe(){return window.AudioContext||window.webkitAudioContext}let Le;function Te(){const e=Fe();return Le=Le||new e({sampleRate:te})}function le(e){return fe(this,null,function*(){const t=new Uint8Array(e);return yield new Promise((a,l)=>{Te().decodeAudioData(t.buffer,a,l)})})}function he(e,t){return fe(this,null,function*(){const n=yield N.getSourceFileData(e),a=yield le(n);if(t)for(let l=0;l<a.numberOfChannels;l++)Ne(a.getChannelData(l));return a})}function We(e){return fe(this,null,function*(){const{qualityBitDepth:t,sourceFileId:n,userFileInfo:a,scaleCoefficient:l,trim:{frames:c}}=e.metadata;if(t<8||t>16||!Number.isInteger(t))throw new Error(`Expected bit depth between 8 and 16. Received: ${t}`);const i=yield he(n,Boolean(a)),s=i.numberOfChannels===1?me(i.getChannelData(0),c):pe(i,c);l!==1&&Ct(s,l),t<16&&Ot(s,t);const r=xe(s),u=r.length*2,w=De()({channels:1,sampleRate:i.sampleRate,bitDepth:16,dataLength:u}),v=new Uint8Array(w.length+u);return v.set(w),v.set(new Uint8Array(r.buffer),w.length),{data:v,sampleRate:16}})}const Pt={playAudioBuffer(e,t){throw new Error("Must render AudioPlaybackContextProvider")},isAudioBusy:!1},He=Object(d.createContext)(Pt);function At({children:e}){const[t,n]=Object(d.useState)(!1),a=Object(d.useCallback)((c,{onTimeUpdate:i=()=>null,onEnded:s=()=>null}={})=>{if(t)throw new Error("Wait until audio playback has finished to start new playback");n(!0);let r,u;try{r=Te(),u=r.createBufferSource(),u.buffer=c,u.connect(r.destination),u.start()}catch(y){throw n(!1),y}const w=r.currentTime;i(0);let v=requestAnimationFrame(b);function b(){i(r.currentTime-w),v=requestAnimationFrame(b)}let g=!1;return u.addEventListener("ended",()=>{g||(i(c.duration),s()),n(!1),cancelAnimationFrame(v)}),function(){u.stop(),g=!0}},[t]),l=Object(d.useMemo)(()=>({playAudioBuffer:a,isAudioBusy:t}),[a,t]);return Object(d.createElement)(He.Provider,{value:l},e)}function Ve(){return Object(d.useContext)(He)}var kt=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{s(n.next(r))}catch(u){l(u)}},i=r=>{try{s(n.throw(r))}catch(u){l(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});const G=6,ze=G*44;function Ue(e,t){const n=Math.floor(G*e.length/t),a=new Float32Array(Math.floor(e.length/n)),l=new Float32Array(Math.floor(e.length/n));for(let c=0;c<a.length;c++){const i=new Float32Array(e.buffer,c*n*4,n);let s=0,r=0;for(const u of i)u>s&&(s=u),u<r&&(r=u);a[c]=Math.min(1,s),l[c]=Math.max(-1,r)}return{positive:a,negative:l}}function Xe(e,t){return kt(this,null,function*(){const n=yield he(e,!1),a=pe(n,t);return Ue(a,ze)})}var Mt=E(81);const Rt=Z.a.canvas({width:"100%",height:"100%",display:"block",imageRendering:"pixelated"});function jt(e,t){function n(l,c){e.width=l,e.height=c}n(e.offsetWidth,e.offsetHeight),t({width:e.offsetWidth,height:e.offsetHeight});const a=new Mt.a(([l])=>{const{width:c,height:i}=l.contentRect;n(c,i),t({width:c,height:i})});return a.observe(e),()=>a.disconnect()}function It(e,t,n){const a=getComputedStyle(document.documentElement),l=a.getPropertyValue("--bs-primary"),c=a.getPropertyValue("--bs-primary-darkened"),i=e.getContext("2d");i.imageSmoothingEnabled=!1;const{width:s,height:r}=e;i.clearRect(0,0,s,r);const u=Math.floor(r*(2/3))+1;i.fillStyle=l,t.positive.forEach((v,b)=>{const g=u*v,y=Math.max(Math.round(n*g),1);i.fillRect(b*G,u-y,G-1,y)});const w=r-u;i.fillStyle=c,t.negative.forEach((v,b)=>{const g=w*v*-1,y=Math.round(n*g);i.fillRect(b*G,u,G-1,y)})}function Bt({peaks:e,scaleCoefficient:t,waveformRef:n}){const a=Object(d.useRef)(null);Object(d.useImperativeHandle)(n,()=>a.current);const[l,c]=Object(d.useState)(Symbol()),i=Object(d.useRef)({width:0,height:0});return Object(d.useLayoutEffect)(()=>{if(!a.current)throw new Error("Canvas should be defined");return i.current.width=a.current.offsetWidth,i.current.height=a.current.offsetHeight,jt(a.current,({width:s,height:r})=>{(s!==i.current.width||r!==i.current.height)&&(c(Symbol()),i.current.width=s,i.current.height=r)})},[]),Object(d.useLayoutEffect)(()=>{const s=a.current;if(!s)throw new Error("Canvas should be defined");let r=requestAnimationFrame(()=>{r=requestAnimationFrame(()=>{It(s,e,t)})});return()=>cancelAnimationFrame(r)},[e,t,l]),o.a.createElement(Rt,{ref:a})}var $e=Bt;const Nt=Z.a.div({width:`${ze}px`,height:"40px"}),Ge=typeof IntersectionObserver!="undefined",xt=o.a.memo(({sample:e,selected:t,onSampleSelect:n})=>{const a=Object(d.useRef)(null),[l,c]=Object(d.useState)(!Ge);return Object(d.useLayoutEffect)(()=>{if(!Ge)return;const i=a.current;if(!i)throw new Error("Waveform container should be defined");const s=i.getBoundingClientRect();if(s.top+s.height>=0&&s.bottom-s.height<=window.innerHeight){c(!0);return}const r=new IntersectionObserver(([u])=>{u.isIntersecting&&(c(!0),r.unobserve(i))});return r.observe(i),()=>r.disconnect()},[]),o.a.createElement(q.a.Item,{active:t,onClick:()=>n(e.id)},o.a.createElement("div",null,e.metadata.name),o.a.createElement(Nt,{ref:a},l&&o.a.createElement($e,{peaks:e.metadata.trim.waveformPeaks,scaleCoefficient:e.metadata.scaleCoefficient})))});function Ft({samples:e,selectedSampleId:t,onSampleSelect:n}){return o.a.createElement(q.a,{variant:"flush"},[...e].map(([a,l])=>o.a.createElement(xt,{key:a,sample:l,selected:a===t,onSampleSelect:n})))}var _e=Ft,Lt=E(133),Tt=E(134),ce=E(87),B=E(82),L=E(136),Wt=Object.defineProperty,Ht=Object.defineProperties,Vt=Object.getOwnPropertyDescriptors,ie=Object.getOwnPropertySymbols,Ke=Object.prototype.hasOwnProperty,Ye=Object.prototype.propertyIsEnumerable,Qe=(e,t,n)=>t in e?Wt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,zt=(e,t)=>{for(var n in t||(t={}))Ke.call(t,n)&&Qe(e,n,t[n]);if(ie)for(var n of ie(t))Ye.call(t,n)&&Qe(e,n,t[n]);return e},Ut=(e,t)=>Ht(e,Vt(t)),Xt=(e,t)=>{var n={};for(var a in e)Ke.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&ie)for(var a of ie(e))t.indexOf(a)<0&&Ye.call(e,a)&&(n[a]=e[a]);return n},$t=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{s(n.next(r))}catch(u){l(u)}},i=r=>{try{s(n.throw(r))}catch(u){l(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});function Gt({sourceAudioBuffer:e,sample:{metadata:{trim:{frames:t},scaleCoefficient:n}},onSetTrimFrames:a,onSetScaleCoefficient:l}){const c=Object(d.useMemo)(()=>e?pe(e,[0,0]):new Float32Array,[e]),[i,s]=Object(d.useState)(null),r=Object(d.useMemo)(()=>i&&i.offsetWidth,[i]),u=Object(d.useMemo)(()=>!r||!c.length?{positive:new Float32Array,negative:new Float32Array}:Ue(c,r),[r,c]),w=Object(d.useMemo)(()=>{if(!e)return 0;const f=me(c,t);return Be(f)},[e,c,t]),v=1/w;Object(d.useLayoutEffect)(()=>{n>v&&l(v)},[n,v,l]);const b=Object(d.useMemo)(()=>{if(!c.length||!r)return[0,0];const f=r/c.length;return t.map(m=>m*f)},[r,c.length,t]),g=Object(d.useRef)(null),y=Object(d.useRef)(null);return Object(d.useEffect)(()=>{function f(p){if(g.current===null||!r||!c.length)return;const{pageX:D}=p,A=D-g.current;if(A){const k=A/r,C=Math.round(c.length*k);a(M=>{let O=M[0]+C;return O=Math.min(O,c.length-M[1]-2e3),O=Math.max(O,0),[O,M[1]]}),g.current=D}}function m(){g.current=null,document.body.style.userSelect="unset"}return window.addEventListener("mousemove",f),window.addEventListener("mouseup",m),()=>{window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",m)}},[r,c.length,a]),Object(d.useEffect)(()=>{function f(p){if(y.current===null||!r||!c.length)return;const{pageX:D}=p,A=y.current-D;if(A){const k=A/r,C=Math.round(c.length*k);a(M=>{let O=M[1]+C;return O=Math.min(O,c.length-M[0]-2e3),O=Math.max(O,0),[M[0],O]}),y.current=D}}function m(){y.current=null,document.body.style.userSelect="unset"}return window.addEventListener("mousemove",f),window.addEventListener("mouseup",m),()=>{window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",m)}},[r,c.length,a]),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{style:{position:"relative"}},o.a.createElement("div",{style:{position:"absolute",right:0,bottom:4}},o.a.createElement(B.a,{type:"button",variant:"light",disabled:n===v,onClick:()=>l(v)},"Normalize")," ",o.a.createElement(B.a,{type:"button",variant:"light",disabled:n===1,onClick:()=>l(1)},"Original level"))),o.a.createElement("div",{style:{position:"relative",backgroundColor:"#f3f3f3"}},o.a.createElement($e,{waveformRef:s,peaks:u,scaleCoefficient:n}),o.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,left:0,right:`calc(100% - ${b[0]}px)`,background:"#f3f3f3"}},o.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,right:0,width:2,background:"var(--bs-dark)"}}),o.a.createElement("div",{style:{position:"absolute",top:"100%",right:0,width:20,height:20,background:"var(--bs-dark)",borderRadius:10,transform:"translateX(50%)"},onTouchStart:f=>{f.preventDefault(),document.body.style.userSelect="none",g.current=f.touches[0].pageX},onMouseDown:f=>{document.body.style.userSelect="none",g.current=f.pageX},onTouchMove:f=>{if(f.preventDefault(),g.current===null||!r||!c.length)return;const{pageX:m}=f.touches[0],p=m-g.current;if(p){const D=p/r,A=Math.round(c.length*D);a(k=>{let C=k[0]+A;return C=Math.min(C,c.length-k[1]-2e3),C=Math.max(C,0),[C,k[1]]}),g.current=m}},onTouchEnd:()=>{g.current=null},onTouchCancel:()=>{g.current=null}})),o.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,right:0,left:`calc(100% - ${b[1]}px)`,background:"#f3f3f3"}},o.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,left:0,width:2,background:"var(--bs-dark)"}}),o.a.createElement("div",{style:{position:"absolute",top:"100%",left:0,width:20,height:20,background:"var(--bs-dark)",borderRadius:10,transform:"translateX(-50%)"},onTouchStart:f=>{f.preventDefault(),document.body.style.userSelect="none",y.current=f.touches[0].pageX},onMouseDown:f=>{document.body.style.userSelect="none",y.current=f.pageX},onTouchMove:f=>{if(f.preventDefault(),y.current===null||!r||!c.length)return;const{pageX:m}=f.touches[0],p=y.current-m;if(p){const D=p/r,A=Math.round(c.length*D);a(k=>{let C=k[1]+A;return C=Math.min(C,c.length-k[0]-2e3),C=Math.max(C,0),[k[0],C]}),y.current=m}},onTouchEnd:()=>{y.current=null},onTouchCancel:()=>{y.current=null}}))))}function _t(e){var t=e,{sample:n}=t,a=Xt(t,["sample"]);const[l,c]=Object(d.useState)(null);Object(d.useEffect)(()=>{let s=!1;return(()=>$t(this,null,function*(){if(s)return;const r=yield he(n.metadata.sourceFileId,Boolean(n.metadata.userFileInfo));s||c([n.metadata.sourceFileId,r])}))(),()=>{s=!0}},[n.metadata.sourceFileId,n.metadata.userFileInfo]);const i=Object(d.useRef)(n);return l&&n.metadata.sourceFileId===l[0]&&(i.current=n),o.a.createElement(Gt,Ut(zt({},a),{sample:i.current,sourceAudioBuffer:l&&l[1]}))}var Kt=_t,Yt=E(141),Qt=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{s(n.next(r))}catch(u){l(u)}},i=r=>{try{s(n.throw(r))}catch(u){l(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});let Je;function Jt(){return Qt(this,null,function*(){if(typeof window.CREATE_SYRO_BINDINGS!="function")return Promise.reject("Expected CREATE_SYRO_BINDINGS global function to exist");const e=yield window.CREATE_SYRO_BINDINGS();return Je=Je||new Promise((t,n)=>{let a;try{a={prepareSampleBufferFromWavData:e.cwrap("prepareSampleBufferFromWavData","number",["array","number","number","number","number"]),prepareSampleBufferFrom16BitPcmData(){throw new Error("This function does not work. Use prepareSampleBufferFromWavData.")},getSampleBufferChunkPointer:e.cwrap("getSampleBufferChunkPointer","number",["number"]),getSampleBufferChunkSize:e.cwrap("getSampleBufferChunkSize","number",["number"]),getSampleBufferProgress:e.cwrap("getSampleBufferProgress","number",["number"]),getSampleBufferTotalSize:e.cwrap("getSampleBufferTotalSize","number",["number"]),cancelSampleBufferWork:e.cwrap("cancelSampleBufferWork",null,["number"]),registerUpdateCallback(l){return e.addFunction(l,"vi")},unregisterUpdateCallback(l){e.removeFunction(l)},heap8Buffer(){return e.HEAP8.buffer}}}catch(l){n(l);return}t(a)})})}var Zt=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{s(n.next(r))}catch(u){l(u)}},i=r=>{try{s(n.throw(r))}catch(u){l(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});function qt(e,t){let n=!1,a=()=>{};return{cancelWork(){n=!0,a()},sampleBufferPromise:(()=>Zt(this,null,function*(){const{prepareSampleBufferFromWavData:l,getSampleBufferChunkPointer:c,getSampleBufferChunkSize:i,getSampleBufferProgress:s,getSampleBufferTotalSize:r,cancelSampleBufferWork:u,registerUpdateCallback:w,unregisterUpdateCallback:v,heap8Buffer:b}=yield Jt();if(n)return new Uint8Array;const{data:g}=yield We(e);if(n)return new Uint8Array;let y,f=0;const m=w(D=>{if(n)return;const A=r(D);y||(y=new Uint8Array(A));const k=c(D),C=i(D),M=s(D);y.set(new Uint8Array(b(),k,C),M-C),f=M/A}),p=l(g,g.length,e.metadata.slotNumber,e.metadata.qualityBitDepth,e.metadata.useCompression?1:0,m);t(f);try{yield new Promise(D=>{let A;a=()=>{cancelAnimationFrame(A),u(p),D()},k();function k(){if(f&&(t(f),f>=1)){D();return}A=requestAnimationFrame(k)}})}finally{a=()=>{},v(m)}if(n)return new Uint8Array;if(!y)throw new Error("Unexpected condition: sampleBuffer should be defined");return y}))()}}var en=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{s(n.next(r))}catch(u){l(u)}},i=r=>{try{s(n.throw(r))}catch(u){l(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});function tn({sample:e}){const[t,n]=Object(d.useState)(0),[a,l]=Object(d.useState)("idle"),[c,i]=Object(d.useState)(null),[s,r]=Object(d.useState)(null);Object(d.useEffect)(()=>{c instanceof AudioBuffer&&s&&(r(null),s.fn())},[c,s]);const u=Object(d.useRef)(()=>{});Object(d.useEffect)(()=>{let b=!1;n(0),l("idle"),i(null),r(null),u.current=()=>{b=!0};try{const{sampleBufferPromise:g,cancelWork:y}=qt(e,f=>{b||n(f)});u.current=()=>{y(),b=!0},g.then(f=>en(this,null,function*(){if(b)return;u.current=()=>{b=!0};const m=yield le(f);b||i(m)}))}catch(g){console.error(g),i(new Error(String(g)))}return()=>u.current()},[e]);const{playAudioBuffer:w,isAudioBusy:v}=Ve();return o.a.createElement(o.a.Fragment,null,o.a.createElement(B.a,{type:"button",variant:"primary",onClick:b=>{if(!(c instanceof AudioBuffer)){if(!c){const g=b.currentTarget;r({fn:()=>g.click()})}return}try{l("transferring");const g=w(c,{onTimeUpdate:y=>n(y/c.duration),onEnded:()=>l("idle")});u.current=()=>{g(),l("idle")}}catch(g){console.error(g),l("error")}},disabled:v||c instanceof Error||a==="transferring"},"Transfer to volca sample"),o.a.createElement("br",null),c&&a==="idle"?null:a==="error"?"Error transferring":o.a.createElement(o.a.Fragment,null,o.a.createElement("p",null,c?c instanceof AudioBuffer?"Transferring to Volca Sample...":"Error preparing sample for transfer":"Preparing sample for transfer..."),o.a.createElement(Yt.a,{now:100*t}),o.a.createElement("br",null),o.a.createElement(B.a,{type:"button",variant:"light",onClick:()=>u.current()},"Cancel")),o.a.createElement("br",null))}var nn=tn,Ze=E(66),qe=E.n(Ze),an=E(137),rn=E(132),ve=E(67),ge=E(68),on=E(83),ln=E(17),T=E.n(ln),et=Math.pow;Ze.Digit.defaultProps.offOpacity=0;const tt=(e,t)=>Math.min(199,t+et(10,e)),nt=(e,t)=>Math.max(0,t-et(10,e));function cn({sample:e,onSampleUpdate:t}){const[n,a]=Object(d.useState)(e.metadata.slotNumber);Object(d.useEffect)(()=>{a(e.metadata.slotNumber)},[e.metadata.slotNumber]);const[l,c]=Object(d.useState)(null),i=Object(d.useCallback)(w=>{t(e.id,({slotNumber:v})=>({slotNumber:tt(w,v)}))},[e.id,t]),s=Object(d.useCallback)(w=>{t(e.id,({slotNumber:v})=>({slotNumber:nt(w,v)}))},[e.id,t]),r=Object(d.useRef)(null),u=Object(d.useRef)(null);{const w=Object(d.useRef)(l);w.current=l;const v=Object(d.useRef)(e.id);v.current=e.id;const b=Object(d.useRef)(n);b.current=n,Object(d.useEffect)(()=>{if(!u.current)throw new Error("Expected elements to exist");function g(S){const h=w.current;if(h!==null)switch(S.stopPropagation(),S.preventDefault(),S.key){case"ArrowDown":a(P=>nt(h,P));break;case"ArrowUp":a(P=>tt(h,P));break;case"ArrowLeft":c(P=>P!==null&&P<2?P+1:P);break;case"ArrowRight":c(P=>P&&P-1);break;case"Enter":case"Escape":c(null);break;default:break}}function y(S){const h=w.current;if(h===null)return;S.stopPropagation(),S.preventDefault();const P=b.current;if(isNaN(Number(S.key)))t(v.current,{slotNumber:P});else{const j=String(P).padStart(3,"0").split("");j[2-h]=S.key;const I=Math.min(199,Math.max(0,Number(j.join(""))));c(h?h-1:null),t(v.current,{slotNumber:I})}}function f(S){r.current&&r.current.contains(S.target)||c(null)}document.addEventListener("keydown",g,!0),document.addEventListener("keyup",y,!0),document.addEventListener("click",f);const m=r.current;let p=0,D=!1,A=!1,k=0;function C(S){document.body.style.userSelect="none",p=S instanceof MouseEvent?S.pageY:S.touches[0].pageY,D=!0,A=!1,k=b.current}m.addEventListener("mousedown",C),m.addEventListener("touchstart",S=>{S.preventDefault(),C(S)});function M(S){if(!D)return;const{pageY:h}=S instanceof MouseEvent?S:S.touches[0],P=2,j=Math.round((p-h)/P);j&&(A=!0,a(Math.min(199,Math.max(0,k+j))))}window.addEventListener("mousemove",M),m.addEventListener("touchmove",M);function O(){document.body.style.userSelect="unset",D=!1,A&&t(v.current,{slotNumber:b.current})}window.addEventListener("mouseup",O),m.addEventListener("touchend",O),m.addEventListener("touchcancel",()=>{document.body.style.userSelect="unset"});function R(S){A||u.current&&u.current.some(h=>h.contains(S.target))||c(2)}return m.addEventListener("click",R),u.current.forEach((S,h)=>{const P=h;S.addEventListener("click",()=>{A||c(P)}),S.addEventListener("touchstart",j=>{j.preventDefault()})}),()=>{document.removeEventListener("keydown",g,!0),document.removeEventListener("keyup",y,!0),document.removeEventListener("click",f),window.removeEventListener("mousemove",M),window.removeEventListener("mouseup",O)}},[t])}return Object(d.useEffect)(()=>{if(!u.current)throw new Error("Expected elements to exist");u.current.forEach((w,v)=>{v===l?w.classList.add(T.a.active):w.classList.remove(T.a.active)})},[l]),o.a.createElement(o.a.Fragment,null,o.a.createElement(L.a.Label,null,"Destination"),o.a.createElement("br",null),o.a.createElement("div",{className:T.a.slotNumberRow},o.a.createElement("div",{className:T.a.slotNumberContainer},o.a.createElement("div",{className:T.a.arrowControls},o.a.createElement("span",{onClick:()=>i(2)},o.a.createElement("img",{src:ve.a,alt:"Increment 100"})),o.a.createElement("span",{onClick:()=>i(1)},o.a.createElement("img",{src:ve.a,alt:"Increment 10"})),o.a.createElement("span",{onClick:()=>i(0)},o.a.createElement("img",{src:ve.a,alt:"Increment 1"}))),o.a.createElement("div",{className:T.a.slotNumber,title:`Slot ${n}`,ref:r},o.a.createElement(qe.a,{value:"8888",color:"var(--bs-gray-dark)",strokeColor:"transparent",digitCount:4}),o.a.createElement(qe.a,{ref:w=>{const v=Object(Oe.findDOMNode)(w);if(v){v.querySelectorAll("circle").forEach(g=>{v.removeChild(g)});const b=document.createElementNS("http://www.w3.org/2000/svg","circle");b.classList.add(T.a.point),b.setAttribute("cx","10.7"),b.setAttribute("cy","17"),b.setAttribute("r","1"),v.appendChild(b),u.current=[].slice.call(v.querySelectorAll("g")).reverse().slice(0,3)}},value:`5${String(n).padStart(3,"0")}`,digitProps:{color:"var(--bs-primary)"},digitCount:4})),o.a.createElement("div",{className:T.a.arrowControls},o.a.createElement("span",{onClick:()=>s(2)},o.a.createElement("img",{src:ge.a,alt:"Decrement 100"})),o.a.createElement("span",{onClick:()=>s(1)},o.a.createElement("img",{src:ge.a,alt:"Decrement 10"})),o.a.createElement("span",{onClick:()=>s(0)},o.a.createElement("img",{src:ge.a,alt:"Decrement 1"})))),e.metadata.slotNumber>99&&n>99&&o.a.createElement(an.a,{placement:"auto-end",overlay:o.a.createElement(rn.a,null,"To transfer to this destination, be sure you have a volca sample2. The original volca sample only supports slots 0-99.")},o.a.createElement("img",{className:T.a.warning,src:on.a,alt:"destination-warning"}))))}var sn=cn,un=E(84),dn=E.n(un),fn=Object.defineProperty,mn=Object.defineProperties,pn=Object.getOwnPropertyDescriptors,at=Object.getOwnPropertySymbols,hn=Object.prototype.hasOwnProperty,vn=Object.prototype.propertyIsEnumerable,rt=(e,t,n)=>t in e?fn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ot=(e,t)=>{for(var n in t||(t={}))hn.call(t,n)&&rt(e,n,t[n]);if(at)for(var n of at(t))vn.call(t,n)&&rt(e,n,t[n]);return e},lt=(e,t)=>mn(e,pn(t)),gn=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{s(n.next(r))}catch(u){l(u)}},i=r=>{try{s(n.throw(r))}catch(u){l(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});function yn(e,t){const n=URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download=t,a.style.display="none",document.body.appendChild(a),a.click(),a.remove(),URL.revokeObjectURL(n)}function bn({sample:e,onSampleUpdate:t,onSampleDuplicate:n,onSampleDelete:a}){const l=e&&e.id,c=Object(d.useCallback)(m=>l&&t(l,{scaleCoefficient:m}),[l,t]),i=Object(d.useCallback)(m=>l&&t(l,p=>lt(ot({},p),{trim:lt(ot({},p.trim),{frames:m(p.trim.frames)})})),[l,t]),[s,r]=Object(d.useState)(null),[u,w]=Object(d.useState)(null),[v,b]=Object(d.useState)(null);Object(d.useEffect)(()=>{u instanceof AudioBuffer&&v&&(b(null),v.fn())},[u,v]),Object(d.useEffect)(()=>{if(r(null),b(null),e){let m=!1;We(e).then(({data:p})=>{m||r(p)})}},[e]),Object(d.useEffect)(()=>{if(w(null),s){let m=!1;le(s).then(p=>{m||w(p)})}},[s]);const{playAudioBuffer:g,isAudioBusy:y}=Ve(),f=Object(d.useRef)(()=>{});return Object(d.useEffect)(()=>()=>f.current(),[e]),e?o.a.createElement(Lt.a,{fluid:"sm"},o.a.createElement("h2",null,e.metadata.name,o.a.createElement(Tt.a,{style:{display:"inline-block",float:"right"},variant:"light",align:"end",title:"options"},o.a.createElement(ce.a.Item,{onClick:()=>{const m=prompt(`Choose a new name for the sample "${e.metadata.name}":`,e.metadata.name),p=m&&m.trim();p&&t(e.id,{name:p})}},"Rename"),o.a.createElement(ce.a.Item,{onClick:()=>n(e.id)},"Duplicate"),o.a.createElement(ce.a.Divider,null),o.a.createElement(ce.a.Item,{onClick:()=>{window.confirm(`Are you sure you want to delete ${e.metadata.name}?`)&&a(e.id)}},"Delete"))),o.a.createElement("p",null,o.a.createElement("strong",null,"Sampled:")," ",new Date(e.metadata.dateSampled).toLocaleString(),o.a.createElement("br",null),o.a.createElement("strong",null,"Updated:")," ",new Date(e.metadata.dateModified).toLocaleString()),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("div",{className:dn.a.waveformContainer},o.a.createElement(Kt,{onSetTrimFrames:i,onSetScaleCoefficient:c,sample:e})),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(B.a,{type:"button",variant:"secondary",size:"sm",onClick:m=>{if(u)f.current=g(u);else{const p=m.currentTarget;b({fn:()=>p.click()})}},disabled:y},"Play audio preview")," ",o.a.createElement(B.a,{type:"button",variant:"secondary",size:"sm",onClick:()=>gn(this,null,function*(){const{sourceFileId:m,userFileInfo:p}=e.metadata,D=yield N.getSourceFileData(m),A=new Blob([D],{type:p?p.type:"audio/x-wav"});yn(A,`${e.metadata.name}${p?p.ext:".wav"}`)})},"Download original file"),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(L.a.Group,null,o.a.createElement(L.a.Label,null,"Quality bit depth (",e.metadata.qualityBitDepth,")"),o.a.createElement(L.a.Range,{value:e.metadata.qualityBitDepth,step:1,min:8,max:16,onChange:m=>{const p=Number(m.target.value);t(e.id,{qualityBitDepth:p})}})),o.a.createElement(sn,{sample:e,onSampleUpdate:t}),o.a.createElement("br",null),o.a.createElement(nn,{sample:e})):null}var En=bn,wn=E(88),Y=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{s(n.next(r))}catch(u){l(u)}},i=r=>{try{s(n.throw(r))}catch(u){l(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});let ct;function ye(){const e=Fe();return ct=ct||new e(navigator.mediaDevices.getSupportedConstraints().sampleRate?{sampleRate:te}:{})}function Sn(){return Y(this,null,function*(){{const a=yield navigator.mediaDevices.getUserMedia({audio:!0,video:!1});for(const l of a.getTracks())l.stop()}const t=(yield navigator.mediaDevices.enumerateDevices()).filter(a=>a.kind==="audioinput"),n=[];for(const a of t){const l=yield navigator.mediaDevices.getUserMedia({audio:{deviceId:a.deviceId,channelCount:2},video:!1}),c=(yield navigator.mediaDevices.enumerateDevices()).find(({deviceId:s})=>a.deviceId===s).label;let i=1;{const s=l.getAudioTracks()[0],r=s.getSettings().channelCount;r?i=r:s.getCapabilities&&(i=(s.getCapabilities().channelCount||{}).max||i)}for(const s of l.getTracks())s.stop();n.push({device:{deviceId:a.deviceId,label:c},channelsAvailable:i})}return n})}let be;function Cn(e){return Y(this,arguments,function*({onData:t,onFinish:n}){const a=ye();be=be||a.audioWorklet.addModule("recorderWorkletProcessor.js"),yield be;const l=new AudioWorkletNode(a,"recorder-worklet",{parameterData:{bufferSize:1024}});l.port.onmessage=i=>{if(i.data.eventType==="data"){const s=i.data.audioChannels;t(s)}i.data.eventType==="stop"&&n()};const c=l.parameters.get("isRecording");return c.setValueAtTime(1,a.currentTime),{recorderNode:l,stop(){c.setValueAtTime(0,a.currentTime)}}})}function On({channelCount:e,onData:t,onFinish:n}){const l=ye().createScriptProcessor(1024,e,e);let c=!1;return l.onaudioprocess=i=>{const s=Array(e).fill().map((r,u)=>i.inputBuffer.getChannelData(u));t(s),c&&n()},{recorderNode:l,stop(){c=!0}}}function Dn(e){return Y(this,null,function*(){return typeof AudioWorkletNode=="undefined"?On(e):yield Cn(e)})}function Pn(e){return Y(this,arguments,function*({deviceId:t,channelCount:n,onStart:a,onUpdate:l}){const c=yield navigator.mediaDevices.getUserMedia({audio:{deviceId:t,channelCount:n,sampleRate:te,echoCancellation:!1,autoGainControl:!1,noiseSuppression:!1},video:!1}),i=ye(),s=i.createMediaStreamSource(c),{recorderNode:r,stop:u}=yield Dn({channelCount:n,onData:y,onFinish:A});s.connect(r),r.connect(i.destination);const w=10;a(i.sampleRate,w);const v=w*i.sampleRate;let b=0;const g=Array(n).fill([]);function y(k){let C=0;const M=[];for(let S=0;S<n;S++){const h=k[S],P=h.length,j=h.slice(0,Math.min(P,v-b));Ne(j),C||(C=j.length),M.push(j)}const O=Dt(M),R=xe(O);g.push(R),b+=C,b>=v&&u(),l(M)}let f,m;const p=new Promise((k,C)=>{f=k,m=C});let D=!1;function A(){return Y(this,null,function*(){if(D)return;try{const M=yield new Blob(g).arrayBuffer(),O=new Float32Array(M),R=De()({channels:n,sampleRate:i.sampleRate,bitDepth:16,dataLength:O.byteLength}),S=new Uint8Array(R.length+O.byteLength);S.set(R),S.set(new Uint8Array(O.buffer),R.length),f(S)}catch(C){m(C)}const k=c.getTracks();for(const C of k)C.stop();r.disconnect(i.destination),s.disconnect(r),D=!0})}return{stop:u,mediaRecording:p}})}var An=E(69),Ee=E.n(An),Q=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{s(n.next(r))}catch(u){l(u)}},i=r=>{try{s(n.throw(r))}catch(u){l(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});const it="capture_device_preference";let st=null;function kn(e,t){const n=Object(d.useRef)(JSON.parse(localStorage.getItem(it)||"null")),[a,l]=Object(d.useState)(st),[c,i]=Object(d.useState)(a?"ok":"pending"),[s,r]=Object(d.useState)("");Object(d.useEffect)(()=>{st=a,i("ok")},[a]);const u=Object(d.useCallback)(()=>{let O=!1;return Sn().then(R=>{O||R.length&&(l(new Map(R.map(S=>[S.device.deviceId,S]))),r(S=>S?(n.current=null,S):n.current&&R.find(({device:h})=>n.current.deviceId===h.deviceId)?n.current.deviceId:(n.current=null,R[0].device.deviceId)))}).catch(R=>{if(!O){if(R instanceof DOMException){if(R.name==="NotAllowedError"){i("denied");return}if(R.name==="NotFoundError"){i("unavailable");return}}throw R}}),()=>{O=!0}},[]),[w,v]=Object(d.useState)(1);Object(d.useEffect)(()=>{const O=a&&a.get(s);O&&(n.current&&n.current.deviceId===O.device.deviceId&&n.current.channelCount<=O.channelsAvailable?v(n.current.channelCount):v(O.channelsAvailable),n.current=null)},[a,s]),Object(d.useEffect)(()=>{s&&localStorage.setItem(it,JSON.stringify({deviceId:s,channelCount:w}))},[s,w]);const[b,g]=Object(d.useState)("ready"),[y,f]=Object(d.useState)(null),[m,p]=Object(d.useState)({fn(O){}}),[D,A]=Object(d.useState)(1/0),[k,C]=Object(d.useState)(0),M=Object(d.useCallback)(()=>Q(this,null,function*(){let O=!1;const R=(I,_)=>Pn({deviceId:I,channelCount:_,onStart:(H,J)=>{const V=J*H;A(H),C(V),g("capturing")},onUpdate:e}),S=n.current,{mediaRecording:h,stop:P}=yield S?(()=>Q(this,null,function*(){try{return R(S.deviceId,S.channelCount)}catch(I){if(I instanceof DOMException&&I.name==="NotFoundError")return R(s,w);throw I}}))():R(s,w);p({fn(I){P(),I&&(O=!0)}});let j;try{j=yield h}catch(I){f(I),g("error");return}O?g("ready"):(g("finalizing"),t(j))}),[s,w,e,t]);return{captureDevices:a,accessState:c,selectedCaptureDeviceId:s,selectedChannelCount:w,captureState:b,recordingError:y,sampleRate:D,maxSamples:k,refreshCaptureDevices:u,setSelectedCaptureDeviceId:r,setSelectedChannelCount:v,beginRecording:M,stopRecording:m.fn}}const we=3;function Mn({canvas:e,peaks:t,scaleCoefficient:n}){const a="#fff",l=e.getContext("2d");l.imageSmoothingEnabled=!1;const{width:c,height:i}=e;l.clearRect(0,0,c,i),l.fillStyle=a;for(let s=0;s<t.length;s++){const r=t[s];if(r===0)continue;const u=i*r,w=Math.max(Math.round(n*u),2);l.fillRect(s*we,i-w,we-1,w)}}function Rn({onRecordFinish:e}){const t=Object(d.useRef)(null),n=Object(d.useRef)(0),a=Object(d.useRef)(new Float32Array),l=Object(d.useRef)(0),c=Object(d.useRef)([]),i=Object(d.useRef)(1/0),s=Object(d.useRef)(0),[r,u]=Object(d.useState)(0),w=Object(d.useCallback)(h=>Q(this,null,function*(){const P=n.current,j=a.current,I=c.current;if(I.push(h),s.current+=h[0].length,u(Math.floor(s.current/i.current)),I.reduce((H,[{length:J}])=>H+J,0)>=P){const H=yield Promise.all(h.map((V,Ce)=>I.reduce((Tn,Wn)=>[...Tn,Wn[Ce]],[])).map(V=>Q(this,null,function*(){const Ce=yield new Blob(V).arrayBuffer();return new Float32Array(Ce)}))),J=H.map(V=>Be(new Float32Array(V.buffer,0,P)));j[l.current]=Math.max(...J),Mn({canvas:t.current,peaks:j,scaleCoefficient:.3}),l.current++,c.current=[H.map(V=>V.slice(P))]}}),[]),{captureDevices:v,accessState:b,selectedCaptureDeviceId:g,selectedChannelCount:y,captureState:f,recordingError:m,maxSamples:p,sampleRate:D,refreshCaptureDevices:A,setSelectedCaptureDeviceId:k,setSelectedChannelCount:C,beginRecording:M,stopRecording:O}=kn(w,e);i.current=D,Object(d.useEffect)(()=>{const h=t.current;h&&(h.width=h.offsetWidth,h.height=h.offsetHeight)},[b]),Object(d.useLayoutEffect)(()=>{const h=t.current;!h||(f!=="finalizing"&&h.getContext("2d").clearRect(0,0,h.width,h.height),f==="capturing"&&p&&(n.current=Math.floor(we*p/t.current.width),a.current=new Float32Array(Math.floor(p/n.current)),l.current=0,c.current=[],i.current=1/0,s.current=0,u(0)))},[p,f]);const[R,S]=Object(d.useState)(!1);return Object(d.useEffect)(()=>{R&&A()},[R,A]),o.a.createElement("div",null,b==="denied"?o.a.createElement("p",null,"Looks like you didn't grant access to your audio input device. Please give Volca Sampler access, then"," ",o.a.createElement(B.a,{type:"button",variant:"secondary",onClick:A},"try again")):b==="unavailable"?o.a.createElement("p",null,"Volca Sampler couldn't find any audio input devices. Please connect one, then"," ",o.a.createElement(B.a,{type:"button",variant:"secondary",onClick:A},"try again")):o.a.createElement("div",null,o.a.createElement("h2",null,"Send a new sound to your Volca Sample!"),o.a.createElement(B.a,{className:Ee.a.recordButton,type:"button",variant:f==="capturing"?"danger":"primary",size:"lg",style:{width:250},onClick:f==="capturing"?()=>O():M,disabled:f==="finalizing"},o.a.createElement("canvas",{ref:t}),o.a.createElement("span",{className:Ee.a.mainText},["capturing","finalizing"].includes(f)?"Finished recording":"Start recording"),["capturing","finalizing"].includes(f)&&o.a.createElement("span",{className:Ee.a.timeRecorded},"0:",String(r).padStart(2,"0"))),["capturing","finalizing"].includes(f)?o.a.createElement(o.a.Fragment,null,o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(B.a,{style:{width:250},size:"sm",type:"button",variant:"secondary",onClick:()=>O(!0)},"Cancel")):o.a.createElement(o.a.Fragment,null,o.a.createElement("br",null),o.a.createElement(B.a,{style:{width:250},type:"button",variant:"light",size:"sm",onClick:()=>S(h=>!h)},"Audio input settings ",R?"\u25B2":"\u25BC"),o.a.createElement(wn.a,{in:R},o.a.createElement("div",null,o.a.createElement(L.a.Group,null,o.a.createElement(L.a.Label,null,"Capture Device"),o.a.createElement(L.a.Select,{style:{width:250},value:g,onChange:h=>k(h.target.value)},v&&b==="ok"?[...v].map(([h,{device:P}])=>o.a.createElement("option",{key:h,value:h},P.label||h)):o.a.createElement("option",{value:"",disabled:!0},"Loading devices..."))),o.a.createElement(L.a.Group,null,o.a.createElement(L.a.Label,null,"Input channels"),o.a.createElement(L.a.Select,{style:{width:250},value:y,onChange:h=>C(Number(h.target.value))},[1,2].map(h=>o.a.createElement("option",{key:h,value:h,disabled:!v||!v.has(g)||v.get(g).channelsAvailable<h},h===1?"Mono":"Stereo (summed to mono)")))),o.a.createElement("br",null))))),f==="error"&&m||null,o.a.createElement("br",null),o.a.createElement(B.a,{style:{width:250},type:"button",variant:"secondary",onClick:h=>{const P=h.currentTarget.querySelector("input");P&&h.target!==P&&P.click()}},"Or import an audio file",o.a.createElement("input",{hidden:!0,type:"file",accept:"audio/*,.wav,.mp3,.ogg",onChange:h=>{if(h.target.files&&h.target.files.length){const P=h.target.files[0];P.arrayBuffer().then(j=>Q(this,null,function*(){const I=new Uint8Array(j);let _;try{_=yield le(I)}catch(H){alert("Unsupported audio format detected");return}if(_.length>10*_.sampleRate){alert("Please select an audio file no more than 10 seconds long");return}e(I,P)}))}}})))}var jn=Rn,Se=E(135),U=E(138),In=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{s(n.next(r))}catch(u){l(u)}},i=r=>{try{s(n.throw(r))}catch(u){l(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});const Bn=Z.a.div({padding:"2rem",display:"flex",height:"100%"}),Nn=Z.a.div({flexGrow:1});function xn(){const[e,t]=Object(d.useState)(new Map),[n,a]=Object(d.useState)(new Map),l=Object(d.useMemo)(()=>new Map([...e,...n]),[e,n]);Object(d.useEffect)(()=>{St().then(a).catch(console.error)},[]);const[c,i]=Object(d.useState)(null),[s,r]=Object(d.useState)(!0);Object(d.useEffect)(()=>{N.getAllFromStorage().then(y=>{t(f=>new Map([...f,...y.map(m=>[m.id,m])]))}).finally(()=>{r(!1)})},[]);const u=Object(d.useCallback)((y,f)=>In(this,null,function*(){const m=yield bt(y);let p="",D="";if(f){const M=f.name.lastIndexOf(".");M>0?(p=f.name.slice(0,M),D=f.name.slice(M)):p=f.name}else p="New sample";const A=[0,0],k=yield Xe(m,A),C=new N.Mutable({name:p,sourceFileId:m,trim:{frames:A,waveformPeaks:k},userFileInfo:f&&{type:f.type,ext:D}});yield C.persist(),t(M=>new Map([[C.id,C],...M])),i(C.id)}),[]),w=Object(d.useCallback)((y,f)=>{t(m=>{const p=m.get(y);if(p&&p instanceof N.Mutable){const D=p.update(f);if(D!==p)return new Map(m).set(p.id,D)}return m})},[]),[v,b]=Object(d.useState)(!1),g=Object(d.useCallback)(y=>{i(y),b(!1)},[]);return o.a.createElement("div",null,o.a.createElement(mt,{onMenuOpen:()=>b(!0),onHeaderClick:()=>i(null)}),o.a.createElement(Se.a,{show:v,onHide:()=>b(!1)},o.a.createElement(Se.a.Header,{closeButton:!0}),o.a.createElement(Se.a.Body,null,o.a.createElement(q.a,null,o.a.createElement(q.a.Item,{as:"button",onClick:()=>g(null)},"New Sample"),s?"Loading...":null,!s&&o.a.createElement(U.a,{defaultActiveKey:e.size?"user":"factory"},o.a.createElement(U.a.Item,{eventKey:"user"},o.a.createElement(U.a.Header,null,"Your Samples"),o.a.createElement(U.a.Body,{style:{padding:0}},o.a.createElement(_e,{samples:e,selectedSampleId:c,onSampleSelect:g}))),o.a.createElement(U.a.Item,{eventKey:"factory"},o.a.createElement(U.a.Header,null,"Factory Samples"),o.a.createElement(U.a.Body,{style:{padding:0}},o.a.createElement(_e,{samples:n,selectedSampleId:c,onSampleSelect:g}))))))),o.a.createElement(Bn,null,o.a.createElement(Nn,null,c&&o.a.createElement(En,{sample:l.get(c)||null,onSampleUpdate:w,onSampleDuplicate:y=>{const f=l.get(y);if(f){const m=f.duplicate();t(p=>new Map([[m.id,m],...p])),i(m.id)}},onSampleDelete:y=>{const f=l.get(y);f&&f instanceof N.Mutable&&(f.remove(),t(m=>{const p=new Map(m);return p.delete(f.id),p}))}}),!c&&o.a.createElement(jn,{onRecordFinish:u}))))}var Fn=xn,Ln=e=>{e&&e instanceof Function&&E.e(3).then(E.bind(null,142)).then(({getCLS:t,getFID:n,getFCP:a,getLCP:l,getTTFB:c})=>{t(e),n(e),a(e),l(e),c(e)})};Blob.prototype.arrayBuffer||(Blob.prototype.arrayBuffer=function(){return new Response(this).arrayBuffer()}),ut.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(At,null,o.a.createElement(Fn,null))),document.getElementById("root")),Ln()},17:function(x,z,E){x.exports={slotNumberRow:"SlotNumberInput_slotNumberRow__kQwOw",slotNumberContainer:"SlotNumberInput_slotNumberContainer__1q7P1",arrowControls:"SlotNumberInput_arrowControls__1LPAC",slotNumber:"SlotNumberInput_slotNumber__GC-i7",active:"SlotNumberInput_active__2zN4D",digitBlinkEffect:"SlotNumberInput_digitBlinkEffect__1_u8n",point:"SlotNumberInput_point__3pJD3",warning:"SlotNumberInput_warning__3NAeN"}},28:function(x,z,E){x.exports={title:"Header_title__R3bRx",menuIcon:"Header_menuIcon__swn7p",titleText:"Header_titleText__3e5ME",titleR:"Header_titleR__3QRgv",titleStarburst:"Header_titleStarburst__1oLYP",titleGraphic:"Header_titleGraphic__3S89F"}},69:function(x,z,E){x.exports={recordButton:"SampleRecord_recordButton__3R-KX",mainText:"SampleRecord_mainText__2dca6",timeRecorded:"SampleRecord_timeRecorded__3FGTe"}},84:function(x,z,E){x.exports={waveformContainer:"SampleDetail_waveformContainer__3VrPQ",slotNumber:"SampleDetail_slotNumber__3sgS6",point:"SampleDetail_point__3d7qL"}},93:function(x,z,E){},94:function(x,z,E){}},[[125,1,2]]]);

//# sourceMappingURL=main.92035ff3.chunk.js.map