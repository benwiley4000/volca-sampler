(this["webpackJsonpvolca-sampler"]=this["webpackJsonpvolca-sampler"]||[]).push([[0],{130:function(F,X,y){"use strict";y.r(X);var u=y(0),o=y.n(u),Ae=y(9),pt=y.n(Ae),Un=y(98),Xn=y(99),ne=y(28),me=y(137),vt=y(19),V=y.n(vt);function ht({onMenuOpen:e,onHeaderClick:t}){return o.a.createElement("div",{className:V.a.titleBar},o.a.createElement("span",{className:V.a.menuIcon,onClick:e},"\u2630"),o.a.createElement(me.a,{fluid:"sm",className:V.a.titleContainer},o.a.createElement("h1",{className:V.a.title,onClick:t},o.a.createElement("span",{className:V.a.titleText,"data-text":"Volca Sample"},"Volca Sample",o.a.createElement("span",{className:V.a.titleR},"r"),o.a.createElement("svg",{viewBox:"0 0 150 150",preserveAspectRatio:"none",className:V.a.titleStarburst},Array(24).fill().map((n,a,{length:l})=>o.a.createElement("polygon",{key:a,points:"75,70 75,80 150,75","transform-origin":"75 75",style:{"--rotation":`${a*360/l}deg`}})))),o.a.createElement("img",{className:V.a.titleGraphic,src:"volca_sample.png",alt:""}))),o.a.createElement("svg",{width:0,height:0},o.a.createElement("filter",{id:"outline"},o.a.createElement("feMorphology",{in:"SourceAlpha",result:"DILATED",operator:"dilate",radius:"1"}),o.a.createElement("feFlood",{floodColor:"var(--stroke-color)",floodOpacity:"1",result:"PINK"}),o.a.createElement("feComposite",{in:"PINK",in2:"DILATED",operator:"in",result:"OUTLINE"}),o.a.createElement("feMerge",null,o.a.createElement("feMergeNode",{in:"OUTLINE"}),o.a.createElement("feMergeNode",{in:"SourceGraphic"})))))}var gt=ht,ae=y(145),yt=y(52),ke=y.n(yt),bt=y(44),re=y.n(bt),je=y(146),Me=y(77);const oe=31250;var Et=Object.defineProperty,wt=Object.defineProperties,St=Object.getOwnPropertyDescriptors,le=Object.getOwnPropertySymbols,Re=Object.prototype.hasOwnProperty,Ie=Object.prototype.propertyIsEnumerable,pe=(e,t,n)=>t in e?Et(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,z=(e,t)=>{for(var n in t||(t={}))Re.call(t,n)&&pe(e,n,t[n]);if(le)for(var n of le(t))Ie.call(t,n)&&pe(e,n,t[n]);return e},J=(e,t)=>wt(e,St(t)),Be=(e,t)=>{var n={};for(var a in e)Re.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&le)for(var a of le(e))t.indexOf(a)<0&&Ie.call(e,a)&&(n[a]=e[a]);return n},ce=(e,t,n)=>(pe(e,typeof t!="symbol"?t+"":t,n),n),L=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{i(n.next(r))}catch(d){l(d)}},s=r=>{try{i(n.throw(r))}catch(d){l(d)}},i=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,s);i((n=n.apply(e,t)).next())});const ie=re.a.createInstance({name:"audio_file_data",driver:re.a.INDEXEDDB}),se=re.a.createInstance({name:"sample_metadata",driver:re.a.INDEXEDDB});function Ct(e){return L(this,null,function*(){const t=Object(je.a)();return yield ie.setItem(t,e),t})}const ve="0.3.0",Ot={"0.1.0":e=>{const t=e,{clip:n}=t,a=Be(t,["clip"]);return J(z({},a),{trimFrames:n.map(c=>Math.round(c*oe)),metadataVersion:"0.2.0"})},"0.2.0":e=>L(void 0,null,function*(){const t=e,{trimFrames:n}=t,a=Be(t,["trimFrames"]),l=yield Ee(a.sourceFileId,!1),c=yield _e(l,n),s={frames:n,waveformPeaks:c};return J(z({},a),{trim:s,metadataVersion:"0.3.0"})})};function Dt(e){return L(this,null,function*(){let t=e;for(;t.metadataVersion!==ve;){const n=Ot[e.metadataVersion];if(!n){console.warn(`Failed to properly upgrade metadata for sample "${t.name}"`),t={name:t.name,sourceFileId:t.sourceFileId,id:t.id,metadataVersion:ve};break}t=yield n(t)}return t})}const _=class{constructor({name:e,sourceFileId:t,trim:n,id:a=Object(je.a)(),userFileInfo:l=null,slotNumber:c=0,dateSampled:s=Date.now(),dateModified:i=s,useCompression:r=!0,qualityBitDepth:d=16,scaleCoefficient:b=1}){this.id=a,this.metadata={name:e,sourceFileId:t,trim:n,userFileInfo:l,slotNumber:c,dateSampled:s,dateModified:i,useCompression:r,qualityBitDepth:d,scaleCoefficient:b,metadataVersion:ve}}duplicate(){const e=new _.Mutable(J(z({},this.metadata),{name:`${this.metadata.name} (copy)`,dateModified:Date.now()}));return e.persist(),e}static cacheSourceFileData(e,t){this.sourceFileData.set(e,t),this.recentlyCachedSourceFileIds=[e,...this.recentlyCachedSourceFileIds.filter(a=>a!==e)];const n=this.recentlyCachedSourceFileIds.slice(this.MAX_CACHED);for(const a of n)this.sourceFileData.delete(a);this.recentlyCachedSourceFileIds=this.recentlyCachedSourceFileIds.slice(0,this.MAX_CACHED)}static getSourceFileData(e){return L(this,null,function*(){{const n=this.sourceFileData.get(e);if(n)return n}if(e.includes(".")){const n=yield fetch(e);if(n.status>=400)return Promise.reject(new Error(`Failed to fetch source file "${e}"`));const a=yield n.arrayBuffer(),l=new Uint8Array(a);return this.cacheSourceFileData(e,l),l}const t=yield ie.getItem(e);return t?t instanceof Uint8Array?(this.cacheSourceFileData(e,t),t):Promise.reject("Source data is of unexpected type"):Promise.reject("Missing source data")})}static getAllMetadataFromStore(){return L(this,null,function*(){const e=new Map,t=[];return yield se.iterate((n,a)=>{n&&t.push(Dt(n).then(l=>{e.set(a,l)}).catch(l=>{console.error(l),console.warn(`Failed to upgrade metadata "${a}" (${n.name}); ignoring.`)}))}),yield Promise.all(t),e})}static getAllFromStorage(){return L(this,null,function*(){const e=yield this.getAllMetadataFromStore(),t=yield Ne(),n=(yield ie.keys()).concat(t.map(({sourceFileId:l})=>l));return[...e].map(([l,c])=>{const{sourceFileId:s}=c;return n.includes(s)?new _.Mutable(z({id:l},c)):(console.warn(`Found metadata "${c.name||l}" with missing data "${s}; ignoring.`),null)}).filter(Boolean).sort((l,c)=>c.metadata.dateModified-l.metadata.dateModified)})}};let x=_;ce(x,"Mutable",class extends _{constructor(e){super(e);setTimeout(()=>L(this,null,function*(){(yield se.keys()).includes(this.id)||console.warn(`Expected sample metadata container ${this.id} to be persisted`)}))}persist(){return L(this,null,function*(){yield se.setItem(this.id,this.metadata)})}update(e){const{id:t,metadata:n}=this,a=typeof e=="function"?e(n):e;if(Object.keys(a).every(s=>a[s]===n[s]))return this;const l=J(z(z({},n),a),{dateModified:Date.now()}),c=new _.Mutable(z({id:t},l));return c.persist(),c}remove(){return L(this,null,function*(){if(yield se.removeItem(this.id),this.metadata.sourceFileId.includes("."))return;const e=yield _.getAllMetadataFromStore();for(const[,{sourceFileId:t}]of e)if(t===this.metadata.sourceFileId)return;yield ie.removeItem(this.metadata.sourceFileId)})}}),ce(x,"sourceFileData",new Map),ce(x,"recentlyCachedSourceFileIds",[]),ce(x,"MAX_CACHED",10);let he;function Ne(){return he||(he=fetch("factory-samples.json").then(e=>e.json())),he}function Pt(){return L(this,null,function*(){const e=yield Ne();return new Map(e.map(t=>[t.id,new x(J(z({},t),{trim:{frames:[t.trim.frames[0],t.trim.frames[1]],waveformPeaks:{positive:new Float32Array(Object(Me.a)(t.trim.waveformPeaks.positive)),negative:new Float32Array(Object(Me.a)(t.trim.waveformPeaks.negative))}}}))]))})}var xe=Math.pow,ge=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{i(n.next(r))}catch(d){l(d)}},s=r=>{try{i(n.throw(r))}catch(d){l(d)}},i=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,s);i((n=n.apply(e,t)).next())});function ye(e,t){const n=4,a=t[0]*n,l=e.length-t[0]-t[1];return new Float32Array(e.buffer,a,l)}function be(e,t){const n=e.length-t[0]-t[1],a=new Float32Array(n),l=Array(e.numberOfChannels).fill().map((c,s)=>ye(e.getChannelData(s),t));for(let c=0;c<n;c++){let s=0;for(let i=0;i<l.length;i++)s+=l[i][c];s/=l.length,a[c]=s}return a}function Fe(e){let t=0;for(const n of e){const a=Math.abs(n);a>t&&(t=a)}return t}function At(e,t){if(t!==1)for(let n=0;n<e.length;n++)e[n]*=t}function kt(e,t){const n=xe(2,t-1);for(let a=0;a<e.length;a++)e[a]=Math.round(e[a]*n)/n}function Le(e){for(let t=0;t<e.length;t++)e[t]>1?e[t]=1:e[t]<-1&&(e[t]=-1)}function jt(e){const t=e.length,n=e[0].length,a=new Float32Array(t*n);for(let l=0;l<a.length;l++){const c=t*l;for(let s=0;s<t;s++)a[c+s]=e[s][l]}return a}function Te(e){const t=new Int16Array(e.length),n=xe(2,15);for(let a=0;a<e.length;a++)t[a]=e[a]===1?n-1:n*e[a];return t}function We(){return window.AudioContext||window.webkitAudioContext}let He;function Ve(){const e=We();return He=He||new e({sampleRate:oe})}function Z(e){return ge(this,null,function*(){const t=new Uint8Array(e);return yield new Promise((a,l)=>{Ve().decodeAudioData(t.buffer,a,l)})})}function Ee(e,t){return ge(this,null,function*(){const n=yield x.getSourceFileData(e),a=yield Z(n);if(t)for(let l=0;l<a.numberOfChannels;l++)Le(a.getChannelData(l));return a})}function ze(e){return ge(this,null,function*(){const{qualityBitDepth:t,sourceFileId:n,userFileInfo:a,scaleCoefficient:l,trim:{frames:c}}=e.metadata;if(t<8||t>16||!Number.isInteger(t))throw new Error(`Expected bit depth between 8 and 16. Received: ${t}`);const s=yield Ee(n,Boolean(a)),i=s.numberOfChannels===1?ye(s.getChannelData(0),c):be(s,c);l!==1&&At(i,l),t<16&&kt(i,t);const r=Te(i),d=r.length*2,b=ke()({channels:1,sampleRate:s.sampleRate,bitDepth:16,dataLength:d}),m=new Uint8Array(b.length+d);return m.set(b),m.set(new Uint8Array(r.buffer),b.length),{data:m,sampleRate:16}})}const Mt={playAudioBuffer(e,t){throw new Error("Must render AudioPlaybackContextProvider")}},Ue=Object(u.createContext)(Mt);function Rt({children:e}){const t=Object(u.useRef)(()=>{}),n=Object(u.useCallback)((l,{onTimeUpdate:c=()=>null,onEnded:s=()=>null}={})=>{t.current();const i=Ve(),r=i.createBufferSource();r.buffer=l,r.connect(i.destination),r.start();const d=i.currentTime;c(0);let b=requestAnimationFrame(m);function m(){c(i.currentTime-d),b=requestAnimationFrame(m)}let h=!1;r.addEventListener("ended",()=>{h||(c(l.duration),s()),cancelAnimationFrame(b)});function E(){r.stop(),cancelAnimationFrame(b),h=!0}return t.current=E,E},[]),a=Object(u.useMemo)(()=>({playAudioBuffer:n}),[n]);return Object(u.createElement)(Ue.Provider,{value:a},e)}function Xe(){return Object(u.useContext)(Ue)}var It=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{i(n.next(r))}catch(d){l(d)}},s=r=>{try{i(n.throw(r))}catch(d){l(d)}},i=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,s);i((n=n.apply(e,t)).next())});const Y=6,$e=Y*44;function Ge(e,t){const n=Math.floor(Y*e.length/t),a=new Float32Array(Math.floor(e.length/n)),l=new Float32Array(Math.floor(e.length/n));for(let c=0;c<a.length;c++){const s=new Float32Array(e.buffer,c*n*4,n);let i=0,r=0;for(const d of s)d>i&&(i=d),d<r&&(r=d);a[c]=Math.min(1,i),l[c]=Math.max(-1,r)}return{positive:a,negative:l}}function _e(e,t){return It(this,null,function*(){const n=be(e,t);return Ge(n,$e)})}var Bt=y(86);const Nt=ne.a.canvas({width:"100%",height:"100%",display:"block",imageRendering:"pixelated"});function xt(e,t){function n(l,c){e.width=l,e.height=c}n(e.offsetWidth,e.offsetHeight),t({width:e.offsetWidth,height:e.offsetHeight});const a=new Bt.a(([l])=>{const{width:c,height:s}=l.contentRect;n(c,s),t({width:c,height:s})});return a.observe(e),()=>a.disconnect()}function Ft(e,t,n){const a=getComputedStyle(document.documentElement),l=a.getPropertyValue("--bs-primary"),c=a.getPropertyValue("--bs-primary-darkened"),s=e.getContext("2d");s.imageSmoothingEnabled=!1;const{width:i,height:r}=e;s.clearRect(0,0,i,r);const d=Math.floor(r*(2/3))+1;s.fillStyle=l,t.positive.forEach((m,h)=>{const E=d*m,g=Math.max(Math.round(n*E),1);s.fillRect(h*Y,d-g,Y-1,g)});const b=r-d;s.fillStyle=c,t.negative.forEach((m,h)=>{const E=b*m*-1,g=Math.round(n*E);s.fillRect(h*Y,d,Y-1,g)})}function Lt({peaks:e,scaleCoefficient:t,waveformRef:n}){const a=Object(u.useRef)(null);Object(u.useImperativeHandle)(n,()=>a.current);const[l,c]=Object(u.useState)(Symbol()),s=Object(u.useRef)({width:0,height:0});return Object(u.useLayoutEffect)(()=>{if(!a.current)throw new Error("Canvas should be defined");return s.current.width=a.current.offsetWidth,s.current.height=a.current.offsetHeight,xt(a.current,({width:i,height:r})=>{(i!==s.current.width||r!==s.current.height)&&(c(Symbol()),s.current.width=i,s.current.height=r)})},[]),Object(u.useLayoutEffect)(()=>{const i=a.current;if(!i)throw new Error("Canvas should be defined");let r=requestAnimationFrame(()=>{r=requestAnimationFrame(()=>{Ft(i,e,t)})});return()=>cancelAnimationFrame(r)},[e,t,l]),o.a.createElement(Nt,{ref:a})}var Ye=Lt;const Tt=ne.a.div({width:`${$e}px`,height:"40px"}),Ke=typeof IntersectionObserver!="undefined",Wt=o.a.memo(({sample:e,selected:t,onSampleSelect:n})=>{const a=Object(u.useRef)(null),[l,c]=Object(u.useState)(!Ke);return Object(u.useLayoutEffect)(()=>{if(!Ke)return;const s=a.current;if(!s)throw new Error("Waveform container should be defined");const i=s.getBoundingClientRect();if(i.top+i.height>=0&&i.bottom-i.height<=window.innerHeight){c(!0);return}const r=new IntersectionObserver(([d])=>{d.isIntersecting&&(c(!0),r.unobserve(s))});return r.observe(s),()=>r.disconnect()},[]),o.a.createElement(ae.a.Item,{active:t,onClick:()=>n(e.id)},o.a.createElement("div",null,e.metadata.name),o.a.createElement(Tt,{ref:a},l&&o.a.createElement(Ye,{peaks:e.metadata.trim.waveformPeaks,scaleCoefficient:e.metadata.scaleCoefficient})))});function Ht({samples:e,selectedSampleId:t,onSampleSelect:n}){return o.a.createElement(ae.a,{variant:"flush"},[...e].map(([a,l])=>o.a.createElement(Wt,{key:a,sample:l,selected:a===t,onSampleSelect:n})))}var Qe=Ht,Vt=y(139),ue=y(92),B=y(87),T=y(141),zt=Object.defineProperty,Ut=Object.defineProperties,Xt=Object.getOwnPropertyDescriptors,de=Object.getOwnPropertySymbols,Je=Object.prototype.hasOwnProperty,Ze=Object.prototype.propertyIsEnumerable,qe=(e,t,n)=>t in e?zt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,$t=(e,t)=>{for(var n in t||(t={}))Je.call(t,n)&&qe(e,n,t[n]);if(de)for(var n of de(t))Ze.call(t,n)&&qe(e,n,t[n]);return e},Gt=(e,t)=>Ut(e,Xt(t)),_t=(e,t)=>{var n={};for(var a in e)Je.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&de)for(var a of de(e))t.indexOf(a)<0&&Ze.call(e,a)&&(n[a]=e[a]);return n},Yt=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{i(n.next(r))}catch(d){l(d)}},s=r=>{try{i(n.throw(r))}catch(d){l(d)}},i=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,s);i((n=n.apply(e,t)).next())});function Kt({sourceAudioBuffer:e,sample:{metadata:{trim:{frames:t},scaleCoefficient:n}},onSetTrimFrames:a,onSetScaleCoefficient:l}){const c=Object(u.useMemo)(()=>e?be(e,[0,0]):new Float32Array,[e]),[s,i]=Object(u.useState)(null),r=Object(u.useMemo)(()=>s&&s.offsetWidth,[s]),d=Object(u.useMemo)(()=>!r||!c.length?{positive:new Float32Array,negative:new Float32Array}:Ge(c,r),[r,c]),b=Object(u.useMemo)(()=>{if(!e)return 0;const f=ye(c,t);return Fe(f)},[e,c,t]),m=1/b;Object(u.useLayoutEffect)(()=>{n>m&&l(m)},[n,m,l]);const h=Object(u.useMemo)(()=>{if(!c.length||!r)return[0,0];const f=r/c.length;return t.map(p=>p*f)},[r,c.length,t]),E=Object(u.useRef)(null),g=Object(u.useRef)(null);return Object(u.useEffect)(()=>{function f(C){if(E.current===null||!r||!c.length)return;const{pageX:w}=C,j=w-E.current;if(j){const D=j/r,S=Math.round(c.length*D);a(M=>{let k=M[0]+S;return k=Math.min(k,c.length-M[1]-2e3),k=Math.max(k,0),[k,M[1]]}),E.current=w}}function p(){E.current=null,document.body.style.userSelect="unset"}return window.addEventListener("mousemove",f),window.addEventListener("mouseup",p),()=>{window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",p)}},[r,c.length,a]),Object(u.useEffect)(()=>{function f(C){if(g.current===null||!r||!c.length)return;const{pageX:w}=C,j=g.current-w;if(j){const D=j/r,S=Math.round(c.length*D);a(M=>{let k=M[1]+S;return k=Math.min(k,c.length-M[0]-2e3),k=Math.max(k,0),[M[0],k]}),g.current=w}}function p(){g.current=null,document.body.style.userSelect="unset"}return window.addEventListener("mousemove",f),window.addEventListener("mouseup",p),()=>{window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",p)}},[r,c.length,a]),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{style:{position:"relative"}},o.a.createElement("div",{style:{position:"absolute",right:0,bottom:4}},o.a.createElement(B.a,{type:"button",variant:"light",disabled:n===m,onClick:()=>l(m)},"Normalize")," ",o.a.createElement(B.a,{type:"button",variant:"light",disabled:n===1,onClick:()=>l(1)},"Original level"))),o.a.createElement("div",{style:{position:"relative",backgroundColor:"#f3f3f3"}},o.a.createElement(Ye,{waveformRef:i,peaks:d,scaleCoefficient:n}),o.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,left:0,right:`calc(100% - ${h[0]}px)`,background:"#f3f3f3"}},o.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,right:0,width:2,background:"var(--bs-dark)"}}),o.a.createElement("div",{style:{position:"absolute",top:"100%",right:0,width:20,height:20,background:"var(--bs-dark)",borderRadius:10,transform:"translateX(50%)"},onTouchStart:f=>{f.preventDefault(),document.body.style.userSelect="none",E.current=f.touches[0].pageX},onMouseDown:f=>{document.body.style.userSelect="none",E.current=f.pageX},onTouchMove:f=>{if(f.preventDefault(),E.current===null||!r||!c.length)return;const{pageX:p}=f.touches[0],C=p-E.current;if(C){const w=C/r,j=Math.round(c.length*w);a(D=>{let S=D[0]+j;return S=Math.min(S,c.length-D[1]-2e3),S=Math.max(S,0),[S,D[1]]}),E.current=p}},onTouchEnd:()=>{E.current=null},onTouchCancel:()=>{E.current=null}})),o.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,right:0,left:`calc(100% - ${h[1]}px)`,background:"#f3f3f3"}},o.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,left:0,width:2,background:"var(--bs-dark)"}}),o.a.createElement("div",{style:{position:"absolute",top:"100%",left:0,width:20,height:20,background:"var(--bs-dark)",borderRadius:10,transform:"translateX(-50%)"},onTouchStart:f=>{f.preventDefault(),document.body.style.userSelect="none",g.current=f.touches[0].pageX},onMouseDown:f=>{document.body.style.userSelect="none",g.current=f.pageX},onTouchMove:f=>{if(f.preventDefault(),g.current===null||!r||!c.length)return;const{pageX:p}=f.touches[0],C=g.current-p;if(C){const w=C/r,j=Math.round(c.length*w);a(D=>{let S=D[1]+j;return S=Math.min(S,c.length-D[0]-2e3),S=Math.max(S,0),[D[0],S]}),g.current=p}},onTouchEnd:()=>{g.current=null},onTouchCancel:()=>{g.current=null}}))))}function Qt(e){var t=e,{sample:n}=t,a=_t(t,["sample"]);const[l,c]=Object(u.useState)(null);Object(u.useEffect)(()=>{let i=!1;return(()=>Yt(this,null,function*(){if(i)return;const r=yield Ee(n.metadata.sourceFileId,Boolean(n.metadata.userFileInfo));i||c([n.metadata.sourceFileId,r])}))(),()=>{i=!0}},[n.metadata.sourceFileId,n.metadata.userFileInfo]);const s=Object(u.useRef)(n);return l&&n.metadata.sourceFileId===l[0]&&(s.current=n),o.a.createElement(Kt,Gt($t({},a),{sample:s.current,sourceAudioBuffer:l&&l[1]}))}var Jt=Qt,Zt=y(147),qt=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{i(n.next(r))}catch(d){l(d)}},s=r=>{try{i(n.throw(r))}catch(d){l(d)}},i=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,s);i((n=n.apply(e,t)).next())});let et;function en(){return qt(this,null,function*(){if(typeof window.CREATE_SYRO_BINDINGS!="function")return Promise.reject("Expected CREATE_SYRO_BINDINGS global function to exist");const e=yield window.CREATE_SYRO_BINDINGS();return et=et||new Promise((t,n)=>{let a;try{a={prepareSampleBufferFromWavData:e.cwrap("prepareSampleBufferFromWavData","number",["array","number","number","number","number"]),prepareSampleBufferFrom16BitPcmData(){throw new Error("This function does not work. Use prepareSampleBufferFromWavData.")},getSampleBufferChunkPointer:e.cwrap("getSampleBufferChunkPointer","number",["number"]),getSampleBufferChunkSize:e.cwrap("getSampleBufferChunkSize","number",["number"]),getSampleBufferProgress:e.cwrap("getSampleBufferProgress","number",["number"]),getSampleBufferTotalSize:e.cwrap("getSampleBufferTotalSize","number",["number"]),cancelSampleBufferWork:e.cwrap("cancelSampleBufferWork",null,["number"]),registerUpdateCallback(l){return e.addFunction(l,"vi")},unregisterUpdateCallback(l){e.removeFunction(l)},heap8Buffer(){return e.HEAP8.buffer}}}catch(l){n(l);return}t(a)})})}var tn=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{i(n.next(r))}catch(d){l(d)}},s=r=>{try{i(n.throw(r))}catch(d){l(d)}},i=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,s);i((n=n.apply(e,t)).next())});function nn(e,t){let n=!1,a=()=>{};return{cancelWork(){n=!0,a()},sampleBufferPromise:(()=>tn(this,null,function*(){const{prepareSampleBufferFromWavData:l,getSampleBufferChunkPointer:c,getSampleBufferChunkSize:s,getSampleBufferProgress:i,getSampleBufferTotalSize:r,cancelSampleBufferWork:d,registerUpdateCallback:b,unregisterUpdateCallback:m,heap8Buffer:h}=yield en();if(n)return new Uint8Array;const{data:E}=yield ze(e);if(n)return new Uint8Array;let g,f=0;const p=b(w=>{if(n)return;const j=r(w);g||(g=new Uint8Array(j));const D=c(w),S=s(w),M=i(w);g.set(new Uint8Array(h(),D,S),M-S),f=M/j}),C=l(E,E.length,e.metadata.slotNumber,e.metadata.qualityBitDepth,e.metadata.useCompression?1:0,p);t(f);try{yield new Promise(w=>{let j;a=()=>{cancelAnimationFrame(j),d(C),w()},D();function D(){if(f&&(t(f),f>=1)){w();return}j=requestAnimationFrame(D)}})}finally{a=()=>{},m(p)}if(n)return new Uint8Array;if(!g)throw new Error("Unexpected condition: sampleBuffer should be defined");return g}))()}}var an=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{i(n.next(r))}catch(d){l(d)}},s=r=>{try{i(n.throw(r))}catch(d){l(d)}},i=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,s);i((n=n.apply(e,t)).next())});function rn({sample:e}){const[t,n]=Object(u.useState)(0),[a,l]=Object(u.useState)("idle"),[c,s]=Object(u.useState)(null),[i,r]=Object(u.useState)(null);Object(u.useEffect)(()=>{c instanceof AudioBuffer&&i&&(r(null),i.fn())},[c,i]);const d=Object(u.useRef)(()=>{});Object(u.useEffect)(()=>{let m=!1;n(0),l("idle"),s(null),r(null),d.current=()=>{m=!0};try{const{sampleBufferPromise:h,cancelWork:E}=nn(e,g=>{m||n(g)});d.current=()=>{E(),m=!0},h.then(g=>an(this,null,function*(){if(m)return;d.current=()=>{m=!0};const f=yield Z(g);m||s(f)}))}catch(h){console.error(h),s(new Error(String(h)))}return()=>d.current()},[e]);const{playAudioBuffer:b}=Xe();return o.a.createElement(o.a.Fragment,null,o.a.createElement(B.a,{type:"button",variant:"primary",onClick:m=>{if(!(c instanceof AudioBuffer)){if(!c){const h=m.currentTarget;r({fn:()=>h.click()})}return}try{l("transferring");const h=b(c,{onTimeUpdate:E=>n(E/c.duration),onEnded:()=>l("idle")});d.current=()=>{h(),l("idle")}}catch(h){console.error(h),l("error")}},disabled:c instanceof Error||a==="transferring"},"Transfer to volca sample"),o.a.createElement("br",null),c&&a==="idle"?null:a==="error"?"Error transferring":o.a.createElement(o.a.Fragment,null,o.a.createElement("p",null,c?c instanceof AudioBuffer?"Transferring to Volca Sample...":"Error preparing sample for transfer":"Preparing sample for transfer..."),o.a.createElement(Zt.a,{now:100*t}),o.a.createElement("br",null),o.a.createElement(B.a,{type:"button",variant:"light",onClick:()=>d.current()},"Cancel")),o.a.createElement("br",null))}var on=rn,tt=y(72),nt=y.n(tt),ln=y(143),cn=y(138),we=y(73),Se=y(74),sn=y(88),un=y(18),W=y.n(un),at=Math.pow;tt.Digit.defaultProps.offOpacity=0;const rt=(e,t)=>Math.min(199,t+at(10,e)),ot=(e,t)=>Math.max(0,t-at(10,e));function dn({sample:e,onSampleUpdate:t}){const[n,a]=Object(u.useState)(e.metadata.slotNumber);Object(u.useEffect)(()=>{a(e.metadata.slotNumber)},[e.metadata.slotNumber]);const[l,c]=Object(u.useState)(null),s=Object(u.useCallback)(b=>{t(e.id,({slotNumber:m})=>({slotNumber:rt(b,m)}))},[e.id,t]),i=Object(u.useCallback)(b=>{t(e.id,({slotNumber:m})=>({slotNumber:ot(b,m)}))},[e.id,t]),r=Object(u.useRef)(null),d=Object(u.useRef)(null);{const b=Object(u.useRef)(l);b.current=l;const m=Object(u.useRef)(e.id);m.current=e.id;const h=Object(u.useRef)(n);h.current=n,Object(u.useEffect)(()=>{if(!d.current)throw new Error("Expected elements to exist");function E(O){const A=b.current;if(A!==null)switch(O.stopPropagation(),O.preventDefault(),O.key){case"ArrowDown":a(P=>ot(A,P));break;case"ArrowUp":a(P=>rt(A,P));break;case"ArrowLeft":c(P=>P!==null&&P<2?P+1:P);break;case"ArrowRight":c(P=>P&&P-1);break;case"Enter":case"Escape":c(null);break;default:break}}function g(O){const A=b.current;if(A===null)return;O.stopPropagation(),O.preventDefault();const P=h.current;if(isNaN(Number(O.key)))t(m.current,{slotNumber:P});else{const v=String(P).padStart(3,"0").split("");v[2-A]=O.key;const R=Math.min(199,Math.max(0,Number(v.join(""))));c(A?A-1:null),t(m.current,{slotNumber:R})}}function f(O){r.current&&r.current.contains(O.target)||c(null)}document.addEventListener("keydown",E,!0),document.addEventListener("keyup",g,!0),document.addEventListener("click",f);const p=r.current;let C=0,w=!1,j=!1,D=0;function S(O){document.body.style.userSelect="none",C=O instanceof MouseEvent?O.pageY:O.touches[0].pageY,w=!0,j=!1,D=h.current}p.addEventListener("mousedown",S),p.addEventListener("touchstart",O=>{O.preventDefault(),S(O)});function M(O){if(!w)return;const{pageY:A}=O instanceof MouseEvent?O:O.touches[0],P=2,v=Math.round((C-A)/P);v&&(j=!0,a(Math.min(199,Math.max(0,D+v))))}window.addEventListener("mousemove",M),p.addEventListener("touchmove",M);function k(){document.body.style.userSelect="unset",w=!1,j&&t(m.current,{slotNumber:h.current})}window.addEventListener("mouseup",k),p.addEventListener("touchend",k),p.addEventListener("touchcancel",()=>{document.body.style.userSelect="unset"});function N(O){j||d.current&&d.current.some(A=>A.contains(O.target))||c(2)}return p.addEventListener("click",N),d.current.forEach((O,A)=>{const P=A;O.addEventListener("click",()=>{j||c(P)}),O.addEventListener("touchstart",v=>{v.preventDefault()})}),()=>{document.removeEventListener("keydown",E,!0),document.removeEventListener("keyup",g,!0),document.removeEventListener("click",f),window.removeEventListener("mousemove",M),window.removeEventListener("mouseup",k)}},[t])}return Object(u.useEffect)(()=>{if(!d.current)throw new Error("Expected elements to exist");d.current.forEach((b,m)=>{m===l?b.classList.add(W.a.active):b.classList.remove(W.a.active)})},[l]),o.a.createElement(o.a.Fragment,null,o.a.createElement(T.a.Label,null,"Destination"),o.a.createElement("br",null),o.a.createElement("div",{className:W.a.slotNumberRow},o.a.createElement("div",{className:W.a.slotNumberContainer},o.a.createElement("div",{className:W.a.arrowControls},o.a.createElement("span",{onClick:()=>s(2)},o.a.createElement("img",{src:we.a,alt:"Increment 100"})),o.a.createElement("span",{onClick:()=>s(1)},o.a.createElement("img",{src:we.a,alt:"Increment 10"})),o.a.createElement("span",{onClick:()=>s(0)},o.a.createElement("img",{src:we.a,alt:"Increment 1"}))),o.a.createElement("div",{className:W.a.slotNumber,title:`Slot ${n}`,ref:r},o.a.createElement(nt.a,{value:"8888",color:"var(--bs-gray-dark)",strokeColor:"transparent",digitCount:4}),o.a.createElement(nt.a,{ref:b=>{const m=Object(Ae.findDOMNode)(b);if(m){m.querySelectorAll("circle").forEach(E=>{m.removeChild(E)});const h=document.createElementNS("http://www.w3.org/2000/svg","circle");h.classList.add(W.a.point),h.setAttribute("cx","10.7"),h.setAttribute("cy","17"),h.setAttribute("r","1"),m.appendChild(h),d.current=[].slice.call(m.querySelectorAll("g")).reverse().slice(0,3)}},value:`5${String(n).padStart(3,"0")}`,digitProps:{color:"var(--bs-primary)"},digitCount:4})),o.a.createElement("div",{className:W.a.arrowControls},o.a.createElement("span",{onClick:()=>i(2)},o.a.createElement("img",{src:Se.a,alt:"Decrement 100"})),o.a.createElement("span",{onClick:()=>i(1)},o.a.createElement("img",{src:Se.a,alt:"Decrement 10"})),o.a.createElement("span",{onClick:()=>i(0)},o.a.createElement("img",{src:Se.a,alt:"Decrement 1"})))),e.metadata.slotNumber>99&&n>99&&o.a.createElement(ln.a,{placement:"auto-end",overlay:o.a.createElement(cn.a,null,"To transfer to this destination, be sure you have a volca sample2. The original volca sample only supports slots 0-99.")},o.a.createElement("img",{className:W.a.warning,src:sn.a,alt:"destination-warning"}))))}var fn=dn,mn=y(89),pn=y.n(mn),vn=Object.defineProperty,hn=Object.defineProperties,gn=Object.getOwnPropertyDescriptors,lt=Object.getOwnPropertySymbols,yn=Object.prototype.hasOwnProperty,bn=Object.prototype.propertyIsEnumerable,ct=(e,t,n)=>t in e?vn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,it=(e,t)=>{for(var n in t||(t={}))yn.call(t,n)&&ct(e,n,t[n]);if(lt)for(var n of lt(t))bn.call(t,n)&&ct(e,n,t[n]);return e},st=(e,t)=>hn(e,gn(t)),En=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{i(n.next(r))}catch(d){l(d)}},s=r=>{try{i(n.throw(r))}catch(d){l(d)}},i=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,s);i((n=n.apply(e,t)).next())});function wn(e,t){const n=URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download=t,a.style.display="none",document.body.appendChild(a),a.click(),a.remove(),URL.revokeObjectURL(n)}function Sn({sample:e,onSampleUpdate:t,onSampleDuplicate:n,onSampleDelete:a}){const l=e&&e.id,c=Object(u.useCallback)(f=>l&&t(l,{scaleCoefficient:f}),[l,t]),s=Object(u.useCallback)(f=>l&&t(l,p=>st(it({},p),{trim:st(it({},p.trim),{frames:f(p.trim.frames)})})),[l,t]),[i,r]=Object(u.useState)(null),[d,b]=Object(u.useState)(null),[m,h]=Object(u.useState)(null);Object(u.useEffect)(()=>{d instanceof AudioBuffer&&m&&(h(null),m.fn())},[d,m]),Object(u.useEffect)(()=>{if(r(null),h(null),e){let f=!1;ze(e).then(({data:p})=>{f||r(p)})}},[e]),Object(u.useEffect)(()=>{if(b(null),i){let f=!1;Z(i).then(p=>{f||b(p)})}},[i]);const{playAudioBuffer:E}=Xe(),g=Object(u.useRef)(()=>{});return Object(u.useEffect)(()=>()=>g.current(),[e]),e?o.a.createElement(me.a,{fluid:"sm"},o.a.createElement("h2",null,e.metadata.name,o.a.createElement(Vt.a,{style:{display:"inline-block",float:"right"},variant:"light",align:"end",title:"options"},o.a.createElement(ue.a.Item,{onClick:()=>{const f=prompt(`Choose a new name for the sample "${e.metadata.name}":`,e.metadata.name),p=f&&f.trim();p&&t(e.id,{name:p})}},"Rename"),o.a.createElement(ue.a.Item,{onClick:()=>n(e.id)},"Duplicate"),o.a.createElement(ue.a.Divider,null),o.a.createElement(ue.a.Item,{onClick:()=>{window.confirm(`Are you sure you want to delete ${e.metadata.name}?`)&&a(e.id)}},"Delete"))),o.a.createElement("p",null,o.a.createElement("strong",null,"Sampled:")," ",new Date(e.metadata.dateSampled).toLocaleString(),o.a.createElement("br",null),o.a.createElement("strong",null,"Updated:")," ",new Date(e.metadata.dateModified).toLocaleString()),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("div",{className:pn.a.waveformContainer},o.a.createElement(Jt,{onSetTrimFrames:s,onSetScaleCoefficient:c,sample:e})),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(B.a,{type:"button",variant:"secondary",size:"sm",onClick:f=>{if(d)g.current=E(d);else{const p=f.currentTarget;h({fn:()=>p.click()})}}},"Play audio preview")," ",o.a.createElement(B.a,{type:"button",variant:"secondary",size:"sm",onClick:()=>En(this,null,function*(){const{sourceFileId:f,userFileInfo:p}=e.metadata,C=yield x.getSourceFileData(f),w=new Blob([C],{type:p?p.type:"audio/x-wav"});wn(w,`${e.metadata.name}${p?p.ext:".wav"}`)})},"Download original file"),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(T.a.Group,null,o.a.createElement(T.a.Label,null,"Quality bit depth (",e.metadata.qualityBitDepth,")"),o.a.createElement(T.a.Range,{value:e.metadata.qualityBitDepth,step:1,min:8,max:16,onChange:f=>{const p=Number(f.target.value);t(e.id,{qualityBitDepth:p})}})),o.a.createElement(fn,{sample:e,onSampleUpdate:t}),o.a.createElement("br",null),o.a.createElement(on,{sample:e})):null}var Cn=Sn,ut=y(140),On=y(93),q=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{i(n.next(r))}catch(d){l(d)}},s=r=>{try{i(n.throw(r))}catch(d){l(d)}},i=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,s);i((n=n.apply(e,t)).next())});let dt;function Ce(){const e=We();return dt=dt||new e(navigator.mediaDevices.getSupportedConstraints().sampleRate?{sampleRate:oe}:{})}function Dn(){return q(this,null,function*(){{const a=yield navigator.mediaDevices.getUserMedia({audio:!0,video:!1});for(const l of a.getTracks())l.stop()}const t=(yield navigator.mediaDevices.enumerateDevices()).filter(a=>a.kind==="audioinput"),n=[];for(const a of t){const l=yield navigator.mediaDevices.getUserMedia({audio:{deviceId:a.deviceId,channelCount:2},video:!1}),c=(yield navigator.mediaDevices.enumerateDevices()).find(({deviceId:i})=>a.deviceId===i).label;let s=1;{const i=l.getAudioTracks()[0],r=i.getSettings().channelCount;r?s=r:i.getCapabilities&&(s=(i.getCapabilities().channelCount||{}).max||s)}for(const i of l.getTracks())i.stop();n.push({device:{deviceId:a.deviceId,label:c},channelsAvailable:s})}return n})}let Oe;function Pn(e){return q(this,arguments,function*({onData:t,onFinish:n}){const a=Ce();Oe=Oe||a.audioWorklet.addModule("recorderWorkletProcessor.js"),yield Oe;const l=new AudioWorkletNode(a,"recorder-worklet",{parameterData:{bufferSize:1024}});l.port.onmessage=s=>{if(s.data.eventType==="data"){const i=s.data.audioChannels;t(i)}s.data.eventType==="stop"&&n()};const c=l.parameters.get("isRecording");return c.setValueAtTime(1,a.currentTime),{recorderNode:l,stop(){c.setValueAtTime(0,a.currentTime)}}})}function An({channelCount:e,onData:t,onFinish:n}){const l=Ce().createScriptProcessor(1024,e,e);let c=!1;return l.onaudioprocess=s=>{const i=Array(e).fill().map((r,d)=>s.inputBuffer.getChannelData(d));t(i),c&&n()},{recorderNode:l,stop(){c=!0}}}function kn(e){return q(this,null,function*(){return typeof AudioWorkletNode=="undefined"?An(e):yield Pn(e)})}function jn(e){return q(this,arguments,function*({deviceId:t,channelCount:n,onStart:a,onUpdate:l}){const c=yield navigator.mediaDevices.getUserMedia({audio:{deviceId:t,channelCount:n,sampleRate:oe,echoCancellation:!1,autoGainControl:!1,noiseSuppression:!1},video:!1}),s=Ce(),i=s.createMediaStreamSource(c),{recorderNode:r,stop:d}=yield kn({channelCount:n,onData:g,onFinish:j});i.connect(r),r.connect(s.destination);const b=10;a(s.sampleRate,b);const m=b*s.sampleRate;let h=0;const E=Array(n).fill([]);function g(D){let S=0;const M=[];for(let O=0;O<n;O++){const A=D[O],P=A.length,v=A.slice(0,Math.min(P,m-h));Le(v),S||(S=v.length),M.push(v)}const k=jt(M),N=Te(k);E.push(N),h+=S,h>=m&&d(),l(M)}let f,p;const C=new Promise((D,S)=>{f=D,p=S});let w=!1;function j(){return q(this,null,function*(){if(w)return;try{const M=yield new Blob(E).arrayBuffer(),k=new Float32Array(M),N=ke()({channels:n,sampleRate:s.sampleRate,bitDepth:16,dataLength:k.byteLength}),O=new Uint8Array(N.length+k.byteLength);O.set(N),O.set(new Uint8Array(k.buffer),N.length),f(O)}catch(S){p(S)}const D=c.getTracks();for(const S of D)S.stop();r.disconnect(s.destination),i.disconnect(r),w=!0})}return{stop:d,mediaRecording:C}})}var Mn=y(45),fe=y.n(Mn),ee=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{i(n.next(r))}catch(d){l(d)}},s=r=>{try{i(n.throw(r))}catch(d){l(d)}},i=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,s);i((n=n.apply(e,t)).next())});const ft="capture_device_preference";let mt=null;function Rn(e,t){const n=Object(u.useRef)(JSON.parse(localStorage.getItem(ft)||"null")),[a,l]=Object(u.useState)(mt),[c,s]=Object(u.useState)(a?"ok":"pending"),[i,r]=Object(u.useState)("");Object(u.useEffect)(()=>{mt=a,s("ok")},[a]);const d=Object(u.useCallback)(()=>{let A=!1;return Dn().then(P=>{A||P.length&&(l(new Map(P.map(v=>[v.device.deviceId,v]))),r(v=>v?(n.current=null,v):n.current&&P.find(({device:R})=>n.current.deviceId===R.deviceId)?n.current.deviceId:(n.current=null,P[0].device.deviceId)))}).catch(P=>{if(!A){if(P instanceof DOMException){if(P.name==="NotAllowedError"){s("denied");return}if(P.name==="NotFoundError"){s("unavailable");return}}throw P}}),()=>{A=!0}},[]),[b,m]=Object(u.useState)(1);Object(u.useEffect)(()=>{const A=a&&a.get(i);A&&(n.current&&n.current.deviceId===A.device.deviceId&&n.current.channelCount<=A.channelsAvailable?m(n.current.channelCount):m(A.channelsAvailable),n.current=null)},[a,i]),Object(u.useEffect)(()=>{i&&localStorage.setItem(ft,JSON.stringify({deviceId:i,channelCount:b}))},[i,b]);const[h,E]=Object(u.useState)("ready"),[g,f]=Object(u.useState)(null),[p,C]=Object(u.useState)(!1);Object(u.useEffect)(()=>{h!=="ready"&&C(!1)},[h]);const w=Object(u.useCallback)(()=>{C(!1)},[]),[j,D]=Object(u.useState)({fn(A){}});Object(u.useEffect)(()=>j.fn,[j]);const[S,M]=Object(u.useState)(1/0),[k,N]=Object(u.useState)(0),O=Object(u.useCallback)(()=>ee(this,null,function*(){let A=!1;const P=(I,G)=>jn({deviceId:I,channelCount:G,onStart:(Q,U)=>{const te=U*Q;M(Q),N(te),E("capturing")},onUpdate:e}),v=n.current,{mediaRecording:R,stop:K}=yield v?(()=>ee(this,null,function*(){try{return P(v.deviceId,v.channelCount)}catch(I){if(I instanceof DOMException&&I.name==="NotFoundError")return P(i,b);throw I}}))():P(i,b);D({fn(I){K(),I&&(A=!0)}});let H;try{H=yield R}catch(I){f(I),E("error");return}if(A)E("ready");else{E("finalizing");const I=yield t(H);A||(E("ready"),I==="silent"&&C(!0))}}),[i,b,e,t]);return{captureDevices:a,accessState:c,selectedCaptureDeviceId:i,selectedChannelCount:b,captureState:h,recordingError:g,showSilenceWarning:p,sampleRate:S,maxSamples:k,refreshCaptureDevices:d,setSelectedCaptureDeviceId:r,setSelectedChannelCount:m,beginRecording:O,stopRecording:j.fn,dismissSilenceWarning:w}}const De=3;function In({canvas:e,peaks:t,drawUntil:n,scaleCoefficient:a}){const l="#fff",c=e.getContext("2d");c.imageSmoothingEnabled=!1;const{width:s,height:i}=e;c.clearRect(0,0,s,i),c.fillStyle=l;for(let r=0;r<n&&r<t.length;r++){const d=t[r],b=i*d,m=Math.max(Math.round(a*b),2);c.fillRect(r*De,i-m,De-1,m)}}function Bn({onRecordFinish:e}){const t=Object(u.useRef)(null),n=Object(u.useRef)(0),a=Object(u.useRef)(new Float32Array),l=Object(u.useRef)(0),c=Object(u.useRef)([]),s=Object(u.useRef)(1/0),i=Object(u.useRef)(0),[r,d]=Object(u.useState)(0),b=Object(u.useCallback)(v=>ee(this,null,function*(){const R=n.current,K=a.current,H=c.current;if(H.push(v),i.current+=v[0].length,d(Math.floor(i.current/s.current)),H.reduce((G,[{length:Q}])=>G+Q,0)>=R){const G=yield Promise.all(v.map((U,te)=>H.reduce((Vn,zn)=>[...Vn,zn[te]],[])).map(U=>ee(this,null,function*(){const te=yield new Blob(U).arrayBuffer();return new Float32Array(te)}))),Q=G.map(U=>Fe(new Float32Array(U.buffer,0,R)));K[l.current++]=Math.max(...Q),In({canvas:t.current,peaks:K,drawUntil:l.current,scaleCoefficient:.3}),c.current=[G.map(U=>U.slice(R))]}}),[]),{captureDevices:m,accessState:h,selectedCaptureDeviceId:E,selectedChannelCount:g,captureState:f,recordingError:p,showSilenceWarning:C,maxSamples:w,sampleRate:j,refreshCaptureDevices:D,setSelectedCaptureDeviceId:S,setSelectedChannelCount:M,beginRecording:k,stopRecording:N,dismissSilenceWarning:O}=Rn(b,e);s.current=j,Object(u.useEffect)(()=>{const v=t.current;v&&(v.width=v.offsetWidth,v.height=v.offsetHeight)},[h]),Object(u.useLayoutEffect)(()=>{const v=t.current;!v||(f!=="finalizing"&&v.getContext("2d").clearRect(0,0,v.width,v.height),f==="capturing"&&w&&(n.current=Math.floor(De*w/t.current.width),a.current=new Float32Array(Math.floor(w/n.current)),l.current=0,c.current=[],s.current=1/0,i.current=0,d(0)))},[w,f]);const[A,P]=Object(u.useState)(!1);return Object(u.useEffect)(()=>{A&&D()},[A,D]),o.a.createElement(me.a,{fluid:"sm"},h==="denied"?o.a.createElement("p",null,"Looks like you didn't grant access to your audio input device. Please give Volca Sampler access, then"," ",o.a.createElement(B.a,{type:"button",variant:"secondary",onClick:D},"try again")):h==="unavailable"?o.a.createElement("p",null,"Volca Sampler couldn't find any audio input devices. Please connect one, then"," ",o.a.createElement(B.a,{type:"button",variant:"secondary",onClick:D},"try again")):o.a.createElement("div",null,o.a.createElement("h2",null,"Send a new sound to your Volca Sample!"),C&&o.a.createElement("div",{className:fe.a.alertContainer},o.a.createElement(ut.a,{dismissible:!0,variant:"warning",onClose:O},o.a.createElement(ut.a.Heading,null,"Your recording was totally silent"),o.a.createElement("p",null,"Check the audio input settings and your connections, then try again"))),o.a.createElement(B.a,{className:fe.a.recordButton,type:"button",variant:f==="capturing"?"danger":"primary",size:"lg",style:{width:250},onClick:f==="capturing"?()=>N():k,disabled:f==="finalizing"},o.a.createElement("canvas",{ref:t}),o.a.createElement("span",{className:fe.a.mainText},["capturing","finalizing"].includes(f)?"Finished recording":"Start recording"),["capturing","finalizing"].includes(f)&&o.a.createElement("span",{className:fe.a.timeRecorded},"0:",String(r).padStart(2,"0"))),["capturing","finalizing"].includes(f)?o.a.createElement(o.a.Fragment,null,o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(B.a,{style:{width:250},size:"sm",type:"button",variant:"secondary",onClick:()=>N(!0)},"Cancel")):o.a.createElement(o.a.Fragment,null,o.a.createElement("br",null),o.a.createElement(B.a,{style:{width:250},type:"button",variant:"light",size:"sm",onClick:()=>P(v=>!v)},"Audio input settings ",A?"\u25B2":"\u25BC"),o.a.createElement(On.a,{in:A},o.a.createElement("div",null,o.a.createElement(T.a.Group,null,o.a.createElement(T.a.Label,null,"Capture Device"),o.a.createElement(T.a.Select,{style:{width:250},value:E,onChange:v=>S(v.target.value)},m&&h==="ok"?[...m].map(([v,{device:R}])=>o.a.createElement("option",{key:v,value:v},R.label||v)):o.a.createElement("option",{value:"",disabled:!0},"Loading devices..."))),o.a.createElement(T.a.Group,null,o.a.createElement(T.a.Label,null,"Input channels"),o.a.createElement(T.a.Select,{style:{width:250},value:g,onChange:v=>M(Number(v.target.value))},[1,2].map(v=>o.a.createElement("option",{key:v,value:v,disabled:!m||!m.has(E)||m.get(E).channelsAvailable<v},v===1?"Mono":"Stereo (summed to mono)")))),o.a.createElement("br",null))))),f==="error"&&p||null,o.a.createElement("br",null),o.a.createElement(B.a,{style:{width:250},type:"button",variant:"secondary",onClick:v=>{const R=v.currentTarget.querySelector("input");R&&v.target!==R&&R.click()}},"Or import an audio file",o.a.createElement("input",{hidden:!0,type:"file",accept:"audio/*,.wav,.mp3,.ogg",onChange:v=>{if(v.target.files&&v.target.files.length){const R=v.target.files[0];R.arrayBuffer().then(K=>ee(this,null,function*(){const H=new Uint8Array(K);let I;try{I=yield Z(H)}catch(G){alert("Unsupported audio format detected");return}if(I.length>10*I.sampleRate){alert("Please select an audio file no more than 10 seconds long");return}e(H,R)}))}}})))}var Nn=Bn,Pe=y(142),$=y(144),xn=(e,t,n)=>new Promise((a,l)=>{var c=r=>{try{i(n.next(r))}catch(d){l(d)}},s=r=>{try{i(n.throw(r))}catch(d){l(d)}},i=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,s);i((n=n.apply(e,t)).next())});const Fn=ne.a.div({padding:"2rem",display:"flex",height:"100%"}),Ln=ne.a.div({flexGrow:1});function Tn(){const[e,t]=Object(u.useState)(new Map),[n,a]=Object(u.useState)(new Map),l=Object(u.useMemo)(()=>new Map([...e,...n]),[e,n]);Object(u.useEffect)(()=>{Pt().then(a).catch(console.error)},[]);const[c,s]=Object(u.useState)(null),[i,r]=Object(u.useState)(!0);Object(u.useEffect)(()=>{x.getAllFromStorage().then(g=>{t(f=>new Map([...f,...g.map(p=>[p.id,p])]))}).finally(()=>{r(!1)})},[]);const d=Object(u.useCallback)((g,f)=>xn(this,null,function*(){const p=yield Z(g),C=[0,0],w=yield _e(p,C);if([...w.positive,...w.negative].every(k=>k===0))return"silent";const j=yield Ct(g);let D="",S="";if(f){const k=f.name.lastIndexOf(".");k>0?(D=f.name.slice(0,k),S=f.name.slice(k)):D=f.name}else D="New sample";const M=new x.Mutable({name:D,sourceFileId:j,trim:{frames:C,waveformPeaks:w},userFileInfo:f&&{type:f.type,ext:S}});return yield M.persist(),t(k=>new Map([[M.id,M],...k])),s(M.id),"saved"}),[]),b=Object(u.useCallback)((g,f)=>{t(p=>{const C=p.get(g);if(C&&C instanceof x.Mutable){const w=C.update(f);if(w!==C)return new Map(p).set(C.id,w)}return p})},[]),[m,h]=Object(u.useState)(!1),E=Object(u.useCallback)(g=>{s(g),h(!1)},[]);return o.a.createElement("div",null,o.a.createElement(gt,{onMenuOpen:()=>h(!0),onHeaderClick:()=>s(null)}),o.a.createElement(Pe.a,{show:m,onHide:()=>h(!1)},o.a.createElement(Pe.a.Header,{closeButton:!0}),o.a.createElement(Pe.a.Body,null,o.a.createElement(ae.a,null,o.a.createElement(ae.a.Item,{as:"button",onClick:()=>E(null)},"New Sample"),i?"Loading...":null,!i&&o.a.createElement($.a,{defaultActiveKey:e.size?"user":"factory"},o.a.createElement($.a.Item,{eventKey:"user"},o.a.createElement($.a.Header,null,"Your Samples"),o.a.createElement($.a.Body,{style:{padding:0}},o.a.createElement(Qe,{samples:e,selectedSampleId:c,onSampleSelect:E}))),o.a.createElement($.a.Item,{eventKey:"factory"},o.a.createElement($.a.Header,null,"Factory Samples"),o.a.createElement($.a.Body,{style:{padding:0}},o.a.createElement(Qe,{samples:n,selectedSampleId:c,onSampleSelect:E}))))))),o.a.createElement(Fn,null,o.a.createElement(Ln,null,c&&o.a.createElement(Cn,{sample:l.get(c)||null,onSampleUpdate:b,onSampleDuplicate:g=>{const f=l.get(g);if(f){const p=f.duplicate();t(C=>new Map([[p.id,p],...C])),s(p.id)}},onSampleDelete:g=>{const f=l.get(g);f&&f instanceof x.Mutable&&(f.remove(),t(p=>{const C=new Map(p);return C.delete(f.id),C}))}}),!c&&o.a.createElement(Nn,{onRecordFinish:d}))))}var Wn=Tn,Hn=e=>{e&&e instanceof Function&&y.e(3).then(y.bind(null,148)).then(({getCLS:t,getFID:n,getFCP:a,getLCP:l,getTTFB:c})=>{t(e),n(e),a(e),l(e),c(e)})};Blob.prototype.arrayBuffer||(Blob.prototype.arrayBuffer=function(){return new Response(this).arrayBuffer()}),pt.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(Rt,null,o.a.createElement(Wn,null))),document.getElementById("root")),Hn()},18:function(F,X,y){F.exports={slotNumberRow:"SlotNumberInput_slotNumberRow__kQwOw",slotNumberContainer:"SlotNumberInput_slotNumberContainer__1q7P1",arrowControls:"SlotNumberInput_arrowControls__1LPAC",slotNumber:"SlotNumberInput_slotNumber__GC-i7",active:"SlotNumberInput_active__2zN4D",digitBlinkEffect:"SlotNumberInput_digitBlinkEffect__1_u8n",point:"SlotNumberInput_point__3pJD3",warning:"SlotNumberInput_warning__3NAeN"}},19:function(F,X,y){F.exports={titleBar:"Header_titleBar__3BLa-",menuIcon:"Header_menuIcon__swn7p",title:"Header_title__R3bRx",titleText:"Header_titleText__3e5ME",titleR:"Header_titleR__3QRgv",titleStarburst:"Header_titleStarburst__1oLYP",titleGraphic:"Header_titleGraphic__3S89F"}},45:function(F,X,y){F.exports={alertContainer:"SampleRecord_alertContainer__vjGNP",recordButton:"SampleRecord_recordButton__3R-KX",mainText:"SampleRecord_mainText__2dca6",timeRecorded:"SampleRecord_timeRecorded__3FGTe"}},89:function(F,X,y){F.exports={waveformContainer:"SampleDetail_waveformContainer__3VrPQ",slotNumber:"SampleDetail_slotNumber__3sgS6",point:"SampleDetail_point__3d7qL"}},98:function(F,X,y){},99:function(F,X,y){}},[[130,1,2]]]);

//# sourceMappingURL=main.6470850c.chunk.js.map