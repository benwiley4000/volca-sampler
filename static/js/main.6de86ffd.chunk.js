(this["webpackJsonpvolca-sampler"]=this["webpackJsonpvolca-sampler"]||[]).push([[0],{22:function(N,X,w){N.exports={title:"Header_title__R3bRx",menuIcon:"Header_menuIcon__swn7p",titleText:"Header_titleText__3e5ME",titleR:"Header_titleR__3QRgv",titleStarburst:"Header_titleStarburst__1oLYP",titleGraphic:"Header_titleGraphic__3S89F"}},52:function(N,X,w){N.exports={recordButton:"SampleRecord_recordButton__3R-KX",mainText:"SampleRecord_mainText__2dca6",timeRecorded:"SampleRecord_timeRecorded__3FGTe"}},65:function(N,X,w){},66:function(N,X,w){},77:function(N,X,w){"use strict";w.r(X);var d=w(0),c=w.n(d),tt=w(13),at=w.n(tt),Oa=w(65),Pa=w(66),$=w(15),nt=w(22),H=w.n(nt);function rt({onMenuOpen:e,onHeaderClick:a}){return c.a.createElement("h1",{className:H.a.title,onClick:a},c.a.createElement("span",{className:H.a.menuIcon,onClick:t=>{t.stopPropagation(),e()}},"\u2630"),c.a.createElement("span",{className:H.a.titleText,"data-text":"Volca Sample"},"Volca Sample",c.a.createElement("span",{className:H.a.titleR},"r"),c.a.createElement("div",{className:H.a.titleStarburst},Array(24).fill().map((t,n,{length:o})=>c.a.createElement("span",{key:n,style:{"--rotation":`${n*360/o}deg`}})))),c.a.createElement("img",{className:H.a.titleGraphic,src:"volca_sample.png",alt:""}),c.a.createElement("svg",{width:0,height:0},c.a.createElement("filter",{id:"outline"},c.a.createElement("feMorphology",{in:"SourceAlpha",result:"DILATED",operator:"dilate",radius:"1"}),c.a.createElement("feFlood",{floodColor:"var(--stroke-color)",floodOpacity:"1",result:"PINK"}),c.a.createElement("feComposite",{in:"PINK",in2:"DILATED",operator:"in",result:"OUTLINE"}),c.a.createElement("feMerge",null,c.a.createElement("feMergeNode",{in:"OUTLINE"}),c.a.createElement("feMergeNode",{in:"SourceGraphic"})))))}var ot=rt,Q=w(89),lt=w(41),we=w.n(lt),ct=w(37),Y=w.n(ct),Ee=w(90),Ce=w(54);const J=31250;var it=Object.defineProperty,st=Object.defineProperties,ut=Object.getOwnPropertyDescriptors,Z=Object.getOwnPropertySymbols,Oe=Object.prototype.hasOwnProperty,Pe=Object.prototype.propertyIsEnumerable,ce=(e,a,t)=>a in e?it(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,T=(e,a)=>{for(var t in a||(a={}))Oe.call(a,t)&&ce(e,t,a[t]);if(Z)for(var t of Z(a))Pe.call(a,t)&&ce(e,t,a[t]);return e},G=(e,a)=>st(e,ut(a)),Ae=(e,a)=>{var t={};for(var n in e)Oe.call(e,n)&&a.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&Z)for(var n of Z(e))a.indexOf(n)<0&&Pe.call(e,n)&&(t[n]=e[n]);return t},q=(e,a,t)=>(ce(e,typeof a!="symbol"?a+"":a,t),t),x=(e,a,t)=>new Promise((n,o)=>{var l=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(l,i);s((t=t.apply(e,a)).next())});const ee=Y.a.createInstance({name:"audio_file_data",driver:Y.a.INDEXEDDB}),te=Y.a.createInstance({name:"sample_metadata",driver:Y.a.INDEXEDDB});function dt(e){return x(this,null,function*(){const a=Object(Ee.a)();return yield ee.setItem(a,e),a})}const ie="0.3.0",ft={"0.1.0":e=>{const a=e,{clip:t}=a,n=Ae(a,["clip"]);return G(T({},n),{trimFrames:t.map(l=>Math.round(l*J)),metadataVersion:"0.2.0"})},"0.2.0":e=>x(void 0,null,function*(){const a=e,{trimFrames:t}=a,n=Ae(a,["trimFrames"]),o=yield He(n.sourceFileId,t),l={frames:t,waveformPeaks:o};return G(T({},n),{trim:l,metadataVersion:"0.3.0"})})};function mt(e){return x(this,null,function*(){let a=e;for(;a.metadataVersion!==ie;){const t=ft[e.metadataVersion];if(!t){console.warn(`Failed to properly upgrade metadata for sample "${a.name}"`),a={name:a.name,sourceFileId:a.sourceFileId,id:a.id,metadataVersion:ie};break}a=yield t(a)}return a})}const V=class{constructor({name:e,sourceFileId:a,trim:t,id:n=Object(Ee.a)(),userFileInfo:o=null,slotNumber:l=0,dateSampled:i=Date.now(),dateModified:s=i,useCompression:r=!0,qualityBitDepth:u=16,scaleCoefficient:E=1}){this.id=n,this.metadata={name:e,sourceFileId:a,trim:t,userFileInfo:o,slotNumber:l,dateSampled:i,dateModified:s,useCompression:r,qualityBitDepth:u,scaleCoefficient:E,metadataVersion:ie}}duplicate(){const e=new V.Mutable(G(T({},this.metadata),{name:`${this.metadata.name} (copy)`,dateModified:Date.now()}));return e.persist(),e}static cacheSourceFileData(e,a){this.sourceFileData.set(e,a),this.recentlyCachedSourceFileIds=[e,...this.recentlyCachedSourceFileIds.filter(n=>n!==e)];const t=this.recentlyCachedSourceFileIds.slice(this.MAX_CACHED);for(const n of t)this.sourceFileData.delete(n);this.recentlyCachedSourceFileIds=this.recentlyCachedSourceFileIds.slice(0,this.MAX_CACHED)}static getSourceFileData(e){return x(this,null,function*(){{const t=this.sourceFileData.get(e);if(t)return t}if(e.includes(".")){const t=yield fetch(e);if(t.status>=400)return Promise.reject(new Error(`Failed to fetch source file "${e}"`));const n=yield t.arrayBuffer(),o=new Uint8Array(n);return this.cacheSourceFileData(e,o),o}const a=yield ee.getItem(e);return a?a instanceof Uint8Array?(this.cacheSourceFileData(e,a),a):Promise.reject("Source data is of unexpected type"):Promise.reject("Missing source data")})}static getAllMetadataFromStore(){return x(this,null,function*(){const e=new Map,a=[];return yield te.iterate((t,n)=>{t&&a.push(mt(t).then(o=>{e.set(n,o)}).catch(o=>{console.error(o),console.warn(`Failed to upgrade metadata "${n}" (${t.name}); ignoring.`)}))}),yield Promise.all(a),e})}static getAllFromStorage(){return x(this,null,function*(){const e=yield this.getAllMetadataFromStore(),a=yield De(),t=(yield ee.keys()).concat(a.map(({sourceFileId:o})=>o));return[...e].map(([o,l])=>{const{sourceFileId:i}=l;return t.includes(i)?new V.Mutable(T({id:o},l)):(console.warn(`Found metadata "${l.name||o}" with missing data "${i}; ignoring.`),null)}).filter(Boolean).sort((o,l)=>l.metadata.dateModified-o.metadata.dateModified)})}};let I=V;q(I,"Mutable",class extends V{constructor(e){super(e);setTimeout(()=>x(this,null,function*(){(yield te.keys()).includes(this.id)||console.warn(`Expected sample metadata container ${this.id} to be persisted`)}))}persist(){return x(this,null,function*(){yield te.setItem(this.id,this.metadata)})}update(e){const{id:a,metadata:t}=this,n=typeof e=="function"?e(t):e;if(Object.keys(n).every(i=>n[i]===t[i]))return this;const o=G(T(T({},t),n),{dateModified:Date.now()}),l=new V.Mutable(T({id:a},o));return l.persist(),l}remove(){return x(this,null,function*(){if(yield te.removeItem(this.id),this.metadata.sourceFileId.includes("."))return;const e=yield V.getAllMetadataFromStore();for(const[,{sourceFileId:a}]of e)if(a===this.metadata.sourceFileId)return;yield ee.removeItem(this.metadata.sourceFileId)})}}),q(I,"sourceFileData",new Map),q(I,"recentlyCachedSourceFileIds",[]),q(I,"MAX_CACHED",10);let se;function De(){return se||(se=fetch("factory-samples.json").then(e=>e.json())),se}function pt(){return x(this,null,function*(){const e=yield De();return new Map(e.map(a=>[a.id,new I(G(T({},a),{trim:{frames:[a.trim.frames[0],a.trim.frames[1]],waveformPeaks:{positive:new Float32Array(Object(Ce.a)(a.trim.waveformPeaks.positive)),negative:new Float32Array(Object(Ce.a)(a.trim.waveformPeaks.negative))}}}))]))})}var Me=Math.pow,ue=(e,a,t)=>new Promise((n,o)=>{var l=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(l,i);s((t=t.apply(e,a)).next())});function de(e,a){const t=4,n=a[0]*t,o=e.length-a[0]-a[1];return new Float32Array(e.buffer,n,o)}function fe(e,a){const t=e.length-a[0]-a[1],n=new Float32Array(t),o=Array(e.numberOfChannels).fill().map((l,i)=>de(e.getChannelData(i),a));for(let l=0;l<t;l++){let i=0;for(let s=0;s<o.length;s++)i+=o[s][l];i/=o.length,n[l]=i}return n}function Be(e){let a=0;for(const t of e){const n=Math.abs(t);n>a&&(a=n)}return a}function ht(e,a){if(a!==1)for(let t=0;t<e.length;t++)e[t]*=a}function vt(e,a){const t=Me(2,a-1);for(let n=0;n<e.length;n++)e[n]=Math.round(e[n]*t)/t}function Re(e){for(let a=0;a<e.length;a++)e[a]>1?e[a]=1:e[a]<-1&&(e[a]=-1)}function yt(e){const a=e.length,t=e[0].length,n=new Float32Array(a*t);for(let o=0;o<n.length;o++){const l=a*o;for(let i=0;i<a;i++)n[l+i]=e[i][o]}return n}function je(e,a){const t=a===16?Int16Array:Int32Array,n=new t(e.length),o=Me(2,a-1);for(let l=0;l<e.length;l++)n[l]=e[l]===1?o-1:o*e[l];return n}function ke(){return window.AudioContext||window.webkitAudioContext}let Ie;function xe(){const e=ke();return Ie=Ie||new e({sampleRate:J})}function ae(e){return ue(this,null,function*(){const a=new Uint8Array(e);return yield new Promise((n,o)=>{xe().decodeAudioData(a.buffer,n,o)})})}function me(e,a){return ue(this,null,function*(){const t=yield I.getSourceFileData(e),n=yield ae(t);if(a)for(let o=0;o<n.numberOfChannels;o++)Re(n.getChannelData(o));return n})}function Fe(e){return ue(this,null,function*(){const{qualityBitDepth:a,sourceFileId:t,userFileInfo:n,scaleCoefficient:o,trim:{frames:l}}=e.metadata;if(a<8||a>16||!Number.isInteger(a))throw new Error(`Expected bit depth between 8 and 16. Received: ${a}`);const i=yield me(t,Boolean(n)),s=i.numberOfChannels===1?de(i.getChannelData(0),l):fe(i,l);o!==1&&ht(s,o),a<16&&vt(s,a);const r=je(s,16),u=r.length*2,E=we()({channels:1,sampleRate:i.sampleRate,bitDepth:16,dataLength:u}),g=new Uint8Array(E.length+u);return g.set(E),g.set(new Uint8Array(r.buffer),E.length),{data:g,sampleRate:16}})}const gt={playAudioBuffer(e,a){throw new Error("Must render AudioPlaybackContextProvider")},isAudioBusy:!1},Te=Object(d.createContext)(gt);function bt({children:e}){const[a,t]=Object(d.useState)(!1),n=Object(d.useCallback)((l,{onTimeUpdate:i=()=>null,onEnded:s=()=>null}={})=>{if(a)throw new Error("Wait until audio playback has finished to start new playback");t(!0);let r,u;try{r=xe(),u=r.createBufferSource(),u.buffer=l,u.connect(r.destination),u.start()}catch(v){throw t(!1),v}const E=r.currentTime;i(0);let g=requestAnimationFrame(b);function b(){i(r.currentTime-E),g=requestAnimationFrame(b)}let h=!1;return u.addEventListener("ended",()=>{h||(i(l.duration),s()),t(!1),cancelAnimationFrame(g)}),function(){u.stop(),h=!0}},[a]),o=Object(d.useMemo)(()=>({playAudioBuffer:n,isAudioBusy:a}),[n,a]);return Object(d.createElement)(Te.Provider,{value:o},e)}function We(){return Object(d.useContext)(Te)}var St=(e,a,t)=>new Promise((n,o)=>{var l=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(l,i);s((t=t.apply(e,a)).next())});const z=6,Le=z*44;function Ne(e,a){const t=Math.floor(z*e.length/a),n=new Float32Array(Math.floor(e.length/t)),o=new Float32Array(Math.floor(e.length/t));for(let l=0;l<n.length;l++){const i=new Float32Array(e.buffer,l*t*4,t);let s=0,r=0;for(const u of i)u>s&&(s=u),u<r&&(r=u);n[l]=Math.min(1,s),o[l]=Math.max(-1,r)}return{positive:n,negative:o}}function He(e,a){return St(this,null,function*(){const t=yield me(e,!1),n=fe(t,a);return Ne(n,Le)})}var wt=w(55);const Et=$.a.canvas({width:"100%",height:"100%",display:"block",imageRendering:"pixelated"});function Ct(e,a){function t(o,l){e.width=o,e.height=l}t(e.offsetWidth,e.offsetHeight),a({width:e.offsetWidth,height:e.offsetHeight});const n=new wt.a(([o])=>{const{width:l,height:i}=o.contentRect;t(l,i),a({width:l,height:i})});return n.observe(e),()=>n.disconnect()}function Ot(e,a,t){const n=getComputedStyle(document.documentElement),o=n.getPropertyValue("--bs-primary"),l=n.getPropertyValue("--bs-primary-darkened"),i=e.getContext("2d");i.imageSmoothingEnabled=!1;const{width:s,height:r}=e;i.clearRect(0,0,s,r);const u=Math.floor(r*(2/3))+1;i.fillStyle=o,a.positive.forEach((g,b)=>{const h=u*g,v=Math.max(Math.round(t*h),1);i.fillRect(b*z,u-v,z-1,v)});const E=r-u;i.fillStyle=l,a.negative.forEach((g,b)=>{const h=E*g*-1,v=Math.round(t*h);i.fillRect(b*z,u,z-1,v)})}function Pt({peaks:e,scaleCoefficient:a,waveformRef:t}){const n=Object(d.useRef)(null);Object(d.useImperativeHandle)(t,()=>n.current);const[o,l]=Object(d.useState)(Symbol()),i=Object(d.useRef)({width:0,height:0});return Object(d.useLayoutEffect)(()=>{if(!n.current)throw new Error("Canvas should be defined");return i.current.width=n.current.offsetWidth,i.current.height=n.current.offsetHeight,Ct(n.current,({width:s,height:r})=>{(s!==i.current.width||r!==i.current.height)&&(l(Symbol()),i.current.width=s,i.current.height=r)})},[]),Object(d.useLayoutEffect)(()=>{const s=n.current;if(!s)throw new Error("Canvas should be defined");let r=requestAnimationFrame(()=>{r=requestAnimationFrame(()=>{Ot(s,e,a)})});return()=>cancelAnimationFrame(r)},[e,a,o]),c.a.createElement(Et,{ref:n})}var Ve=Pt;const At=$.a.div({width:`${Le}px`,height:"40px"}),ze=typeof IntersectionObserver!="undefined",Dt=c.a.memo(({sample:e,selected:a,onSampleSelect:t})=>{const n=Object(d.useRef)(null),[o,l]=Object(d.useState)(!ze);return Object(d.useLayoutEffect)(()=>{if(!ze)return;const i=n.current;if(!i)throw new Error("Waveform container should be defined");const s=i.getBoundingClientRect();if(s.top+s.height>=0&&s.bottom-s.height<=window.innerHeight){l(!0);return}const r=new IntersectionObserver(([u])=>{u.isIntersecting&&(l(!0),r.unobserve(i))});return r.observe(i),()=>r.disconnect()},[]),c.a.createElement(Q.a.Item,{active:a,onClick:()=>t(e.id)},c.a.createElement("div",null,e.metadata.name),c.a.createElement(At,{ref:n},o&&c.a.createElement(Ve,{peaks:e.metadata.trim.waveformPeaks,scaleCoefficient:e.metadata.scaleCoefficient})))});function Mt({samples:e,selectedSampleId:a,onSampleSelect:t}){return c.a.createElement(Q.a,{variant:"flush"},[...e].map(([n,o])=>c.a.createElement(Dt,{key:n,sample:o,selected:n===a,onSampleSelect:t})))}var Ue=Mt,j=w(56),Bt=Object.defineProperty,Rt=Object.defineProperties,jt=Object.getOwnPropertyDescriptors,ne=Object.getOwnPropertySymbols,Xe=Object.prototype.hasOwnProperty,$e=Object.prototype.propertyIsEnumerable,Ge=(e,a,t)=>a in e?Bt(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,kt=(e,a)=>{for(var t in a||(a={}))Xe.call(a,t)&&Ge(e,t,a[t]);if(ne)for(var t of ne(a))$e.call(a,t)&&Ge(e,t,a[t]);return e},It=(e,a)=>Rt(e,jt(a)),xt=(e,a)=>{var t={};for(var n in e)Xe.call(e,n)&&a.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&ne)for(var n of ne(e))a.indexOf(n)<0&&$e.call(e,n)&&(t[n]=e[n]);return t},Ft=(e,a,t)=>new Promise((n,o)=>{var l=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(l,i);s((t=t.apply(e,a)).next())});function Tt({sourceAudioBuffer:e,sample:{metadata:{trim:{frames:a},scaleCoefficient:t}},onSetTrimFrames:n,onSetScaleCoefficient:o}){const l=Object(d.useMemo)(()=>e?fe(e,[0,0]):new Float32Array,[e]),[i,s]=Object(d.useState)(null),r=Object(d.useMemo)(()=>i&&i.offsetWidth,[i]),u=Object(d.useMemo)(()=>!r||!l.length?{positive:new Float32Array,negative:new Float32Array}:Ne(l,r),[r,l]),E=Object(d.useMemo)(()=>{if(!e)return 0;const f=de(l,a);return Be(f)},[e,l,a]),g=1/E;Object(d.useLayoutEffect)(()=>{t>g&&o(g)},[t,g,o]);const b=Object(d.useMemo)(()=>{if(!l.length||!r)return[0,0];const f=r/l.length;return a.map(m=>m*f)},[r,l.length,a]),h=Object(d.useRef)(null),v=Object(d.useRef)(null);return Object(d.useEffect)(()=>{function f(p){if(h.current===null||!r||!l.length)return;const{pageX:O}=p,P=O-h.current;if(P){const A=P/r,S=Math.round(l.length*A);n(D=>{let C=D[0]+S;return C=Math.min(C,l.length-D[1]-2e3),C=Math.max(C,0),[C,D[1]]}),h.current=O}}function m(){h.current=null,document.body.style.userSelect="unset"}return window.addEventListener("mousemove",f),window.addEventListener("mouseup",m),()=>{window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",m)}},[r,l.length,n]),Object(d.useEffect)(()=>{function f(p){if(v.current===null||!r||!l.length)return;const{pageX:O}=p,P=v.current-O;if(P){const A=P/r,S=Math.round(l.length*A);n(D=>{let C=D[1]+S;return C=Math.min(C,l.length-D[0]-2e3),C=Math.max(C,0),[D[0],C]}),v.current=O}}function m(){v.current=null,document.body.style.userSelect="unset"}return window.addEventListener("mousemove",f),window.addEventListener("mouseup",m),()=>{window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",m)}},[r,l.length,n]),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{style:{position:"relative"}},c.a.createElement("div",{style:{position:"absolute",right:0,bottom:4}},c.a.createElement(j.a,{type:"button",variant:"light",disabled:t===g,onClick:()=>o(g)},"Normalize")," ",c.a.createElement(j.a,{type:"button",variant:"light",disabled:t===1,onClick:()=>o(1)},"Original level"))),c.a.createElement("div",{style:{position:"relative",backgroundColor:"#f3f3f3"}},c.a.createElement(Ve,{waveformRef:s,peaks:u,scaleCoefficient:t}),c.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,left:0,right:`calc(100% - ${b[0]}px)`,background:"#f3f3f3"}},c.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,right:0,width:2,background:"var(--bs-dark)"}}),c.a.createElement("div",{style:{position:"absolute",top:"100%",right:0,width:20,height:20,background:"var(--bs-dark)",borderRadius:10,transform:"translateX(50%)"},onTouchStart:f=>{f.preventDefault(),document.body.style.userSelect="none",h.current=f.touches[0].pageX},onMouseDown:f=>{document.body.style.userSelect="none",h.current=f.pageX},onTouchMove:f=>{if(f.preventDefault(),h.current===null||!r||!l.length)return;const{pageX:m}=f.touches[0],p=m-h.current;if(p){const O=p/r,P=Math.round(l.length*O);n(A=>{let S=A[0]+P;return S=Math.min(S,l.length-A[1]-2e3),S=Math.max(S,0),[S,A[1]]}),h.current=m}},onTouchEnd:()=>{h.current=null},onTouchCancel:()=>{h.current=null}})),c.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,right:0,left:`calc(100% - ${b[1]}px)`,background:"#f3f3f3"}},c.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,left:0,width:2,background:"var(--bs-dark)"}}),c.a.createElement("div",{style:{position:"absolute",top:"100%",left:0,width:20,height:20,background:"var(--bs-dark)",borderRadius:10,transform:"translateX(-50%)"},onTouchStart:f=>{f.preventDefault(),document.body.style.userSelect="none",v.current=f.touches[0].pageX},onMouseDown:f=>{document.body.style.userSelect="none",v.current=f.pageX},onTouchMove:f=>{if(f.preventDefault(),v.current===null||!r||!l.length)return;const{pageX:m}=f.touches[0],p=v.current-m;if(p){const O=p/r,P=Math.round(l.length*O);n(A=>{let S=A[1]+P;return S=Math.min(S,l.length-A[0]-2e3),S=Math.max(S,0),[A[0],S]}),v.current=m}},onTouchEnd:()=>{v.current=null},onTouchCancel:()=>{v.current=null}}))))}function Wt(e){var a=e,{sample:t}=a,n=xt(a,["sample"]);const[o,l]=Object(d.useState)(null);Object(d.useEffect)(()=>{let s=!1;return(()=>Ft(this,null,function*(){if(s)return;const r=yield me(t.metadata.sourceFileId,Boolean(t.metadata.userFileInfo));s||l([t.metadata.sourceFileId,r])}))(),()=>{s=!0}},[t.metadata.sourceFileId,t.metadata.userFileInfo]);const i=Object(d.useRef)(t);return o&&t.metadata.sourceFileId===o[0]&&(i.current=t),c.a.createElement(Tt,It(kt({},n),{sample:i.current,sourceAudioBuffer:o&&o[1]}))}var Lt=Wt,Nt=w(91),Ht=(e,a,t)=>new Promise((n,o)=>{var l=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(l,i);s((t=t.apply(e,a)).next())});let _e;function Vt(){return Ht(this,null,function*(){if(typeof window.CREATE_SYRO_BINDINGS!="function")return Promise.reject("Expected CREATE_SYRO_BINDINGS global function to exist");const e=yield window.CREATE_SYRO_BINDINGS();return _e=_e||new Promise((a,t)=>{let n;try{n={prepareSampleBufferFromWavData:e.cwrap("prepareSampleBufferFromWavData","number",["array","number","number","number","number"]),prepareSampleBufferFrom16BitPcmData(){throw new Error("This function does not work. Use prepareSampleBufferFromWavData.")},getSampleBufferChunkPointer:e.cwrap("getSampleBufferChunkPointer","number",["number"]),getSampleBufferChunkSize:e.cwrap("getSampleBufferChunkSize","number",["number"]),getSampleBufferProgress:e.cwrap("getSampleBufferProgress","number",["number"]),getSampleBufferTotalSize:e.cwrap("getSampleBufferTotalSize","number",["number"]),cancelSampleBufferWork:e.cwrap("cancelSampleBufferWork",null,["number"]),registerUpdateCallback(o){return e.addFunction(o,"vi")},unregisterUpdateCallback(o){e.removeFunction(o)},heap8Buffer(){return e.HEAP8.buffer}}}catch(o){t(o);return}a(n)})})}var zt=(e,a,t)=>new Promise((n,o)=>{var l=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(l,i);s((t=t.apply(e,a)).next())});function Ut(e,a){let t=!1,n=()=>{};return{cancelWork(){t=!0,n()},sampleBufferPromise:(()=>zt(this,null,function*(){const{prepareSampleBufferFromWavData:o,getSampleBufferChunkPointer:l,getSampleBufferChunkSize:i,getSampleBufferProgress:s,getSampleBufferTotalSize:r,cancelSampleBufferWork:u,registerUpdateCallback:E,unregisterUpdateCallback:g,heap8Buffer:b}=yield Vt();if(t)return new Uint8Array;const{data:h}=yield Fe(e);if(t)return new Uint8Array;let v,f=0;const m=E(O=>{if(t)return;const P=r(O);v||(v=new Uint8Array(P));const A=l(O),S=i(O),D=s(O);v.set(new Uint8Array(b(),A,S),D-S),f=D/P}),p=o(h,h.length,e.metadata.slotNumber,e.metadata.qualityBitDepth,e.metadata.useCompression?1:0,m);a(f);try{yield new Promise(O=>{let P;n=()=>{cancelAnimationFrame(P),u(p),O()},A();function A(){if(f&&(a(f),f>=1)){O();return}P=requestAnimationFrame(A)}})}finally{n=()=>{},g(m)}if(t)return new Uint8Array;if(!v)throw new Error("Unexpected condition: sampleBuffer should be defined");return v}))()}}var Xt=(e,a,t)=>new Promise((n,o)=>{var l=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(l,i);s((t=t.apply(e,a)).next())});function $t({sample:e}){const[a,t]=Object(d.useState)(0),[n,o]=Object(d.useState)("idle"),[l,i]=Object(d.useState)(null),[s,r]=Object(d.useState)(null);Object(d.useEffect)(()=>{l instanceof AudioBuffer&&s&&(r(null),s.fn())},[l,s]);const u=Object(d.useRef)(()=>{});Object(d.useEffect)(()=>{let b=!1;t(0),o("idle"),i(null),r(null),u.current=()=>{b=!0};try{const{sampleBufferPromise:h,cancelWork:v}=Ut(e,f=>{b||t(f)});u.current=()=>{v(),b=!0},h.then(f=>Xt(this,null,function*(){if(b)return;u.current=()=>{b=!0};const m=yield ae(f);b||i(m)}))}catch(h){console.error(h),i(new Error(String(h)))}return()=>u.current()},[e]);const{playAudioBuffer:E,isAudioBusy:g}=We();return c.a.createElement(c.a.Fragment,null,c.a.createElement(j.a,{type:"button",variant:"primary",onClick:b=>{if(!(l instanceof AudioBuffer)){if(!l){const h=b.currentTarget;r({fn:()=>h.click()})}return}try{o("transferring");const h=E(l,{onTimeUpdate:v=>t(v/l.duration),onEnded:()=>o("idle")});u.current=()=>{h(),o("idle")}}catch(h){console.error(h),o("error")}},disabled:g||l instanceof Error||n==="transferring"},"Transfer to volca sample"),c.a.createElement("br",null),l&&n==="idle"?null:n==="error"?"Error transferring":c.a.createElement(c.a.Fragment,null,c.a.createElement("p",null,l?l instanceof AudioBuffer?"Transferring to Volca Sample...":"Error preparing sample for transfer":"Preparing sample for transfer..."),c.a.createElement(Nt.a,{now:100*a}),c.a.createElement("br",null),c.a.createElement(j.a,{type:"button",variant:"light",onClick:()=>u.current()},"Cancel")),c.a.createElement("br",null))}var Gt=$t,_t=w(84),Kt=w(85),re=w(59),k=w(87),Qt=Object.defineProperty,Yt=Object.defineProperties,Jt=Object.getOwnPropertyDescriptors,Ke=Object.getOwnPropertySymbols,Zt=Object.prototype.hasOwnProperty,qt=Object.prototype.propertyIsEnumerable,Qe=(e,a,t)=>a in e?Qt(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,Ye=(e,a)=>{for(var t in a||(a={}))Zt.call(a,t)&&Qe(e,t,a[t]);if(Ke)for(var t of Ke(a))qt.call(a,t)&&Qe(e,t,a[t]);return e},Je=(e,a)=>Yt(e,Jt(a)),ea=(e,a,t)=>new Promise((n,o)=>{var l=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(l,i);s((t=t.apply(e,a)).next())});const ta=$.a.div({height:"200px",maxWidth:"400px"});function aa(e,a){const t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=a,n.style.display="none",document.body.appendChild(n),n.click(),n.remove(),URL.revokeObjectURL(t)}function na({sample:e,onSampleUpdate:a,onSampleDuplicate:t,onSampleDelete:n}){const o=e&&e.id,l=Object(d.useCallback)(m=>o&&a(o,{scaleCoefficient:m}),[o,a]),i=Object(d.useCallback)(m=>o&&a(o,p=>Je(Ye({},p),{trim:Je(Ye({},p.trim),{frames:m(p.trim.frames)})})),[o,a]),[s,r]=Object(d.useState)(null),[u,E]=Object(d.useState)(null),[g,b]=Object(d.useState)(null);Object(d.useEffect)(()=>{u instanceof AudioBuffer&&g&&(b(null),g.fn())},[u,g]),Object(d.useEffect)(()=>{if(r(null),b(null),e){let m=!1;Fe(e).then(({data:p})=>{m||r(p)})}},[e]),Object(d.useEffect)(()=>{if(E(null),s){let m=!1;ae(s).then(p=>{m||E(p)})}},[s]);const{playAudioBuffer:h,isAudioBusy:v}=We(),f=Object(d.useRef)(()=>{});return Object(d.useEffect)(()=>()=>f.current(),[e]),e?c.a.createElement(_t.a,{fluid:"sm"},c.a.createElement("h2",null,e.metadata.name,c.a.createElement(Kt.a,{style:{display:"inline-block",float:"right"},variant:"light",align:"end",title:"options"},c.a.createElement(re.a.Item,{onClick:()=>{const m=prompt(`Choose a new name for the sample "${e.metadata.name}":`,e.metadata.name),p=m&&m.trim();p&&a(e.id,{name:p})}},"Rename"),c.a.createElement(re.a.Item,{onClick:()=>t(e.id)},"Duplicate"),c.a.createElement(re.a.Divider,null),c.a.createElement(re.a.Item,{onClick:()=>{window.confirm(`Are you sure you want to delete ${e.metadata.name}?`)&&n(e.id)}},"Delete"))),c.a.createElement("p",null,c.a.createElement("strong",null,"Sampled:")," ",new Date(e.metadata.dateSampled).toLocaleString(),c.a.createElement("br",null),c.a.createElement("strong",null,"Updated:")," ",new Date(e.metadata.dateModified).toLocaleString()),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement(ta,null,c.a.createElement(Lt,{onSetTrimFrames:i,onSetScaleCoefficient:l,sample:e})),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement(j.a,{type:"button",variant:"secondary",size:"sm",onClick:m=>{if(u)f.current=h(u);else{const p=m.currentTarget;b({fn:()=>p.click()})}},disabled:v},"Play audio preview")," ",c.a.createElement(j.a,{type:"button",variant:"secondary",size:"sm",onClick:()=>ea(this,null,function*(){const{sourceFileId:m,userFileInfo:p}=e.metadata,O=yield I.getSourceFileData(m),P=new Blob([O],{type:p?p.type:"audio/x-wav"});aa(P,`${e.metadata.name}${p?p.ext:".wav"}`)})},"Download original file"),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement(k.a.Group,null,c.a.createElement(k.a.Label,null,"Quality bit depth (",e.metadata.qualityBitDepth,")"),c.a.createElement(k.a.Range,{value:e.metadata.qualityBitDepth,step:1,min:8,max:16,onChange:m=>{const p=Number(m.target.value);a(e.id,{qualityBitDepth:p})}})),c.a.createElement(k.a.Group,null,c.a.createElement(k.a.Label,null,"Slot number"),c.a.createElement(k.a.Control,{type:"number",value:e.metadata.slotNumber,step:1,min:0,max:99,onChange:m=>{const p=Number(m.target.value);a(e.id,{slotNumber:p})}})),c.a.createElement("br",null),c.a.createElement(Gt,{sample:e})):null}var ra=na,oa=w(60),_=(e,a,t)=>new Promise((n,o)=>{var l=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(l,i);s((t=t.apply(e,a)).next())});let Ze;function pe(){const e=ke();return Ze=Ze||new e(navigator.mediaDevices.getSupportedConstraints().sampleRate?{sampleRate:J}:{})}function la(){return _(this,null,function*(){{const n=yield navigator.mediaDevices.getUserMedia({audio:!0,video:!1});for(const o of n.getTracks())o.stop()}const a=(yield navigator.mediaDevices.enumerateDevices()).filter(n=>n.kind==="audioinput"),t=[];for(const n of a){const o=yield navigator.mediaDevices.getUserMedia({audio:{deviceId:n.deviceId,channelCount:2},video:!1}),l=(yield navigator.mediaDevices.enumerateDevices()).find(({deviceId:s})=>n.deviceId===s).label;let i=1;{const s=o.getAudioTracks()[0],r=s.getSettings().channelCount;r?i=r:s.getCapabilities&&(i=(s.getCapabilities().channelCount||{}).max||i)}for(const s of o.getTracks())s.stop();t.push({device:{deviceId:n.deviceId,label:l},channelsAvailable:i})}return t})}let he;function ca(e){return _(this,arguments,function*({onData:a,onFinish:t}){const n=pe();he=he||n.audioWorklet.addModule("recorderWorkletProcessor.js"),yield he;const o=new AudioWorkletNode(n,"recorder-worklet",{parameterData:{bufferSize:1024}});o.port.onmessage=i=>{if(i.data.eventType==="data"){const s=i.data.audioChannels;a(s)}i.data.eventType==="stop"&&t()};const l=o.parameters.get("isRecording");return l.setValueAtTime(1,n.currentTime),{recorderNode:o,stop(){l.setValueAtTime(0,n.currentTime)}}})}function ia({channelCount:e,onData:a,onFinish:t}){const o=pe().createScriptProcessor(1024,e,e);let l=!1;return o.onaudioprocess=i=>{const s=Array(e).fill().map((r,u)=>i.inputBuffer.getChannelData(u));a(s),l&&t()},{recorderNode:o,stop(){l=!0}}}function sa(e){return _(this,null,function*(){return typeof AudioWorkletNode=="undefined"?ia(e):yield ca(e)})}function ua(e){return _(this,arguments,function*({deviceId:a,channelCount:t,onStart:n,onUpdate:o}){const l=yield navigator.mediaDevices.getUserMedia({audio:{deviceId:a,channelCount:t,sampleRate:J,echoCancellation:!1,autoGainControl:!1,noiseSuppression:!1},video:!1}),i=pe(),s=i.createMediaStreamSource(l),{recorderNode:r,stop:u}=yield sa({channelCount:t,onData:v,onFinish:P});s.connect(r),r.connect(i.destination);const E=10;n(i.sampleRate,E);const g=E*i.sampleRate;let b=0;const h=Array(t).fill([]);function v(A){let S=0;const D=[];for(let R=0;R<t;R++){const y=A[R],B=y.length,F=y.slice(0,Math.min(B,g-b));Re(F),S||(S=F.length),D.push(F)}const C=yt(D),M=je(C,32);h.push(M),b+=S,b>=g&&u(),o(D)}let f,m;const p=new Promise((A,S)=>{f=A,m=S});let O=!1;function P(){return _(this,null,function*(){if(O)return;try{const D=yield new Blob(h).arrayBuffer(),C=we()({channels:t,sampleRate:i.sampleRate,bitDepth:32,dataLength:D.byteLength}),M=new Uint8Array(C.length+D.byteLength);M.set(C),M.set(new Uint8Array(D),C.length),f(M)}catch(S){m(S)}const A=l.getTracks();for(const S of A)S.stop();r.disconnect(i.destination),s.disconnect(r),O=!0})}return{stop:u,mediaRecording:p}})}var da=w(52),ve=w.n(da),oe=(e,a,t)=>new Promise((n,o)=>{var l=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(l,i);s((t=t.apply(e,a)).next())});const qe="capture_device_preference";let et=null;function fa(e,a){const t=Object(d.useRef)(JSON.parse(localStorage.getItem(qe)||"null")),[n,o]=Object(d.useState)(et),[l,i]=Object(d.useState)(n?"ok":"pending"),[s,r]=Object(d.useState)("");Object(d.useEffect)(()=>{et=n,i("ok")},[n]);const u=Object(d.useCallback)(()=>{let C=!1;return la().then(M=>{C||M.length&&(o(new Map(M.map(R=>[R.device.deviceId,R]))),r(R=>R?(t.current=null,R):t.current&&M.find(({device:y})=>t.current.deviceId===y.deviceId)?t.current.deviceId:(t.current=null,M[0].device.deviceId)))}).catch(M=>{if(!C){if(M instanceof DOMException){if(M.name==="NotAllowedError"){i("denied");return}if(M.name==="NotFoundError"){i("unavailable");return}}throw M}}),()=>{C=!0}},[]),[E,g]=Object(d.useState)(1);Object(d.useEffect)(()=>{const C=n&&n.get(s);C&&(t.current&&t.current.deviceId===C.device.deviceId&&t.current.channelCount<=C.channelsAvailable?g(t.current.channelCount):g(C.channelsAvailable),t.current=null)},[n,s]),Object(d.useEffect)(()=>{s&&localStorage.setItem(qe,JSON.stringify({deviceId:s,channelCount:E}))},[s,E]);const[b,h]=Object(d.useState)("ready"),[v,f]=Object(d.useState)(null),[m,p]=Object(d.useState)({fn(C){}}),[O,P]=Object(d.useState)(1/0),[A,S]=Object(d.useState)(0),D=Object(d.useCallback)(()=>oe(this,null,function*(){let C=!1;const{mediaRecording:M,stop:R}=yield ua({deviceId:s,channelCount:E,onStart:(B,F)=>{const W=F*B;P(B),S(W),h("capturing")},onUpdate:e});p({fn(B){R(),B&&(C=!0)}});let y;try{y=yield M}catch(B){f(B),h("error");return}C?h("ready"):(h("finalizing"),a(y))}),[s,E,e,a]);return{captureDevices:n,accessState:l,selectedCaptureDeviceId:s,selectedChannelCount:E,captureState:b,recordingError:v,sampleRate:O,maxSamples:A,refreshCaptureDevices:u,setSelectedCaptureDeviceId:r,setSelectedChannelCount:g,beginRecording:D,stopRecording:m.fn}}const ye=3;function ma({canvas:e,peaks:a,scaleCoefficient:t}){const n="#fff",o=e.getContext("2d");o.imageSmoothingEnabled=!1;const{width:l,height:i}=e;o.clearRect(0,0,l,i),o.fillStyle=n;for(let s=0;s<a.length;s++){const r=a[s];if(r===0)continue;const u=i*r,E=Math.max(Math.round(t*u),2);o.fillRect(s*ye,i-E,ye-1,E)}}function pa({onRecordFinish:e}){const a=Object(d.useRef)(null),t=Object(d.useRef)(0),n=Object(d.useRef)(new Float32Array),o=Object(d.useRef)(0),l=Object(d.useRef)([]),i=Object(d.useRef)(1/0),s=Object(d.useRef)(0),[r,u]=Object(d.useState)(0),E=Object(d.useCallback)(y=>oe(this,null,function*(){const B=t.current,F=n.current,W=l.current;if(W.push(y),s.current+=y[0].length,u(Math.floor(s.current/i.current)),W.reduce((K,[{length:be}])=>K+be,0)>=B){const K=yield Promise.all(y.map((U,Se)=>W.reduce((Ea,Ca)=>[...Ea,Ca[Se]],[])).map(U=>oe(this,null,function*(){const Se=yield new Blob(U).arrayBuffer();return new Float32Array(Se)}))),be=K.map(U=>Be(new Float32Array(U.buffer,0,B)));F[o.current]=Math.max(...be),ma({canvas:a.current,peaks:F,scaleCoefficient:.3}),o.current++,l.current=[K.map(U=>U.slice(B))]}}),[]),{captureDevices:g,accessState:b,selectedCaptureDeviceId:h,selectedChannelCount:v,captureState:f,recordingError:m,maxSamples:p,sampleRate:O,refreshCaptureDevices:P,setSelectedCaptureDeviceId:A,setSelectedChannelCount:S,beginRecording:D,stopRecording:C}=fa(E,e);i.current=O,Object(d.useEffect)(()=>{const y=a.current;y&&(y.width=y.offsetWidth,y.height=y.offsetHeight)},[b]),Object(d.useLayoutEffect)(()=>{const y=a.current;!y||(f!=="finalizing"&&y.getContext("2d").clearRect(0,0,y.width,y.height),f==="capturing"&&p&&(t.current=Math.floor(ye*p/a.current.width),n.current=new Float32Array(Math.floor(p/t.current)),o.current=0,l.current=[],i.current=1/0,s.current=0,u(0)))},[p,f]);const[M,R]=Object(d.useState)(!1);return Object(d.useEffect)(()=>{M&&P()},[M,P]),c.a.createElement("div",null,b==="denied"?c.a.createElement("p",null,"Looks like you didn't grant access to your audio input device. Please give Volca Sampler access, then"," ",c.a.createElement(j.a,{type:"button",variant:"secondary",onClick:P},"try again")):b==="unavailable"?c.a.createElement("p",null,"Volca Sampler couldn't find any audio input devices. Please connect one, then"," ",c.a.createElement(j.a,{type:"button",variant:"secondary",onClick:P},"try again")):c.a.createElement("div",null,c.a.createElement("h2",null,"Send a new sound to your Volca Sample!"),c.a.createElement(j.a,{className:ve.a.recordButton,type:"button",variant:f==="capturing"?"danger":"primary",size:"lg",style:{width:250},onClick:f==="capturing"?()=>C():D,disabled:f==="finalizing"},c.a.createElement("canvas",{ref:a}),c.a.createElement("span",{className:ve.a.mainText},["capturing","finalizing"].includes(f)?"Finished recording":"Start recording"),["capturing","finalizing"].includes(f)&&c.a.createElement("span",{className:ve.a.timeRecorded},"0:",String(r).padStart(2,"0"))),["capturing","finalizing"].includes(f)?c.a.createElement(c.a.Fragment,null,c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement(j.a,{style:{width:250},size:"sm",type:"button",variant:"secondary",onClick:()=>C(!0)},"Cancel")):c.a.createElement(c.a.Fragment,null,c.a.createElement("br",null),c.a.createElement(j.a,{style:{width:250},type:"button",variant:"light",size:"sm",onClick:()=>R(y=>!y)},"Audio input settings ",M?"\u25B2":"\u25BC"),c.a.createElement(oa.a,{in:M},c.a.createElement("div",null,c.a.createElement(k.a.Group,null,c.a.createElement(k.a.Label,null,"Capture Device"),c.a.createElement(k.a.Select,{style:{width:250},value:h,onChange:y=>A(y.target.value)},g&&b==="ok"?[...g].map(([y,{device:B}])=>c.a.createElement("option",{key:y,value:y},B.label||y)):c.a.createElement("option",{value:"",disabled:!0},"Loading devices..."))),c.a.createElement(k.a.Group,null,c.a.createElement(k.a.Label,null,"Input channels"),c.a.createElement(k.a.Select,{style:{width:250},value:v,onChange:y=>S(Number(y.target.value))},[1,2].map(y=>c.a.createElement("option",{key:y,value:y,disabled:!g||!g.has(h)||g.get(h).channelsAvailable<y},y===1?"Mono":"Stereo (summed to mono)")))),c.a.createElement("br",null))))),f==="error"&&m||null,c.a.createElement("br",null),c.a.createElement(j.a,{style:{width:250},type:"button",variant:"secondary",onClick:y=>{const B=y.currentTarget.querySelector("input");B&&y.target!==B&&B.click()}},"Or import an audio file",c.a.createElement("input",{hidden:!0,type:"file",accept:"audio/*,.wav,.mp3,.ogg",onChange:y=>{if(y.target.files&&y.target.files.length){const B=y.target.files[0];B.arrayBuffer().then(F=>oe(this,null,function*(){const W=new Uint8Array(F);let le;try{le=yield ae(W)}catch(K){alert("Unsupported audio format detected");return}if(le.length>10*le.sampleRate){alert("Please select an audio file no more than 10 seconds long");return}e(W,B)}))}}})))}var ha=pa,ge=w(86),L=w(88),va=(e,a,t)=>new Promise((n,o)=>{var l=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(l,i);s((t=t.apply(e,a)).next())});const ya=$.a.div({padding:"2rem",display:"flex",height:"100%"}),ga=$.a.div({flexGrow:1});function ba(){const[e,a]=Object(d.useState)(new Map),[t,n]=Object(d.useState)(new Map),o=Object(d.useMemo)(()=>new Map([...e,...t]),[e,t]);Object(d.useEffect)(()=>{pt().then(n).catch(console.error)},[]);const[l,i]=Object(d.useState)(null),[s,r]=Object(d.useState)(!0);Object(d.useEffect)(()=>{I.getAllFromStorage().then(v=>{a(f=>new Map([...f,...v.map(m=>[m.id,m])]))}).finally(()=>{r(!1)})},[]);const u=Object(d.useCallback)((v,f)=>va(this,null,function*(){const m=yield dt(v);let p="",O="";if(f){const D=f.name.lastIndexOf(".");D>0?(p=f.name.slice(0,D),O=f.name.slice(D)):p=f.name}else p="New sample";const P=[0,0],A=yield He(m,P),S=new I.Mutable({name:p,sourceFileId:m,trim:{frames:P,waveformPeaks:A},userFileInfo:f&&{type:f.type,ext:O}});yield S.persist(),a(D=>new Map([[S.id,S],...D])),i(S.id)}),[]),E=Object(d.useCallback)((v,f)=>{a(m=>{const p=m.get(v);if(p&&p instanceof I.Mutable){const O=p.update(f);if(O!==p)return new Map(m).set(p.id,O)}return m})},[]),[g,b]=Object(d.useState)(!1),h=Object(d.useCallback)(v=>{i(v),b(!1)},[]);return c.a.createElement("div",null,c.a.createElement(ot,{onMenuOpen:()=>b(!0),onHeaderClick:()=>i(null)}),c.a.createElement(ge.a,{show:g,onHide:()=>b(!1)},c.a.createElement(ge.a.Header,{closeButton:!0}),c.a.createElement(ge.a.Body,null,c.a.createElement(Q.a,null,c.a.createElement(Q.a.Item,{as:"button",onClick:()=>h(null)},"New Sample"),s?"Loading...":null,!s&&c.a.createElement(L.a,{defaultActiveKey:e.size?"user":"factory"},c.a.createElement(L.a.Item,{eventKey:"user"},c.a.createElement(L.a.Header,null,"Your Samples"),c.a.createElement(L.a.Body,{style:{padding:0}},c.a.createElement(Ue,{samples:e,selectedSampleId:l,onSampleSelect:h}))),c.a.createElement(L.a.Item,{eventKey:"factory"},c.a.createElement(L.a.Header,null,"Factory Samples"),c.a.createElement(L.a.Body,{style:{padding:0}},c.a.createElement(Ue,{samples:t,selectedSampleId:l,onSampleSelect:h}))))))),c.a.createElement(ya,null,c.a.createElement(ga,null,l&&c.a.createElement(ra,{sample:o.get(l)||null,onSampleUpdate:E,onSampleDuplicate:v=>{const f=o.get(v);if(f){const m=f.duplicate();a(p=>new Map([[m.id,m],...p])),i(m.id)}},onSampleDelete:v=>{const f=o.get(v);f&&f instanceof I.Mutable&&(f.remove(),a(m=>{const p=new Map(m);return p.delete(f.id),p}))}}),!l&&c.a.createElement(ha,{onRecordFinish:u}))))}var Sa=ba,wa=e=>{e&&e instanceof Function&&w.e(3).then(w.bind(null,92)).then(({getCLS:a,getFID:t,getFCP:n,getLCP:o,getTTFB:l})=>{a(e),t(e),n(e),o(e),l(e)})};Blob.prototype.arrayBuffer||(Blob.prototype.arrayBuffer=function(){return new Response(this).arrayBuffer()}),at.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(bt,null,c.a.createElement(Sa,null))),document.getElementById("root")),wa()}},[[77,1,2]]]);

//# sourceMappingURL=main.6de86ffd.chunk.js.map