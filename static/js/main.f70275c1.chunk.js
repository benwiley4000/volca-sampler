(this["webpackJsonpvolca-sampler"]=this["webpackJsonpvolca-sampler"]||[]).push([[0],{115:function(N,V,E){"use strict";E.r(V);var d=E(0),l=E.n(d),Oe=E(9),ut=E.n(Oe),Ln=E(83),Tn=E(84),Z=E(23),dt=E(24),_=E.n(dt);function ft({onMenuOpen:e,onHeaderClick:t}){return l.a.createElement("h1",{className:_.a.title,onClick:t},l.a.createElement("span",{className:_.a.menuIcon,onClick:n=>{n.stopPropagation(),e()}},"\u2630"),l.a.createElement("span",{className:_.a.titleText,"data-text":"Volca Sample"},"Volca Sample",l.a.createElement("span",{className:_.a.titleR},"r"),l.a.createElement("div",{className:_.a.titleStarburst},Array(24).fill().map((n,a,{length:o})=>l.a.createElement("span",{key:a,style:{"--rotation":`${a*360/o}deg`}})))),l.a.createElement("img",{className:_.a.titleGraphic,src:"volca_sample.png",alt:""}),l.a.createElement("svg",{width:0,height:0},l.a.createElement("filter",{id:"outline"},l.a.createElement("feMorphology",{in:"SourceAlpha",result:"DILATED",operator:"dilate",radius:"1"}),l.a.createElement("feFlood",{floodColor:"var(--stroke-color)",floodOpacity:"1",result:"PINK"}),l.a.createElement("feComposite",{in:"PINK",in2:"DILATED",operator:"in",result:"OUTLINE"}),l.a.createElement("feMerge",null,l.a.createElement("feMergeNode",{in:"OUTLINE"}),l.a.createElement("feMergeNode",{in:"SourceGraphic"})))))}var mt=ft,q=E(127),pt=E(46),De=E.n(pt),ht=E(40),ee=E.n(ht),Pe=E(128),ke=E(63);const te=31250;var vt=Object.defineProperty,yt=Object.defineProperties,gt=Object.getOwnPropertyDescriptors,ne=Object.getOwnPropertySymbols,Ae=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable,se=(e,t,n)=>t in e?vt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,T=(e,t)=>{for(var n in t||(t={}))Ae.call(t,n)&&se(e,n,t[n]);if(ne)for(var n of ne(t))je.call(t,n)&&se(e,n,t[n]);return e},K=(e,t)=>yt(e,gt(t)),Re=(e,t)=>{var n={};for(var a in e)Ae.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&ne)for(var a of ne(e))t.indexOf(a)<0&&je.call(e,a)&&(n[a]=e[a]);return n},ae=(e,t,n)=>(se(e,typeof t!="symbol"?t+"":t,n),n),F=(e,t,n)=>new Promise((a,o)=>{var c=r=>{try{s(n.next(r))}catch(u){o(u)}},i=r=>{try{s(n.throw(r))}catch(u){o(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});const re=ee.a.createInstance({name:"audio_file_data",driver:ee.a.INDEXEDDB}),oe=ee.a.createInstance({name:"sample_metadata",driver:ee.a.INDEXEDDB});function bt(e){return F(this,null,function*(){const t=Object(Pe.a)();return yield re.setItem(t,e),t})}const ue="0.3.0",Et={"0.1.0":e=>{const t=e,{clip:n}=t,a=Re(t,["clip"]);return K(T({},a),{trimFrames:n.map(c=>Math.round(c*te)),metadataVersion:"0.2.0"})},"0.2.0":e=>F(void 0,null,function*(){const t=e,{trimFrames:n}=t,a=Re(t,["trimFrames"]),o=yield _e(a.sourceFileId,n),c={frames:n,waveformPeaks:o};return K(T({},a),{trim:c,metadataVersion:"0.3.0"})})};function St(e){return F(this,null,function*(){let t=e;for(;t.metadataVersion!==ue;){const n=Et[e.metadataVersion];if(!n){console.warn(`Failed to properly upgrade metadata for sample "${t.name}"`),t={name:t.name,sourceFileId:t.sourceFileId,id:t.id,metadataVersion:ue};break}t=yield n(t)}return t})}const X=class{constructor({name:e,sourceFileId:t,trim:n,id:a=Object(Pe.a)(),userFileInfo:o=null,slotNumber:c=0,dateSampled:i=Date.now(),dateModified:s=i,useCompression:r=!0,qualityBitDepth:u=16,scaleCoefficient:g=1}){this.id=a,this.metadata={name:e,sourceFileId:t,trim:n,userFileInfo:o,slotNumber:c,dateSampled:i,dateModified:s,useCompression:r,qualityBitDepth:u,scaleCoefficient:g,metadataVersion:ue}}duplicate(){const e=new X.Mutable(K(T({},this.metadata),{name:`${this.metadata.name} (copy)`,dateModified:Date.now()}));return e.persist(),e}static cacheSourceFileData(e,t){this.sourceFileData.set(e,t),this.recentlyCachedSourceFileIds=[e,...this.recentlyCachedSourceFileIds.filter(a=>a!==e)];const n=this.recentlyCachedSourceFileIds.slice(this.MAX_CACHED);for(const a of n)this.sourceFileData.delete(a);this.recentlyCachedSourceFileIds=this.recentlyCachedSourceFileIds.slice(0,this.MAX_CACHED)}static getSourceFileData(e){return F(this,null,function*(){{const n=this.sourceFileData.get(e);if(n)return n}if(e.includes(".")){const n=yield fetch(e);if(n.status>=400)return Promise.reject(new Error(`Failed to fetch source file "${e}"`));const a=yield n.arrayBuffer(),o=new Uint8Array(a);return this.cacheSourceFileData(e,o),o}const t=yield re.getItem(e);return t?t instanceof Uint8Array?(this.cacheSourceFileData(e,t),t):Promise.reject("Source data is of unexpected type"):Promise.reject("Missing source data")})}static getAllMetadataFromStore(){return F(this,null,function*(){const e=new Map,t=[];return yield oe.iterate((n,a)=>{n&&t.push(St(n).then(o=>{e.set(a,o)}).catch(o=>{console.error(o),console.warn(`Failed to upgrade metadata "${a}" (${n.name}); ignoring.`)}))}),yield Promise.all(t),e})}static getAllFromStorage(){return F(this,null,function*(){const e=yield this.getAllMetadataFromStore(),t=yield Me(),n=(yield re.keys()).concat(t.map(({sourceFileId:o})=>o));return[...e].map(([o,c])=>{const{sourceFileId:i}=c;return n.includes(i)?new X.Mutable(T({id:o},c)):(console.warn(`Found metadata "${c.name||o}" with missing data "${i}; ignoring.`),null)}).filter(Boolean).sort((o,c)=>c.metadata.dateModified-o.metadata.dateModified)})}};let B=X;ae(B,"Mutable",class extends X{constructor(e){super(e);setTimeout(()=>F(this,null,function*(){(yield oe.keys()).includes(this.id)||console.warn(`Expected sample metadata container ${this.id} to be persisted`)}))}persist(){return F(this,null,function*(){yield oe.setItem(this.id,this.metadata)})}update(e){const{id:t,metadata:n}=this,a=typeof e=="function"?e(n):e;if(Object.keys(a).every(i=>a[i]===n[i]))return this;const o=K(T(T({},n),a),{dateModified:Date.now()}),c=new X.Mutable(T({id:t},o));return c.persist(),c}remove(){return F(this,null,function*(){if(yield oe.removeItem(this.id),this.metadata.sourceFileId.includes("."))return;const e=yield X.getAllMetadataFromStore();for(const[,{sourceFileId:t}]of e)if(t===this.metadata.sourceFileId)return;yield re.removeItem(this.metadata.sourceFileId)})}}),ae(B,"sourceFileData",new Map),ae(B,"recentlyCachedSourceFileIds",[]),ae(B,"MAX_CACHED",10);let de;function Me(){return de||(de=fetch("factory-samples.json").then(e=>e.json())),de}function wt(){return F(this,null,function*(){const e=yield Me();return new Map(e.map(t=>[t.id,new B(K(T({},t),{trim:{frames:[t.trim.frames[0],t.trim.frames[1]],waveformPeaks:{positive:new Float32Array(Object(ke.a)(t.trim.waveformPeaks.positive)),negative:new Float32Array(Object(ke.a)(t.trim.waveformPeaks.negative))}}}))]))})}var Ie=Math.pow,fe=(e,t,n)=>new Promise((a,o)=>{var c=r=>{try{s(n.next(r))}catch(u){o(u)}},i=r=>{try{s(n.throw(r))}catch(u){o(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});function me(e,t){const n=4,a=t[0]*n,o=e.length-t[0]-t[1];return new Float32Array(e.buffer,a,o)}function pe(e,t){const n=e.length-t[0]-t[1],a=new Float32Array(n),o=Array(e.numberOfChannels).fill().map((c,i)=>me(e.getChannelData(i),t));for(let c=0;c<n;c++){let i=0;for(let s=0;s<o.length;s++)i+=o[s][c];i/=o.length,a[c]=i}return a}function Be(e){let t=0;for(const n of e){const a=Math.abs(n);a>t&&(t=a)}return t}function Ct(e,t){if(t!==1)for(let n=0;n<e.length;n++)e[n]*=t}function Ot(e,t){const n=Ie(2,t-1);for(let a=0;a<e.length;a++)e[a]=Math.round(e[a]*n)/n}function xe(e){for(let t=0;t<e.length;t++)e[t]>1?e[t]=1:e[t]<-1&&(e[t]=-1)}function Dt(e){const t=e.length,n=e[0].length,a=new Float32Array(t*n);for(let o=0;o<a.length;o++){const c=t*o;for(let i=0;i<t;i++)a[c+i]=e[i][o]}return a}function Ne(e){const t=new Int16Array(e.length),n=Ie(2,15);for(let a=0;a<e.length;a++)t[a]=e[a]===1?n-1:n*e[a];return t}function Fe(){return window.AudioContext||window.webkitAudioContext}let Le;function Te(){const e=Fe();return Le=Le||new e({sampleRate:te})}function le(e){return fe(this,null,function*(){const t=new Uint8Array(e);return yield new Promise((a,o)=>{Te().decodeAudioData(t.buffer,a,o)})})}function he(e,t){return fe(this,null,function*(){const n=yield B.getSourceFileData(e),a=yield le(n);if(t)for(let o=0;o<a.numberOfChannels;o++)xe(a.getChannelData(o));return a})}function We(e){return fe(this,null,function*(){const{qualityBitDepth:t,sourceFileId:n,userFileInfo:a,scaleCoefficient:o,trim:{frames:c}}=e.metadata;if(t<8||t>16||!Number.isInteger(t))throw new Error(`Expected bit depth between 8 and 16. Received: ${t}`);const i=yield he(n,Boolean(a)),s=i.numberOfChannels===1?me(i.getChannelData(0),c):pe(i,c);o!==1&&Ct(s,o),t<16&&Ot(s,t);const r=Ne(s),u=r.length*2,g=De()({channels:1,sampleRate:i.sampleRate,bitDepth:16,dataLength:u}),h=new Uint8Array(g.length+u);return h.set(g),h.set(new Uint8Array(r.buffer),g.length),{data:h,sampleRate:16}})}const Pt={playAudioBuffer(e,t){throw new Error("Must render AudioPlaybackContextProvider")},isAudioBusy:!1},He=Object(d.createContext)(Pt);function kt({children:e}){const[t,n]=Object(d.useState)(!1),a=Object(d.useCallback)((c,{onTimeUpdate:i=()=>null,onEnded:s=()=>null}={})=>{if(t)throw new Error("Wait until audio playback has finished to start new playback");n(!0);let r,u;try{r=Te(),u=r.createBufferSource(),u.buffer=c,u.connect(r.destination),u.start()}catch(y){throw n(!1),y}const g=r.currentTime;i(0);let h=requestAnimationFrame(S);function S(){i(r.currentTime-g),h=requestAnimationFrame(S)}let v=!1;return u.addEventListener("ended",()=>{v||(i(c.duration),s()),n(!1),cancelAnimationFrame(h)}),function(){u.stop(),v=!0}},[t]),o=Object(d.useMemo)(()=>({playAudioBuffer:a,isAudioBusy:t}),[a,t]);return Object(d.createElement)(He.Provider,{value:o},e)}function Ve(){return Object(d.useContext)(He)}var At=(e,t,n)=>new Promise((a,o)=>{var c=r=>{try{s(n.next(r))}catch(u){o(u)}},i=r=>{try{s(n.throw(r))}catch(u){o(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});const $=6,ze=$*44;function Ue(e,t){const n=Math.floor($*e.length/t),a=new Float32Array(Math.floor(e.length/n)),o=new Float32Array(Math.floor(e.length/n));for(let c=0;c<a.length;c++){const i=new Float32Array(e.buffer,c*n*4,n);let s=0,r=0;for(const u of i)u>s&&(s=u),u<r&&(r=u);a[c]=Math.min(1,s),o[c]=Math.max(-1,r)}return{positive:a,negative:o}}function _e(e,t){return At(this,null,function*(){const n=yield he(e,!1),a=pe(n,t);return Ue(a,ze)})}var jt=E(72);const Rt=Z.a.canvas({width:"100%",height:"100%",display:"block",imageRendering:"pixelated"});function Mt(e,t){function n(o,c){e.width=o,e.height=c}n(e.offsetWidth,e.offsetHeight),t({width:e.offsetWidth,height:e.offsetHeight});const a=new jt.a(([o])=>{const{width:c,height:i}=o.contentRect;n(c,i),t({width:c,height:i})});return a.observe(e),()=>a.disconnect()}function It(e,t,n){const a=getComputedStyle(document.documentElement),o=a.getPropertyValue("--bs-primary"),c=a.getPropertyValue("--bs-primary-darkened"),i=e.getContext("2d");i.imageSmoothingEnabled=!1;const{width:s,height:r}=e;i.clearRect(0,0,s,r);const u=Math.floor(r*(2/3))+1;i.fillStyle=o,t.positive.forEach((h,S)=>{const v=u*h,y=Math.max(Math.round(n*v),1);i.fillRect(S*$,u-y,$-1,y)});const g=r-u;i.fillStyle=c,t.negative.forEach((h,S)=>{const v=g*h*-1,y=Math.round(n*v);i.fillRect(S*$,u,$-1,y)})}function Bt({peaks:e,scaleCoefficient:t,waveformRef:n}){const a=Object(d.useRef)(null);Object(d.useImperativeHandle)(n,()=>a.current);const[o,c]=Object(d.useState)(Symbol()),i=Object(d.useRef)({width:0,height:0});return Object(d.useLayoutEffect)(()=>{if(!a.current)throw new Error("Canvas should be defined");return i.current.width=a.current.offsetWidth,i.current.height=a.current.offsetHeight,Mt(a.current,({width:s,height:r})=>{(s!==i.current.width||r!==i.current.height)&&(c(Symbol()),i.current.width=s,i.current.height=r)})},[]),Object(d.useLayoutEffect)(()=>{const s=a.current;if(!s)throw new Error("Canvas should be defined");let r=requestAnimationFrame(()=>{r=requestAnimationFrame(()=>{It(s,e,t)})});return()=>cancelAnimationFrame(r)},[e,t,o]),l.a.createElement(Rt,{ref:a})}var Xe=Bt;const xt=Z.a.div({width:`${ze}px`,height:"40px"}),$e=typeof IntersectionObserver!="undefined",Nt=l.a.memo(({sample:e,selected:t,onSampleSelect:n})=>{const a=Object(d.useRef)(null),[o,c]=Object(d.useState)(!$e);return Object(d.useLayoutEffect)(()=>{if(!$e)return;const i=a.current;if(!i)throw new Error("Waveform container should be defined");const s=i.getBoundingClientRect();if(s.top+s.height>=0&&s.bottom-s.height<=window.innerHeight){c(!0);return}const r=new IntersectionObserver(([u])=>{u.isIntersecting&&(c(!0),r.unobserve(i))});return r.observe(i),()=>r.disconnect()},[]),l.a.createElement(q.a.Item,{active:t,onClick:()=>n(e.id)},l.a.createElement("div",null,e.metadata.name),l.a.createElement(xt,{ref:a},o&&l.a.createElement(Xe,{peaks:e.metadata.trim.waveformPeaks,scaleCoefficient:e.metadata.scaleCoefficient})))});function Ft({samples:e,selectedSampleId:t,onSampleSelect:n}){return l.a.createElement(q.a,{variant:"flush"},[...e].map(([a,o])=>l.a.createElement(Nt,{key:a,sample:o,selected:a===t,onSampleSelect:n})))}var Ge=Ft,Lt=E(122),Tt=E(123),ce=E(77),I=E(73),L=E(125),Wt=Object.defineProperty,Ht=Object.defineProperties,Vt=Object.getOwnPropertyDescriptors,ie=Object.getOwnPropertySymbols,Ke=Object.prototype.hasOwnProperty,Qe=Object.prototype.propertyIsEnumerable,Je=(e,t,n)=>t in e?Wt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,zt=(e,t)=>{for(var n in t||(t={}))Ke.call(t,n)&&Je(e,n,t[n]);if(ie)for(var n of ie(t))Qe.call(t,n)&&Je(e,n,t[n]);return e},Ut=(e,t)=>Ht(e,Vt(t)),_t=(e,t)=>{var n={};for(var a in e)Ke.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&ie)for(var a of ie(e))t.indexOf(a)<0&&Qe.call(e,a)&&(n[a]=e[a]);return n},Xt=(e,t,n)=>new Promise((a,o)=>{var c=r=>{try{s(n.next(r))}catch(u){o(u)}},i=r=>{try{s(n.throw(r))}catch(u){o(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});function $t({sourceAudioBuffer:e,sample:{metadata:{trim:{frames:t},scaleCoefficient:n}},onSetTrimFrames:a,onSetScaleCoefficient:o}){const c=Object(d.useMemo)(()=>e?pe(e,[0,0]):new Float32Array,[e]),[i,s]=Object(d.useState)(null),r=Object(d.useMemo)(()=>i&&i.offsetWidth,[i]),u=Object(d.useMemo)(()=>!r||!c.length?{positive:new Float32Array,negative:new Float32Array}:Ue(c,r),[r,c]),g=Object(d.useMemo)(()=>{if(!e)return 0;const f=me(c,t);return Be(f)},[e,c,t]),h=1/g;Object(d.useLayoutEffect)(()=>{n>h&&o(h)},[n,h,o]);const S=Object(d.useMemo)(()=>{if(!c.length||!r)return[0,0];const f=r/c.length;return t.map(m=>m*f)},[r,c.length,t]),v=Object(d.useRef)(null),y=Object(d.useRef)(null);return Object(d.useEffect)(()=>{function f(p){if(v.current===null||!r||!c.length)return;const{pageX:b}=p,D=b-v.current;if(D){const P=D/r,C=Math.round(c.length*P);a(k=>{let O=k[0]+C;return O=Math.min(O,c.length-k[1]-2e3),O=Math.max(O,0),[O,k[1]]}),v.current=b}}function m(){v.current=null,document.body.style.userSelect="unset"}return window.addEventListener("mousemove",f),window.addEventListener("mouseup",m),()=>{window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",m)}},[r,c.length,a]),Object(d.useEffect)(()=>{function f(p){if(y.current===null||!r||!c.length)return;const{pageX:b}=p,D=y.current-b;if(D){const P=D/r,C=Math.round(c.length*P);a(k=>{let O=k[1]+C;return O=Math.min(O,c.length-k[0]-2e3),O=Math.max(O,0),[k[0],O]}),y.current=b}}function m(){y.current=null,document.body.style.userSelect="unset"}return window.addEventListener("mousemove",f),window.addEventListener("mouseup",m),()=>{window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",m)}},[r,c.length,a]),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{style:{position:"relative"}},l.a.createElement("div",{style:{position:"absolute",right:0,bottom:4}},l.a.createElement(I.a,{type:"button",variant:"light",disabled:n===h,onClick:()=>o(h)},"Normalize")," ",l.a.createElement(I.a,{type:"button",variant:"light",disabled:n===1,onClick:()=>o(1)},"Original level"))),l.a.createElement("div",{style:{position:"relative",backgroundColor:"#f3f3f3"}},l.a.createElement(Xe,{waveformRef:s,peaks:u,scaleCoefficient:n}),l.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,left:0,right:`calc(100% - ${S[0]}px)`,background:"#f3f3f3"}},l.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,right:0,width:2,background:"var(--bs-dark)"}}),l.a.createElement("div",{style:{position:"absolute",top:"100%",right:0,width:20,height:20,background:"var(--bs-dark)",borderRadius:10,transform:"translateX(50%)"},onTouchStart:f=>{f.preventDefault(),document.body.style.userSelect="none",v.current=f.touches[0].pageX},onMouseDown:f=>{document.body.style.userSelect="none",v.current=f.pageX},onTouchMove:f=>{if(f.preventDefault(),v.current===null||!r||!c.length)return;const{pageX:m}=f.touches[0],p=m-v.current;if(p){const b=p/r,D=Math.round(c.length*b);a(P=>{let C=P[0]+D;return C=Math.min(C,c.length-P[1]-2e3),C=Math.max(C,0),[C,P[1]]}),v.current=m}},onTouchEnd:()=>{v.current=null},onTouchCancel:()=>{v.current=null}})),l.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,right:0,left:`calc(100% - ${S[1]}px)`,background:"#f3f3f3"}},l.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,left:0,width:2,background:"var(--bs-dark)"}}),l.a.createElement("div",{style:{position:"absolute",top:"100%",left:0,width:20,height:20,background:"var(--bs-dark)",borderRadius:10,transform:"translateX(-50%)"},onTouchStart:f=>{f.preventDefault(),document.body.style.userSelect="none",y.current=f.touches[0].pageX},onMouseDown:f=>{document.body.style.userSelect="none",y.current=f.pageX},onTouchMove:f=>{if(f.preventDefault(),y.current===null||!r||!c.length)return;const{pageX:m}=f.touches[0],p=y.current-m;if(p){const b=p/r,D=Math.round(c.length*b);a(P=>{let C=P[1]+D;return C=Math.min(C,c.length-P[0]-2e3),C=Math.max(C,0),[P[0],C]}),y.current=m}},onTouchEnd:()=>{y.current=null},onTouchCancel:()=>{y.current=null}}))))}function Gt(e){var t=e,{sample:n}=t,a=_t(t,["sample"]);const[o,c]=Object(d.useState)(null);Object(d.useEffect)(()=>{let s=!1;return(()=>Xt(this,null,function*(){if(s)return;const r=yield he(n.metadata.sourceFileId,Boolean(n.metadata.userFileInfo));s||c([n.metadata.sourceFileId,r])}))(),()=>{s=!0}},[n.metadata.sourceFileId,n.metadata.userFileInfo]);const i=Object(d.useRef)(n);return o&&n.metadata.sourceFileId===o[0]&&(i.current=n),l.a.createElement($t,Ut(zt({},a),{sample:i.current,sourceAudioBuffer:o&&o[1]}))}var Kt=Gt,Qt=E(129),Jt=(e,t,n)=>new Promise((a,o)=>{var c=r=>{try{s(n.next(r))}catch(u){o(u)}},i=r=>{try{s(n.throw(r))}catch(u){o(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});let Ye;function Yt(){return Jt(this,null,function*(){if(typeof window.CREATE_SYRO_BINDINGS!="function")return Promise.reject("Expected CREATE_SYRO_BINDINGS global function to exist");const e=yield window.CREATE_SYRO_BINDINGS();return Ye=Ye||new Promise((t,n)=>{let a;try{a={prepareSampleBufferFromWavData:e.cwrap("prepareSampleBufferFromWavData","number",["array","number","number","number","number"]),prepareSampleBufferFrom16BitPcmData(){throw new Error("This function does not work. Use prepareSampleBufferFromWavData.")},getSampleBufferChunkPointer:e.cwrap("getSampleBufferChunkPointer","number",["number"]),getSampleBufferChunkSize:e.cwrap("getSampleBufferChunkSize","number",["number"]),getSampleBufferProgress:e.cwrap("getSampleBufferProgress","number",["number"]),getSampleBufferTotalSize:e.cwrap("getSampleBufferTotalSize","number",["number"]),cancelSampleBufferWork:e.cwrap("cancelSampleBufferWork",null,["number"]),registerUpdateCallback(o){return e.addFunction(o,"vi")},unregisterUpdateCallback(o){e.removeFunction(o)},heap8Buffer(){return e.HEAP8.buffer}}}catch(o){n(o);return}t(a)})})}var Zt=(e,t,n)=>new Promise((a,o)=>{var c=r=>{try{s(n.next(r))}catch(u){o(u)}},i=r=>{try{s(n.throw(r))}catch(u){o(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});function qt(e,t){let n=!1,a=()=>{};return{cancelWork(){n=!0,a()},sampleBufferPromise:(()=>Zt(this,null,function*(){const{prepareSampleBufferFromWavData:o,getSampleBufferChunkPointer:c,getSampleBufferChunkSize:i,getSampleBufferProgress:s,getSampleBufferTotalSize:r,cancelSampleBufferWork:u,registerUpdateCallback:g,unregisterUpdateCallback:h,heap8Buffer:S}=yield Yt();if(n)return new Uint8Array;const{data:v}=yield We(e);if(n)return new Uint8Array;let y,f=0;const m=g(b=>{if(n)return;const D=r(b);y||(y=new Uint8Array(D));const P=c(b),C=i(b),k=s(b);y.set(new Uint8Array(S(),P,C),k-C),f=k/D}),p=o(v,v.length,e.metadata.slotNumber,e.metadata.qualityBitDepth,e.metadata.useCompression?1:0,m);t(f);try{yield new Promise(b=>{let D;a=()=>{cancelAnimationFrame(D),u(p),b()},P();function P(){if(f&&(t(f),f>=1)){b();return}D=requestAnimationFrame(P)}})}finally{a=()=>{},h(m)}if(n)return new Uint8Array;if(!y)throw new Error("Unexpected condition: sampleBuffer should be defined");return y}))()}}var en=(e,t,n)=>new Promise((a,o)=>{var c=r=>{try{s(n.next(r))}catch(u){o(u)}},i=r=>{try{s(n.throw(r))}catch(u){o(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});function tn({sample:e}){const[t,n]=Object(d.useState)(0),[a,o]=Object(d.useState)("idle"),[c,i]=Object(d.useState)(null),[s,r]=Object(d.useState)(null);Object(d.useEffect)(()=>{c instanceof AudioBuffer&&s&&(r(null),s.fn())},[c,s]);const u=Object(d.useRef)(()=>{});Object(d.useEffect)(()=>{let S=!1;n(0),o("idle"),i(null),r(null),u.current=()=>{S=!0};try{const{sampleBufferPromise:v,cancelWork:y}=qt(e,f=>{S||n(f)});u.current=()=>{y(),S=!0},v.then(f=>en(this,null,function*(){if(S)return;u.current=()=>{S=!0};const m=yield le(f);S||i(m)}))}catch(v){console.error(v),i(new Error(String(v)))}return()=>u.current()},[e]);const{playAudioBuffer:g,isAudioBusy:h}=Ve();return l.a.createElement(l.a.Fragment,null,l.a.createElement(I.a,{type:"button",variant:"primary",onClick:S=>{if(!(c instanceof AudioBuffer)){if(!c){const v=S.currentTarget;r({fn:()=>v.click()})}return}try{o("transferring");const v=g(c,{onTimeUpdate:y=>n(y/c.duration),onEnded:()=>o("idle")});u.current=()=>{v(),o("idle")}}catch(v){console.error(v),o("error")}},disabled:h||c instanceof Error||a==="transferring"},"Transfer to volca sample"),l.a.createElement("br",null),c&&a==="idle"?null:a==="error"?"Error transferring":l.a.createElement(l.a.Fragment,null,l.a.createElement("p",null,c?c instanceof AudioBuffer?"Transferring to Volca Sample...":"Error preparing sample for transfer":"Preparing sample for transfer..."),l.a.createElement(Qt.a,{now:100*t}),l.a.createElement("br",null),l.a.createElement(I.a,{type:"button",variant:"light",onClick:()=>u.current()},"Cancel")),l.a.createElement("br",null))}var nn=tn,Ze=E(57),qe=E.n(Ze),ve=E(58),ye=E(59),an=E(22),z=E.n(an),et=Math.pow;Ze.Digit.defaultProps.offOpacity=0;const tt=(e,t)=>Math.min(199,t+et(10,e)),nt=(e,t)=>Math.max(0,t-et(10,e));function rn({sample:e,onSampleUpdate:t}){const[n,a]=Object(d.useState)(e.metadata.slotNumber);Object(d.useEffect)(()=>{a(e.metadata.slotNumber)},[e.metadata.slotNumber]);const[o,c]=Object(d.useState)(null),i=Object(d.useCallback)(g=>{t(e.id,({slotNumber:h})=>({slotNumber:tt(g,h)}))},[e.id,t]),s=Object(d.useCallback)(g=>{t(e.id,({slotNumber:h})=>({slotNumber:nt(g,h)}))},[e.id,t]),r=Object(d.useRef)(null),u=Object(d.useRef)(null);{const g=Object(d.useRef)(o);g.current=o;const h=Object(d.useRef)(e.id);h.current=e.id;const S=Object(d.useRef)(n);S.current=n,Object(d.useEffect)(()=>{if(!u.current)throw new Error("Expected elements to exist");u.current.forEach((m,p)=>{const b=p;m.addEventListener("click",()=>{c(b)})});function v(m){const p=g.current;if(p!==null)switch(m.stopPropagation(),m.preventDefault(),m.key){case"ArrowDown":a(b=>nt(p,b));break;case"ArrowUp":a(b=>tt(p,b));break;case"ArrowLeft":c(b=>b!==null&&b<2?b+1:b);break;case"ArrowRight":c(b=>b&&b-1);break;case"Enter":case"Escape":c(null);break;default:break}}function y(m){const p=g.current;if(p===null)return;m.stopPropagation(),m.preventDefault();const b=S.current;if(isNaN(Number(m.key)))t(h.current,{slotNumber:b});else{const D=String(b).padStart(3,"0").split("");D[2-p]=m.key;const P=Math.min(199,Math.max(0,Number(D.join(""))));c(p?p-1:null),t(h.current,{slotNumber:P})}}function f(m){r.current&&r.current.contains(m.target)||c(null)}return document.addEventListener("keydown",v,!0),document.addEventListener("keyup",y,!0),document.addEventListener("click",f),()=>{document.removeEventListener("keydown",v,!0),document.removeEventListener("keyup",y,!0),document.removeEventListener("click",f)}},[t])}return Object(d.useEffect)(()=>{if(!u.current)throw new Error("Expected elements to exist");u.current.forEach((g,h)=>{h===o?g.classList.add(z.a.active):g.classList.remove(z.a.active)})},[o]),l.a.createElement(l.a.Fragment,null,l.a.createElement(L.a.Label,null,"Destination"),l.a.createElement("br",null),l.a.createElement("div",{className:z.a.slotNumberContainer},l.a.createElement("div",{className:z.a.arrowControls},l.a.createElement("span",{onClick:()=>i(2)},l.a.createElement("img",{src:ve.a,alt:"Increment 100"})),l.a.createElement("span",{onClick:()=>i(1)},l.a.createElement("img",{src:ve.a,alt:"Increment 10"})),l.a.createElement("span",{onClick:()=>i(0)},l.a.createElement("img",{src:ve.a,alt:"Increment 1"}))),l.a.createElement("div",{className:z.a.slotNumber,title:`Slot ${n}`,ref:r,onClick:g=>{u.current&&u.current.some(h=>h.contains(g.target))||c(2)}},l.a.createElement(qe.a,{value:"8888",color:"var(--bs-gray-dark)",strokeColor:"transparent",digitCount:4}),l.a.createElement(qe.a,{ref:g=>{const h=Object(Oe.findDOMNode)(g);if(h){h.querySelectorAll("circle").forEach(v=>{h.removeChild(v)});const S=document.createElementNS("http://www.w3.org/2000/svg","circle");S.classList.add(z.a.point),h.appendChild(S),u.current=[].slice.call(h.querySelectorAll("g")).reverse().slice(0,3)}},value:`5${String(n).padStart(3,"0")}`,digitProps:{color:"var(--bs-primary)"},digitCount:4})),l.a.createElement("div",{className:z.a.arrowControls},l.a.createElement("span",{onClick:()=>s(2)},l.a.createElement("img",{src:ye.a,alt:"Decrement 100"})),l.a.createElement("span",{onClick:()=>s(1)},l.a.createElement("img",{src:ye.a,alt:"Decrement 10"})),l.a.createElement("span",{onClick:()=>s(0)},l.a.createElement("img",{src:ye.a,alt:"Decrement 1"})))))}var on=rn,ln=E(74),cn=E.n(ln),sn=Object.defineProperty,un=Object.defineProperties,dn=Object.getOwnPropertyDescriptors,at=Object.getOwnPropertySymbols,fn=Object.prototype.hasOwnProperty,mn=Object.prototype.propertyIsEnumerable,rt=(e,t,n)=>t in e?sn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ot=(e,t)=>{for(var n in t||(t={}))fn.call(t,n)&&rt(e,n,t[n]);if(at)for(var n of at(t))mn.call(t,n)&&rt(e,n,t[n]);return e},lt=(e,t)=>un(e,dn(t)),pn=(e,t,n)=>new Promise((a,o)=>{var c=r=>{try{s(n.next(r))}catch(u){o(u)}},i=r=>{try{s(n.throw(r))}catch(u){o(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});function hn(e,t){const n=URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download=t,a.style.display="none",document.body.appendChild(a),a.click(),a.remove(),URL.revokeObjectURL(n)}function vn({sample:e,onSampleUpdate:t,onSampleDuplicate:n,onSampleDelete:a}){const o=e&&e.id,c=Object(d.useCallback)(m=>o&&t(o,{scaleCoefficient:m}),[o,t]),i=Object(d.useCallback)(m=>o&&t(o,p=>lt(ot({},p),{trim:lt(ot({},p.trim),{frames:m(p.trim.frames)})})),[o,t]),[s,r]=Object(d.useState)(null),[u,g]=Object(d.useState)(null),[h,S]=Object(d.useState)(null);Object(d.useEffect)(()=>{u instanceof AudioBuffer&&h&&(S(null),h.fn())},[u,h]),Object(d.useEffect)(()=>{if(r(null),S(null),e){let m=!1;We(e).then(({data:p})=>{m||r(p)})}},[e]),Object(d.useEffect)(()=>{if(g(null),s){let m=!1;le(s).then(p=>{m||g(p)})}},[s]);const{playAudioBuffer:v,isAudioBusy:y}=Ve(),f=Object(d.useRef)(()=>{});return Object(d.useEffect)(()=>()=>f.current(),[e]),e?l.a.createElement(Lt.a,{fluid:"sm"},l.a.createElement("h2",null,e.metadata.name,l.a.createElement(Tt.a,{style:{display:"inline-block",float:"right"},variant:"light",align:"end",title:"options"},l.a.createElement(ce.a.Item,{onClick:()=>{const m=prompt(`Choose a new name for the sample "${e.metadata.name}":`,e.metadata.name),p=m&&m.trim();p&&t(e.id,{name:p})}},"Rename"),l.a.createElement(ce.a.Item,{onClick:()=>n(e.id)},"Duplicate"),l.a.createElement(ce.a.Divider,null),l.a.createElement(ce.a.Item,{onClick:()=>{window.confirm(`Are you sure you want to delete ${e.metadata.name}?`)&&a(e.id)}},"Delete"))),l.a.createElement("p",null,l.a.createElement("strong",null,"Sampled:")," ",new Date(e.metadata.dateSampled).toLocaleString(),l.a.createElement("br",null),l.a.createElement("strong",null,"Updated:")," ",new Date(e.metadata.dateModified).toLocaleString()),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("div",{className:cn.a.waveformContainer},l.a.createElement(Kt,{onSetTrimFrames:i,onSetScaleCoefficient:c,sample:e})),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement(I.a,{type:"button",variant:"secondary",size:"sm",onClick:m=>{if(u)f.current=v(u);else{const p=m.currentTarget;S({fn:()=>p.click()})}},disabled:y},"Play audio preview")," ",l.a.createElement(I.a,{type:"button",variant:"secondary",size:"sm",onClick:()=>pn(this,null,function*(){const{sourceFileId:m,userFileInfo:p}=e.metadata,b=yield B.getSourceFileData(m),D=new Blob([b],{type:p?p.type:"audio/x-wav"});hn(D,`${e.metadata.name}${p?p.ext:".wav"}`)})},"Download original file"),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement(L.a.Group,null,l.a.createElement(L.a.Label,null,"Quality bit depth (",e.metadata.qualityBitDepth,")"),l.a.createElement(L.a.Range,{value:e.metadata.qualityBitDepth,step:1,min:8,max:16,onChange:m=>{const p=Number(m.target.value);t(e.id,{qualityBitDepth:p})}})),l.a.createElement(on,{sample:e,onSampleUpdate:t}),l.a.createElement("br",null),l.a.createElement(nn,{sample:e})):null}var yn=vn,gn=E(78),Q=(e,t,n)=>new Promise((a,o)=>{var c=r=>{try{s(n.next(r))}catch(u){o(u)}},i=r=>{try{s(n.throw(r))}catch(u){o(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});let ct;function ge(){const e=Fe();return ct=ct||new e(navigator.mediaDevices.getSupportedConstraints().sampleRate?{sampleRate:te}:{})}function bn(){return Q(this,null,function*(){{const a=yield navigator.mediaDevices.getUserMedia({audio:!0,video:!1});for(const o of a.getTracks())o.stop()}const t=(yield navigator.mediaDevices.enumerateDevices()).filter(a=>a.kind==="audioinput"),n=[];for(const a of t){const o=yield navigator.mediaDevices.getUserMedia({audio:{deviceId:a.deviceId,channelCount:2},video:!1}),c=(yield navigator.mediaDevices.enumerateDevices()).find(({deviceId:s})=>a.deviceId===s).label;let i=1;{const s=o.getAudioTracks()[0],r=s.getSettings().channelCount;r?i=r:s.getCapabilities&&(i=(s.getCapabilities().channelCount||{}).max||i)}for(const s of o.getTracks())s.stop();n.push({device:{deviceId:a.deviceId,label:c},channelsAvailable:i})}return n})}let be;function En(e){return Q(this,arguments,function*({onData:t,onFinish:n}){const a=ge();be=be||a.audioWorklet.addModule("recorderWorkletProcessor.js"),yield be;const o=new AudioWorkletNode(a,"recorder-worklet",{parameterData:{bufferSize:1024}});o.port.onmessage=i=>{if(i.data.eventType==="data"){const s=i.data.audioChannels;t(s)}i.data.eventType==="stop"&&n()};const c=o.parameters.get("isRecording");return c.setValueAtTime(1,a.currentTime),{recorderNode:o,stop(){c.setValueAtTime(0,a.currentTime)}}})}function Sn({channelCount:e,onData:t,onFinish:n}){const o=ge().createScriptProcessor(1024,e,e);let c=!1;return o.onaudioprocess=i=>{const s=Array(e).fill().map((r,u)=>i.inputBuffer.getChannelData(u));t(s),c&&n()},{recorderNode:o,stop(){c=!0}}}function wn(e){return Q(this,null,function*(){return typeof AudioWorkletNode=="undefined"?Sn(e):yield En(e)})}function Cn(e){return Q(this,arguments,function*({deviceId:t,channelCount:n,onStart:a,onUpdate:o}){const c=yield navigator.mediaDevices.getUserMedia({audio:{deviceId:t,channelCount:n,sampleRate:te,echoCancellation:!1,autoGainControl:!1,noiseSuppression:!1},video:!1}),i=ge(),s=i.createMediaStreamSource(c),{recorderNode:r,stop:u}=yield wn({channelCount:n,onData:y,onFinish:D});s.connect(r),r.connect(i.destination);const g=10;a(i.sampleRate,g);const h=g*i.sampleRate;let S=0;const v=Array(n).fill([]);function y(P){let C=0;const k=[];for(let j=0;j<n;j++){const w=P[j],R=w.length,x=w.slice(0,Math.min(R,h-S));xe(x),C||(C=x.length),k.push(x)}const O=Dt(k),A=Ne(O);v.push(A),S+=C,S>=h&&u(),o(k)}let f,m;const p=new Promise((P,C)=>{f=P,m=C});let b=!1;function D(){return Q(this,null,function*(){if(b)return;try{const k=yield new Blob(v).arrayBuffer(),O=new Float32Array(k),A=De()({channels:n,sampleRate:i.sampleRate,bitDepth:16,dataLength:O.byteLength}),j=new Uint8Array(A.length+O.byteLength);j.set(A),j.set(new Uint8Array(O.buffer),A.length),f(j)}catch(C){m(C)}const P=c.getTracks();for(const C of P)C.stop();r.disconnect(i.destination),s.disconnect(r),b=!0})}return{stop:u,mediaRecording:p}})}var On=E(60),Ee=E.n(On),J=(e,t,n)=>new Promise((a,o)=>{var c=r=>{try{s(n.next(r))}catch(u){o(u)}},i=r=>{try{s(n.throw(r))}catch(u){o(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});const it="capture_device_preference";let st=null;function Dn(e,t){const n=Object(d.useRef)(JSON.parse(localStorage.getItem(it)||"null")),[a,o]=Object(d.useState)(st),[c,i]=Object(d.useState)(a?"ok":"pending"),[s,r]=Object(d.useState)("");Object(d.useEffect)(()=>{st=a,i("ok")},[a]);const u=Object(d.useCallback)(()=>{let O=!1;return bn().then(A=>{O||A.length&&(o(new Map(A.map(j=>[j.device.deviceId,j]))),r(j=>j?(n.current=null,j):n.current&&A.find(({device:w})=>n.current.deviceId===w.deviceId)?n.current.deviceId:(n.current=null,A[0].device.deviceId)))}).catch(A=>{if(!O){if(A instanceof DOMException){if(A.name==="NotAllowedError"){i("denied");return}if(A.name==="NotFoundError"){i("unavailable");return}}throw A}}),()=>{O=!0}},[]),[g,h]=Object(d.useState)(1);Object(d.useEffect)(()=>{const O=a&&a.get(s);O&&(n.current&&n.current.deviceId===O.device.deviceId&&n.current.channelCount<=O.channelsAvailable?h(n.current.channelCount):h(O.channelsAvailable),n.current=null)},[a,s]),Object(d.useEffect)(()=>{s&&localStorage.setItem(it,JSON.stringify({deviceId:s,channelCount:g}))},[s,g]);const[S,v]=Object(d.useState)("ready"),[y,f]=Object(d.useState)(null),[m,p]=Object(d.useState)({fn(O){}}),[b,D]=Object(d.useState)(1/0),[P,C]=Object(d.useState)(0),k=Object(d.useCallback)(()=>J(this,null,function*(){let O=!1;const A=(M,G)=>Cn({deviceId:M,channelCount:G,onStart:(W,Y)=>{const H=Y*W;D(W),C(H),v("capturing")},onUpdate:e}),j=n.current,{mediaRecording:w,stop:R}=yield j?(()=>J(this,null,function*(){try{return A(j.deviceId,j.channelCount)}catch(M){if(M instanceof DOMException&&M.name==="NotFoundError")return A(s,g);throw M}}))():A(s,g);p({fn(M){R(),M&&(O=!0)}});let x;try{x=yield w}catch(M){f(M),v("error");return}O?v("ready"):(v("finalizing"),t(x))}),[s,g,e,t]);return{captureDevices:a,accessState:c,selectedCaptureDeviceId:s,selectedChannelCount:g,captureState:S,recordingError:y,sampleRate:b,maxSamples:P,refreshCaptureDevices:u,setSelectedCaptureDeviceId:r,setSelectedChannelCount:h,beginRecording:k,stopRecording:m.fn}}const Se=3;function Pn({canvas:e,peaks:t,scaleCoefficient:n}){const a="#fff",o=e.getContext("2d");o.imageSmoothingEnabled=!1;const{width:c,height:i}=e;o.clearRect(0,0,c,i),o.fillStyle=a;for(let s=0;s<t.length;s++){const r=t[s];if(r===0)continue;const u=i*r,g=Math.max(Math.round(n*u),2);o.fillRect(s*Se,i-g,Se-1,g)}}function kn({onRecordFinish:e}){const t=Object(d.useRef)(null),n=Object(d.useRef)(0),a=Object(d.useRef)(new Float32Array),o=Object(d.useRef)(0),c=Object(d.useRef)([]),i=Object(d.useRef)(1/0),s=Object(d.useRef)(0),[r,u]=Object(d.useState)(0),g=Object(d.useCallback)(w=>J(this,null,function*(){const R=n.current,x=a.current,M=c.current;if(M.push(w),s.current+=w[0].length,u(Math.floor(s.current/i.current)),M.reduce((W,[{length:Y}])=>W+Y,0)>=R){const W=yield Promise.all(w.map((H,Ce)=>M.reduce((Nn,Fn)=>[...Nn,Fn[Ce]],[])).map(H=>J(this,null,function*(){const Ce=yield new Blob(H).arrayBuffer();return new Float32Array(Ce)}))),Y=W.map(H=>Be(new Float32Array(H.buffer,0,R)));x[o.current]=Math.max(...Y),Pn({canvas:t.current,peaks:x,scaleCoefficient:.3}),o.current++,c.current=[W.map(H=>H.slice(R))]}}),[]),{captureDevices:h,accessState:S,selectedCaptureDeviceId:v,selectedChannelCount:y,captureState:f,recordingError:m,maxSamples:p,sampleRate:b,refreshCaptureDevices:D,setSelectedCaptureDeviceId:P,setSelectedChannelCount:C,beginRecording:k,stopRecording:O}=Dn(g,e);i.current=b,Object(d.useEffect)(()=>{const w=t.current;w&&(w.width=w.offsetWidth,w.height=w.offsetHeight)},[S]),Object(d.useLayoutEffect)(()=>{const w=t.current;!w||(f!=="finalizing"&&w.getContext("2d").clearRect(0,0,w.width,w.height),f==="capturing"&&p&&(n.current=Math.floor(Se*p/t.current.width),a.current=new Float32Array(Math.floor(p/n.current)),o.current=0,c.current=[],i.current=1/0,s.current=0,u(0)))},[p,f]);const[A,j]=Object(d.useState)(!1);return Object(d.useEffect)(()=>{A&&D()},[A,D]),l.a.createElement("div",null,S==="denied"?l.a.createElement("p",null,"Looks like you didn't grant access to your audio input device. Please give Volca Sampler access, then"," ",l.a.createElement(I.a,{type:"button",variant:"secondary",onClick:D},"try again")):S==="unavailable"?l.a.createElement("p",null,"Volca Sampler couldn't find any audio input devices. Please connect one, then"," ",l.a.createElement(I.a,{type:"button",variant:"secondary",onClick:D},"try again")):l.a.createElement("div",null,l.a.createElement("h2",null,"Send a new sound to your Volca Sample!"),l.a.createElement(I.a,{className:Ee.a.recordButton,type:"button",variant:f==="capturing"?"danger":"primary",size:"lg",style:{width:250},onClick:f==="capturing"?()=>O():k,disabled:f==="finalizing"},l.a.createElement("canvas",{ref:t}),l.a.createElement("span",{className:Ee.a.mainText},["capturing","finalizing"].includes(f)?"Finished recording":"Start recording"),["capturing","finalizing"].includes(f)&&l.a.createElement("span",{className:Ee.a.timeRecorded},"0:",String(r).padStart(2,"0"))),["capturing","finalizing"].includes(f)?l.a.createElement(l.a.Fragment,null,l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement(I.a,{style:{width:250},size:"sm",type:"button",variant:"secondary",onClick:()=>O(!0)},"Cancel")):l.a.createElement(l.a.Fragment,null,l.a.createElement("br",null),l.a.createElement(I.a,{style:{width:250},type:"button",variant:"light",size:"sm",onClick:()=>j(w=>!w)},"Audio input settings ",A?"\u25B2":"\u25BC"),l.a.createElement(gn.a,{in:A},l.a.createElement("div",null,l.a.createElement(L.a.Group,null,l.a.createElement(L.a.Label,null,"Capture Device"),l.a.createElement(L.a.Select,{style:{width:250},value:v,onChange:w=>P(w.target.value)},h&&S==="ok"?[...h].map(([w,{device:R}])=>l.a.createElement("option",{key:w,value:w},R.label||w)):l.a.createElement("option",{value:"",disabled:!0},"Loading devices..."))),l.a.createElement(L.a.Group,null,l.a.createElement(L.a.Label,null,"Input channels"),l.a.createElement(L.a.Select,{style:{width:250},value:y,onChange:w=>C(Number(w.target.value))},[1,2].map(w=>l.a.createElement("option",{key:w,value:w,disabled:!h||!h.has(v)||h.get(v).channelsAvailable<w},w===1?"Mono":"Stereo (summed to mono)")))),l.a.createElement("br",null))))),f==="error"&&m||null,l.a.createElement("br",null),l.a.createElement(I.a,{style:{width:250},type:"button",variant:"secondary",onClick:w=>{const R=w.currentTarget.querySelector("input");R&&w.target!==R&&R.click()}},"Or import an audio file",l.a.createElement("input",{hidden:!0,type:"file",accept:"audio/*,.wav,.mp3,.ogg",onChange:w=>{if(w.target.files&&w.target.files.length){const R=w.target.files[0];R.arrayBuffer().then(x=>J(this,null,function*(){const M=new Uint8Array(x);let G;try{G=yield le(M)}catch(W){alert("Unsupported audio format detected");return}if(G.length>10*G.sampleRate){alert("Please select an audio file no more than 10 seconds long");return}e(M,R)}))}}})))}var An=kn,we=E(124),U=E(126),jn=(e,t,n)=>new Promise((a,o)=>{var c=r=>{try{s(n.next(r))}catch(u){o(u)}},i=r=>{try{s(n.throw(r))}catch(u){o(u)}},s=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,i);s((n=n.apply(e,t)).next())});const Rn=Z.a.div({padding:"2rem",display:"flex",height:"100%"}),Mn=Z.a.div({flexGrow:1});function In(){const[e,t]=Object(d.useState)(new Map),[n,a]=Object(d.useState)(new Map),o=Object(d.useMemo)(()=>new Map([...e,...n]),[e,n]);Object(d.useEffect)(()=>{wt().then(a).catch(console.error)},[]);const[c,i]=Object(d.useState)(null),[s,r]=Object(d.useState)(!0);Object(d.useEffect)(()=>{B.getAllFromStorage().then(y=>{t(f=>new Map([...f,...y.map(m=>[m.id,m])]))}).finally(()=>{r(!1)})},[]);const u=Object(d.useCallback)((y,f)=>jn(this,null,function*(){const m=yield bt(y);let p="",b="";if(f){const k=f.name.lastIndexOf(".");k>0?(p=f.name.slice(0,k),b=f.name.slice(k)):p=f.name}else p="New sample";const D=[0,0],P=yield _e(m,D),C=new B.Mutable({name:p,sourceFileId:m,trim:{frames:D,waveformPeaks:P},userFileInfo:f&&{type:f.type,ext:b}});yield C.persist(),t(k=>new Map([[C.id,C],...k])),i(C.id)}),[]),g=Object(d.useCallback)((y,f)=>{t(m=>{const p=m.get(y);if(p&&p instanceof B.Mutable){const b=p.update(f);if(b!==p)return new Map(m).set(p.id,b)}return m})},[]),[h,S]=Object(d.useState)(!1),v=Object(d.useCallback)(y=>{i(y),S(!1)},[]);return l.a.createElement("div",null,l.a.createElement(mt,{onMenuOpen:()=>S(!0),onHeaderClick:()=>i(null)}),l.a.createElement(we.a,{show:h,onHide:()=>S(!1)},l.a.createElement(we.a.Header,{closeButton:!0}),l.a.createElement(we.a.Body,null,l.a.createElement(q.a,null,l.a.createElement(q.a.Item,{as:"button",onClick:()=>v(null)},"New Sample"),s?"Loading...":null,!s&&l.a.createElement(U.a,{defaultActiveKey:e.size?"user":"factory"},l.a.createElement(U.a.Item,{eventKey:"user"},l.a.createElement(U.a.Header,null,"Your Samples"),l.a.createElement(U.a.Body,{style:{padding:0}},l.a.createElement(Ge,{samples:e,selectedSampleId:c,onSampleSelect:v}))),l.a.createElement(U.a.Item,{eventKey:"factory"},l.a.createElement(U.a.Header,null,"Factory Samples"),l.a.createElement(U.a.Body,{style:{padding:0}},l.a.createElement(Ge,{samples:n,selectedSampleId:c,onSampleSelect:v}))))))),l.a.createElement(Rn,null,l.a.createElement(Mn,null,c&&l.a.createElement(yn,{sample:o.get(c)||null,onSampleUpdate:g,onSampleDuplicate:y=>{const f=o.get(y);if(f){const m=f.duplicate();t(p=>new Map([[m.id,m],...p])),i(m.id)}},onSampleDelete:y=>{const f=o.get(y);f&&f instanceof B.Mutable&&(f.remove(),t(m=>{const p=new Map(m);return p.delete(f.id),p}))}}),!c&&l.a.createElement(An,{onRecordFinish:u}))))}var Bn=In,xn=e=>{e&&e instanceof Function&&E.e(3).then(E.bind(null,130)).then(({getCLS:t,getFID:n,getFCP:a,getLCP:o,getTTFB:c})=>{t(e),n(e),a(e),o(e),c(e)})};Blob.prototype.arrayBuffer||(Blob.prototype.arrayBuffer=function(){return new Response(this).arrayBuffer()}),ut.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(kt,null,l.a.createElement(Bn,null))),document.getElementById("root")),xn()},22:function(N,V,E){N.exports={slotNumberContainer:"SlotNumberInput_slotNumberContainer__1q7P1",arrowControls:"SlotNumberInput_arrowControls__1LPAC",slotNumber:"SlotNumberInput_slotNumber__GC-i7",active:"SlotNumberInput_active__2zN4D",digitBlinkEffect:"SlotNumberInput_digitBlinkEffect__1_u8n",point:"SlotNumberInput_point__3pJD3"}},24:function(N,V,E){N.exports={title:"Header_title__R3bRx",menuIcon:"Header_menuIcon__swn7p",titleText:"Header_titleText__3e5ME",titleR:"Header_titleR__3QRgv",titleStarburst:"Header_titleStarburst__1oLYP",titleGraphic:"Header_titleGraphic__3S89F"}},60:function(N,V,E){N.exports={recordButton:"SampleRecord_recordButton__3R-KX",mainText:"SampleRecord_mainText__2dca6",timeRecorded:"SampleRecord_timeRecorded__3FGTe"}},74:function(N,V,E){N.exports={waveformContainer:"SampleDetail_waveformContainer__3VrPQ",slotNumber:"SampleDetail_slotNumber__3sgS6",point:"SampleDetail_point__3d7qL"}},83:function(N,V,E){},84:function(N,V,E){}},[[115,1,2]]]);

//# sourceMappingURL=main.f70275c1.chunk.js.map