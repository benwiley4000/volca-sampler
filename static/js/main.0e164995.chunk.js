(this["webpackJsonpvolca-sampler"]=this["webpackJsonpvolca-sampler"]||[]).push([[0],{107:function(I,$,d){I.exports={"form-switch":"NormalizeSwitch_form-switch__pmDx5","form-check-input":"NormalizeSwitch_form-check-input__trt4D",normalizeControlWrapper:"NormalizeSwitch_normalizeControlWrapper__3yf2V"}},111:function(I,$,d){I.exports={waveformContainer:"WaveformReadonly_waveformContainer__RARS4"}},118:function(I,$,d){},119:function(I,$,d){},150:function(I,$,d){"use strict";d.r($);var u=d(0),n=d.n(u),gt=d(11),ha=d.n(gt),ar=d(118),nr=d(119),Xe=d(165),T=d(106),ya=d(166),ue=d(164),je=d(157),ba=d(22),le=d.n(ba),ga=n.a.memo(function({onMenuOpen:e,onHeaderClick:a}){return n.a.createElement("div",{className:le.a.titleBar},n.a.createElement("span",{className:le.a.menuIcon,onClick:e},"\u2630"),n.a.createElement(je.a,{fluid:"sm",className:le.a.titleContainer},n.a.createElement("h1",{className:le.a.title,onClick:a},n.a.createElement("span",{className:le.a.titleText,"data-text":"Volca Sample"},"Volca Sample",n.a.createElement("span",{className:le.a.titleR},"r"),n.a.createElement("svg",{viewBox:"0 0 150 150",preserveAspectRatio:"none",className:le.a.titleStarburst},Array(24).fill().map((r,o,{length:i})=>n.a.createElement("polygon",{key:o,points:"75,70 75,80 150,75","transform-origin":"75 75",style:{"--rotation":`${o*360/i}deg`}})))),n.a.createElement("img",{className:le.a.titleGraphic,src:"volca_sample.png",alt:""}),n.a.createElement("div",{className:le.a.tagline},n.a.createElement("h2",null,"for volca sample")))),n.a.createElement("svg",{width:0,height:0},n.a.createElement("filter",{id:"outline"},n.a.createElement("feMorphology",{in:"SourceAlpha",result:"DILATED",operator:"dilate",radius:"1"}),n.a.createElement("feFlood",{floodColor:"var(--stroke-color)",floodOpacity:"1",result:"PINK"}),n.a.createElement("feComposite",{in:"PINK",in2:"DILATED",operator:"in",result:"OUTLINE"}),n.a.createElement("feMerge",null,n.a.createElement("feMergeNode",{in:"OUTLINE"}),n.a.createElement("feMergeNode",{in:"SourceGraphic"})))))}),Q=d(161),Et=d(63),Ea=d(64),wt=d.n(Ea),wa=d(55),Ae=d.n(wa),St=d(167),Ct=d(93);const Pe=31250;var Sa=Object.defineProperty,Ca=Object.defineProperties,Oa=Object.getOwnPropertyDescriptors,Re=Object.getOwnPropertySymbols,Ot=Object.prototype.hasOwnProperty,kt=Object.prototype.propertyIsEnumerable,Ke=(t,e,a)=>e in t?Sa(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,q=(t,e)=>{for(var a in e||(e={}))Ot.call(e,a)&&Ke(t,a,e[a]);if(Re)for(var a of Re(e))kt.call(e,a)&&Ke(t,a,e[a]);return t},ce=(t,e)=>Ca(t,Oa(e)),Ne=(t,e)=>{var a={};for(var r in t)Ot.call(t,r)&&e.indexOf(r)<0&&(a[r]=t[r]);if(t!=null&&Re)for(var r of Re(t))e.indexOf(r)<0&&kt.call(t,r)&&(a[r]=t[r]);return a},Me=(t,e,a)=>(Ke(t,typeof e!="symbol"?e+"":e,a),a),te=(t,e,a)=>new Promise((r,o)=>{var i=l=>{try{c(a.next(l))}catch(m){o(m)}},s=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(i,s);c((a=a.apply(t,e)).next())});const Be=Ae.a.createInstance({name:"audio_file_data",driver:Ae.a.INDEXEDDB}),Le=Ae.a.createInstance({name:"sample_metadata",driver:Ae.a.INDEXEDDB});function ka(t){return te(this,null,function*(){const e=Object(St.a)();return yield Be.setItem(e,t),e})}const Ye="0.5.0",Da={"0.1.0":t=>{const e=t,{clip:a}=e,r=Ne(e,["clip"]);return ce(q({},r),{trimFrames:a.map(i=>Math.round(i*Pe)),metadataVersion:"0.2.0"})},"0.2.0":t=>te(void 0,null,function*(){const e=t,{trimFrames:a}=e,r=Ne(e,["trimFrames"]),o=yield xe(r.sourceFileId,!1),i=yield et(o,a),s={frames:a,waveformPeaks:i};return ce(q({},r),{trim:s,metadataVersion:"0.3.0"})}),"0.3.0":t=>{const e=t,{dateSampled:a,dateModified:r}=e,o=Ne(e,["dateSampled","dateModified"]);return ce(q({},o),{dateSampled:new Date(a).toISOString(),dateModified:new Date(r).toISOString(),metadataVersion:"0.4.0"})},"0.4.0":t=>te(void 0,null,function*(){const e=t,{scaleCoefficient:a,trim:{frames:r,waveformPeaks:o}}=e,i=Ne(e,["scaleCoefficient","trim"]),s=yield xe(i.sourceFileId,!1),c=Fe(s,r),l=pe(c);return ce(q({},i),{normalize:a!==1,trim:{frames:r,waveformPeaks:ce(q({},o),{normalizationCoefficient:1/l})},metadataVersion:"0.5.0"})})};function ja(t){return te(this,null,function*(){let e=t;for(;e.metadataVersion!==Ye;){const a=Da[e.metadataVersion];if(!a){console.warn(`Failed to properly upgrade metadata for sample "${e.name}"`),e={name:e.name,sourceFileId:e.sourceFileId,id:e.id,metadataVersion:Ye};break}e=yield a(e)}return e})}const fe=class{constructor({name:t,sourceFileId:e,trim:a,id:r=Object(St.a)(),userFileInfo:o=null,slotNumber:i=0,dateSampled:s=new Date().toISOString(),dateModified:c=s,useCompression:l=!0,qualityBitDepth:m=16,normalize:f=!0}){this.id=r,this.metadata={name:t,sourceFileId:e,trim:a,userFileInfo:o,slotNumber:i,dateSampled:s,dateModified:c,useCompression:l,qualityBitDepth:m,normalize:f,metadataVersion:Ye}}duplicate(){const t=new fe.Mutable(ce(q({},this.metadata),{name:`${this.metadata.name} (copy)`,dateModified:new Date().toISOString()}));return t.persist(),t}static cacheSourceFileData(t,e){this.sourceFileData.set(t,e),this.recentlyCachedSourceFileIds=[t,...this.recentlyCachedSourceFileIds.filter(r=>r!==t)];const a=this.recentlyCachedSourceFileIds.slice(this.MAX_CACHED);for(const r of a)this.sourceFileData.delete(r);this.recentlyCachedSourceFileIds=this.recentlyCachedSourceFileIds.slice(0,this.MAX_CACHED)}static getSourceFileData(t){return te(this,null,function*(){{const a=this.sourceFileData.get(t);if(a)return a}if(t.includes(".")){const a=yield fetch(t);if(a.status>=400)return Promise.reject(new Error(`Failed to fetch source file "${t}"`));const r=yield a.arrayBuffer(),o=new Uint8Array(r);return this.cacheSourceFileData(t,o),o}const e=yield Be.getItem(t);return e?e instanceof Uint8Array?(this.cacheSourceFileData(t,e),e):Promise.reject("Source data is of unexpected type"):Promise.reject("Missing source data")})}static getAllMetadataFromStore(){return te(this,null,function*(){const t=new Map,e=[];return yield Le.iterate((a,r)=>{a&&e.push(ja(a).then(o=>{t.set(r,o)}).catch(o=>{console.error(o),console.warn(`Failed to upgrade metadata "${r}" (${a.name}); ignoring.`)}))}),yield Promise.all(e),t})}static getAllFromStorage(){return te(this,null,function*(){const t=yield this.getAllMetadataFromStore(),e=yield Dt(),a=(yield Be.keys()).concat(e.map(({sourceFileId:o})=>o));return[...t].map(([o,i])=>{const{sourceFileId:s}=i;return a.includes(s)?new fe.Mutable(q({id:o},i)):(console.warn(`Found metadata "${i.name||o}" with missing data "${s}; ignoring.`),null)}).filter(Boolean).sort(({metadata:{dateModified:o}},{metadata:{dateModified:i}})=>o>i?-1:i>o?1:0)})}};let Z=fe;Me(Z,"Mutable",class extends fe{constructor(t){super(t);setTimeout(()=>te(this,null,function*(){(yield Le.keys()).includes(this.id)||console.warn(`Expected sample metadata container ${this.id} to be persisted`)}))}persist(){return te(this,null,function*(){yield Le.setItem(this.id,this.metadata)})}update(t){const{id:e,metadata:a}=this,r=typeof t=="function"?t(a):t;if(Object.keys(r).every(s=>r[s]===a[s]))return this;const o=ce(q(q({},a),r),{dateModified:new Date().toISOString()}),i=new fe.Mutable(q({id:e},o));return i.persist(),i}remove(){return te(this,null,function*(){if(yield Le.removeItem(this.id),this.metadata.sourceFileId.includes("."))return;const t=yield fe.getAllMetadataFromStore();for(const[,{sourceFileId:e}]of t)if(e===this.metadata.sourceFileId)return;yield Be.removeItem(this.metadata.sourceFileId)})}}),Me(Z,"sourceFileData",new Map),Me(Z,"recentlyCachedSourceFileIds",[]),Me(Z,"MAX_CACHED",10);let Ze;function Dt(){return Ze||(Ze=fetch("factory-samples.json").then(t=>t.json())),Ze}function Aa(){return te(this,null,function*(){const t=yield Dt();return new Map(t.map(e=>[e.id,new Z(ce(q({},e),{normalize:!1,trim:{frames:[e.trim.frames[0],e.trim.frames[1]],waveformPeaks:ce(q({},e.trim.waveformPeaks),{positive:new Float32Array(Object(Ct.a)(e.trim.waveformPeaks.positive)),negative:new Float32Array(Object(Ct.a)(e.trim.waveformPeaks.negative))})}}))]))})}var jt=Math.pow,Je=(t,e,a)=>new Promise((r,o)=>{var i=l=>{try{c(a.next(l))}catch(m){o(m)}},s=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(i,s);c((a=a.apply(t,e)).next())});function Ie(t,e){const a=4,r=e[0]*a,o=t.length-e[0]-e[1];return new Float32Array(t.buffer,r,o)}function Fe(t,e){const a=t.length-e[0]-e[1],r=new Float32Array(a),o=Array(t.numberOfChannels).fill().map((i,s)=>Ie(t.getChannelData(s),e));for(let i=0;i<a;i++){let s=0;for(let c=0;c<o.length;c++)s+=o[c][i];s/=o.length,r[i]=s}return r}function pe(t){let e=0;for(const a of t){const r=Math.abs(a);r>e&&(e=r)}return e}function Pa(t,e){if(e!==1)for(let a=0;a<t.length;a++)t[a]*=e}function Ra(t){const e=pe(t);Pa(t,1/e)}function Na(t,e){const a=jt(2,e-1);for(let r=0;r<t.length;r++)t[r]=Math.round(t[r]*a)/a}function At(t){for(let e=0;e<t.length;e++)t[e]>1?t[e]=1:t[e]<-1&&(t[e]=-1)}function Ma(t){const e=t.length,a=t[0].length,r=new Float32Array(e*a);for(let o=0;o<r.length;o++){const i=e*o;for(let s=0;s<e;s++)r[i+s]=t[s][o]}return r}function Pt(t){const e=new Int16Array(t.length),a=jt(2,15);for(let r=0;r<t.length;r++)e[r]=t[r]===1?a-1:a*t[r];return e}function Rt(){return window.AudioContext||window.webkitAudioContext}let Nt;function Mt(){const t=Rt();return Nt=Nt||new t({sampleRate:Pe})}function Ee(t){return Je(this,null,function*(){const e=new Uint8Array(t);return yield new Promise((r,o)=>{Mt().decodeAudioData(e.buffer,r,o)})})}function xe(t,e){return Je(this,null,function*(){const a=yield Z.getSourceFileData(t),r=yield Ee(a);if(e)for(let o=0;o<r.numberOfChannels;o++)At(r.getChannelData(o));return r})}function Bt(t,e){return Je(this,null,function*(){const{qualityBitDepth:a,sourceFileId:r,userFileInfo:o,normalize:i,trim:{frames:s}}=t.metadata;if(a<8||a>16||!Number.isInteger(a))throw new Error(`Expected bit depth between 8 and 16. Received: ${a}`);const c=yield xe(r,Boolean(o)),l=c.numberOfChannels===1?Ie(c.getChannelData(0),s):Fe(c,s);i&&Ra(l),e&&a<16&&Na(l,a);const m=Pt(l),f=m.length*2,p=wt()({channels:1,sampleRate:c.sampleRate,bitDepth:16,dataLength:f}),h=new Uint8Array(p.length+f);return h.set(p),h.set(new Uint8Array(m.buffer),p.length),{data:h,sampleRate:16}})}function Lt(t){const[e,a]=Object(u.useState)(null),[r,o]=Object(u.useState)(null);return Object(u.useEffect)(()=>{a(null);let i=!1;Bt(t,!0).then(({data:s})=>{i||a(s)})},[t]),Object(u.useEffect)(()=>{if(o(null),e){let i=!1;Ee(e).then(s=>{i||o(s)})}},[e]),{wav:e,audioBuffer:r}}const Ba={playAudioBuffer(t,e){throw new Error("Must render AudioPlaybackContextProvider")}},It=Object(u.createContext)(Ba);function La({children:t}){const e=Object(u.useRef)(()=>{}),a=Object(u.useCallback)((o,{onTimeUpdate:i=()=>null,onEnded:s=()=>null}={})=>{e.current();const c=Mt(),l=c.createBufferSource();l.buffer=o,l.connect(c.destination),l.start();const m=c.currentTime;i(0);let f=requestAnimationFrame(p);function p(){i(c.currentTime-m),f=requestAnimationFrame(p)}let h=!1;l.addEventListener("ended",()=>{h||(i(o.duration),s()),cancelAnimationFrame(f)});function E(){h||(l.stop(),cancelAnimationFrame(f),s(),h=!0)}return e.current=E,E},[]),r=Object(u.useMemo)(()=>({playAudioBuffer:a}),[a]);return Object(u.createElement)(It.Provider,{value:r},t)}function Ft(){return Object(u.useContext)(It)}function qe(t){return t.toLocaleString([],{dateStyle:"medium",timeStyle:"short"})}function _e(t,e){return`0:${t.toFixed(e).padStart(3+e,"0")}`}function Ia(t){return`${Math.floor(t/60)}m ${Math.floor(t%60)}s`}var xt=(t,e,a)=>new Promise((r,o)=>{var i=l=>{try{c(a.next(l))}catch(m){o(m)}},s=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(i,s);c((a=a.apply(t,e)).next())});const ve=6,_t=ve*44;function Wt(t,e){const a=Math.floor(ve*t.length/e),r=new Float32Array(Math.floor(t.length/a)),o=new Float32Array(Math.floor(t.length/a));for(let l=0;l<r.length;l++){const m=new Float32Array(t.buffer,l*a*4,a);let f=0,p=0;for(const h of m)h>f&&(f=h),h<p&&(p=h);r[l]=Math.min(1,f),o[l]=Math.max(-1,p)}const i=t.length%a,s=new Float32Array(r.length+o.length+i);s.set(r,0),s.set(o,r.length),s.set(new Float32Array(t.buffer,(t.length-i)*4,i),r.length+o.length);const c=pe(s);return{positive:r,negative:o,normalizationCoefficient:1/c}}function et(t,e){return xt(this,null,function*(){const a=Fe(t,e);return Wt(a,_t)})}function Tt(t){const[e,a]=Object(u.useState)(null);Object(u.useEffect)(()=>{let o=!1;return(()=>xt(this,null,function*(){if(o)return;const i=yield xe(t.metadata.sourceFileId,Boolean(t.metadata.userFileInfo));o||a([t.metadata.sourceFileId,i])}))(),()=>{o=!0}},[t.metadata.sourceFileId,t.metadata.userFileInfo]);const r=Object(u.useRef)(t);return e&&t.metadata.sourceFileId===e[0]&&(r.current=t),{sample:r.current,sourceAudioBuffer:e&&e[1]}}function Ht(t){const e=Object(u.useMemo)(()=>t?Fe(t,[0,0]):new Float32Array,[t]),[a,r]=Object(u.useState)(null),[o,i]=Object(u.useState)({width:0,height:0}),s=Object(u.useMemo)(()=>a&&(o.width||a.offsetWidth),[a,o]),c=Object(u.useMemo)(()=>!s||!e.length?{positive:new Float32Array,negative:new Float32Array,normalizationCoefficient:1/0}:Wt(e,s),[s,e]);return{monoSamples:e,waveformRef:r,pixelWidth:s,peaks:c,onResize:i}}function zt(t){const{playAudioBuffer:e}=Ft(),a=Object(u.useRef)(()=>{}),[r,o]=Object(u.useState)(null);Object(u.useEffect)(()=>{t&&r&&(o(null),r.fn())},[t,r]);const[i,s]=Object(u.useState)(0),[c,l]=Object(u.useState)(!1),[m,f]=Object(u.useState)("");Object(u.useEffect)(()=>{t&&f(_e(c?i*t.duration:t.duration,1))},[t,c,i]);const p=Object(u.useCallback)(E=>{if(c)a.current();else if(t)a.current=e(t,{onTimeUpdate(b){s(b/t.duration)},onEnded(){l(!1)}}),s(0),l(!0);else{const b=E.target;o({fn:()=>b.dispatchEvent(E)})}},[c,e,t]);Object(u.useEffect)(()=>{function E(b){document.querySelector('[role="dialog"]')||b.key===" "&&(b.preventDefault(),p(b))}return document.addEventListener("keydown",E),()=>document.removeEventListener("keydown",E)},[p]);const h=Object(u.useCallback)(()=>a.current(),[]);return{isPlaybackActive:c,playbackProgress:i,displayedTime:m,togglePlayback:p,stopPlayback:h}}var Fa=d(102),xa=Object.defineProperty,Vt=Object.getOwnPropertySymbols,_a=Object.prototype.hasOwnProperty,Wa=Object.prototype.propertyIsEnumerable,Ut=(t,e,a)=>e in t?xa(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,$t=(t,e)=>{for(var a in e||(e={}))_a.call(e,a)&&Ut(t,a,e[a]);if(Vt)for(var a of Vt(e))Wa.call(e,a)&&Ut(t,a,e[a]);return t};const Ta=Et.a.canvas({width:"100%",height:"100%",display:"block",imageRendering:"pixelated"});function Ha(t,e){function a(o,i){t.width=o,t.height=i}a(t.offsetWidth,t.offsetHeight),e({width:t.offsetWidth,height:t.offsetHeight});const r=new Fa.a(([o])=>{const{width:i,height:s}=o.contentRect;a(i,s),e({width:i,height:s})});return r.observe(t),()=>r.disconnect()}function za(t,e,a){const r=getComputedStyle(document.documentElement),o=r.getPropertyValue("--bs-primary"),i=r.getPropertyValue("--bs-primary-darkened"),s=t.getContext("2d");s.imageSmoothingEnabled=!1;const{width:c,height:l}=t;s.clearRect(0,0,c,l);const m=Math.floor(l*(2/3))+1;s.fillStyle=o,e.positive.forEach((p,h)=>{const E=m*p,b=Math.max(Math.round(a*E),1);s.fillRect(h*ve,m-b,ve-1,b)});const f=l-m;s.fillStyle=i,e.negative.forEach((p,h)=>{const E=f*p*-1,b=Math.round(a*E);s.fillRect(h*ve,m,ve-1,b)})}function Va({peaks:t,scaleCoefficient:e,waveformRef:a,onResize:r}){const o=Object(u.useRef)(null);Object(u.useImperativeHandle)(a,()=>o.current);const[i,s]=Object(u.useState)(Symbol()),c=Object(u.useRef)({width:0,height:0});return Object(u.useLayoutEffect)(()=>{if(!o.current)throw new Error("Canvas should be defined");return c.current.width=o.current.offsetWidth,c.current.height=o.current.offsetHeight,r&&r($t({},c.current)),Ha(o.current,({width:l,height:m})=>{(l!==c.current.width||m!==c.current.height)&&(s(Symbol()),c.current.width=l,c.current.height=m,r&&r($t({},c.current)))})},[r]),Object(u.useLayoutEffect)(()=>{const l=o.current;if(!l)throw new Error("Canvas should be defined");let m=requestAnimationFrame(()=>{m=requestAnimationFrame(()=>{za(l,t,e===void 0?t.normalizationCoefficient:e)})});return()=>cancelAnimationFrame(m)},[t,e,i]),n.a.createElement(Ta,{ref:o})}var tt=Va,Ua=d(86),at=d.n(Ua);const $a=Et.a.div({width:`${_t}px`,height:"40px"}),Qt=typeof IntersectionObserver!="undefined",Qa=n.a.memo(function({sample:e,selected:a,onSampleSelect:r}){const o=Object(u.useRef)(null),[i,s]=Object(u.useState)(!Qt);return Object(u.useLayoutEffect)(()=>{if(!Qt)return;const c=o.current;if(!c)throw new Error("Waveform container should be defined");const l=c.getBoundingClientRect();if(l.top+l.height>=0&&l.bottom-l.height<=window.innerHeight){s(!0);return}const m=new IntersectionObserver(([f])=>{f.isIntersecting&&(s(!0),m.unobserve(c))});return m.observe(c),()=>m.disconnect()},[]),n.a.createElement("li",{className:["list-group-item",at.a.listItem,a?`active ${at.a.active}`:""].join(" "),onClick:()=>r(e.id)},n.a.createElement(Q.a.Label,null,e.metadata.name),n.a.createElement("div",{className:at.a.listWaveform},n.a.createElement($a,{ref:o},i&&n.a.createElement(tt,{peaks:e.metadata.trim.waveformPeaks}))))});function Ga({samples:t,selectedSampleId:e,onSampleSelect:a}){const r=Object(u.useRef)(new WeakMap),o=[];for(const i of t.values()){let s=r.current.get(i);s||(s=n.a.createElement(Qa,{key:i.id,sample:i,selected:i.id===e,onSampleSelect:a}),r.current.set(i,s)),o.push(s)}return n.a.createElement("ul",{className:"list-group list-group-flush"},o)}var Gt=Ga,Xa=d(159),we=d(112),W=d(163),Xt=d(65),We=d(162),Te=d(158),Ka=d(103),Ya=d(104),Za=d(105);function Kt(t,e){const a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download=e,r.style.display="none",document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(a)}var Ja=d(45),Se=d.n(Ja),qa=(t,e,a)=>new Promise((r,o)=>{var i=l=>{try{c(a.next(l))}catch(m){o(m)}},s=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(i,s);c((a=a.apply(t,e)).next())}),Yt=n.a.memo(function({isPlaybackActive:e,playbackProgress:a,displayedTime:r,downloadFilename:o,wavFile:i,togglePlayback:s}){const c=Object(u.useCallback)(()=>qa(this,null,function*(){if(i){const l=new Blob([i],{type:"audio/x-wav"});Kt(l,o)}}),[o,i]);return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:[Se.a.playbackOverlay,e?Se.a.playbackActive:""].join(" "),style:{"--playback-progress":`${100*a}%`}},n.a.createElement("div",{className:Se.a.playback})),n.a.createElement("div",{className:Se.a.playbackButtonContainer},n.a.createElement(We.a,{delay:{show:400,hide:0},overlay:n.a.createElement(Te.a,null,"Preview how your sample will sound on the volca sample")},n.a.createElement(T.a,{variant:"dark",onClick:l=>s(l.nativeEvent)},e?n.a.createElement(Ya.a,null):n.a.createElement(Ka.a,null))),r&&n.a.createElement("span",null,r)),n.a.createElement(We.a,{delay:{show:400,hide:0},overlay:n.a.createElement(Te.a,null,"Download a copy of the audio that will be transferred to the volca sample")},n.a.createElement(T.a,{className:Se.a.downloadButton,type:"button",variant:"dark",size:"sm",onClick:c,disabled:!i},n.a.createElement(Za.a,null))))}),en=d(107),tn=d.n(en),an=n.a.memo(function({sampleId:e,normalize:a,onSampleUpdate:r}){return n.a.createElement(We.a,{delay:{show:400,hide:0},overlay:n.a.createElement(Te.a,null,"Boosts your sample's volume so its peak is at the same level as your other normalized samples")},n.a.createElement("div",{className:tn.a.normalizeControlWrapper},n.a.createElement(Q.a.Switch,{label:n.a.createElement("span",{onClick:()=>r(e,o=>({normalize:!o.normalize}))},"Normalize"),checked:a,onChange:o=>r(e,{normalize:o.target.checked})})))}),nn=d(8),G=d.n(nn),rn=(t,e,a)=>new Promise((r,o)=>{var i=l=>{try{c(a.next(l))}catch(m){o(m)}},s=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(i,s);c((a=a.apply(t,e)).next())}),on=n.a.memo(function({sample:e,onSampleUpdate:a}){const{wav:r,audioBuffer:o}=Lt(e),{sample:{id:i,metadata:{name:s,trim:{frames:c},normalize:l}},sourceAudioBuffer:m}=Tt(e),{monoSamples:f,waveformRef:p,pixelWidth:h,peaks:E,onResize:b}=Ht(m),j=Object(u.useMemo)(()=>{if(!m)return 0;const x=Ie(f,c);return pe(x)},[m,f,c]),M=1/j,[w,k]=Object(u.useState)({trimFrames:c,cursor:null});Object(u.useEffect)(()=>{k({trimFrames:c,cursor:null})},[c]);const P=Object(u.useMemo)(()=>{if(!f.length||!h)return[0,0];const x=h/f.length;return w.trimFrames.map(_=>_*x)},[h,f.length,w.trimFrames]),B=Object(u.useRef)(w);B.current=w;const C=Object(u.useRef)(e.id);C.current=e.id;const A=Object(u.useRef)(0),D=Object(u.useCallback)(()=>rn(this,null,function*(){if(!m||i!==C.current)return;let x=A.current=Math.random();const{trimFrames:_}=B.current,X=yield et(m,_);A.current===x&&a(i,{trim:{frames:_,waveformPeaks:X}})}),[i,m,a]),R=Object(u.useRef)(!1);Object(u.useEffect)(()=>{R.current&&(D(),R.current=!1)},[w,D]);const g=Object(u.useCallback)(()=>{R.current=!0,k({trimFrames:[0,0],cursor:null})},[]),N=Object(u.useRef)(null),S=Object(u.useRef)(null),O=Object(u.useRef)(null);{const x=Object(u.useRef)(null),_=Object(u.useRef)(null),X=Object(u.useRef)(null),De=Object(u.useRef)(!1),oe=Object(u.useRef)(null);Object(u.useLayoutEffect)(()=>{oe.current&&(clearTimeout(oe.current),oe.current=null)},[w]);const ut=Object(u.useMemo)(()=>{if(!h||!f.length)return null;const U=Math.max(2e3,Math.ceil(10*f.length/h));return{pixelWidth:h,monoSamplesLength:f.length,minFrameWidth:U}},[h,f.length]);Object(u.useEffect)(()=>{if(!ut||!N.current||!S.current||!O.current)return;const K=N.current,U=S.current,ee=O.current,{pixelWidth:ye,monoSamplesLength:ae,minFrameWidth:be}=ut;let mt=0;function tr(){mt=ee.getBoundingClientRect().left}function Ue(y){y instanceof TouchEvent&&y.preventDefault(),document.body.style.userSelect="none";const{pageX:L}=y instanceof MouseEvent?y:y.touches[0];x.current=L}function $e(y){y instanceof TouchEvent&&y.preventDefault(),document.body.style.userSelect="none";const{pageX:L}=y instanceof MouseEvent?y:y.touches[0];_.current=L}function Qe(y){if(y instanceof TouchEvent&&y.preventDefault(),y.detail===2){g();return}document.body.style.userSelect="none";const{clientX:L}=y instanceof MouseEvent?y:y.touches[0];tr();const Y=Math.max(0,Math.min(ye,L-mt)),J=Y/ye,H=Math.round(ae*J),me=H+be,de=me<ae?me:H-be;de<0||(k({trimFrames:[Math.min(H,de),ae-1-Math.max(H,de)],cursor:Y-1}),X.current=H)}function dt(y){const L=y/ye,Y=Math.round(ae*L);k(({trimFrames:J})=>{let H=J[0]+Y;return H=Math.min(H,ae-J[1]-be),H=Math.max(H,0),{trimFrames:[H,J[1]],cursor:null}})}function ft(y){if(x.current===null)return;y instanceof TouchEvent&&y.preventDefault();const{pageX:L}=y instanceof MouseEvent?y:y.touches[0],Y=L-x.current;Y&&(dt(Y),x.current=L)}function pt(y){const L=y/ye,Y=Math.round(ae*L);k(({trimFrames:J})=>{let H=J[1]+Y;return H=Math.min(H,ae-J[0]-be),H=Math.max(H,0),{trimFrames:[J[0],H],cursor:null}})}function vt(y){if(_.current===null)return;y instanceof TouchEvent&&y.preventDefault();const{pageX:L}=y instanceof MouseEvent?y:y.touches[0],Y=_.current-L;Y&&(pt(Y),_.current=L)}let Ge=!1;function fa(y){if(x.current!==null)return;let L=!0;switch(y.key){case"ArrowLeft":dt(-1);break;case"ArrowRight":dt(1);break;default:L=!1;break}L&&(y.stopPropagation(),y.preventDefault(),Ge=!0)}function pa(y){if(_.current!==null)return;let L=!0;switch(y.key){case"ArrowLeft":pt(1);break;case"ArrowRight":pt(-1);break;default:L=!1;break}L&&(y.stopPropagation(),y.preventDefault(),Ge=!0)}function ht(y){if(X.current===null)return;y instanceof TouchEvent&&y.preventDefault();const L=X.current,{clientX:Y}=y instanceof MouseEvent?y:y.touches[0],J=Math.max(0,Math.min(ye,Y-mt)),H=J/ye,me=Math.max(0,Math.min(ae-1,Math.round(ae*H)));if(me!==X.current){De.current=!0;const de=L+be,yt=L-be,bt=me>L?de<ae?Math.max(me,de):yt:yt>=0?Math.min(me,yt):de;k({trimFrames:[Math.min(L,bt),ae-1-Math.max(L,bt)],cursor:L<bt?J:J-1})}}function va(y){ft(y),vt(y),ht(y)}function z(y){(x.current!==null||_.current!==null||X.current!==null||Ge)&&((y instanceof TouchEvent||y instanceof KeyboardEvent)&&y.preventDefault(),X.current&&!De.current&&y.detail===1?oe.current=setTimeout(()=>{oe.current=null,D()},250):D(),x.current=null,_.current=null,X.current=null,De.current=!1,Ge=!1),document.body.style.userSelect="unset"}function ge(y){y.target instanceof Node&&ee.contains(y.target)||oe.current&&(clearTimeout(oe.current),oe.current=null,D())}return K.addEventListener("touchstart",Ue),K.addEventListener("mousedown",Ue),U.addEventListener("touchstart",$e),U.addEventListener("mousedown",$e),ee.addEventListener("touchstart",Qe),ee.addEventListener("mousedown",Qe),K.addEventListener("touchmove",ft),U.addEventListener("touchmove",vt),K.addEventListener("keydown",fa),U.addEventListener("keydown",pa),ee.addEventListener("touchmove",ht),window.addEventListener("mousemove",va),K.addEventListener("touchend",z),K.addEventListener("touchcancel",z),K.addEventListener("keyup",z),U.addEventListener("touchend",z),U.addEventListener("keyup",z),U.addEventListener("touchcancel",z),ee.addEventListener("touchend",z),ee.addEventListener("touchcancel",z),window.addEventListener("mouseup",z),window.addEventListener("touchstart",ge,{capture:!0}),window.addEventListener("mousedown",ge,{capture:!0}),window.addEventListener("keydown",ge,{capture:!0}),()=>{K.removeEventListener("touchstart",Ue),K.removeEventListener("mousedown",Ue),U.removeEventListener("touchstart",$e),U.removeEventListener("mousedown",$e),ee.removeEventListener("touchstart",Qe),ee.removeEventListener("mousedown",Qe),K.removeEventListener("touchmove",ft),U.removeEventListener("touchmove",vt),K.removeEventListener("keydown",fa),U.removeEventListener("keydown",pa),ee.removeEventListener("touchmove",ht),window.removeEventListener("mousemove",va),K.removeEventListener("touchend",z),K.removeEventListener("touchcancel",z),K.removeEventListener("keyup",z),U.removeEventListener("touchend",z),U.removeEventListener("keyup",z),U.removeEventListener("touchcancel",z),ee.removeEventListener("touchend",z),ee.removeEventListener("touchcancel",z),window.removeEventListener("mouseup",z),window.removeEventListener("touchstart",ge,{capture:!0}),window.removeEventListener("mousedown",ge,{capture:!0}),window.removeEventListener("keydown",ge,{capture:!0})}},[ut,D,g])}const{isPlaybackActive:v,playbackProgress:F,displayedTime:ne,togglePlayback:re,stopPlayback:V}=zt(o);Object(u.useEffect)(()=>V,[e,w,V]);const se=e.metadata.trim.frames.every(x=>x===0);return n.a.createElement(n.a.Fragment,null,n.a.createElement(Q.a.Group,{className:G.a.waveformAdjacentControls},n.a.createElement(an,{sampleId:e.id,normalize:e.metadata.normalize,onSampleUpdate:a}),n.a.createElement(T.a,{type:"button",variant:"secondary",disabled:se,onClick:g},se?"All audio selected":"Select all audio")),n.a.createElement("div",{className:[G.a.waveformContainer,v?G.a.playbackActive:""].join(" "),style:{"--cursor-display":w.cursor===null?"none":"unset","--cursor-left":`${w.cursor}px`,"--trim-pixels-left":`${P[0]}px`,"--trim-pixels-right":`${P[1]}px`}},n.a.createElement(tt,{waveformRef:p,peaks:E,scaleCoefficient:l?M:1,onResize:b}),n.a.createElement(Yt,{isPlaybackActive:v,playbackProgress:F,displayedTime:ne,downloadFilename:`${s}.volcasample.wav`,wavFile:r,togglePlayback:re}),n.a.createElement("div",{className:G.a.cursor}),n.a.createElement("div",{className:[G.a.trim,G.a.left].join(" ")},n.a.createElement("div",{className:G.a.bar}),n.a.createElement("div",{ref:N,className:G.a.handle,tabIndex:0}),m&&Boolean(f.length)&&n.a.createElement("span",{className:G.a.time},_e(m.duration*w.trimFrames[0]/f.length,2))),n.a.createElement("div",{className:[G.a.trim,G.a.right].join(" ")},n.a.createElement("div",{className:G.a.bar}),n.a.createElement("div",{ref:S,className:G.a.handle,tabIndex:0}),m&&Boolean(f.length)&&n.a.createElement("span",{className:G.a.time},_e(m.duration*(f.length-1-w.trimFrames[1])/f.length,2))),n.a.createElement("div",{ref:O,className:G.a.waveformOverlay})))}),ln=d(168),Zt=(t,e,a)=>new Promise((r,o)=>{var i=l=>{try{c(a.next(l))}catch(m){o(m)}},s=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(i,s);c((a=a.apply(t,e)).next())});let Jt;function cn(){return Zt(this,null,function*(){return typeof window.CREATE_SYRO_BINDINGS!="function"?Promise.reject("Expected CREATE_SYRO_BINDINGS global function to exist"):Jt=Jt||window.CREATE_SYRO_BINDINGS().then(t=>Zt(this,null,function*(){return{prepareSampleBufferFromWavData:t.cwrap("prepareSampleBufferFromWavData","number",["array","number","number","number","number"]),prepareSampleBufferFrom16BitPcmData(){throw new Error("This function does not work. Use prepareSampleBufferFromWavData.")},getSampleBufferChunkPointer:t.cwrap("getSampleBufferChunkPointer","number",["number"]),getSampleBufferChunkSize:t.cwrap("getSampleBufferChunkSize","number",["number"]),getSampleBufferProgress:t.cwrap("getSampleBufferProgress","number",["number"]),getSampleBufferTotalSize:t.cwrap("getSampleBufferTotalSize","number",["number"]),cancelSampleBufferWork:t.cwrap("cancelSampleBufferWork",null,["number"]),registerUpdateCallback(e){return t.addFunction(e,"vi")},unregisterUpdateCallback(e){t.removeFunction(e)},heap8Buffer(){return t.HEAP8.buffer}}}))})}var sn=(t,e,a)=>new Promise((r,o)=>{var i=l=>{try{c(a.next(l))}catch(m){o(m)}},s=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(i,s);c((a=a.apply(t,e)).next())});function un(t,e){let a=!1,r=()=>{};return{cancelWork(){a=!0,r()},sampleBufferPromise:(()=>sn(this,null,function*(){const{prepareSampleBufferFromWavData:o,getSampleBufferChunkPointer:i,getSampleBufferChunkSize:s,getSampleBufferProgress:c,getSampleBufferTotalSize:l,cancelSampleBufferWork:m,registerUpdateCallback:f,unregisterUpdateCallback:p,heap8Buffer:h}=yield cn();if(a)return new Uint8Array;const{data:E}=yield Bt(t);if(a)return new Uint8Array;let b,j=0;const M=f(k=>{if(a)return;const P=l(k);b||(b=new Uint8Array(P));const B=i(k),C=s(k),A=c(k);b.set(new Uint8Array(h(),B,C),A-C),j=A/P}),w=o(E,E.length,t.metadata.slotNumber,t.metadata.qualityBitDepth,t.metadata.useCompression?1:0,M);e(j);try{yield new Promise(k=>{let P;r=()=>{cancelAnimationFrame(P),m(w),k()},B();function B(){if(j&&(e(j),j>=1)){k();return}P=requestAnimationFrame(B)}})}finally{r=()=>{},p(M)}if(a)return new Uint8Array;if(!b)throw new Error("Unexpected condition: sampleBuffer should be defined");return b}))()}}var mn=d(87),nt=d.n(mn),dn=(t,e,a)=>new Promise((r,o)=>{var i=l=>{try{c(a.next(l))}catch(m){o(m)}},s=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(i,s);c((a=a.apply(t,e)).next())});function fn({sample:t}){const[e,a]=Object(u.useState)(0),[r,o]=Object(u.useState)(!1),[i,s]=Object(u.useState)("idle");Object(u.useLayoutEffect)(()=>{i==="transferring"&&o(!1)},[i]);const[c,l]=Object(u.useState)(null),[m,f]=Object(u.useState)(null);Object(u.useEffect)(()=>{c instanceof AudioBuffer&&m&&(f(null),m.fn())},[c,m]);const p=Object(u.useRef)(()=>{});Object(u.useEffect)(()=>{let M=!1;a(0),s("idle"),l(null),f(null),p.current=()=>{M=!0};try{const{sampleBufferPromise:w,cancelWork:k}=un(t,P=>{M||a(P)});p.current=()=>{k(),M=!0},w.then(P=>dn(this,null,function*(){if(M)return;p.current=()=>{M=!0};const B=yield Ee(P);M||l(B)}))}catch(w){console.error(w),l(new Error(String(w)))}return()=>p.current()},[t]);const{playAudioBuffer:h}=Ft(),E=Object(u.useCallback)(M=>{if(!(c instanceof AudioBuffer)){if(!c){const{target:w,nativeEvent:k}=M;f({fn:()=>w.dispatchEvent(k)})}return}try{s("transferring");const w=h(c,{onTimeUpdate:k=>a(k/c.duration)});p.current=()=>{w(),s("idle")}}catch(w){console.error(w),s("error")}},[h,c]),b=Object(u.useCallback)(()=>p.current(),[]),j=e<1;return n.a.createElement(n.a.Fragment,null,n.a.createElement(T.a,{className:nt.a.transferButton,type:"button",variant:"primary",onClick:()=>o(!0)},"Transfer to volca sample"),n.a.createElement(W.a,{onHide:()=>o(!1),className:nt.a.preTransferModal,show:r,"aria-labelledby":"pre-transfer-modal"},n.a.createElement(W.a.Header,null,n.a.createElement(W.a.Title,{id:"pre-transfer-modal"},"Connect volca sample before continuing")),n.a.createElement(W.a.Body,null,n.a.createElement("figure",null,n.a.createElement("img",{src:"connection.png",alt:""}),n.a.createElement("figcaption",{className:"small"},"Source:"," ",n.a.createElement("a",{href:"https://github.com/korginc/volcasample#6-transferring-syrostream-to-your-volca-sample",target:"_blank",rel:"noreferrer"},"KORG"))),n.a.createElement("p",null,"Make sure your ",n.a.createElement("strong",null,"headphone output")," is connected to the volca sample's ",n.a.createElement("strong",null,"SYNC IN")," and adjust your output volume to a high (but not overdriven) level. Your volca wants to hear this, but you don't.")),n.a.createElement(W.a.Footer,null,n.a.createElement(T.a,{type:"button",variant:"light",onClick:()=>o(!1)},"Cancel"),n.a.createElement(T.a,{type:"button",variant:"primary",disabled:!(c instanceof AudioBuffer),onClick:E},"Transfer now"))),n.a.createElement(W.a,{show:i!=="idle","aria-labelledby":"transfer-modal"},n.a.createElement(W.a.Header,null,n.a.createElement(W.a.Title,{id:"transfer-modal"},j?"Sample transfer in progress":"Sample transfer complete")),n.a.createElement(W.a.Body,null,i==="error"?n.a.createElement("p",null,"Something unexpected happening while transferring (on our end)."):j?n.a.createElement(n.a.Fragment,null,n.a.createElement("p",null,"Transferring ",n.a.createElement("strong",null,t.metadata.name)," to slot"," ",n.a.createElement("strong",null,t.metadata.slotNumber)," on your your volca sample. Don't disconnect anything."),n.a.createElement(ln.a,{striped:!0,animated:!0,variant:"primary",now:100*e}),n.a.createElement("div",{className:nt.a.progressAnnotation},c instanceof AudioBuffer&&Ia(c.duration*(1-e))," ","remaining")):n.a.createElement(n.a.Fragment,null,n.a.createElement("p",null,"The sample ",n.a.createElement("strong",null,t.metadata.name)," was transferred to slot"," ",n.a.createElement("strong",null,t.metadata.slotNumber)," on your volca sample. Press the ",n.a.createElement("strong",null,"[FUNC]")," button to finish."),n.a.createElement("p",null,"If everything worked, you will see ",n.a.createElement("strong",null,"[End]")," on the volca sample's display. If you see ",n.a.createElement("strong",null,"[Err]")," on the display, the transfer failed. Normally this means you need to either adjust your output volume or free up some memory on the volca sample. For more info, check out this"," ",n.a.createElement("a",{href:"https://www.korg.com/products/dj/volca_sample/faq.php",target:"_blank",rel:"noreferrer"},"FAQ")," ","from KORG."))),n.a.createElement(W.a.Footer,null,n.a.createElement(T.a,{type:"button",variant:"primary",onClick:b},j?"Cancel":"Done"))))}var qt=fn,pn=d(108),vn=d.n(pn),hn=d(32),he=d.n(hn),yn=n.a.memo(function({sampleId:e,qualityBitDepth:a,onSampleUpdate:r}){const[o,i]=Object(u.useState)(a);Object(u.useEffect)(()=>{i(a)},[a]);const s=Object(u.useCallback)(c=>{const l=Number(c.target.value);i(l)},[]);return n.a.createElement(Q.a.Group,{className:he.a.qualityBitDepthWrapper},n.a.createElement(Q.a.Label,{className:he.a.label},"Quality bit depth"),n.a.createElement("div",{className:he.a.ticks},[8,9,10,11,12,13,14,15,16].map((c,l,{length:m})=>{const f=`calc(${l*100/(m-1)}% + ${12-3*l}px)`,p=o===c;return n.a.createElement(n.a.Fragment,{key:c},n.a.createElement("label",{className:["small",he.a.tickLabel].join(" "),style:{left:f,visibility:p?"hidden":void 0},onClick:()=>r(e,{qualityBitDepth:c})},c),n.a.createElement("span",{className:he.a.tickMark,style:{left:f,visibility:p?"hidden":void 0}}))})),n.a.createElement(vn.a,{value:o,step:1,min:8,max:16,size:"lg",tooltip:"on",tooltipPlacement:"top",tooltipStyle:{zIndex:1020},onChange:s,ref:c=>c&&c.addEventListener("change",()=>{const l=Number(c.value);r(e,{qualityBitDepth:l})})}),n.a.createElement("div",{className:he.a.annotations},n.a.createElement("label",{className:"small"},"Faster transfer"),n.a.createElement("label",{className:"small"},"Higher quality")))}),ea=d(88),ta=d.n(ea),rt=d(89),ot=d(90),bn=d(23),ie=d.n(bn),aa=Math.pow;ea.Digit.defaultProps.offOpacity=0;const na=(t,e)=>Math.min(199,e+aa(10,t)),ra=(t,e)=>Math.max(0,e-aa(10,t));var oa=n.a.memo(function({slotNumber:t,onSlotNumberUpdate:e}){const[a,r]=Object(u.useState)(t);Object(u.useEffect)(()=>{r(t)},[t]);const[o,i]=Object(u.useState)(null),s=Object(u.useCallback)(f=>{e(p=>na(f,p))},[e]),c=Object(u.useCallback)(f=>{e(p=>ra(f,p))},[e]),l=Object(u.useRef)(null),m=Object(u.useRef)(null);{const f=Object(u.useRef)(o);f.current=o;const p=Object(u.useRef)(a);p.current=a,Object(u.useEffect)(()=>{if(!m.current)throw new Error("Expected elements to exist");function h(g){const N=f.current===null?0:f.current;let S=!0;const O=()=>{i(N)};switch(g.key){case"ArrowDown":O(),r(v=>ra(N,v));break;case"ArrowUp":O(),r(v=>na(N,v));break;case"ArrowLeft":O(),i(v=>v!==null&&v<2?v+1:v);break;case"ArrowRight":O(),i(v=>v&&v-1);break;case"Enter":case"Escape":i(null);break;default:S=!1;break}S&&g.preventDefault()}function E(g){const N=f.current===null?2:f.current;g.stopPropagation(),g.preventDefault();const S=p.current;if(isNaN(Number(g.key)))e(S);else{const O=String(S).padStart(3,"0").split("");O[2-N]=g.key;const v=Math.min(199,Math.max(0,Number(O.join(""))));i(N?N-1:null),e(v)}}const b=l.current;b.addEventListener("keydown",h,!0),b.addEventListener("keyup",E,!0);let j=0,M=!1,w=!1,k=0;function P(g){document.body.style.userSelect="none",j=g instanceof MouseEvent?g.pageY:g.touches[0].pageY,M=!0,w=!1,k=p.current}b.addEventListener("mousedown",P),b.addEventListener("touchstart",g=>{g.preventDefault(),P(g)});function B(g){if(!M)return;const{pageY:N}=g instanceof MouseEvent?g:g.touches[0],S=2,O=Math.round((j-N)/S);O&&(w=!0,r(Math.min(199,Math.max(0,k+O))))}window.addEventListener("mousemove",B),b.addEventListener("touchmove",B);function C(){document.body.style.userSelect="unset",M=!1,w&&e(p.current)}window.addEventListener("mouseup",C),b.addEventListener("touchend",C),b.addEventListener("touchcancel",()=>{document.body.style.userSelect="unset"});function A(g){w||m.current&&m.current.some(N=>N.contains(g.target))||i(2)}b.addEventListener("click",A),m.current.forEach((g,N)=>{const S=N;g.addEventListener("click",()=>{w||i(S)}),g.addEventListener("touchstart",O=>{O.preventDefault()})});function D(){M||i(2)}function R(){i(null)}return b.addEventListener("focus",D),b.addEventListener("blur",R),()=>{window.removeEventListener("mousemove",B),window.removeEventListener("mouseup",C)}},[e])}return Object(u.useEffect)(()=>{if(!m.current)throw new Error("Expected elements to exist");m.current.forEach((f,p)=>{p===o?f.classList.add(ie.a.active):f.classList.remove(ie.a.active)})},[o]),n.a.createElement(n.a.Fragment,null,n.a.createElement(Q.a.Label,null,"Choose destination"),n.a.createElement("br",null),n.a.createElement("div",{className:ie.a.slotNumberRow},n.a.createElement("div",{className:ie.a.slotNumberContainer},n.a.createElement("div",{className:ie.a.arrowControls},n.a.createElement("span",{onClick:()=>s(2)},n.a.createElement(rt.a,null)),n.a.createElement("span",{onClick:()=>s(1)},n.a.createElement(rt.a,null)),n.a.createElement("span",{onClick:()=>s(0)},n.a.createElement(rt.a,null))),n.a.createElement("div",{className:ie.a.slotNumber,title:`Slot ${a}`,ref:l,tabIndex:0},n.a.createElement(ta.a,{value:"8888",color:"var(--bs-gray-dark)",strokeColor:"transparent",digitCount:4}),n.a.createElement(ta.a,{ref:f=>{const p=Object(gt.findDOMNode)(f);if(p){p.querySelectorAll("circle").forEach(E=>{p.removeChild(E)});const h=document.createElementNS("http://www.w3.org/2000/svg","circle");h.classList.add(ie.a.point),h.setAttribute("cx","10.7"),h.setAttribute("cy","17"),h.setAttribute("r","1"),p.appendChild(h),m.current=[].slice.call(p.querySelectorAll("g")).reverse().slice(0,3)}},value:`5${String(a).padStart(3,"0")}`,digitProps:{color:"var(--bs-primary)"},digitCount:4})),n.a.createElement("div",{className:ie.a.arrowControls},n.a.createElement("span",{onClick:()=>c(2)},n.a.createElement(ot.a,null)),n.a.createElement("span",{onClick:()=>c(1)},n.a.createElement(ot.a,null)),n.a.createElement("span",{onClick:()=>c(0)},n.a.createElement(ot.a,null)))),t>99&&a>99&&n.a.createElement(We.a,{placement:"auto-end",overlay:n.a.createElement(Te.a,null,"To transfer to this destination, be sure you have a volca sample2. The original volca sample only supports slots 0-99.")},n.a.createElement("span",{className:ie.a.warning},n.a.createElement(Xt.a,null)))))}),gn=d(44),He=d.n(gn),En=(t,e,a)=>new Promise((r,o)=>{var i=l=>{try{c(a.next(l))}catch(m){o(m)}},s=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(i,s);c((a=a.apply(t,e)).next())});const wn=n.a.memo(function({sample:e,onSampleUpdate:a,onSampleDuplicate:r,onSampleDelete:o}){const i=Object(u.useCallback)(s=>{a(e.id,({slotNumber:c})=>({slotNumber:typeof s=="function"?s(c):s}))},[e.id,a]);return n.a.createElement(je.a,{fluid:"sm"},n.a.createElement("h2",null,e.metadata.name,n.a.createElement(Sn,{sampleId:e.id,name:e.metadata.name,sourceFileId:e.metadata.sourceFileId,userFileInfo:e.metadata.userFileInfo,onSampleUpdate:a,onSampleDuplicate:r,onSampleDelete:o})),n.a.createElement("p",null,n.a.createElement("strong",null,"Sampled:")," ",qe(new Date(e.metadata.dateSampled)),n.a.createElement("br",null),n.a.createElement("strong",null,"Updated:")," ",qe(new Date(e.metadata.dateModified))),n.a.createElement("h4",null,"Configure"),n.a.createElement(yn,{sampleId:e.id,qualityBitDepth:e.metadata.qualityBitDepth,onSampleUpdate:a}),n.a.createElement(on,{sample:e,onSampleUpdate:a}),n.a.createElement("h4",null,"Transfer"),n.a.createElement(oa,{slotNumber:e.metadata.slotNumber,onSlotNumberUpdate:i}),n.a.createElement(qt,{sample:e}))}),Sn=n.a.memo(({sampleId:t,name:e,sourceFileId:a,userFileInfo:r,onSampleUpdate:o,onSampleDuplicate:i,onSampleDelete:s})=>{const[c,l]=Object(u.useState)(!1),m=Object(u.useRef)(null),[f,p]=Object(u.useState)(e),[h,E]=Object(u.useState)(!1);Object(u.useEffect)(()=>{h&&(p(e),m.current&&m.current.select())},[h,e]);const b=f.trim(),j=Object(u.useCallback)(P=>{P.preventDefault(),b&&(o(t,{name:b}),E(!1))},[b,t,o]),M=Object(u.useCallback)(()=>i(t),[t,i]),w=Object(u.useCallback)(()=>En(void 0,null,function*(){const P=yield Z.getSourceFileData(a),B=new Blob([P],{type:r?r.type:"audio/x-wav"});Kt(B,`${e}${r?r.ext:".wav"}`)}),[e,a,r]),k=Object(u.useCallback)(P=>{P.preventDefault(),s(t),l(!1)},[t,s]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(Xa.a,{className:He.a.optionsButton,variant:"light",align:"end",title:"options"},n.a.createElement(we.a.Item,{onClick:()=>E(!0)},"Rename"),n.a.createElement(we.a.Item,{onClick:M},"Duplicate"),n.a.createElement(we.a.Item,{onClick:w},"Download source audio"),n.a.createElement(we.a.Divider,null),n.a.createElement(we.a.Item,{onClick:()=>l(!0)},"Delete")),n.a.createElement(W.a,{onHide:()=>E(!1),show:h,"aria-labelledby":"rename-modal"},n.a.createElement(Q.a,{onSubmit:j},n.a.createElement(W.a.Header,null,n.a.createElement(W.a.Title,{id:"rename-modal"},"Renaming sample")),n.a.createElement(W.a.Body,null,n.a.createElement("p",null,"Choose a new name for the sample ",n.a.createElement("strong",null,e),":"),n.a.createElement(Q.a.Control,{ref:m,defaultValue:e,onChange:P=>p(P.target.value)})),n.a.createElement(W.a.Footer,null,n.a.createElement(T.a,{type:"button",variant:"light",onClick:()=>E(!1)},"Cancel"),n.a.createElement(T.a,{type:"submit",variant:"primary",disabled:!b},"Rename")))),n.a.createElement(W.a,{onHide:()=>l(!1),show:c,"aria-labelledby":"delete-modal"},n.a.createElement(Q.a,{onSubmit:k},n.a.createElement(W.a.Header,{className:He.a.deleteModalHeader},n.a.createElement(Xt.a,null),n.a.createElement(W.a.Title,{id:"delete-modal"},"Deleting sample")),n.a.createElement(W.a.Body,null,n.a.createElement("p",null,"Are you sure you want to delete ",n.a.createElement("strong",null,e),"? This can't be undone.")),n.a.createElement(W.a.Footer,null,n.a.createElement(T.a,{type:"button",variant:"light",onClick:()=>l(!1)},"Cancel"),n.a.createElement(T.a,{type:"submit",variant:"primary"},"Delete")))))});var Cn=wn,ze=d(160),On=d(111),kn=d.n(On);function Dn({sample:t}){const{wav:e,audioBuffer:a}=Lt(t),{sample:{metadata:{name:r,normalize:o,trim:{frames:i}}},sourceAudioBuffer:s}=Tt(t),{monoSamples:c,waveformRef:l,peaks:m,onResize:f}=Ht(s),p=Object(u.useMemo)(()=>{if(!s)return 0;const k=Ie(c,i);return pe(k)},[s,c,i]),h=1/p,{isPlaybackActive:E,playbackProgress:b,displayedTime:j,togglePlayback:M,stopPlayback:w}=zt(a);return Object(u.useEffect)(()=>w,[t,w]),n.a.createElement("div",{className:kn.a.waveformContainer},n.a.createElement(tt,{waveformRef:l,peaks:m,scaleCoefficient:o?h:1,onResize:f}),n.a.createElement(Yt,{isPlaybackActive:E,playbackProgress:b,displayedTime:j,downloadFilename:`${r}.volcasample.wav`,wavFile:e,togglePlayback:M}))}var jn=Dn,An=Object.defineProperty,Pn=Object.defineProperties,Rn=Object.getOwnPropertyDescriptors,la=Object.getOwnPropertySymbols,Nn=Object.prototype.hasOwnProperty,Mn=Object.prototype.propertyIsEnumerable,ca=(t,e,a)=>e in t?An(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,Bn=(t,e)=>{for(var a in e||(e={}))Nn.call(e,a)&&ca(t,a,e[a]);if(la)for(var a of la(e))Mn.call(e,a)&&ca(t,a,e[a]);return t},Ln=(t,e)=>Pn(t,Rn(e));function In(t){const e=t.metadata.slotNumber,[a,r]=Object(u.useState)(e);return Object(u.useEffect)(()=>{r(e)},[e]),{sample:Object(u.useMemo)(()=>t&&new Z(Ln(Bn({id:t.id},t.metadata),{slotNumber:a})),[t,a]),setSlotNumber:r}}function Fn({sample:t,onSampleDuplicate:e}){const{sample:a,setSlotNumber:r}=In(t);return n.a.createElement(je.a,{fluid:"sm"},n.a.createElement("h2",null,a.metadata.name),n.a.createElement("p",null,n.a.createElement("strong",null,"Sampled:")," ",qe(new Date(a.metadata.dateSampled))),n.a.createElement(ze.a,{variant:"secondary"},n.a.createElement(ze.a.Heading,null,"This is a factory sample."),n.a.createElement("p",null,"If you want to trim the audio or adjust quality before transferring to the volca sample,"," ",n.a.createElement("span",{className:He.a.buttonLink},n.a.createElement(T.a,{variant:"link",className:He.a.duplicateButtonLink,onClick:()=>e(a.id)},"make a duplicate"),"."))),n.a.createElement("h4",null,"Preview"),n.a.createElement(jn,{sample:a}),n.a.createElement("h4",null,"Transfer"),n.a.createElement(oa,{slotNumber:a.metadata.slotNumber,onSlotNumberUpdate:r}),n.a.createElement(qt,{sample:a}))}var xn=Fn,_n=d(113),Ce=(t,e,a)=>new Promise((r,o)=>{var i=l=>{try{c(a.next(l))}catch(m){o(m)}},s=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(i,s);c((a=a.apply(t,e)).next())});let ia;function lt(){const t=Rt();return ia=ia||new t(navigator.mediaDevices.getSupportedConstraints().sampleRate?{sampleRate:Pe}:{})}function Wn(){return Ce(this,null,function*(){{const r=yield navigator.mediaDevices.getUserMedia({audio:!0,video:!1});for(const o of r.getTracks())o.stop()}const e=(yield navigator.mediaDevices.enumerateDevices()).filter(r=>r.kind==="audioinput"),a=[];for(const r of e){const o=yield navigator.mediaDevices.getUserMedia({audio:{deviceId:r.deviceId,channelCount:2},video:!1}),i=(yield navigator.mediaDevices.enumerateDevices()).find(({deviceId:c})=>r.deviceId===c).label;let s=1;{const c=o.getAudioTracks()[0],l=c.getSettings().channelCount;l?s=l:c.getCapabilities&&(s=(c.getCapabilities().channelCount||{}).max||s)}for(const c of o.getTracks())c.stop();a.push({device:{deviceId:r.deviceId,label:i},channelsAvailable:s})}return a})}let ct;function Tn(t){return Ce(this,arguments,function*({onData:e,onFinish:a}){const r=lt();ct=ct||r.audioWorklet.addModule("recorderWorkletProcessor.js"),yield ct;const o=new AudioWorkletNode(r,"recorder-worklet",{parameterData:{bufferSize:1024}});o.port.onmessage=s=>{if(s.data.eventType==="data"){const c=s.data.audioChannels;e(c)}s.data.eventType==="stop"&&a()};const i=o.parameters.get("isRecording");return i.setValueAtTime(1,r.currentTime),{recorderNode:o,stop(){i.setValueAtTime(0,r.currentTime)}}})}function Hn({channelCount:t,onData:e,onFinish:a}){const o=lt().createScriptProcessor(1024,t,t);let i=!1;return o.onaudioprocess=s=>{const c=Array(t).fill().map((l,m)=>s.inputBuffer.getChannelData(m));e(c),i&&a()},{recorderNode:o,stop(){i=!0}}}function zn(t){return Ce(this,null,function*(){return typeof AudioWorkletNode=="undefined"?Hn(t):yield Tn(t)})}function Vn(t){return Ce(this,arguments,function*({deviceId:e,channelCount:a,onStart:r,onUpdate:o}){const i=yield navigator.mediaDevices.getUserMedia({audio:{deviceId:e,channelCount:a,sampleRate:Pe,echoCancellation:!1,autoGainControl:!1,noiseSuppression:!1},video:!1}),s=lt(),c=s.createMediaStreamSource(i),{recorderNode:l,stop:m}=yield zn({channelCount:a,onData:b,onFinish:P});c.connect(l),l.connect(s.destination);const f=10;r(s.sampleRate,f);const p=f*s.sampleRate;let h=0;const E=Array(a).fill([]);function b(B){let C=0;const A=[];for(let g=0;g<a;g++){const N=B[g],S=N.length,O=N.slice(0,Math.min(S,p-h));At(O),C||(C=O.length),A.push(O)}const D=Ma(A),R=Pt(D);E.push(R),h+=C,h>=p&&m(),o(A)}let j,M;const w=new Promise((B,C)=>{j=B,M=C});let k=!1;function P(){return Ce(this,null,function*(){if(k)return;try{const A=yield new Blob(E).arrayBuffer(),D=new Float32Array(A),R=wt()({channels:a,sampleRate:s.sampleRate,bitDepth:16,dataLength:D.byteLength}),g=new Uint8Array(R.length+D.byteLength);g.set(R),g.set(new Uint8Array(D.buffer),R.length),j(g)}catch(C){M(C)}const B=i.getTracks();for(const C of B)C.stop();l.disconnect(s.destination),c.disconnect(l),k=!0})}return{stop:m,mediaRecording:w}})}var Un=d(46),Oe=d.n(Un),ke=(t,e,a)=>new Promise((r,o)=>{var i=l=>{try{c(a.next(l))}catch(m){o(m)}},s=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(i,s);c((a=a.apply(t,e)).next())});const sa="capture_device_preference";let ua=null;function $n(t,e){const a=Object(u.useRef)(JSON.parse(localStorage.getItem(sa)||"null")),[r,o]=Object(u.useState)(ua),[i,s]=Object(u.useState)(r?"ok":"pending"),[c,l]=Object(u.useState)("");Object(u.useEffect)(()=>{ua=r,s("ok")},[r]);const m=Object(u.useCallback)(()=>{let S=!1;return Wn().then(O=>{S||O.length&&(o(new Map(O.map(v=>[v.device.deviceId,v]))),l(v=>v?(a.current=null,v):a.current&&O.find(({device:F})=>a.current.deviceId===F.deviceId)?a.current.deviceId:(a.current=null,O[0].device.deviceId)))}).catch(O=>{if(!S){if(O instanceof DOMException){if(O.name==="NotAllowedError"){s("denied");return}if(O.name==="NotFoundError"){s("unavailable");return}}throw O}}),()=>{S=!0}},[]),[f,p]=Object(u.useState)(1);Object(u.useEffect)(()=>{const S=r&&r.get(c);S&&(a.current&&a.current.deviceId===S.device.deviceId&&a.current.channelCount<=S.channelsAvailable?p(a.current.channelCount):p(S.channelsAvailable),a.current=null)},[r,c]),Object(u.useEffect)(()=>{c&&localStorage.setItem(sa,JSON.stringify({deviceId:c,channelCount:f}))},[c,f]);const[h,E]=Object(u.useState)("ready"),[b,j]=Object(u.useState)(null),[M,w]=Object(u.useState)(!1);Object(u.useEffect)(()=>{h!=="ready"&&w(!1)},[h]);const k=Object(u.useCallback)(()=>{w(!1)},[]),[P,B]=Object(u.useState)({fn(S){}});Object(u.useEffect)(()=>P.fn,[P]);const[C,A]=Object(u.useState)(1/0),[D,R]=Object(u.useState)(0),g=Object(u.useCallback)(()=>ke(this,null,function*(){let S=!1;const O=(V,se)=>Vn({deviceId:V,channelCount:se,onStart:(x,_)=>{const X=_*x;A(x),R(X),E("capturing")},onUpdate:t}),v=a.current,{mediaRecording:F,stop:ne}=yield v?(()=>ke(this,null,function*(){try{return O(v.deviceId,v.channelCount)}catch(V){if(V instanceof DOMException&&V.name==="NotFoundError")return O(c,f);throw V}}))():O(c,f);B({fn(V){ne(),V&&(S=!0)}});let re;try{re=yield F}catch(V){j(V),E("error");return}if(S)E("ready");else{E("finalizing");const V=yield e(re);S||(E("ready"),V==="silent"&&w(!0))}}),[c,f,t,e]),N=Object(u.useCallback)(S=>{if(S.target.files&&S.target.files.length){const O=S.target.files[0];O.arrayBuffer().then(v=>ke(this,null,function*(){const F=new Uint8Array(v);let ne;try{ne=yield Ee(F)}catch(V){alert("Unsupported audio format detected");return}if(ne.length>10*ne.sampleRate){alert("Please select an audio file no more than 10 seconds long");return}E("finalizing");const re=yield e(F,O);E("ready"),re==="silent"&&w(!0)}))}},[e]);return{captureDevices:r,accessState:i,selectedCaptureDeviceId:c,selectedChannelCount:f,captureState:h,recordingError:b,showSilenceWarning:M,sampleRate:C,maxSamples:D,refreshCaptureDevices:m,setSelectedCaptureDeviceId:l,setSelectedChannelCount:p,beginRecording:g,stopRecording:P.fn,importFile:N,dismissSilenceWarning:k}}const it=3;function Qn({canvas:t,peaks:e,drawUntil:a,scaleCoefficient:r}){const o="#fff",i=t.getContext("2d");i.imageSmoothingEnabled=!1;const{width:s,height:c}=t;i.clearRect(0,0,s,c),i.fillStyle=o;for(let l=0;l<a&&l<e.length;l++){const m=e[l],f=c*m,p=Math.max(Math.round(r*f),2);i.fillRect(l*it,c-p,it-1,p)}}function Gn({onRecordFinish:t}){const e=Object(u.useRef)(null),a=Object(u.useRef)(0),r=Object(u.useRef)(new Float32Array),o=Object(u.useRef)(0),i=Object(u.useRef)([]),s=Object(u.useRef)(1/0),c=Object(u.useRef)(0),[l,m]=Object(u.useState)(0),f=Object(u.useCallback)(v=>ke(this,null,function*(){const F=a.current,ne=r.current,re=i.current;if(re.push(v),c.current+=v[0].length,m(Math.floor(c.current/s.current)),re.reduce((se,[{length:x}])=>se+x,0)>=F){const se=yield Promise.all(v.map((_,X)=>re.reduce((De,oe)=>[...De,oe[X]],[])).map(_=>ke(this,null,function*(){const X=yield new Blob(_).arrayBuffer();return new Float32Array(X)}))),x=se.map(_=>pe(new Float32Array(_.buffer,0,F)));ne[o.current++]=Math.max(...x),Qn({canvas:e.current,peaks:ne,drawUntil:o.current,scaleCoefficient:.3}),i.current=[se.map(_=>_.slice(F))]}}),[]),{captureDevices:p,accessState:h,selectedCaptureDeviceId:E,selectedChannelCount:b,captureState:j,recordingError:M,showSilenceWarning:w,maxSamples:k,sampleRate:P,refreshCaptureDevices:B,setSelectedCaptureDeviceId:C,setSelectedChannelCount:A,beginRecording:D,stopRecording:R,importFile:g,dismissSilenceWarning:N}=$n(f,t);s.current=P,Object(u.useEffect)(()=>{const v=e.current;v&&(v.width=v.offsetWidth,v.height=v.offsetHeight)},[h]),Object(u.useLayoutEffect)(()=>{const v=e.current;!v||(j!=="finalizing"&&v.getContext("2d").clearRect(0,0,v.width,v.height),j==="capturing"&&k&&(a.current=Math.floor(it*k/e.current.width),r.current=new Float32Array(Math.floor(k/a.current)),o.current=0,i.current=[],s.current=1/0,c.current=0,m(0)))},[k,j]);const[S,O]=Object(u.useState)(!1);return Object(u.useEffect)(()=>{S&&B()},[S,B]),n.a.createElement(je.a,{fluid:"sm",className:Oe.a.container},h==="denied"?n.a.createElement("p",null,"Looks like you didn't grant access to your audio input device. Please give Volca Sampler access, then"," ",n.a.createElement(T.a,{type:"button",variant:"secondary",onClick:B},"try again")):h==="unavailable"?n.a.createElement("p",null,"Volca Sampler couldn't find any audio input devices. Please connect one, then"," ",n.a.createElement(T.a,{type:"button",variant:"secondary",onClick:B},"try again")):n.a.createElement(n.a.Fragment,null,n.a.createElement("h2",null,"Send a new sound to your volca sample!"),w&&n.a.createElement("div",{className:Oe.a.alertContainer},n.a.createElement(ze.a,{dismissible:!0,variant:"warning",onClose:N},n.a.createElement(ze.a.Heading,null,"Your recording was totally silent."),n.a.createElement("p",null,"Check the audio input settings and your connections, then try again."))),n.a.createElement(T.a,{className:Oe.a.recordButton,type:"button",variant:"primary",size:"lg",style:{width:250},onClick:j==="capturing"?()=>R():D,disabled:j==="finalizing"},n.a.createElement("canvas",{ref:e}),n.a.createElement("span",{className:Oe.a.mainText},["capturing","finalizing"].includes(j)?"Finished recording":"Start recording"),["capturing","finalizing"].includes(j)&&n.a.createElement("span",{className:Oe.a.timeRecorded},"0:",String(l).padStart(2,"0"))),["capturing","finalizing"].includes(j)?n.a.createElement(n.a.Fragment,null,n.a.createElement(T.a,{style:{width:250},size:"sm",type:"button",variant:"secondary",onClick:()=>R(!0)},"Cancel")):n.a.createElement(n.a.Fragment,null,n.a.createElement(T.a,{style:{width:250},type:"button",variant:"light",size:"sm",onClick:()=>O(v=>!v)},"Audio input settings ",S?"\u25B2":"\u25BC"),n.a.createElement(_n.a,{in:S},n.a.createElement("div",null,n.a.createElement(Q.a.Group,null,n.a.createElement(Q.a.Label,null,"Capture Device"),n.a.createElement(Q.a.Select,{style:{width:250},value:E,onChange:v=>C(v.target.value)},p&&h==="ok"?[...p].map(([v,{device:F}])=>n.a.createElement("option",{key:v,value:v},F.label||v)):n.a.createElement("option",{value:"",disabled:!0},"Loading devices..."))),n.a.createElement(Q.a.Group,null,n.a.createElement(Q.a.Label,null,"Input channels"),n.a.createElement(Q.a.Select,{style:{width:250},value:b,onChange:v=>A(Number(v.target.value))},[1,2].map(v=>n.a.createElement("option",{key:v,value:v,disabled:!p||!p.has(E)||p.get(E).channelsAvailable<v},v===1?"Mono":"Stereo (summed to mono)")))))))),j==="error"&&M||null,n.a.createElement(T.a,{style:{width:250},type:"button",variant:"secondary",onClick:v=>{const F=v.currentTarget.querySelector("input");F&&v.target!==F&&F.click()}},"Or import an audio file",n.a.createElement("input",{hidden:!0,type:"file",accept:"audio/*,.wav,.mp3,.ogg",onChange:g})))}var Xn=Gn;const ma=["Cool","Dope","Far-out","Chill","Wicked","Bomb","Superb","Choice","Exquisite","Righteous","Dank","Alright","Very Good","Ice Cold"],da=["Sample","Cut","Quotation","Extract","Sound","Noise","Clip"];function Kn(){const t=ma[Math.floor(Math.random()*ma.length)],e=da[Math.floor(Math.random()*da.length)];return`${t} ${e}`}var Yn=d(56),Ve=d.n(Yn),Zn=(t,e,a)=>new Promise((r,o)=>{var i=l=>{try{c(a.next(l))}catch(m){o(m)}},s=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(i,s);c((a=a.apply(t,e)).next())});const st="focused_sample_id";function Jn(){const[t,e]=Object(u.useState)(new Map),[a,r]=Object(u.useState)(new Map),o=Object(u.useMemo)(()=>new Map([...t,...a]),[t,a]);Object(u.useEffect)(()=>{Aa().then(r).catch(console.error)},[]);const i=sessionStorage.getItem(st),[s,c]=Object(u.useState)(i&&typeof i=="string"?i:null);Object(u.useEffect)(()=>{s?sessionStorage.setItem(st,s):sessionStorage.removeItem(st)},[s]);const[l,m]=Object(u.useState)(!0);Object(u.useEffect)(()=>{Z.getAllFromStorage().then(C=>{e(A=>new Map([...A,...C.map(D=>[D.id,D])]))}).finally(()=>{m(!1)})},[]);const f=Object(u.useCallback)((C,A)=>Zn(this,null,function*(){const D=yield Ee(C),R=[0,0],g=yield et(D,R);if([...g.positive,...g.negative].every(F=>F===0))return"silent";const N=yield ka(C);let S="",O="";if(A){const F=A.name.lastIndexOf(".");F>0?(S=A.name.slice(0,F),O=A.name.slice(F)):S=A.name}else S=Kn();const v=new Z.Mutable({name:S,sourceFileId:N,trim:{frames:R,waveformPeaks:g},userFileInfo:A&&{type:A.type,ext:O}});return yield v.persist(),e(F=>new Map([[v.id,v],...F])),c(v.id),"saved"}),[]),p=Object(u.useCallback)((C,A)=>{e(D=>{const R=D.get(C);if(R&&R instanceof Z.Mutable){const g=R.update(A);if(g!==R)return new Map(D).set(R.id,g)}return D})},[]),h=Object(u.useRef)(o);h.current=o;const E=Object(u.useCallback)(C=>{const A=h.current.get(C);if(A){const D=A.duplicate();e(R=>new Map([[D.id,D],...R])),c(D.id)}},[]),b=Object(u.useRef)(t);b.current=t;const j=Object(u.useCallback)(C=>{const A=b.current,D=A.get(C);if(D&&D instanceof Z.Mutable){D.remove();let R=null,g=!1;for(const[,N]of A){if(g){R=N.id;break}if(N.id===C){if(!R){g=!0;continue}break}R=N.id}c(R),e(N=>{const S=new Map(N);return S.delete(D.id),S})}},[]),[M,w]=Object(u.useState)(!1),k=Object(u.useCallback)(C=>{c(C),w(!1)},[]),P=Object(u.useCallback)(()=>w(!0),[]),B=Object(u.useCallback)(()=>c(null),[]);return n.a.createElement("div",null,n.a.createElement(ga,{onMenuOpen:P,onHeaderClick:B}),n.a.createElement(Xe.a,{className:Ve.a.sidebar,show:M,onHide:()=>w(!1)},n.a.createElement(Xe.a.Header,{closeButton:!0}),n.a.createElement(Xe.a.Body,null,n.a.createElement(T.a,{className:Ve.a.newSampleButton,type:"button",variant:"primary",onClick:()=>k(null)},"New sample"),n.a.createElement(ya.a,null,l?"Loading...":null,!l&&n.a.createElement(ue.a,{defaultActiveKey:s&&a.has(s)?"factory":t.size?"user":"factory"},n.a.createElement(ue.a.Item,{eventKey:"user"},n.a.createElement(ue.a.Header,null,"Your Samples"),n.a.createElement(ue.a.Body,{style:{padding:0}},n.a.createElement(Gt,{samples:t,selectedSampleId:s,onSampleSelect:k}))),n.a.createElement(ue.a.Item,{eventKey:"factory"},n.a.createElement(ue.a.Header,null,"Factory Samples"),n.a.createElement(ue.a.Body,{style:{padding:0}},n.a.createElement(Gt,{samples:a,selectedSampleId:s,onSampleSelect:k}))))))),n.a.createElement("div",{className:Ve.a.mainLayout},n.a.createElement("div",{className:Ve.a.focusedSampleContainer},s&&(()=>{const C=o.get(s)||null;return C?C instanceof Z.Mutable?n.a.createElement(Cn,{sample:C,onSampleUpdate:p,onSampleDuplicate:E,onSampleDelete:j}):n.a.createElement(xn,{sample:C,onSampleDuplicate:E}):null})(),!s&&n.a.createElement(Xn,{onRecordFinish:f}))))}var qn=Jn,er=t=>{t&&t instanceof Function&&d.e(3).then(d.bind(null,169)).then(({getCLS:e,getFID:a,getFCP:r,getLCP:o,getTTFB:i})=>{e(t),a(t),r(t),o(t),i(t)})};Blob.prototype.arrayBuffer||(Blob.prototype.arrayBuffer=function(){return new Response(this).arrayBuffer()}),ha.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(La,null,n.a.createElement(qn,null))),document.getElementById("root")),er()},22:function(I,$,d){I.exports={titleBar:"Header_titleBar__3BLa-",menuIcon:"Header_menuIcon__swn7p",title:"Header_title__R3bRx",titleText:"Header_titleText__3e5ME",titleR:"Header_titleR__3QRgv",titleStarburst:"Header_titleStarburst__1oLYP",titleGraphic:"Header_titleGraphic__3S89F",tagline:"Header_tagline__6mYkP"}},23:function(I,$,d){I.exports={"form-switch":"SlotNumberInput_form-switch__39Wtl","form-check-input":"SlotNumberInput_form-check-input__oNf4Z",slotNumberRow:"SlotNumberInput_slotNumberRow__kQwOw",slotNumberContainer:"SlotNumberInput_slotNumberContainer__1q7P1",arrowControls:"SlotNumberInput_arrowControls__1LPAC",slotNumber:"SlotNumberInput_slotNumber__GC-i7",active:"SlotNumberInput_active__2zN4D",digitBlinkEffect:"SlotNumberInput_digitBlinkEffect__1_u8n",point:"SlotNumberInput_point__3pJD3",warning:"SlotNumberInput_warning__3NAeN"}},32:function(I,$,d){I.exports={"form-switch":"QualityBitDepthControl_form-switch__3nCZi","form-check-input":"QualityBitDepthControl_form-check-input__2KgZ8",qualityBitDepthWrapper:"QualityBitDepthControl_qualityBitDepthWrapper__2qLOe",label:"QualityBitDepthControl_label___ohmN",ticks:"QualityBitDepthControl_ticks__1u5GH",tickLabel:"QualityBitDepthControl_tickLabel__2jXRm",tickMark:"QualityBitDepthControl_tickMark__24xm0",annotations:"QualityBitDepthControl_annotations__3mXj2"}},44:function(I,$,d){I.exports={"form-switch":"SampleDetail_form-switch__31CS2","form-check-input":"SampleDetail_form-check-input__1NWgi",optionsButton:"SampleDetail_optionsButton__k0UjV",duplicateButtonLink:"SampleDetail_duplicateButtonLink__3CZZy",deleteModalHeader:"SampleDetail_deleteModalHeader__3DiKA",normalizeControlWrapper:"SampleDetail_normalizeControlWrapper__1yc_t",slotNumber:"SampleDetail_slotNumber__3sgS6",point:"SampleDetail_point__3d7qL"}},45:function(I,$,d){I.exports={playbackOverlay:"WaveformPlayback_playbackOverlay__Er0Rh",playbackActive:"WaveformPlayback_playbackActive__1IHxg",playback:"WaveformPlayback_playback__2heRw",playbackButtonContainer:"WaveformPlayback_playbackButtonContainer__Lhahe",downloadButton:"WaveformPlayback_downloadButton__2s-L5"}},46:function(I,$,d){I.exports={container:"SampleRecord_container__3bdq5",alertContainer:"SampleRecord_alertContainer__vjGNP",recordButton:"SampleRecord_recordButton__3R-KX",mainText:"SampleRecord_mainText__2dca6",timeRecorded:"SampleRecord_timeRecorded__3FGTe"}},56:function(I,$,d){I.exports={"form-switch":"App_form-switch__3Ht4D","form-check-input":"App_form-check-input__19Z6o",mainLayout:"App_mainLayout__3UKwp",sidebar:"App_sidebar__3IISB",newSampleButton:"App_newSampleButton__3OaZl",focusedSampleContainer:"App_focusedSampleContainer__1lol8"}},8:function(I,$,d){I.exports={"form-switch":"WaveformEdit_form-switch__2DZid","form-check-input":"WaveformEdit_form-check-input__2TImp",waveformAdjacentControls:"WaveformEdit_waveformAdjacentControls__12b8z",waveformContainer:"WaveformEdit_waveformContainer__Qq3MI",cursor:"WaveformEdit_cursor__1Ntb3",trim:"WaveformEdit_trim__1GV76",playbackActive:"WaveformEdit_playbackActive__hTwgX",bar:"WaveformEdit_bar__1KFgt",handle:"WaveformEdit_handle__23NoG",time:"WaveformEdit_time__YX5rg",left:"WaveformEdit_left__3Jfpn",right:"WaveformEdit_right__35CjW",waveformOverlay:"WaveformEdit_waveformOverlay__3oZfw"}},86:function(I,$,d){I.exports={listWaveform:"SampleList_listWaveform__11RYh",listItem:"SampleList_listItem__1w0uC",active:"SampleList_active__4LCL3"}},87:function(I,$,d){I.exports={"form-switch":"VolcaTransferControl_form-switch__1ZS81","form-check-input":"VolcaTransferControl_form-check-input__REQsM",transferButton:"VolcaTransferControl_transferButton__11MBQ",preTransferModal:"VolcaTransferControl_preTransferModal__fLiiV",progressAnnotation:"VolcaTransferControl_progressAnnotation__2zJ9A"}}},[[150,1,2]]]);

//# sourceMappingURL=main.0e164995.chunk.js.map