(this["webpackJsonpvolca-sampler"]=this["webpackJsonpvolca-sampler"]||[]).push([[0],{112:function(T,z,g){"use strict";g.r(z);var d=g(0),l=g.n(d),we=g(9),ot=g.n(we),Aa=g(80),Ma=g(81),J=g(22),lt=g(23),U=g.n(lt);function ct({onMenuOpen:e,onHeaderClick:a}){return l.a.createElement("h1",{className:U.a.title,onClick:a},l.a.createElement("span",{className:U.a.menuIcon,onClick:t=>{t.stopPropagation(),e()}},"\u2630"),l.a.createElement("span",{className:U.a.titleText,"data-text":"Volca Sample"},"Volca Sample",l.a.createElement("span",{className:U.a.titleR},"r"),l.a.createElement("div",{className:U.a.titleStarburst},Array(24).fill().map((t,n,{length:o})=>l.a.createElement("span",{key:n,style:{"--rotation":`${n*360/o}deg`}})))),l.a.createElement("img",{className:U.a.titleGraphic,src:"volca_sample.png",alt:""}),l.a.createElement("svg",{width:0,height:0},l.a.createElement("filter",{id:"outline"},l.a.createElement("feMorphology",{in:"SourceAlpha",result:"DILATED",operator:"dilate",radius:"1"}),l.a.createElement("feFlood",{floodColor:"var(--stroke-color)",floodOpacity:"1",result:"PINK"}),l.a.createElement("feComposite",{in:"PINK",in2:"DILATED",operator:"in",result:"OUTLINE"}),l.a.createElement("feMerge",null,l.a.createElement("feMergeNode",{in:"OUTLINE"}),l.a.createElement("feMergeNode",{in:"SourceGraphic"})))))}var it=ct,Z=g(124),st=g(46),Ce=g.n(st),ut=g(39),q=g.n(ut),Oe=g(125),Pe=g(61);const ee=31250;var dt=Object.defineProperty,ft=Object.defineProperties,mt=Object.getOwnPropertyDescriptors,te=Object.getOwnPropertySymbols,De=Object.prototype.hasOwnProperty,Ae=Object.prototype.propertyIsEnumerable,se=(e,a,t)=>a in e?dt(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,L=(e,a)=>{for(var t in a||(a={}))De.call(a,t)&&se(e,t,a[t]);if(te)for(var t of te(a))Ae.call(a,t)&&se(e,t,a[t]);return e},K=(e,a)=>ft(e,mt(a)),Me=(e,a)=>{var t={};for(var n in e)De.call(e,n)&&a.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&te)for(var n of te(e))a.indexOf(n)<0&&Ae.call(e,n)&&(t[n]=e[n]);return t},ae=(e,a,t)=>(se(e,typeof a!="symbol"?a+"":a,t),t),N=(e,a,t)=>new Promise((n,o)=>{var c=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(c,i);s((t=t.apply(e,a)).next())});const ne=q.a.createInstance({name:"audio_file_data",driver:q.a.INDEXEDDB}),re=q.a.createInstance({name:"sample_metadata",driver:q.a.INDEXEDDB});function pt(e){return N(this,null,function*(){const a=Object(Oe.a)();return yield ne.setItem(a,e),a})}const ue="0.3.0",ht={"0.1.0":e=>{const a=e,{clip:t}=a,n=Me(a,["clip"]);return K(L({},n),{trimFrames:t.map(c=>Math.round(c*ee)),metadataVersion:"0.2.0"})},"0.2.0":e=>N(void 0,null,function*(){const a=e,{trimFrames:t}=a,n=Me(a,["trimFrames"]),o=yield ze(n.sourceFileId,t),c={frames:t,waveformPeaks:o};return K(L({},n),{trim:c,metadataVersion:"0.3.0"})})};function vt(e){return N(this,null,function*(){let a=e;for(;a.metadataVersion!==ue;){const t=ht[e.metadataVersion];if(!t){console.warn(`Failed to properly upgrade metadata for sample "${a.name}"`),a={name:a.name,sourceFileId:a.sourceFileId,id:a.id,metadataVersion:ue};break}a=yield t(a)}return a})}const X=class{constructor({name:e,sourceFileId:a,trim:t,id:n=Object(Oe.a)(),userFileInfo:o=null,slotNumber:c=0,dateSampled:i=Date.now(),dateModified:s=i,useCompression:r=!0,qualityBitDepth:u=16,scaleCoefficient:w=1}){this.id=n,this.metadata={name:e,sourceFileId:a,trim:t,userFileInfo:o,slotNumber:c,dateSampled:i,dateModified:s,useCompression:r,qualityBitDepth:u,scaleCoefficient:w,metadataVersion:ue}}duplicate(){const e=new X.Mutable(K(L({},this.metadata),{name:`${this.metadata.name} (copy)`,dateModified:Date.now()}));return e.persist(),e}static cacheSourceFileData(e,a){this.sourceFileData.set(e,a),this.recentlyCachedSourceFileIds=[e,...this.recentlyCachedSourceFileIds.filter(n=>n!==e)];const t=this.recentlyCachedSourceFileIds.slice(this.MAX_CACHED);for(const n of t)this.sourceFileData.delete(n);this.recentlyCachedSourceFileIds=this.recentlyCachedSourceFileIds.slice(0,this.MAX_CACHED)}static getSourceFileData(e){return N(this,null,function*(){{const t=this.sourceFileData.get(e);if(t)return t}if(e.includes(".")){const t=yield fetch(e);if(t.status>=400)return Promise.reject(new Error(`Failed to fetch source file "${e}"`));const n=yield t.arrayBuffer(),o=new Uint8Array(n);return this.cacheSourceFileData(e,o),o}const a=yield ne.getItem(e);return a?a instanceof Uint8Array?(this.cacheSourceFileData(e,a),a):Promise.reject("Source data is of unexpected type"):Promise.reject("Missing source data")})}static getAllMetadataFromStore(){return N(this,null,function*(){const e=new Map,a=[];return yield re.iterate((t,n)=>{t&&a.push(vt(t).then(o=>{e.set(n,o)}).catch(o=>{console.error(o),console.warn(`Failed to upgrade metadata "${n}" (${t.name}); ignoring.`)}))}),yield Promise.all(a),e})}static getAllFromStorage(){return N(this,null,function*(){const e=yield this.getAllMetadataFromStore(),a=yield Be(),t=(yield ne.keys()).concat(a.map(({sourceFileId:o})=>o));return[...e].map(([o,c])=>{const{sourceFileId:i}=c;return t.includes(i)?new X.Mutable(L({id:o},c)):(console.warn(`Found metadata "${c.name||o}" with missing data "${i}; ignoring.`),null)}).filter(Boolean).sort((o,c)=>c.metadata.dateModified-o.metadata.dateModified)})}};let x=X;ae(x,"Mutable",class extends X{constructor(e){super(e);setTimeout(()=>N(this,null,function*(){(yield re.keys()).includes(this.id)||console.warn(`Expected sample metadata container ${this.id} to be persisted`)}))}persist(){return N(this,null,function*(){yield re.setItem(this.id,this.metadata)})}update(e){const{id:a,metadata:t}=this,n=typeof e=="function"?e(t):e;if(Object.keys(n).every(i=>n[i]===t[i]))return this;const o=K(L(L({},t),n),{dateModified:Date.now()}),c=new X.Mutable(L({id:a},o));return c.persist(),c}remove(){return N(this,null,function*(){if(yield re.removeItem(this.id),this.metadata.sourceFileId.includes("."))return;const e=yield X.getAllMetadataFromStore();for(const[,{sourceFileId:a}]of e)if(a===this.metadata.sourceFileId)return;yield ne.removeItem(this.metadata.sourceFileId)})}}),ae(x,"sourceFileData",new Map),ae(x,"recentlyCachedSourceFileIds",[]),ae(x,"MAX_CACHED",10);let de;function Be(){return de||(de=fetch("factory-samples.json").then(e=>e.json())),de}function yt(){return N(this,null,function*(){const e=yield Be();return new Map(e.map(a=>[a.id,new x(K(L({},a),{trim:{frames:[a.trim.frames[0],a.trim.frames[1]],waveformPeaks:{positive:new Float32Array(Object(Pe.a)(a.trim.waveformPeaks.positive)),negative:new Float32Array(Object(Pe.a)(a.trim.waveformPeaks.negative))}}}))]))})}var je=Math.pow,fe=(e,a,t)=>new Promise((n,o)=>{var c=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(c,i);s((t=t.apply(e,a)).next())});function me(e,a){const t=4,n=a[0]*t,o=e.length-a[0]-a[1];return new Float32Array(e.buffer,n,o)}function pe(e,a){const t=e.length-a[0]-a[1],n=new Float32Array(t),o=Array(e.numberOfChannels).fill().map((c,i)=>me(e.getChannelData(i),a));for(let c=0;c<t;c++){let i=0;for(let s=0;s<o.length;s++)i+=o[s][c];i/=o.length,n[c]=i}return n}function Re(e){let a=0;for(const t of e){const n=Math.abs(t);n>a&&(a=n)}return a}function gt(e,a){if(a!==1)for(let t=0;t<e.length;t++)e[t]*=a}function bt(e,a){const t=je(2,a-1);for(let n=0;n<e.length;n++)e[n]=Math.round(e[n]*t)/t}function ke(e){for(let a=0;a<e.length;a++)e[a]>1?e[a]=1:e[a]<-1&&(e[a]=-1)}function St(e){const a=e.length,t=e[0].length,n=new Float32Array(a*t);for(let o=0;o<n.length;o++){const c=a*o;for(let i=0;i<a;i++)n[c+i]=e[i][o]}return n}function Ie(e){const a=new Int16Array(e.length),t=je(2,15);for(let n=0;n<e.length;n++)a[n]=e[n]===1?t-1:t*e[n];return a}function xe(){return window.AudioContext||window.webkitAudioContext}let Fe;function Ne(){const e=xe();return Fe=Fe||new e({sampleRate:ee})}function oe(e){return fe(this,null,function*(){const a=new Uint8Array(e);return yield new Promise((n,o)=>{Ne().decodeAudioData(a.buffer,n,o)})})}function he(e,a){return fe(this,null,function*(){const t=yield x.getSourceFileData(e),n=yield oe(t);if(a)for(let o=0;o<n.numberOfChannels;o++)ke(n.getChannelData(o));return n})}function Te(e){return fe(this,null,function*(){const{qualityBitDepth:a,sourceFileId:t,userFileInfo:n,scaleCoefficient:o,trim:{frames:c}}=e.metadata;if(a<8||a>16||!Number.isInteger(a))throw new Error(`Expected bit depth between 8 and 16. Received: ${a}`);const i=yield he(t,Boolean(n)),s=i.numberOfChannels===1?me(i.getChannelData(0),c):pe(i,c);o!==1&&gt(s,o),a<16&&bt(s,a);const r=Ie(s),u=r.length*2,w=Ce()({channels:1,sampleRate:i.sampleRate,bitDepth:16,dataLength:u}),b=new Uint8Array(w.length+u);return b.set(w),b.set(new Uint8Array(r.buffer),w.length),{data:b,sampleRate:16}})}const Et={playAudioBuffer(e,a){throw new Error("Must render AudioPlaybackContextProvider")},isAudioBusy:!1},Le=Object(d.createContext)(Et);function wt({children:e}){const[a,t]=Object(d.useState)(!1),n=Object(d.useCallback)((c,{onTimeUpdate:i=()=>null,onEnded:s=()=>null}={})=>{if(a)throw new Error("Wait until audio playback has finished to start new playback");t(!0);let r,u;try{r=Ne(),u=r.createBufferSource(),u.buffer=c,u.connect(r.destination),u.start()}catch(v){throw t(!1),v}const w=r.currentTime;i(0);let b=requestAnimationFrame(S);function S(){i(r.currentTime-w),b=requestAnimationFrame(S)}let h=!1;return u.addEventListener("ended",()=>{h||(i(c.duration),s()),t(!1),cancelAnimationFrame(b)}),function(){u.stop(),h=!0}},[a]),o=Object(d.useMemo)(()=>({playAudioBuffer:n,isAudioBusy:a}),[n,a]);return Object(d.createElement)(Le.Provider,{value:o},e)}function We(){return Object(d.useContext)(Le)}var Ct=(e,a,t)=>new Promise((n,o)=>{var c=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(c,i);s((t=t.apply(e,a)).next())});const $=6,He=$*44;function Ve(e,a){const t=Math.floor($*e.length/a),n=new Float32Array(Math.floor(e.length/t)),o=new Float32Array(Math.floor(e.length/t));for(let c=0;c<n.length;c++){const i=new Float32Array(e.buffer,c*t*4,t);let s=0,r=0;for(const u of i)u>s&&(s=u),u<r&&(r=u);n[c]=Math.min(1,s),o[c]=Math.max(-1,r)}return{positive:n,negative:o}}function ze(e,a){return Ct(this,null,function*(){const t=yield he(e,!1),n=pe(t,a);return Ve(n,He)})}var Ot=g(70);const Pt=J.a.canvas({width:"100%",height:"100%",display:"block",imageRendering:"pixelated"});function Dt(e,a){function t(o,c){e.width=o,e.height=c}t(e.offsetWidth,e.offsetHeight),a({width:e.offsetWidth,height:e.offsetHeight});const n=new Ot.a(([o])=>{const{width:c,height:i}=o.contentRect;t(c,i),a({width:c,height:i})});return n.observe(e),()=>n.disconnect()}function At(e,a,t){const n=getComputedStyle(document.documentElement),o=n.getPropertyValue("--bs-primary"),c=n.getPropertyValue("--bs-primary-darkened"),i=e.getContext("2d");i.imageSmoothingEnabled=!1;const{width:s,height:r}=e;i.clearRect(0,0,s,r);const u=Math.floor(r*(2/3))+1;i.fillStyle=o,a.positive.forEach((b,S)=>{const h=u*b,v=Math.max(Math.round(t*h),1);i.fillRect(S*$,u-v,$-1,v)});const w=r-u;i.fillStyle=c,a.negative.forEach((b,S)=>{const h=w*b*-1,v=Math.round(t*h);i.fillRect(S*$,u,$-1,v)})}function Mt({peaks:e,scaleCoefficient:a,waveformRef:t}){const n=Object(d.useRef)(null);Object(d.useImperativeHandle)(t,()=>n.current);const[o,c]=Object(d.useState)(Symbol()),i=Object(d.useRef)({width:0,height:0});return Object(d.useLayoutEffect)(()=>{if(!n.current)throw new Error("Canvas should be defined");return i.current.width=n.current.offsetWidth,i.current.height=n.current.offsetHeight,Dt(n.current,({width:s,height:r})=>{(s!==i.current.width||r!==i.current.height)&&(c(Symbol()),i.current.width=s,i.current.height=r)})},[]),Object(d.useLayoutEffect)(()=>{const s=n.current;if(!s)throw new Error("Canvas should be defined");let r=requestAnimationFrame(()=>{r=requestAnimationFrame(()=>{At(s,e,a)})});return()=>cancelAnimationFrame(r)},[e,a,o]),l.a.createElement(Pt,{ref:n})}var Ue=Mt;const Bt=J.a.div({width:`${He}px`,height:"40px"}),Xe=typeof IntersectionObserver!="undefined",jt=l.a.memo(({sample:e,selected:a,onSampleSelect:t})=>{const n=Object(d.useRef)(null),[o,c]=Object(d.useState)(!Xe);return Object(d.useLayoutEffect)(()=>{if(!Xe)return;const i=n.current;if(!i)throw new Error("Waveform container should be defined");const s=i.getBoundingClientRect();if(s.top+s.height>=0&&s.bottom-s.height<=window.innerHeight){c(!0);return}const r=new IntersectionObserver(([u])=>{u.isIntersecting&&(c(!0),r.unobserve(i))});return r.observe(i),()=>r.disconnect()},[]),l.a.createElement(Z.a.Item,{active:a,onClick:()=>t(e.id)},l.a.createElement("div",null,e.metadata.name),l.a.createElement(Bt,{ref:n},o&&l.a.createElement(Ue,{peaks:e.metadata.trim.waveformPeaks,scaleCoefficient:e.metadata.scaleCoefficient})))});function Rt({samples:e,selectedSampleId:a,onSampleSelect:t}){return l.a.createElement(Z.a,{variant:"flush"},[...e].map(([n,o])=>l.a.createElement(jt,{key:n,sample:o,selected:n===a,onSampleSelect:t})))}var $e=Rt,Ge=g(57),Ke=g.n(Ge),kt=g(119),It=g(120),le=g(74),k=g(71),I=g(122),xt=Object.defineProperty,Ft=Object.defineProperties,Nt=Object.getOwnPropertyDescriptors,ce=Object.getOwnPropertySymbols,_e=Object.prototype.hasOwnProperty,Qe=Object.prototype.propertyIsEnumerable,Ye=(e,a,t)=>a in e?xt(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,Tt=(e,a)=>{for(var t in a||(a={}))_e.call(a,t)&&Ye(e,t,a[t]);if(ce)for(var t of ce(a))Qe.call(a,t)&&Ye(e,t,a[t]);return e},Lt=(e,a)=>Ft(e,Nt(a)),Wt=(e,a)=>{var t={};for(var n in e)_e.call(e,n)&&a.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&ce)for(var n of ce(e))a.indexOf(n)<0&&Qe.call(e,n)&&(t[n]=e[n]);return t},Ht=(e,a,t)=>new Promise((n,o)=>{var c=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(c,i);s((t=t.apply(e,a)).next())});function Vt({sourceAudioBuffer:e,sample:{metadata:{trim:{frames:a},scaleCoefficient:t}},onSetTrimFrames:n,onSetScaleCoefficient:o}){const c=Object(d.useMemo)(()=>e?pe(e,[0,0]):new Float32Array,[e]),[i,s]=Object(d.useState)(null),r=Object(d.useMemo)(()=>i&&i.offsetWidth,[i]),u=Object(d.useMemo)(()=>!r||!c.length?{positive:new Float32Array,negative:new Float32Array}:Ve(c,r),[r,c]),w=Object(d.useMemo)(()=>{if(!e)return 0;const f=me(c,a);return Re(f)},[e,c,a]),b=1/w;Object(d.useLayoutEffect)(()=>{t>b&&o(b)},[t,b,o]);const S=Object(d.useMemo)(()=>{if(!c.length||!r)return[0,0];const f=r/c.length;return a.map(m=>m*f)},[r,c.length,a]),h=Object(d.useRef)(null),v=Object(d.useRef)(null);return Object(d.useEffect)(()=>{function f(p){if(h.current===null||!r||!c.length)return;const{pageX:C}=p,P=C-h.current;if(P){const D=P/r,E=Math.round(c.length*D);n(A=>{let O=A[0]+E;return O=Math.min(O,c.length-A[1]-2e3),O=Math.max(O,0),[O,A[1]]}),h.current=C}}function m(){h.current=null,document.body.style.userSelect="unset"}return window.addEventListener("mousemove",f),window.addEventListener("mouseup",m),()=>{window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",m)}},[r,c.length,n]),Object(d.useEffect)(()=>{function f(p){if(v.current===null||!r||!c.length)return;const{pageX:C}=p,P=v.current-C;if(P){const D=P/r,E=Math.round(c.length*D);n(A=>{let O=A[1]+E;return O=Math.min(O,c.length-A[0]-2e3),O=Math.max(O,0),[A[0],O]}),v.current=C}}function m(){v.current=null,document.body.style.userSelect="unset"}return window.addEventListener("mousemove",f),window.addEventListener("mouseup",m),()=>{window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",m)}},[r,c.length,n]),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{style:{position:"relative"}},l.a.createElement("div",{style:{position:"absolute",right:0,bottom:4}},l.a.createElement(k.a,{type:"button",variant:"light",disabled:t===b,onClick:()=>o(b)},"Normalize")," ",l.a.createElement(k.a,{type:"button",variant:"light",disabled:t===1,onClick:()=>o(1)},"Original level"))),l.a.createElement("div",{style:{position:"relative",backgroundColor:"#f3f3f3"}},l.a.createElement(Ue,{waveformRef:s,peaks:u,scaleCoefficient:t}),l.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,left:0,right:`calc(100% - ${S[0]}px)`,background:"#f3f3f3"}},l.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,right:0,width:2,background:"var(--bs-dark)"}}),l.a.createElement("div",{style:{position:"absolute",top:"100%",right:0,width:20,height:20,background:"var(--bs-dark)",borderRadius:10,transform:"translateX(50%)"},onTouchStart:f=>{f.preventDefault(),document.body.style.userSelect="none",h.current=f.touches[0].pageX},onMouseDown:f=>{document.body.style.userSelect="none",h.current=f.pageX},onTouchMove:f=>{if(f.preventDefault(),h.current===null||!r||!c.length)return;const{pageX:m}=f.touches[0],p=m-h.current;if(p){const C=p/r,P=Math.round(c.length*C);n(D=>{let E=D[0]+P;return E=Math.min(E,c.length-D[1]-2e3),E=Math.max(E,0),[E,D[1]]}),h.current=m}},onTouchEnd:()=>{h.current=null},onTouchCancel:()=>{h.current=null}})),l.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,right:0,left:`calc(100% - ${S[1]}px)`,background:"#f3f3f3"}},l.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,left:0,width:2,background:"var(--bs-dark)"}}),l.a.createElement("div",{style:{position:"absolute",top:"100%",left:0,width:20,height:20,background:"var(--bs-dark)",borderRadius:10,transform:"translateX(-50%)"},onTouchStart:f=>{f.preventDefault(),document.body.style.userSelect="none",v.current=f.touches[0].pageX},onMouseDown:f=>{document.body.style.userSelect="none",v.current=f.pageX},onTouchMove:f=>{if(f.preventDefault(),v.current===null||!r||!c.length)return;const{pageX:m}=f.touches[0],p=v.current-m;if(p){const C=p/r,P=Math.round(c.length*C);n(D=>{let E=D[1]+P;return E=Math.min(E,c.length-D[0]-2e3),E=Math.max(E,0),[D[0],E]}),v.current=m}},onTouchEnd:()=>{v.current=null},onTouchCancel:()=>{v.current=null}}))))}function zt(e){var a=e,{sample:t}=a,n=Wt(a,["sample"]);const[o,c]=Object(d.useState)(null);Object(d.useEffect)(()=>{let s=!1;return(()=>Ht(this,null,function*(){if(s)return;const r=yield he(t.metadata.sourceFileId,Boolean(t.metadata.userFileInfo));s||c([t.metadata.sourceFileId,r])}))(),()=>{s=!0}},[t.metadata.sourceFileId,t.metadata.userFileInfo]);const i=Object(d.useRef)(t);return o&&t.metadata.sourceFileId===o[0]&&(i.current=t),l.a.createElement(Vt,Lt(Tt({},n),{sample:i.current,sourceAudioBuffer:o&&o[1]}))}var Ut=zt,Xt=g(126),$t=(e,a,t)=>new Promise((n,o)=>{var c=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(c,i);s((t=t.apply(e,a)).next())});let Je;function Gt(){return $t(this,null,function*(){if(typeof window.CREATE_SYRO_BINDINGS!="function")return Promise.reject("Expected CREATE_SYRO_BINDINGS global function to exist");const e=yield window.CREATE_SYRO_BINDINGS();return Je=Je||new Promise((a,t)=>{let n;try{n={prepareSampleBufferFromWavData:e.cwrap("prepareSampleBufferFromWavData","number",["array","number","number","number","number"]),prepareSampleBufferFrom16BitPcmData(){throw new Error("This function does not work. Use prepareSampleBufferFromWavData.")},getSampleBufferChunkPointer:e.cwrap("getSampleBufferChunkPointer","number",["number"]),getSampleBufferChunkSize:e.cwrap("getSampleBufferChunkSize","number",["number"]),getSampleBufferProgress:e.cwrap("getSampleBufferProgress","number",["number"]),getSampleBufferTotalSize:e.cwrap("getSampleBufferTotalSize","number",["number"]),cancelSampleBufferWork:e.cwrap("cancelSampleBufferWork",null,["number"]),registerUpdateCallback(o){return e.addFunction(o,"vi")},unregisterUpdateCallback(o){e.removeFunction(o)},heap8Buffer(){return e.HEAP8.buffer}}}catch(o){t(o);return}a(n)})})}var Kt=(e,a,t)=>new Promise((n,o)=>{var c=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(c,i);s((t=t.apply(e,a)).next())});function _t(e,a){let t=!1,n=()=>{};return{cancelWork(){t=!0,n()},sampleBufferPromise:(()=>Kt(this,null,function*(){const{prepareSampleBufferFromWavData:o,getSampleBufferChunkPointer:c,getSampleBufferChunkSize:i,getSampleBufferProgress:s,getSampleBufferTotalSize:r,cancelSampleBufferWork:u,registerUpdateCallback:w,unregisterUpdateCallback:b,heap8Buffer:S}=yield Gt();if(t)return new Uint8Array;const{data:h}=yield Te(e);if(t)return new Uint8Array;let v,f=0;const m=w(C=>{if(t)return;const P=r(C);v||(v=new Uint8Array(P));const D=c(C),E=i(C),A=s(C);v.set(new Uint8Array(S(),D,E),A-E),f=A/P}),p=o(h,h.length,e.metadata.slotNumber,e.metadata.qualityBitDepth,e.metadata.useCompression?1:0,m);a(f);try{yield new Promise(C=>{let P;n=()=>{cancelAnimationFrame(P),u(p),C()},D();function D(){if(f&&(a(f),f>=1)){C();return}P=requestAnimationFrame(D)}})}finally{n=()=>{},b(m)}if(t)return new Uint8Array;if(!v)throw new Error("Unexpected condition: sampleBuffer should be defined");return v}))()}}var Qt=(e,a,t)=>new Promise((n,o)=>{var c=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(c,i);s((t=t.apply(e,a)).next())});function Yt({sample:e}){const[a,t]=Object(d.useState)(0),[n,o]=Object(d.useState)("idle"),[c,i]=Object(d.useState)(null),[s,r]=Object(d.useState)(null);Object(d.useEffect)(()=>{c instanceof AudioBuffer&&s&&(r(null),s.fn())},[c,s]);const u=Object(d.useRef)(()=>{});Object(d.useEffect)(()=>{let S=!1;t(0),o("idle"),i(null),r(null),u.current=()=>{S=!0};try{const{sampleBufferPromise:h,cancelWork:v}=_t(e,f=>{S||t(f)});u.current=()=>{v(),S=!0},h.then(f=>Qt(this,null,function*(){if(S)return;u.current=()=>{S=!0};const m=yield oe(f);S||i(m)}))}catch(h){console.error(h),i(new Error(String(h)))}return()=>u.current()},[e]);const{playAudioBuffer:w,isAudioBusy:b}=We();return l.a.createElement(l.a.Fragment,null,l.a.createElement(k.a,{type:"button",variant:"primary",onClick:S=>{if(!(c instanceof AudioBuffer)){if(!c){const h=S.currentTarget;r({fn:()=>h.click()})}return}try{o("transferring");const h=w(c,{onTimeUpdate:v=>t(v/c.duration),onEnded:()=>o("idle")});u.current=()=>{h(),o("idle")}}catch(h){console.error(h),o("error")}},disabled:b||c instanceof Error||n==="transferring"},"Transfer to volca sample"),l.a.createElement("br",null),c&&n==="idle"?null:n==="error"?"Error transferring":l.a.createElement(l.a.Fragment,null,l.a.createElement("p",null,c?c instanceof AudioBuffer?"Transferring to Volca Sample...":"Error preparing sample for transfer":"Preparing sample for transfer..."),l.a.createElement(Xt.a,{now:100*a}),l.a.createElement("br",null),l.a.createElement(k.a,{type:"button",variant:"light",onClick:()=>u.current()},"Cancel")),l.a.createElement("br",null))}var Jt=Yt,Zt=g(40),ie=g.n(Zt),qt=Object.defineProperty,ea=Object.defineProperties,ta=Object.getOwnPropertyDescriptors,Ze=Object.getOwnPropertySymbols,aa=Object.prototype.hasOwnProperty,na=Object.prototype.propertyIsEnumerable,qe=(e,a,t)=>a in e?qt(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,et=(e,a)=>{for(var t in a||(a={}))aa.call(a,t)&&qe(e,t,a[t]);if(Ze)for(var t of Ze(a))na.call(a,t)&&qe(e,t,a[t]);return e},tt=(e,a)=>ea(e,ta(a)),ra=(e,a,t)=>new Promise((n,o)=>{var c=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(c,i);s((t=t.apply(e,a)).next())});Ge.Digit.defaultProps.offOpacity=0;function oa(e,a){const t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=a,n.style.display="none",document.body.appendChild(n),n.click(),n.remove(),URL.revokeObjectURL(t)}function la({sample:e,onSampleUpdate:a,onSampleDuplicate:t,onSampleDelete:n}){const o=e&&e.id,c=Object(d.useCallback)(m=>o&&a(o,{scaleCoefficient:m}),[o,a]),i=Object(d.useCallback)(m=>o&&a(o,p=>tt(et({},p),{trim:tt(et({},p.trim),{frames:m(p.trim.frames)})})),[o,a]),[s,r]=Object(d.useState)(null),[u,w]=Object(d.useState)(null),[b,S]=Object(d.useState)(null);Object(d.useEffect)(()=>{u instanceof AudioBuffer&&b&&(S(null),b.fn())},[u,b]),Object(d.useEffect)(()=>{if(r(null),S(null),e){let m=!1;Te(e).then(({data:p})=>{m||r(p)})}},[e]),Object(d.useEffect)(()=>{if(w(null),s){let m=!1;oe(s).then(p=>{m||w(p)})}},[s]);const{playAudioBuffer:h,isAudioBusy:v}=We(),f=Object(d.useRef)(()=>{});return Object(d.useEffect)(()=>()=>f.current(),[e]),e?l.a.createElement(kt.a,{fluid:"sm"},l.a.createElement("h2",null,e.metadata.name,l.a.createElement(It.a,{style:{display:"inline-block",float:"right"},variant:"light",align:"end",title:"options"},l.a.createElement(le.a.Item,{onClick:()=>{const m=prompt(`Choose a new name for the sample "${e.metadata.name}":`,e.metadata.name),p=m&&m.trim();p&&a(e.id,{name:p})}},"Rename"),l.a.createElement(le.a.Item,{onClick:()=>t(e.id)},"Duplicate"),l.a.createElement(le.a.Divider,null),l.a.createElement(le.a.Item,{onClick:()=>{window.confirm(`Are you sure you want to delete ${e.metadata.name}?`)&&n(e.id)}},"Delete"))),l.a.createElement("p",null,l.a.createElement("strong",null,"Sampled:")," ",new Date(e.metadata.dateSampled).toLocaleString(),l.a.createElement("br",null),l.a.createElement("strong",null,"Updated:")," ",new Date(e.metadata.dateModified).toLocaleString()),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("div",{className:ie.a.waveformContainer},l.a.createElement(Ut,{onSetTrimFrames:i,onSetScaleCoefficient:c,sample:e})),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement(k.a,{type:"button",variant:"secondary",size:"sm",onClick:m=>{if(u)f.current=h(u);else{const p=m.currentTarget;S({fn:()=>p.click()})}},disabled:v},"Play audio preview")," ",l.a.createElement(k.a,{type:"button",variant:"secondary",size:"sm",onClick:()=>ra(this,null,function*(){const{sourceFileId:m,userFileInfo:p}=e.metadata,C=yield x.getSourceFileData(m),P=new Blob([C],{type:p?p.type:"audio/x-wav"});oa(P,`${e.metadata.name}${p?p.ext:".wav"}`)})},"Download original file"),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement(I.a.Group,null,l.a.createElement(I.a.Label,null,"Quality bit depth (",e.metadata.qualityBitDepth,")"),l.a.createElement(I.a.Range,{value:e.metadata.qualityBitDepth,step:1,min:8,max:16,onChange:m=>{const p=Number(m.target.value);a(e.id,{qualityBitDepth:p})}})),l.a.createElement(I.a.Group,null,l.a.createElement(I.a.Label,null,"Slot number"),l.a.createElement(I.a.Control,{type:"number",value:e.metadata.slotNumber,step:1,min:0,max:199,onChange:m=>{const p=Number(m.target.value);a(e.id,{slotNumber:p})}})),l.a.createElement("br",null),l.a.createElement("div",{className:ie.a.slotNumber,title:`Slot ${e.metadata.slotNumber}`},l.a.createElement(Ke.a,{value:"8888",digitProps:{color:"var(--bs-gray-dark)"},strokeColor:"transparent",digitCount:4}),l.a.createElement(Ke.a,{ref:m=>{const p=Object(we.findDOMNode)(m);if(p){p.querySelectorAll(ie.a.point).forEach(P=>{p.removeChild(P)});const C=document.createElementNS("http://www.w3.org/2000/svg","circle");C.classList.add(ie.a.point),p.appendChild(C)}},value:`5${String(e.metadata.slotNumber).padStart(3,"0")}`,digitProps:{color:"var(--bs-primary)"},digitCount:4})),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement(Jt,{sample:e})):null}var ca=la,ia=g(75),_=(e,a,t)=>new Promise((n,o)=>{var c=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(c,i);s((t=t.apply(e,a)).next())});let at;function ve(){const e=xe();return at=at||new e(navigator.mediaDevices.getSupportedConstraints().sampleRate?{sampleRate:ee}:{})}function sa(){return _(this,null,function*(){{const n=yield navigator.mediaDevices.getUserMedia({audio:!0,video:!1});for(const o of n.getTracks())o.stop()}const a=(yield navigator.mediaDevices.enumerateDevices()).filter(n=>n.kind==="audioinput"),t=[];for(const n of a){const o=yield navigator.mediaDevices.getUserMedia({audio:{deviceId:n.deviceId,channelCount:2},video:!1}),c=(yield navigator.mediaDevices.enumerateDevices()).find(({deviceId:s})=>n.deviceId===s).label;let i=1;{const s=o.getAudioTracks()[0],r=s.getSettings().channelCount;r?i=r:s.getCapabilities&&(i=(s.getCapabilities().channelCount||{}).max||i)}for(const s of o.getTracks())s.stop();t.push({device:{deviceId:n.deviceId,label:c},channelsAvailable:i})}return t})}let ye;function ua(e){return _(this,arguments,function*({onData:a,onFinish:t}){const n=ve();ye=ye||n.audioWorklet.addModule("recorderWorkletProcessor.js"),yield ye;const o=new AudioWorkletNode(n,"recorder-worklet",{parameterData:{bufferSize:1024}});o.port.onmessage=i=>{if(i.data.eventType==="data"){const s=i.data.audioChannels;a(s)}i.data.eventType==="stop"&&t()};const c=o.parameters.get("isRecording");return c.setValueAtTime(1,n.currentTime),{recorderNode:o,stop(){c.setValueAtTime(0,n.currentTime)}}})}function da({channelCount:e,onData:a,onFinish:t}){const o=ve().createScriptProcessor(1024,e,e);let c=!1;return o.onaudioprocess=i=>{const s=Array(e).fill().map((r,u)=>i.inputBuffer.getChannelData(u));a(s),c&&t()},{recorderNode:o,stop(){c=!0}}}function fa(e){return _(this,null,function*(){return typeof AudioWorkletNode=="undefined"?da(e):yield ua(e)})}function ma(e){return _(this,arguments,function*({deviceId:a,channelCount:t,onStart:n,onUpdate:o}){const c=yield navigator.mediaDevices.getUserMedia({audio:{deviceId:a,channelCount:t,sampleRate:ee,echoCancellation:!1,autoGainControl:!1,noiseSuppression:!1},video:!1}),i=ve(),s=i.createMediaStreamSource(c),{recorderNode:r,stop:u}=yield fa({channelCount:t,onData:v,onFinish:P});s.connect(r),r.connect(i.destination);const w=10;n(i.sampleRate,w);const b=w*i.sampleRate;let S=0;const h=Array(t).fill([]);function v(D){let E=0;const A=[];for(let B=0;B<t;B++){const y=D[B],j=y.length,F=y.slice(0,Math.min(j,b-S));ke(F),E||(E=F.length),A.push(F)}const O=St(A),M=Ie(O);h.push(M),S+=E,S>=b&&u(),o(A)}let f,m;const p=new Promise((D,E)=>{f=D,m=E});let C=!1;function P(){return _(this,null,function*(){if(C)return;try{const A=yield new Blob(h).arrayBuffer(),O=new Float32Array(A),M=Ce()({channels:t,sampleRate:i.sampleRate,bitDepth:16,dataLength:O.byteLength}),B=new Uint8Array(M.length+O.byteLength);B.set(M),B.set(new Uint8Array(O.buffer),M.length),f(B)}catch(E){m(E)}const D=c.getTracks();for(const E of D)E.stop();r.disconnect(i.destination),s.disconnect(r),C=!0})}return{stop:u,mediaRecording:p}})}var pa=g(58),ge=g.n(pa),Q=(e,a,t)=>new Promise((n,o)=>{var c=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(c,i);s((t=t.apply(e,a)).next())});const nt="capture_device_preference";let rt=null;function ha(e,a){const t=Object(d.useRef)(JSON.parse(localStorage.getItem(nt)||"null")),[n,o]=Object(d.useState)(rt),[c,i]=Object(d.useState)(n?"ok":"pending"),[s,r]=Object(d.useState)("");Object(d.useEffect)(()=>{rt=n,i("ok")},[n]);const u=Object(d.useCallback)(()=>{let O=!1;return sa().then(M=>{O||M.length&&(o(new Map(M.map(B=>[B.device.deviceId,B]))),r(B=>B?(t.current=null,B):t.current&&M.find(({device:y})=>t.current.deviceId===y.deviceId)?t.current.deviceId:(t.current=null,M[0].device.deviceId)))}).catch(M=>{if(!O){if(M instanceof DOMException){if(M.name==="NotAllowedError"){i("denied");return}if(M.name==="NotFoundError"){i("unavailable");return}}throw M}}),()=>{O=!0}},[]),[w,b]=Object(d.useState)(1);Object(d.useEffect)(()=>{const O=n&&n.get(s);O&&(t.current&&t.current.deviceId===O.device.deviceId&&t.current.channelCount<=O.channelsAvailable?b(t.current.channelCount):b(O.channelsAvailable),t.current=null)},[n,s]),Object(d.useEffect)(()=>{s&&localStorage.setItem(nt,JSON.stringify({deviceId:s,channelCount:w}))},[s,w]);const[S,h]=Object(d.useState)("ready"),[v,f]=Object(d.useState)(null),[m,p]=Object(d.useState)({fn(O){}}),[C,P]=Object(d.useState)(1/0),[D,E]=Object(d.useState)(0),A=Object(d.useCallback)(()=>Q(this,null,function*(){let O=!1;const M=(R,G)=>ma({deviceId:R,channelCount:G,onStart:(W,Y)=>{const H=Y*W;P(W),E(H),h("capturing")},onUpdate:e}),B=t.current,{mediaRecording:y,stop:j}=yield B?(()=>Q(this,null,function*(){try{return M(B.deviceId,B.channelCount)}catch(R){if(R instanceof DOMException&&R.name==="NotFoundError")return M(s,w);throw R}}))():M(s,w);p({fn(R){j(),R&&(O=!0)}});let F;try{F=yield y}catch(R){f(R),h("error");return}O?h("ready"):(h("finalizing"),a(F))}),[s,w,e,a]);return{captureDevices:n,accessState:c,selectedCaptureDeviceId:s,selectedChannelCount:w,captureState:S,recordingError:v,sampleRate:C,maxSamples:D,refreshCaptureDevices:u,setSelectedCaptureDeviceId:r,setSelectedChannelCount:b,beginRecording:A,stopRecording:m.fn}}const be=3;function va({canvas:e,peaks:a,scaleCoefficient:t}){const n="#fff",o=e.getContext("2d");o.imageSmoothingEnabled=!1;const{width:c,height:i}=e;o.clearRect(0,0,c,i),o.fillStyle=n;for(let s=0;s<a.length;s++){const r=a[s];if(r===0)continue;const u=i*r,w=Math.max(Math.round(t*u),2);o.fillRect(s*be,i-w,be-1,w)}}function ya({onRecordFinish:e}){const a=Object(d.useRef)(null),t=Object(d.useRef)(0),n=Object(d.useRef)(new Float32Array),o=Object(d.useRef)(0),c=Object(d.useRef)([]),i=Object(d.useRef)(1/0),s=Object(d.useRef)(0),[r,u]=Object(d.useState)(0),w=Object(d.useCallback)(y=>Q(this,null,function*(){const j=t.current,F=n.current,R=c.current;if(R.push(y),s.current+=y[0].length,u(Math.floor(s.current/i.current)),R.reduce((W,[{length:Y}])=>W+Y,0)>=j){const W=yield Promise.all(y.map((H,Ee)=>R.reduce((Pa,Da)=>[...Pa,Da[Ee]],[])).map(H=>Q(this,null,function*(){const Ee=yield new Blob(H).arrayBuffer();return new Float32Array(Ee)}))),Y=W.map(H=>Re(new Float32Array(H.buffer,0,j)));F[o.current]=Math.max(...Y),va({canvas:a.current,peaks:F,scaleCoefficient:.3}),o.current++,c.current=[W.map(H=>H.slice(j))]}}),[]),{captureDevices:b,accessState:S,selectedCaptureDeviceId:h,selectedChannelCount:v,captureState:f,recordingError:m,maxSamples:p,sampleRate:C,refreshCaptureDevices:P,setSelectedCaptureDeviceId:D,setSelectedChannelCount:E,beginRecording:A,stopRecording:O}=ha(w,e);i.current=C,Object(d.useEffect)(()=>{const y=a.current;y&&(y.width=y.offsetWidth,y.height=y.offsetHeight)},[S]),Object(d.useLayoutEffect)(()=>{const y=a.current;!y||(f!=="finalizing"&&y.getContext("2d").clearRect(0,0,y.width,y.height),f==="capturing"&&p&&(t.current=Math.floor(be*p/a.current.width),n.current=new Float32Array(Math.floor(p/t.current)),o.current=0,c.current=[],i.current=1/0,s.current=0,u(0)))},[p,f]);const[M,B]=Object(d.useState)(!1);return Object(d.useEffect)(()=>{M&&P()},[M,P]),l.a.createElement("div",null,S==="denied"?l.a.createElement("p",null,"Looks like you didn't grant access to your audio input device. Please give Volca Sampler access, then"," ",l.a.createElement(k.a,{type:"button",variant:"secondary",onClick:P},"try again")):S==="unavailable"?l.a.createElement("p",null,"Volca Sampler couldn't find any audio input devices. Please connect one, then"," ",l.a.createElement(k.a,{type:"button",variant:"secondary",onClick:P},"try again")):l.a.createElement("div",null,l.a.createElement("h2",null,"Send a new sound to your Volca Sample!"),l.a.createElement(k.a,{className:ge.a.recordButton,type:"button",variant:f==="capturing"?"danger":"primary",size:"lg",style:{width:250},onClick:f==="capturing"?()=>O():A,disabled:f==="finalizing"},l.a.createElement("canvas",{ref:a}),l.a.createElement("span",{className:ge.a.mainText},["capturing","finalizing"].includes(f)?"Finished recording":"Start recording"),["capturing","finalizing"].includes(f)&&l.a.createElement("span",{className:ge.a.timeRecorded},"0:",String(r).padStart(2,"0"))),["capturing","finalizing"].includes(f)?l.a.createElement(l.a.Fragment,null,l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement(k.a,{style:{width:250},size:"sm",type:"button",variant:"secondary",onClick:()=>O(!0)},"Cancel")):l.a.createElement(l.a.Fragment,null,l.a.createElement("br",null),l.a.createElement(k.a,{style:{width:250},type:"button",variant:"light",size:"sm",onClick:()=>B(y=>!y)},"Audio input settings ",M?"\u25B2":"\u25BC"),l.a.createElement(ia.a,{in:M},l.a.createElement("div",null,l.a.createElement(I.a.Group,null,l.a.createElement(I.a.Label,null,"Capture Device"),l.a.createElement(I.a.Select,{style:{width:250},value:h,onChange:y=>D(y.target.value)},b&&S==="ok"?[...b].map(([y,{device:j}])=>l.a.createElement("option",{key:y,value:y},j.label||y)):l.a.createElement("option",{value:"",disabled:!0},"Loading devices..."))),l.a.createElement(I.a.Group,null,l.a.createElement(I.a.Label,null,"Input channels"),l.a.createElement(I.a.Select,{style:{width:250},value:v,onChange:y=>E(Number(y.target.value))},[1,2].map(y=>l.a.createElement("option",{key:y,value:y,disabled:!b||!b.has(h)||b.get(h).channelsAvailable<y},y===1?"Mono":"Stereo (summed to mono)")))),l.a.createElement("br",null))))),f==="error"&&m||null,l.a.createElement("br",null),l.a.createElement(k.a,{style:{width:250},type:"button",variant:"secondary",onClick:y=>{const j=y.currentTarget.querySelector("input");j&&y.target!==j&&j.click()}},"Or import an audio file",l.a.createElement("input",{hidden:!0,type:"file",accept:"audio/*,.wav,.mp3,.ogg",onChange:y=>{if(y.target.files&&y.target.files.length){const j=y.target.files[0];j.arrayBuffer().then(F=>Q(this,null,function*(){const R=new Uint8Array(F);let G;try{G=yield oe(R)}catch(W){alert("Unsupported audio format detected");return}if(G.length>10*G.sampleRate){alert("Please select an audio file no more than 10 seconds long");return}e(R,j)}))}}})))}var ga=ya,Se=g(121),V=g(123),ba=(e,a,t)=>new Promise((n,o)=>{var c=r=>{try{s(t.next(r))}catch(u){o(u)}},i=r=>{try{s(t.throw(r))}catch(u){o(u)}},s=r=>r.done?n(r.value):Promise.resolve(r.value).then(c,i);s((t=t.apply(e,a)).next())});const Sa=J.a.div({padding:"2rem",display:"flex",height:"100%"}),Ea=J.a.div({flexGrow:1});function wa(){const[e,a]=Object(d.useState)(new Map),[t,n]=Object(d.useState)(new Map),o=Object(d.useMemo)(()=>new Map([...e,...t]),[e,t]);Object(d.useEffect)(()=>{yt().then(n).catch(console.error)},[]);const[c,i]=Object(d.useState)(null),[s,r]=Object(d.useState)(!0);Object(d.useEffect)(()=>{x.getAllFromStorage().then(v=>{a(f=>new Map([...f,...v.map(m=>[m.id,m])]))}).finally(()=>{r(!1)})},[]);const u=Object(d.useCallback)((v,f)=>ba(this,null,function*(){const m=yield pt(v);let p="",C="";if(f){const A=f.name.lastIndexOf(".");A>0?(p=f.name.slice(0,A),C=f.name.slice(A)):p=f.name}else p="New sample";const P=[0,0],D=yield ze(m,P),E=new x.Mutable({name:p,sourceFileId:m,trim:{frames:P,waveformPeaks:D},userFileInfo:f&&{type:f.type,ext:C}});yield E.persist(),a(A=>new Map([[E.id,E],...A])),i(E.id)}),[]),w=Object(d.useCallback)((v,f)=>{a(m=>{const p=m.get(v);if(p&&p instanceof x.Mutable){const C=p.update(f);if(C!==p)return new Map(m).set(p.id,C)}return m})},[]),[b,S]=Object(d.useState)(!1),h=Object(d.useCallback)(v=>{i(v),S(!1)},[]);return l.a.createElement("div",null,l.a.createElement(it,{onMenuOpen:()=>S(!0),onHeaderClick:()=>i(null)}),l.a.createElement(Se.a,{show:b,onHide:()=>S(!1)},l.a.createElement(Se.a.Header,{closeButton:!0}),l.a.createElement(Se.a.Body,null,l.a.createElement(Z.a,null,l.a.createElement(Z.a.Item,{as:"button",onClick:()=>h(null)},"New Sample"),s?"Loading...":null,!s&&l.a.createElement(V.a,{defaultActiveKey:e.size?"user":"factory"},l.a.createElement(V.a.Item,{eventKey:"user"},l.a.createElement(V.a.Header,null,"Your Samples"),l.a.createElement(V.a.Body,{style:{padding:0}},l.a.createElement($e,{samples:e,selectedSampleId:c,onSampleSelect:h}))),l.a.createElement(V.a.Item,{eventKey:"factory"},l.a.createElement(V.a.Header,null,"Factory Samples"),l.a.createElement(V.a.Body,{style:{padding:0}},l.a.createElement($e,{samples:t,selectedSampleId:c,onSampleSelect:h}))))))),l.a.createElement(Sa,null,l.a.createElement(Ea,null,c&&l.a.createElement(ca,{sample:o.get(c)||null,onSampleUpdate:w,onSampleDuplicate:v=>{const f=o.get(v);if(f){const m=f.duplicate();a(p=>new Map([[m.id,m],...p])),i(m.id)}},onSampleDelete:v=>{const f=o.get(v);f&&f instanceof x.Mutable&&(f.remove(),a(m=>{const p=new Map(m);return p.delete(f.id),p}))}}),!c&&l.a.createElement(ga,{onRecordFinish:u}))))}var Ca=wa,Oa=e=>{e&&e instanceof Function&&g.e(3).then(g.bind(null,127)).then(({getCLS:a,getFID:t,getFCP:n,getLCP:o,getTTFB:c})=>{a(e),t(e),n(e),o(e),c(e)})};Blob.prototype.arrayBuffer||(Blob.prototype.arrayBuffer=function(){return new Response(this).arrayBuffer()}),ot.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(wt,null,l.a.createElement(Ca,null))),document.getElementById("root")),Oa()},23:function(T,z,g){T.exports={title:"Header_title__R3bRx",menuIcon:"Header_menuIcon__swn7p",titleText:"Header_titleText__3e5ME",titleR:"Header_titleR__3QRgv",titleStarburst:"Header_titleStarburst__1oLYP",titleGraphic:"Header_titleGraphic__3S89F"}},40:function(T,z,g){T.exports={waveformContainer:"SampleDetail_waveformContainer__3VrPQ",slotNumber:"SampleDetail_slotNumber__3sgS6",point:"SampleDetail_point__3d7qL"}},58:function(T,z,g){T.exports={recordButton:"SampleRecord_recordButton__3R-KX",mainText:"SampleRecord_mainText__2dca6",timeRecorded:"SampleRecord_timeRecorded__3FGTe"}},80:function(T,z,g){},81:function(T,z,g){}},[[112,1,2]]]);

//# sourceMappingURL=main.b6cbfdca.chunk.js.map