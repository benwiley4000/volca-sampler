(this["webpackJsonpvolca-sampler"]=this["webpackJsonpvolca-sampler"]||[]).push([[0],{106:function(I,X,f){I.exports={"form-switch":"NormalizeSwitch_form-switch__pmDx5","form-check-input":"NormalizeSwitch_form-check-input__trt4D",normalizeControlWrapper:"NormalizeSwitch_normalizeControlWrapper__3yf2V"}},110:function(I,X,f){I.exports={waveformContainer:"WaveformReadonly_waveformContainer__RARS4"}},117:function(I,X,f){},118:function(I,X,f){},149:function(I,X,f){"use strict";f.r(X);var u=f(0),n=f.n(u),yt=f(11),pa=f.n(yt),Zn=f(117),Jn=f(118),Ge=f(164),bt=f(165),ue=f(163),je=f(156),va=f(23),ie=f.n(va),ha=n.a.memo(function({onMenuOpen:e,onHeaderClick:a}){return n.a.createElement("div",{className:ie.a.titleBar},n.a.createElement("span",{className:ie.a.menuIcon,onClick:e},"\u2630"),n.a.createElement(je.a,{fluid:"sm",className:ie.a.titleContainer},n.a.createElement("h1",{className:ie.a.title,onClick:a},n.a.createElement("span",{className:ie.a.titleText,"data-text":"Volca Sample"},"Volca Sample",n.a.createElement("span",{className:ie.a.titleR},"r"),n.a.createElement("svg",{viewBox:"0 0 150 150",preserveAspectRatio:"none",className:ie.a.titleStarburst},Array(24).fill().map((r,o,{length:s})=>n.a.createElement("polygon",{key:o,points:"75,70 75,80 150,75","transform-origin":"75 75",style:{"--rotation":`${o*360/s}deg`}})))),n.a.createElement("img",{className:ie.a.titleGraphic,src:"volca_sample.png",alt:""}))),n.a.createElement("svg",{width:0,height:0},n.a.createElement("filter",{id:"outline"},n.a.createElement("feMorphology",{in:"SourceAlpha",result:"DILATED",operator:"dilate",radius:"1"}),n.a.createElement("feFlood",{floodColor:"var(--stroke-color)",floodOpacity:"1",result:"PINK"}),n.a.createElement("feComposite",{in:"PINK",in2:"DILATED",operator:"in",result:"OUTLINE"}),n.a.createElement("feMerge",null,n.a.createElement("feMergeNode",{in:"OUTLINE"}),n.a.createElement("feMergeNode",{in:"SourceGraphic"})))))}),gt=f(62),ya=f(63),Et=f.n(ya),ba=f(55),Pe=f.n(ba),wt=f(166),St=f(91);const Ae=31250;var ga=Object.defineProperty,Ea=Object.defineProperties,wa=Object.getOwnPropertyDescriptors,Re=Object.getOwnPropertySymbols,Ct=Object.prototype.hasOwnProperty,Ot=Object.prototype.propertyIsEnumerable,Xe=(t,e,a)=>e in t?ga(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,q=(t,e)=>{for(var a in e||(e={}))Ct.call(e,a)&&Xe(t,a,e[a]);if(Re)for(var a of Re(e))Ot.call(e,a)&&Xe(t,a,e[a]);return t},le=(t,e)=>Ea(t,wa(e)),Me=(t,e)=>{var a={};for(var r in t)Ct.call(t,r)&&e.indexOf(r)<0&&(a[r]=t[r]);if(t!=null&&Re)for(var r of Re(t))e.indexOf(r)<0&&Ot.call(t,r)&&(a[r]=t[r]);return a},Ne=(t,e,a)=>(Xe(t,typeof e!="symbol"?e+"":e,a),a),te=(t,e,a)=>new Promise((r,o)=>{var s=l=>{try{c(a.next(l))}catch(m){o(m)}},i=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,i);c((a=a.apply(t,e)).next())});const Be=Pe.a.createInstance({name:"audio_file_data",driver:Pe.a.INDEXEDDB}),Le=Pe.a.createInstance({name:"sample_metadata",driver:Pe.a.INDEXEDDB});function Sa(t){return te(this,null,function*(){const e=Object(wt.a)();return yield Be.setItem(e,t),e})}const Ke="0.5.0",Ca={"0.1.0":t=>{const e=t,{clip:a}=e,r=Me(e,["clip"]);return le(q({},r),{trimFrames:a.map(s=>Math.round(s*Ae)),metadataVersion:"0.2.0"})},"0.2.0":t=>te(void 0,null,function*(){const e=t,{trimFrames:a}=e,r=Me(e,["trimFrames"]),o=yield xe(r.sourceFileId,!1),s=yield qe(o,a),i={frames:a,waveformPeaks:s};return le(q({},r),{trim:i,metadataVersion:"0.3.0"})}),"0.3.0":t=>{const e=t,{dateSampled:a,dateModified:r}=e,o=Me(e,["dateSampled","dateModified"]);return le(q({},o),{dateSampled:new Date(a).toISOString(),dateModified:new Date(r).toISOString(),metadataVersion:"0.4.0"})},"0.4.0":t=>te(void 0,null,function*(){const e=t,{scaleCoefficient:a,trim:{frames:r,waveformPeaks:o}}=e,s=Me(e,["scaleCoefficient","trim"]),i=yield xe(s.sourceFileId,!1),c=Ie(i,r),l=pe(c);return le(q({},s),{normalize:a!==1,trim:{frames:r,waveformPeaks:le(q({},o),{normalizationCoefficient:1/l})},metadataVersion:"0.5.0"})})};function Oa(t){return te(this,null,function*(){let e=t;for(;e.metadataVersion!==Ke;){const a=Ca[e.metadataVersion];if(!a){console.warn(`Failed to properly upgrade metadata for sample "${e.name}"`),e={name:e.name,sourceFileId:e.sourceFileId,id:e.id,metadataVersion:Ke};break}e=yield a(e)}return e})}const fe=class{constructor({name:t,sourceFileId:e,trim:a,id:r=Object(wt.a)(),userFileInfo:o=null,slotNumber:s=0,dateSampled:i=new Date().toISOString(),dateModified:c=i,useCompression:l=!0,qualityBitDepth:m=16,normalize:d=!0}){this.id=r,this.metadata={name:t,sourceFileId:e,trim:a,userFileInfo:o,slotNumber:s,dateSampled:i,dateModified:c,useCompression:l,qualityBitDepth:m,normalize:d,metadataVersion:Ke}}duplicate(){const t=new fe.Mutable(le(q({},this.metadata),{name:`${this.metadata.name} (copy)`,dateModified:new Date().toISOString()}));return t.persist(),t}static cacheSourceFileData(t,e){this.sourceFileData.set(t,e),this.recentlyCachedSourceFileIds=[t,...this.recentlyCachedSourceFileIds.filter(r=>r!==t)];const a=this.recentlyCachedSourceFileIds.slice(this.MAX_CACHED);for(const r of a)this.sourceFileData.delete(r);this.recentlyCachedSourceFileIds=this.recentlyCachedSourceFileIds.slice(0,this.MAX_CACHED)}static getSourceFileData(t){return te(this,null,function*(){{const a=this.sourceFileData.get(t);if(a)return a}if(t.includes(".")){const a=yield fetch(t);if(a.status>=400)return Promise.reject(new Error(`Failed to fetch source file "${t}"`));const r=yield a.arrayBuffer(),o=new Uint8Array(r);return this.cacheSourceFileData(t,o),o}const e=yield Be.getItem(t);return e?e instanceof Uint8Array?(this.cacheSourceFileData(t,e),e):Promise.reject("Source data is of unexpected type"):Promise.reject("Missing source data")})}static getAllMetadataFromStore(){return te(this,null,function*(){const t=new Map,e=[];return yield Le.iterate((a,r)=>{a&&e.push(Oa(a).then(o=>{t.set(r,o)}).catch(o=>{console.error(o),console.warn(`Failed to upgrade metadata "${r}" (${a.name}); ignoring.`)}))}),yield Promise.all(e),t})}static getAllFromStorage(){return te(this,null,function*(){const t=yield this.getAllMetadataFromStore(),e=yield kt(),a=(yield Be.keys()).concat(e.map(({sourceFileId:o})=>o));return[...t].map(([o,s])=>{const{sourceFileId:i}=s;return a.includes(i)?new fe.Mutable(q({id:o},s)):(console.warn(`Found metadata "${s.name||o}" with missing data "${i}; ignoring.`),null)}).filter(Boolean).sort(({metadata:{dateModified:o}},{metadata:{dateModified:s}})=>o>s?-1:s>o?1:0)})}};let Z=fe;Ne(Z,"Mutable",class extends fe{constructor(t){super(t);setTimeout(()=>te(this,null,function*(){(yield Le.keys()).includes(this.id)||console.warn(`Expected sample metadata container ${this.id} to be persisted`)}))}persist(){return te(this,null,function*(){yield Le.setItem(this.id,this.metadata)})}update(t){const{id:e,metadata:a}=this,r=typeof t=="function"?t(a):t;if(Object.keys(r).every(i=>r[i]===a[i]))return this;const o=le(q(q({},a),r),{dateModified:new Date().toISOString()}),s=new fe.Mutable(q({id:e},o));return s.persist(),s}remove(){return te(this,null,function*(){if(yield Le.removeItem(this.id),this.metadata.sourceFileId.includes("."))return;const t=yield fe.getAllMetadataFromStore();for(const[,{sourceFileId:e}]of t)if(e===this.metadata.sourceFileId)return;yield Be.removeItem(this.metadata.sourceFileId)})}}),Ne(Z,"sourceFileData",new Map),Ne(Z,"recentlyCachedSourceFileIds",[]),Ne(Z,"MAX_CACHED",10);let Ye;function kt(){return Ye||(Ye=fetch("factory-samples.json").then(t=>t.json())),Ye}function ka(){return te(this,null,function*(){const t=yield kt();return new Map(t.map(e=>[e.id,new Z(le(q({},e),{normalize:!1,trim:{frames:[e.trim.frames[0],e.trim.frames[1]],waveformPeaks:le(q({},e.trim.waveformPeaks),{positive:new Float32Array(Object(St.a)(e.trim.waveformPeaks.positive)),negative:new Float32Array(Object(St.a)(e.trim.waveformPeaks.negative))})}}))]))})}var Dt=Math.pow,Ze=(t,e,a)=>new Promise((r,o)=>{var s=l=>{try{c(a.next(l))}catch(m){o(m)}},i=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,i);c((a=a.apply(t,e)).next())});function Fe(t,e){const a=4,r=e[0]*a,o=t.length-e[0]-e[1];return new Float32Array(t.buffer,r,o)}function Ie(t,e){const a=t.length-e[0]-e[1],r=new Float32Array(a),o=Array(t.numberOfChannels).fill().map((s,i)=>Fe(t.getChannelData(i),e));for(let s=0;s<a;s++){let i=0;for(let c=0;c<o.length;c++)i+=o[c][s];i/=o.length,r[s]=i}return r}function pe(t){let e=0;for(const a of t){const r=Math.abs(a);r>e&&(e=r)}return e}function Da(t,e){if(e!==1)for(let a=0;a<t.length;a++)t[a]*=e}function ja(t){const e=pe(t);Da(t,1/e)}function Pa(t,e){const a=Dt(2,e-1);for(let r=0;r<t.length;r++)t[r]=Math.round(t[r]*a)/a}function jt(t){for(let e=0;e<t.length;e++)t[e]>1?t[e]=1:t[e]<-1&&(t[e]=-1)}function Aa(t){const e=t.length,a=t[0].length,r=new Float32Array(e*a);for(let o=0;o<r.length;o++){const s=e*o;for(let i=0;i<e;i++)r[s+i]=t[i][o]}return r}function Pt(t){const e=new Int16Array(t.length),a=Dt(2,15);for(let r=0;r<t.length;r++)e[r]=t[r]===1?a-1:a*t[r];return e}function At(){return window.AudioContext||window.webkitAudioContext}let Rt;function Mt(){const t=At();return Rt=Rt||new t({sampleRate:Ae})}function Ee(t){return Ze(this,null,function*(){const e=new Uint8Array(t);return yield new Promise((r,o)=>{Mt().decodeAudioData(e.buffer,r,o)})})}function xe(t,e){return Ze(this,null,function*(){const a=yield Z.getSourceFileData(t),r=yield Ee(a);if(e)for(let o=0;o<r.numberOfChannels;o++)jt(r.getChannelData(o));return r})}function Nt(t){return Ze(this,null,function*(){const{qualityBitDepth:e,sourceFileId:a,userFileInfo:r,normalize:o,trim:{frames:s}}=t.metadata;if(e<8||e>16||!Number.isInteger(e))throw new Error(`Expected bit depth between 8 and 16. Received: ${e}`);const i=yield xe(a,Boolean(r)),c=i.numberOfChannels===1?Fe(i.getChannelData(0),s):Ie(i,s);o&&ja(c),e<16&&Pa(c,e);const l=Pt(c),m=l.length*2,d=Et()({channels:1,sampleRate:i.sampleRate,bitDepth:16,dataLength:m}),p=new Uint8Array(d.length+m);return p.set(d),p.set(new Uint8Array(l.buffer),d.length),{data:p,sampleRate:16}})}function Bt(t){const[e,a]=Object(u.useState)(null),[r,o]=Object(u.useState)(null);return Object(u.useEffect)(()=>{a(null);let s=!1;Nt(t).then(({data:i})=>{s||a(i)})},[t]),Object(u.useEffect)(()=>{if(o(null),e){let s=!1;Ee(e).then(i=>{s||o(i)})}},[e]),{wav:e,audioBuffer:r}}const Ra={playAudioBuffer(t,e){throw new Error("Must render AudioPlaybackContextProvider")}},Lt=Object(u.createContext)(Ra);function Ma({children:t}){const e=Object(u.useRef)(()=>{}),a=Object(u.useCallback)((o,{onTimeUpdate:s=()=>null,onEnded:i=()=>null}={})=>{e.current();const c=Mt(),l=c.createBufferSource();l.buffer=o,l.connect(c.destination),l.start();const m=c.currentTime;s(0);let d=requestAnimationFrame(p);function p(){s(c.currentTime-m),d=requestAnimationFrame(p)}let y=!1;l.addEventListener("ended",()=>{y||(s(o.duration),i()),cancelAnimationFrame(d)});function E(){y||(l.stop(),cancelAnimationFrame(d),i(),y=!0)}return e.current=E,E},[]),r=Object(u.useMemo)(()=>({playAudioBuffer:a}),[a]);return Object(u.createElement)(Lt.Provider,{value:r},t)}function Ft(){return Object(u.useContext)(Lt)}function Je(t){return t.toLocaleString([],{dateStyle:"medium",timeStyle:"short"})}function We(t,e){return`0:${t.toFixed(e).padStart(3+e,"0")}`}function Na(t){return`${Math.floor(t/60)}m ${Math.floor(t%60)}s`}var It=(t,e,a)=>new Promise((r,o)=>{var s=l=>{try{c(a.next(l))}catch(m){o(m)}},i=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,i);c((a=a.apply(t,e)).next())});const ve=6,xt=ve*44;function Wt(t,e){const a=Math.floor(ve*t.length/e),r=new Float32Array(Math.floor(t.length/a)),o=new Float32Array(Math.floor(t.length/a));for(let l=0;l<r.length;l++){const m=new Float32Array(t.buffer,l*a*4,a);let d=0,p=0;for(const y of m)y>d&&(d=y),y<p&&(p=y);r[l]=Math.min(1,d),o[l]=Math.max(-1,p)}const s=t.length%a,i=new Float32Array(r.length+o.length+s);i.set(r,0),i.set(o,r.length),i.set(new Float32Array(t.buffer,(t.length-s)*4,s),r.length+o.length);const c=pe(i);return{positive:r,negative:o,normalizationCoefficient:1/c}}function qe(t,e){return It(this,null,function*(){const a=Ie(t,e);return Wt(a,xt)})}function Tt(t){const[e,a]=Object(u.useState)(null);Object(u.useEffect)(()=>{let o=!1;return(()=>It(this,null,function*(){if(o)return;const s=yield xe(t.metadata.sourceFileId,Boolean(t.metadata.userFileInfo));o||a([t.metadata.sourceFileId,s])}))(),()=>{o=!0}},[t.metadata.sourceFileId,t.metadata.userFileInfo]);const r=Object(u.useRef)(t);return e&&t.metadata.sourceFileId===e[0]&&(r.current=t),{sample:r.current,sourceAudioBuffer:e&&e[1]}}function _t(t){const e=Object(u.useMemo)(()=>t?Ie(t,[0,0]):new Float32Array,[t]),[a,r]=Object(u.useState)(null),[o,s]=Object(u.useState)({width:0,height:0}),i=Object(u.useMemo)(()=>a&&(o.width||a.offsetWidth),[a,o]),c=Object(u.useMemo)(()=>!i||!e.length?{positive:new Float32Array,negative:new Float32Array,normalizationCoefficient:1/0}:Wt(e,i),[i,e]);return{monoSamples:e,waveformRef:r,pixelWidth:i,peaks:c,onResize:s}}function Ht(t){const{playAudioBuffer:e}=Ft(),a=Object(u.useRef)(()=>{}),[r,o]=Object(u.useState)(null);Object(u.useEffect)(()=>{t&&r&&(o(null),r.fn())},[t,r]);const[s,i]=Object(u.useState)(0),[c,l]=Object(u.useState)(!1),[m,d]=Object(u.useState)("");Object(u.useEffect)(()=>{t&&d(We(c?s*t.duration:t.duration,1))},[t,c,s]);const p=Object(u.useCallback)(E=>{if(c)a.current();else if(t)a.current=e(t,{onTimeUpdate(b){i(b/t.duration)},onEnded(){l(!1)}}),i(0),l(!0);else{const b=E.target;o({fn:()=>b.dispatchEvent(E)})}},[c,e,t]);Object(u.useEffect)(()=>{function E(b){document.querySelector('[role="dialog"]')||b.key===" "&&(b.preventDefault(),p(b))}return document.addEventListener("keydown",E),()=>document.removeEventListener("keydown",E)},[p]);const y=Object(u.useCallback)(()=>a.current(),[]);return{isPlaybackActive:c,playbackProgress:s,displayedTime:m,togglePlayback:p,stopPlayback:y}}var Ba=f(101),La=Object.defineProperty,zt=Object.getOwnPropertySymbols,Fa=Object.prototype.hasOwnProperty,Ia=Object.prototype.propertyIsEnumerable,Vt=(t,e,a)=>e in t?La(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,Ut=(t,e)=>{for(var a in e||(e={}))Fa.call(e,a)&&Vt(t,a,e[a]);if(zt)for(var a of zt(e))Ia.call(e,a)&&Vt(t,a,e[a]);return t};const xa=gt.a.canvas({width:"100%",height:"100%",display:"block",imageRendering:"pixelated"});function Wa(t,e){function a(o,s){t.width=o,t.height=s}a(t.offsetWidth,t.offsetHeight),e({width:t.offsetWidth,height:t.offsetHeight});const r=new Ba.a(([o])=>{const{width:s,height:i}=o.contentRect;a(s,i),e({width:s,height:i})});return r.observe(t),()=>r.disconnect()}function Ta(t,e,a){const r=getComputedStyle(document.documentElement),o=r.getPropertyValue("--bs-primary"),s=r.getPropertyValue("--bs-primary-darkened"),i=t.getContext("2d");i.imageSmoothingEnabled=!1;const{width:c,height:l}=t;i.clearRect(0,0,c,l);const m=Math.floor(l*(2/3))+1;i.fillStyle=o,e.positive.forEach((p,y)=>{const E=m*p,b=Math.max(Math.round(a*E),1);i.fillRect(y*ve,m-b,ve-1,b)});const d=l-m;i.fillStyle=s,e.negative.forEach((p,y)=>{const E=d*p*-1,b=Math.round(a*E);i.fillRect(y*ve,m,ve-1,b)})}function _a({peaks:t,scaleCoefficient:e,waveformRef:a,onResize:r}){const o=Object(u.useRef)(null);Object(u.useImperativeHandle)(a,()=>o.current);const[s,i]=Object(u.useState)(Symbol()),c=Object(u.useRef)({width:0,height:0});return Object(u.useLayoutEffect)(()=>{if(!o.current)throw new Error("Canvas should be defined");return c.current.width=o.current.offsetWidth,c.current.height=o.current.offsetHeight,r&&r(Ut({},c.current)),Wa(o.current,({width:l,height:m})=>{(l!==c.current.width||m!==c.current.height)&&(i(Symbol()),c.current.width=l,c.current.height=m,r&&r(Ut({},c.current)))})},[r]),Object(u.useLayoutEffect)(()=>{const l=o.current;if(!l)throw new Error("Canvas should be defined");let m=requestAnimationFrame(()=>{m=requestAnimationFrame(()=>{Ta(l,t,e===void 0?t.normalizationCoefficient:e)})});return()=>cancelAnimationFrame(m)},[t,e,s]),n.a.createElement(xa,{ref:o})}var et=_a;const Ha=gt.a.div({width:`${xt}px`,height:"40px"}),Qt=typeof IntersectionObserver!="undefined",za=n.a.memo(function({sample:e,selected:a,onSampleSelect:r}){const o=Object(u.useRef)(null),[s,i]=Object(u.useState)(!Qt);return Object(u.useLayoutEffect)(()=>{if(!Qt)return;const c=o.current;if(!c)throw new Error("Waveform container should be defined");const l=c.getBoundingClientRect();if(l.top+l.height>=0&&l.bottom-l.height<=window.innerHeight){i(!0);return}const m=new IntersectionObserver(([d])=>{d.isIntersecting&&(i(!0),m.unobserve(c))});return m.observe(c),()=>m.disconnect()},[]),n.a.createElement("li",{className:["list-group-item",a?"active":""].join(" "),onClick:()=>r(e.id)},n.a.createElement("div",null,e.metadata.name),n.a.createElement(Ha,{ref:o},s&&n.a.createElement(et,{peaks:e.metadata.trim.waveformPeaks})))});function Va({samples:t,selectedSampleId:e,onSampleSelect:a}){const r=Object(u.useRef)(new WeakMap),o=[];for(const s of t.values()){let i=r.current.get(s);i||(i=n.a.createElement(za,{key:s.id,sample:s,selected:s.id===e,onSampleSelect:a}),r.current.set(s,i)),o.push(i)}return n.a.createElement("ul",{className:"list-group list-group-flush"},o)}var $t=Va,Ua=f(158),we=f(111),T=f(162),K=f(160),H=f(105),Gt=f(64),Te=f(161),_e=f(157),Qa=f(102),$a=f(103),Ga=f(104);function Xt(t,e){const a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download=e,r.style.display="none",document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(a)}var Xa=f(45),Se=f.n(Xa),Ka=(t,e,a)=>new Promise((r,o)=>{var s=l=>{try{c(a.next(l))}catch(m){o(m)}},i=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,i);c((a=a.apply(t,e)).next())}),Kt=n.a.memo(function({isPlaybackActive:e,playbackProgress:a,displayedTime:r,downloadFilename:o,wavFile:s,togglePlayback:i}){const c=Object(u.useCallback)(()=>Ka(this,null,function*(){if(s){const l=new Blob([s],{type:"audio/x-wav"});Xt(l,o)}}),[o,s]);return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:[Se.a.playbackOverlay,e?Se.a.playbackActive:""].join(" "),style:{"--playback-progress":`${100*a}%`}},n.a.createElement("div",{className:Se.a.playback})),n.a.createElement("div",{className:Se.a.playbackButtonContainer},n.a.createElement(Te.a,{delay:{show:400,hide:0},overlay:n.a.createElement(_e.a,null,"Preview how your sample will sound on the volca sample")},n.a.createElement(H.a,{variant:"dark",onClick:l=>i(l.nativeEvent)},e?n.a.createElement($a.a,null):n.a.createElement(Qa.a,null))),r&&n.a.createElement("span",null,r)),n.a.createElement(Te.a,{delay:{show:400,hide:0},overlay:n.a.createElement(_e.a,null,"Download a copy of the audio that will be transferred to the volca sample")},n.a.createElement(H.a,{className:Se.a.downloadButton,type:"button",variant:"dark",size:"sm",onClick:c,disabled:!s},n.a.createElement(Ga.a,null))))}),Ya=f(106),Za=f.n(Ya),Ja=n.a.memo(function({sampleId:e,normalize:a,onSampleUpdate:r}){return n.a.createElement(Te.a,{delay:{show:400,hide:0},overlay:n.a.createElement(_e.a,null,"Boosts your sample's volume so its peak is at the same level as your other normalized samples")},n.a.createElement("div",{className:Za.a.normalizeControlWrapper},n.a.createElement(K.a.Switch,{label:n.a.createElement("span",{onClick:()=>r(e,o=>({normalize:!o.normalize}))},"Normalize"),checked:a,onChange:o=>r(e,{normalize:o.target.checked})})))}),qa=f(8),Q=f.n(qa),en=(t,e,a)=>new Promise((r,o)=>{var s=l=>{try{c(a.next(l))}catch(m){o(m)}},i=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,i);c((a=a.apply(t,e)).next())}),tn=n.a.memo(function({sample:e,onSampleUpdate:a}){const{wav:r,audioBuffer:o}=Bt(e),{sample:{id:s,metadata:{name:i,trim:{frames:c},normalize:l}},sourceAudioBuffer:m}=Tt(e),{monoSamples:d,waveformRef:p,pixelWidth:y,peaks:E,onResize:b}=_t(m),j=Object(u.useMemo)(()=>{if(!m)return 0;const x=Fe(d,c);return pe(x)},[m,d,c]),N=1/j,[w,k]=Object(u.useState)({trimFrames:c,cursor:null});Object(u.useEffect)(()=>{k({trimFrames:c,cursor:null})},[c]);const A=Object(u.useMemo)(()=>{if(!d.length||!y)return[0,0];const x=y/d.length;return w.trimFrames.map(W=>W*x)},[y,d.length,w.trimFrames]),B=Object(u.useRef)(w);B.current=w;const C=Object(u.useRef)(e.id);C.current=e.id;const P=Object(u.useRef)(0),D=Object(u.useCallback)(()=>en(this,null,function*(){if(!m||s!==C.current)return;let x=P.current=Math.random();const{trimFrames:W}=B.current,$=yield qe(m,W);P.current===x&&a(s,{trim:{frames:W,waveformPeaks:$}})}),[s,m,a]),R=Object(u.useRef)(!1);Object(u.useEffect)(()=>{R.current&&(D(),R.current=!1)},[w,D]);const g=Object(u.useCallback)(()=>{R.current=!0,k({trimFrames:[0,0],cursor:null})},[]),M=Object(u.useRef)(null),S=Object(u.useRef)(null),O=Object(u.useRef)(null);{const x=Object(u.useRef)(null),W=Object(u.useRef)(null),$=Object(u.useRef)(null),De=Object(u.useRef)(!1),oe=Object(u.useRef)(null);Object(u.useLayoutEffect)(()=>{oe.current&&(clearTimeout(oe.current),oe.current=null)},[w]);const st=Object(u.useMemo)(()=>{if(!y||!d.length)return null;const U=Math.max(2e3,Math.ceil(10*d.length/y));return{pixelWidth:y,monoSamplesLength:d.length,minFrameWidth:U}},[y,d.length]);Object(u.useEffect)(()=>{if(!st||!M.current||!S.current||!O.current)return;const G=M.current,U=S.current,ee=O.current,{pixelWidth:ye,monoSamplesLength:ae,minFrameWidth:be}=st;let it=0;function Yn(){it=ee.getBoundingClientRect().left}function Ve(h){h instanceof TouchEvent&&h.preventDefault(),document.body.style.userSelect="none";const{pageX:L}=h instanceof MouseEvent?h:h.touches[0];x.current=L}function Ue(h){h instanceof TouchEvent&&h.preventDefault(),document.body.style.userSelect="none";const{pageX:L}=h instanceof MouseEvent?h:h.touches[0];W.current=L}function Qe(h){if(h instanceof TouchEvent&&h.preventDefault(),h.detail===2){g();return}document.body.style.userSelect="none";const{clientX:L}=h instanceof MouseEvent?h:h.touches[0];Yn();const Y=Math.max(0,Math.min(ye,L-it)),J=Y/ye,_=Math.round(ae*J),me=_+be,de=me<ae?me:_-be;de<0||(k({trimFrames:[Math.min(_,de),ae-1-Math.max(_,de)],cursor:Y-1}),$.current=_)}function ut(h){const L=h/ye,Y=Math.round(ae*L);k(({trimFrames:J})=>{let _=J[0]+Y;return _=Math.min(_,ae-J[1]-be),_=Math.max(_,0),{trimFrames:[_,J[1]],cursor:null}})}function mt(h){if(x.current===null)return;h instanceof TouchEvent&&h.preventDefault();const{pageX:L}=h instanceof MouseEvent?h:h.touches[0],Y=L-x.current;Y&&(ut(Y),x.current=L)}function dt(h){const L=h/ye,Y=Math.round(ae*L);k(({trimFrames:J})=>{let _=J[1]+Y;return _=Math.min(_,ae-J[0]-be),_=Math.max(_,0),{trimFrames:[J[0],_],cursor:null}})}function ft(h){if(W.current===null)return;h instanceof TouchEvent&&h.preventDefault();const{pageX:L}=h instanceof MouseEvent?h:h.touches[0],Y=W.current-L;Y&&(dt(Y),W.current=L)}let $e=!1;function ma(h){if(x.current!==null)return;let L=!0;switch(h.key){case"ArrowLeft":ut(-1);break;case"ArrowRight":ut(1);break;default:L=!1;break}L&&(h.stopPropagation(),h.preventDefault(),$e=!0)}function da(h){if(W.current!==null)return;let L=!0;switch(h.key){case"ArrowLeft":dt(1);break;case"ArrowRight":dt(-1);break;default:L=!1;break}L&&(h.stopPropagation(),h.preventDefault(),$e=!0)}function pt(h){if($.current===null)return;h instanceof TouchEvent&&h.preventDefault();const L=$.current,{clientX:Y}=h instanceof MouseEvent?h:h.touches[0],J=Math.max(0,Math.min(ye,Y-it)),_=J/ye,me=Math.max(0,Math.min(ae-1,Math.round(ae*_)));if(me!==$.current){De.current=!0;const de=L+be,vt=L-be,ht=me>L?de<ae?Math.max(me,de):vt:vt>=0?Math.min(me,vt):de;k({trimFrames:[Math.min(L,ht),ae-1-Math.max(L,ht)],cursor:L<ht?J:J-1})}}function fa(h){mt(h),ft(h),pt(h)}function z(h){(x.current!==null||W.current!==null||$.current!==null||$e)&&((h instanceof TouchEvent||h instanceof KeyboardEvent)&&h.preventDefault(),$.current&&!De.current&&h.detail===1?oe.current=setTimeout(()=>{oe.current=null,D()},250):D(),x.current=null,W.current=null,$.current=null,De.current=!1,$e=!1),document.body.style.userSelect="unset"}function ge(h){h.target instanceof Node&&ee.contains(h.target)||oe.current&&(clearTimeout(oe.current),oe.current=null,D())}return G.addEventListener("touchstart",Ve),G.addEventListener("mousedown",Ve),U.addEventListener("touchstart",Ue),U.addEventListener("mousedown",Ue),ee.addEventListener("touchstart",Qe),ee.addEventListener("mousedown",Qe),G.addEventListener("touchmove",mt),U.addEventListener("touchmove",ft),G.addEventListener("keydown",ma),U.addEventListener("keydown",da),ee.addEventListener("touchmove",pt),window.addEventListener("mousemove",fa),G.addEventListener("touchend",z),G.addEventListener("touchcancel",z),G.addEventListener("keyup",z),U.addEventListener("touchend",z),U.addEventListener("keyup",z),U.addEventListener("touchcancel",z),ee.addEventListener("touchend",z),ee.addEventListener("touchcancel",z),window.addEventListener("mouseup",z),window.addEventListener("touchstart",ge,{capture:!0}),window.addEventListener("mousedown",ge,{capture:!0}),window.addEventListener("keydown",ge,{capture:!0}),()=>{G.removeEventListener("touchstart",Ve),G.removeEventListener("mousedown",Ve),U.removeEventListener("touchstart",Ue),U.removeEventListener("mousedown",Ue),ee.removeEventListener("touchstart",Qe),ee.removeEventListener("mousedown",Qe),G.removeEventListener("touchmove",mt),U.removeEventListener("touchmove",ft),G.removeEventListener("keydown",ma),U.removeEventListener("keydown",da),ee.removeEventListener("touchmove",pt),window.removeEventListener("mousemove",fa),G.removeEventListener("touchend",z),G.removeEventListener("touchcancel",z),G.removeEventListener("keyup",z),U.removeEventListener("touchend",z),U.removeEventListener("keyup",z),U.removeEventListener("touchcancel",z),ee.removeEventListener("touchend",z),ee.removeEventListener("touchcancel",z),window.removeEventListener("mouseup",z),window.removeEventListener("touchstart",ge,{capture:!0}),window.removeEventListener("mousedown",ge,{capture:!0}),window.removeEventListener("keydown",ge,{capture:!0})}},[st,D,g])}const{isPlaybackActive:v,playbackProgress:F,displayedTime:ne,togglePlayback:re,stopPlayback:V}=Ht(o);Object(u.useEffect)(()=>V,[e,w,V]);const se=e.metadata.trim.frames.every(x=>x===0);return n.a.createElement(n.a.Fragment,null,n.a.createElement(K.a.Group,{className:Q.a.waveformAdjacentControls},n.a.createElement(Ja,{sampleId:e.id,normalize:e.metadata.normalize,onSampleUpdate:a}),n.a.createElement(H.a,{type:"button",variant:"secondary",disabled:se,onClick:g},se?"All audio selected":"Select all audio")),n.a.createElement("div",{className:[Q.a.waveformContainer,v?Q.a.playbackActive:""].join(" "),style:{"--cursor-display":w.cursor===null?"none":"unset","--cursor-left":`${w.cursor}px`,"--trim-pixels-left":`${A[0]}px`,"--trim-pixels-right":`${A[1]}px`}},n.a.createElement(et,{waveformRef:p,peaks:E,scaleCoefficient:l?N:1,onResize:b}),n.a.createElement(Kt,{isPlaybackActive:v,playbackProgress:F,displayedTime:ne,downloadFilename:`${i}.volcasample.wav`,wavFile:r,togglePlayback:re}),n.a.createElement("div",{className:Q.a.cursor}),n.a.createElement("div",{className:[Q.a.trim,Q.a.left].join(" ")},n.a.createElement("div",{className:Q.a.bar}),n.a.createElement("div",{ref:M,className:Q.a.handle,tabIndex:0}),m&&Boolean(d.length)&&n.a.createElement("span",{className:Q.a.time},We(m.duration*w.trimFrames[0]/d.length,2))),n.a.createElement("div",{className:[Q.a.trim,Q.a.right].join(" ")},n.a.createElement("div",{className:Q.a.bar}),n.a.createElement("div",{ref:S,className:Q.a.handle,tabIndex:0}),m&&Boolean(d.length)&&n.a.createElement("span",{className:Q.a.time},We(m.duration*(d.length-1-w.trimFrames[1])/d.length,2))),n.a.createElement("div",{ref:O,className:Q.a.waveformOverlay})))}),an=f(167),Yt=(t,e,a)=>new Promise((r,o)=>{var s=l=>{try{c(a.next(l))}catch(m){o(m)}},i=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,i);c((a=a.apply(t,e)).next())});let Zt;function nn(){return Yt(this,null,function*(){return typeof window.CREATE_SYRO_BINDINGS!="function"?Promise.reject("Expected CREATE_SYRO_BINDINGS global function to exist"):Zt=Zt||window.CREATE_SYRO_BINDINGS().then(t=>Yt(this,null,function*(){return{prepareSampleBufferFromWavData:t.cwrap("prepareSampleBufferFromWavData","number",["array","number","number","number","number"]),prepareSampleBufferFrom16BitPcmData(){throw new Error("This function does not work. Use prepareSampleBufferFromWavData.")},getSampleBufferChunkPointer:t.cwrap("getSampleBufferChunkPointer","number",["number"]),getSampleBufferChunkSize:t.cwrap("getSampleBufferChunkSize","number",["number"]),getSampleBufferProgress:t.cwrap("getSampleBufferProgress","number",["number"]),getSampleBufferTotalSize:t.cwrap("getSampleBufferTotalSize","number",["number"]),cancelSampleBufferWork:t.cwrap("cancelSampleBufferWork",null,["number"]),registerUpdateCallback(e){return t.addFunction(e,"vi")},unregisterUpdateCallback(e){t.removeFunction(e)},heap8Buffer(){return t.HEAP8.buffer}}}))})}var rn=(t,e,a)=>new Promise((r,o)=>{var s=l=>{try{c(a.next(l))}catch(m){o(m)}},i=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,i);c((a=a.apply(t,e)).next())});function on(t,e){let a=!1,r=()=>{};return{cancelWork(){a=!0,r()},sampleBufferPromise:(()=>rn(this,null,function*(){const{prepareSampleBufferFromWavData:o,getSampleBufferChunkPointer:s,getSampleBufferChunkSize:i,getSampleBufferProgress:c,getSampleBufferTotalSize:l,cancelSampleBufferWork:m,registerUpdateCallback:d,unregisterUpdateCallback:p,heap8Buffer:y}=yield nn();if(a)return new Uint8Array;const{data:E}=yield Nt(t);if(a)return new Uint8Array;let b,j=0;const N=d(k=>{if(a)return;const A=l(k);b||(b=new Uint8Array(A));const B=s(k),C=i(k),P=c(k);b.set(new Uint8Array(y(),B,C),P-C),j=P/A}),w=o(E,E.length,t.metadata.slotNumber,t.metadata.qualityBitDepth,t.metadata.useCompression?1:0,N);e(j);try{yield new Promise(k=>{let A;r=()=>{cancelAnimationFrame(A),m(w),k()},B();function B(){if(j&&(e(j),j>=1)){k();return}A=requestAnimationFrame(B)}})}finally{r=()=>{},p(N)}if(a)return new Uint8Array;if(!b)throw new Error("Unexpected condition: sampleBuffer should be defined");return b}))()}}var ln=f(85),tt=f.n(ln),cn=(t,e,a)=>new Promise((r,o)=>{var s=l=>{try{c(a.next(l))}catch(m){o(m)}},i=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,i);c((a=a.apply(t,e)).next())});function sn({sample:t}){const[e,a]=Object(u.useState)(0),[r,o]=Object(u.useState)(!1),[s,i]=Object(u.useState)("idle");Object(u.useLayoutEffect)(()=>{s==="transferring"&&o(!1)},[s]);const[c,l]=Object(u.useState)(null),[m,d]=Object(u.useState)(null);Object(u.useEffect)(()=>{c instanceof AudioBuffer&&m&&(d(null),m.fn())},[c,m]);const p=Object(u.useRef)(()=>{});Object(u.useEffect)(()=>{let N=!1;a(0),i("idle"),l(null),d(null),p.current=()=>{N=!0};try{const{sampleBufferPromise:w,cancelWork:k}=on(t,A=>{N||a(A)});p.current=()=>{k(),N=!0},w.then(A=>cn(this,null,function*(){if(N)return;p.current=()=>{N=!0};const B=yield Ee(A);N||l(B)}))}catch(w){console.error(w),l(new Error(String(w)))}return()=>p.current()},[t]);const{playAudioBuffer:y}=Ft(),E=Object(u.useCallback)(N=>{if(!(c instanceof AudioBuffer)){if(!c){const{target:w,nativeEvent:k}=N;d({fn:()=>w.dispatchEvent(k)})}return}try{i("transferring");const w=y(c,{onTimeUpdate:k=>a(k/c.duration)});p.current=()=>{w(),i("idle")}}catch(w){console.error(w),i("error")}},[y,c]),b=Object(u.useCallback)(()=>p.current(),[]),j=e<1;return n.a.createElement(n.a.Fragment,null,n.a.createElement(H.a,{className:tt.a.transferButton,type:"button",variant:"primary",onClick:()=>o(!0)},"Transfer to volca sample"),n.a.createElement(T.a,{onHide:()=>o(!1),className:tt.a.preTransferModal,show:r,"aria-labelledby":"pre-transfer-modal"},n.a.createElement(T.a.Header,null,n.a.createElement(T.a.Title,{id:"pre-transfer-modal"},"Connect volca sample before continuing")),n.a.createElement(T.a.Body,null,n.a.createElement("figure",null,n.a.createElement("img",{src:"connection.png",alt:""}),n.a.createElement("figcaption",{className:"small"},"Source:"," ",n.a.createElement("a",{href:"https://github.com/korginc/volcasample#6-transferring-syrostream-to-your-volca-sample",target:"_blank",rel:"noreferrer"},"KORG"))),n.a.createElement("p",null,"Make sure your ",n.a.createElement("strong",null,"headphone output")," is connected to the volca sample's ",n.a.createElement("strong",null,"SYNC IN")," and adjust your output volume to a high (but not overdriven) level. Your volca wants to hear this, but you don't.")),n.a.createElement(T.a.Footer,null,n.a.createElement(H.a,{type:"button",variant:"light",onClick:()=>o(!1)},"Cancel"),n.a.createElement(H.a,{type:"button",variant:"primary",disabled:!(c instanceof AudioBuffer),onClick:E},"Transfer now"))),n.a.createElement(T.a,{show:s!=="idle","aria-labelledby":"transfer-modal"},n.a.createElement(T.a.Header,null,n.a.createElement(T.a.Title,{id:"transfer-modal"},j?"Sample transfer in progress":"Sample transfer complete")),n.a.createElement(T.a.Body,null,s==="error"?n.a.createElement("p",null,"Something unexpected happening while transferring (on our end)."):j?n.a.createElement(n.a.Fragment,null,n.a.createElement("p",null,"Transferring ",n.a.createElement("strong",null,t.metadata.name)," to slot"," ",n.a.createElement("strong",null,t.metadata.slotNumber)," on your your volca sample. Don't disconnect anything."),n.a.createElement(an.a,{striped:!0,animated:!0,variant:"primary",now:100*e}),n.a.createElement("div",{className:tt.a.progressAnnotation},c instanceof AudioBuffer&&Na(c.duration*(1-e))," ","remaining")):n.a.createElement(n.a.Fragment,null,n.a.createElement("p",null,"The sample ",n.a.createElement("strong",null,t.metadata.name)," was transferred to slot"," ",n.a.createElement("strong",null,t.metadata.slotNumber)," on your volca sample. Press the ",n.a.createElement("strong",null,"[FUNC]")," button to finish."),n.a.createElement("p",null,"If everything worked, you will see ",n.a.createElement("strong",null,"[End]")," on the volca sample's display. If you see ",n.a.createElement("strong",null,"[Err]")," on the display, the transfer failed. Normally this means you need to either adjust your output volume or free up some memory on the volca sample. For more info, check out this"," ",n.a.createElement("a",{href:"https://www.korg.com/products/dj/volca_sample/faq.php",target:"_blank",rel:"noreferrer"},"FAQ")," ","from KORG."))),n.a.createElement(T.a.Footer,null,n.a.createElement(H.a,{type:"button",variant:"primary",onClick:b},j?"Cancel":"Done"))))}var Jt=sn,un=f(107),mn=f.n(un),dn=f(32),he=f.n(dn),fn=n.a.memo(function({sampleId:e,qualityBitDepth:a,onSampleUpdate:r}){const[o,s]=Object(u.useState)(a);Object(u.useEffect)(()=>{s(a)},[a]);const i=Object(u.useCallback)(c=>{const l=Number(c.target.value);s(l)},[]);return n.a.createElement(K.a.Group,{className:he.a.qualityBitDepthWrapper},n.a.createElement(K.a.Label,{className:he.a.label},"Quality bit depth"),n.a.createElement("div",{className:he.a.ticks},[8,9,10,11,12,13,14,15,16].map((c,l,{length:m})=>{const d=`calc(${l*100/(m-1)}% + ${12-3*l}px)`,p=o===c;return n.a.createElement(n.a.Fragment,{key:c},n.a.createElement("label",{className:["small",he.a.tickLabel].join(" "),style:{left:d,visibility:p?"hidden":void 0},onClick:()=>r(e,{qualityBitDepth:c})},c),n.a.createElement("span",{className:he.a.tickMark,style:{left:d,visibility:p?"hidden":void 0}}))})),n.a.createElement(mn.a,{value:o,step:1,min:8,max:16,size:"lg",tooltip:"on",tooltipPlacement:"top",tooltipStyle:{zIndex:1020},onChange:i,ref:c=>c&&c.addEventListener("change",()=>{const l=Number(c.value);r(e,{qualityBitDepth:l})})}),n.a.createElement("div",{className:he.a.annotations},n.a.createElement("label",{className:"small"},"Faster transfer"),n.a.createElement("label",{className:"small"},"Higher quality")))}),qt=f(86),ea=f.n(qt),at=f(87),nt=f(88),pn=f(22),ce=f.n(pn),ta=Math.pow;qt.Digit.defaultProps.offOpacity=0;const aa=(t,e)=>Math.min(199,e+ta(10,t)),na=(t,e)=>Math.max(0,e-ta(10,t));var ra=n.a.memo(function({slotNumber:t,onSlotNumberUpdate:e}){const[a,r]=Object(u.useState)(t);Object(u.useEffect)(()=>{r(t)},[t]);const[o,s]=Object(u.useState)(null),i=Object(u.useCallback)(d=>{e(p=>aa(d,p))},[e]),c=Object(u.useCallback)(d=>{e(p=>na(d,p))},[e]),l=Object(u.useRef)(null),m=Object(u.useRef)(null);{const d=Object(u.useRef)(o);d.current=o;const p=Object(u.useRef)(a);p.current=a,Object(u.useEffect)(()=>{if(!m.current)throw new Error("Expected elements to exist");function y(g){const M=d.current===null?0:d.current;let S=!0;const O=()=>{s(M)};switch(g.key){case"ArrowDown":O(),r(v=>na(M,v));break;case"ArrowUp":O(),r(v=>aa(M,v));break;case"ArrowLeft":O(),s(v=>v!==null&&v<2?v+1:v);break;case"ArrowRight":O(),s(v=>v&&v-1);break;case"Enter":case"Escape":s(null);break;default:S=!1;break}S&&g.preventDefault()}function E(g){const M=d.current===null?2:d.current;g.stopPropagation(),g.preventDefault();const S=p.current;if(isNaN(Number(g.key)))e(S);else{const O=String(S).padStart(3,"0").split("");O[2-M]=g.key;const v=Math.min(199,Math.max(0,Number(O.join(""))));s(M?M-1:null),e(v)}}const b=l.current;b.addEventListener("keydown",y,!0),b.addEventListener("keyup",E,!0);let j=0,N=!1,w=!1,k=0;function A(g){document.body.style.userSelect="none",j=g instanceof MouseEvent?g.pageY:g.touches[0].pageY,N=!0,w=!1,k=p.current}b.addEventListener("mousedown",A),b.addEventListener("touchstart",g=>{g.preventDefault(),A(g)});function B(g){if(!N)return;const{pageY:M}=g instanceof MouseEvent?g:g.touches[0],S=2,O=Math.round((j-M)/S);O&&(w=!0,r(Math.min(199,Math.max(0,k+O))))}window.addEventListener("mousemove",B),b.addEventListener("touchmove",B);function C(){document.body.style.userSelect="unset",N=!1,w&&e(p.current)}window.addEventListener("mouseup",C),b.addEventListener("touchend",C),b.addEventListener("touchcancel",()=>{document.body.style.userSelect="unset"});function P(g){w||m.current&&m.current.some(M=>M.contains(g.target))||s(2)}b.addEventListener("click",P),m.current.forEach((g,M)=>{const S=M;g.addEventListener("click",()=>{w||s(S)}),g.addEventListener("touchstart",O=>{O.preventDefault()})});function D(){N||s(2)}function R(){s(null)}return b.addEventListener("focus",D),b.addEventListener("blur",R),()=>{window.removeEventListener("mousemove",B),window.removeEventListener("mouseup",C)}},[e])}return Object(u.useEffect)(()=>{if(!m.current)throw new Error("Expected elements to exist");m.current.forEach((d,p)=>{p===o?d.classList.add(ce.a.active):d.classList.remove(ce.a.active)})},[o]),n.a.createElement(n.a.Fragment,null,n.a.createElement(K.a.Label,null,"Choose destination"),n.a.createElement("br",null),n.a.createElement("div",{className:ce.a.slotNumberRow},n.a.createElement("div",{className:ce.a.slotNumberContainer},n.a.createElement("div",{className:ce.a.arrowControls},n.a.createElement("span",{onClick:()=>i(2)},n.a.createElement(at.a,null)),n.a.createElement("span",{onClick:()=>i(1)},n.a.createElement(at.a,null)),n.a.createElement("span",{onClick:()=>i(0)},n.a.createElement(at.a,null))),n.a.createElement("div",{className:ce.a.slotNumber,title:`Slot ${a}`,ref:l,tabIndex:0},n.a.createElement(ea.a,{value:"8888",color:"var(--bs-gray-dark)",strokeColor:"transparent",digitCount:4}),n.a.createElement(ea.a,{ref:d=>{const p=Object(yt.findDOMNode)(d);if(p){p.querySelectorAll("circle").forEach(E=>{p.removeChild(E)});const y=document.createElementNS("http://www.w3.org/2000/svg","circle");y.classList.add(ce.a.point),y.setAttribute("cx","10.7"),y.setAttribute("cy","17"),y.setAttribute("r","1"),p.appendChild(y),m.current=[].slice.call(p.querySelectorAll("g")).reverse().slice(0,3)}},value:`5${String(a).padStart(3,"0")}`,digitProps:{color:"var(--bs-primary)"},digitCount:4})),n.a.createElement("div",{className:ce.a.arrowControls},n.a.createElement("span",{onClick:()=>c(2)},n.a.createElement(nt.a,null)),n.a.createElement("span",{onClick:()=>c(1)},n.a.createElement(nt.a,null)),n.a.createElement("span",{onClick:()=>c(0)},n.a.createElement(nt.a,null)))),t>99&&a>99&&n.a.createElement(Te.a,{placement:"auto-end",overlay:n.a.createElement(_e.a,null,"To transfer to this destination, be sure you have a volca sample2. The original volca sample only supports slots 0-99.")},n.a.createElement("span",{className:ce.a.warning},n.a.createElement(Gt.a,null)))))}),vn=f(44),He=f.n(vn),hn=(t,e,a)=>new Promise((r,o)=>{var s=l=>{try{c(a.next(l))}catch(m){o(m)}},i=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,i);c((a=a.apply(t,e)).next())});const yn=n.a.memo(function({sample:e,onSampleUpdate:a,onSampleDuplicate:r,onSampleDelete:o}){const s=Object(u.useCallback)(i=>{a(e.id,({slotNumber:c})=>({slotNumber:typeof i=="function"?i(c):i}))},[e.id,a]);return n.a.createElement(je.a,{fluid:"sm"},n.a.createElement("h2",null,e.metadata.name,n.a.createElement(bn,{sampleId:e.id,name:e.metadata.name,sourceFileId:e.metadata.sourceFileId,userFileInfo:e.metadata.userFileInfo,onSampleUpdate:a,onSampleDuplicate:r,onSampleDelete:o})),n.a.createElement("p",null,n.a.createElement("strong",null,"Sampled:")," ",Je(new Date(e.metadata.dateSampled)),n.a.createElement("br",null),n.a.createElement("strong",null,"Updated:")," ",Je(new Date(e.metadata.dateModified))),n.a.createElement("h4",null,"Configure"),n.a.createElement(fn,{sampleId:e.id,qualityBitDepth:e.metadata.qualityBitDepth,onSampleUpdate:a}),n.a.createElement(tn,{sample:e,onSampleUpdate:a}),n.a.createElement("h4",null,"Transfer"),n.a.createElement(ra,{slotNumber:e.metadata.slotNumber,onSlotNumberUpdate:s}),n.a.createElement(Jt,{sample:e}))}),bn=n.a.memo(({sampleId:t,name:e,sourceFileId:a,userFileInfo:r,onSampleUpdate:o,onSampleDuplicate:s,onSampleDelete:i})=>{const[c,l]=Object(u.useState)(!1),m=Object(u.useRef)(null),[d,p]=Object(u.useState)(e),[y,E]=Object(u.useState)(!1);Object(u.useEffect)(()=>{y&&(p(e),m.current&&m.current.select())},[y,e]);const b=d.trim(),j=Object(u.useCallback)(A=>{A.preventDefault(),b&&(o(t,{name:b}),E(!1))},[b,t,o]),N=Object(u.useCallback)(()=>s(t),[t,s]),w=Object(u.useCallback)(()=>hn(void 0,null,function*(){const A=yield Z.getSourceFileData(a),B=new Blob([A],{type:r?r.type:"audio/x-wav"});Xt(B,`${e}${r?r.ext:".wav"}`)}),[e,a,r]),k=Object(u.useCallback)(A=>{A.preventDefault(),i(t),l(!1)},[t,i]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(Ua.a,{className:He.a.optionsButton,variant:"light",align:"end",title:"options"},n.a.createElement(we.a.Item,{onClick:()=>E(!0)},"Rename"),n.a.createElement(we.a.Item,{onClick:N},"Duplicate"),n.a.createElement(we.a.Item,{onClick:w},"Download source audio"),n.a.createElement(we.a.Divider,null),n.a.createElement(we.a.Item,{onClick:()=>l(!0)},"Delete")),n.a.createElement(T.a,{onHide:()=>E(!1),show:y,"aria-labelledby":"rename-modal"},n.a.createElement(K.a,{onSubmit:j},n.a.createElement(T.a.Header,null,n.a.createElement(T.a.Title,{id:"rename-modal"},"Renaming sample")),n.a.createElement(T.a.Body,null,n.a.createElement("p",null,"Choose a new name for the sample ",n.a.createElement("strong",null,e),":"),n.a.createElement(K.a.Control,{ref:m,defaultValue:e,onChange:A=>p(A.target.value)})),n.a.createElement(T.a.Footer,null,n.a.createElement(H.a,{type:"button",variant:"light",onClick:()=>E(!1)},"Cancel"),n.a.createElement(H.a,{type:"submit",variant:"primary",disabled:!b},"Rename")))),n.a.createElement(T.a,{onHide:()=>l(!1),show:c,"aria-labelledby":"delete-modal"},n.a.createElement(K.a,{onSubmit:k},n.a.createElement(T.a.Header,{className:He.a.deleteModalHeader},n.a.createElement(Gt.a,null),n.a.createElement(T.a.Title,{id:"delete-modal"},"Deleting sample")),n.a.createElement(T.a.Body,null,n.a.createElement("p",null,"Are you sure you want to delete ",n.a.createElement("strong",null,e),"? This can't be undone.")),n.a.createElement(T.a.Footer,null,n.a.createElement(H.a,{type:"button",variant:"light",onClick:()=>l(!1)},"Cancel"),n.a.createElement(H.a,{type:"submit",variant:"primary"},"Delete")))))});var gn=yn,ze=f(159),En=f(110),wn=f.n(En);function Sn({sample:t}){const{wav:e,audioBuffer:a}=Bt(t),{sample:{metadata:{name:r,normalize:o,trim:{frames:s}}},sourceAudioBuffer:i}=Tt(t),{monoSamples:c,waveformRef:l,peaks:m,onResize:d}=_t(i),p=Object(u.useMemo)(()=>{if(!i)return 0;const k=Fe(c,s);return pe(k)},[i,c,s]),y=1/p,{isPlaybackActive:E,playbackProgress:b,displayedTime:j,togglePlayback:N,stopPlayback:w}=Ht(a);return Object(u.useEffect)(()=>w,[t,w]),n.a.createElement("div",{className:wn.a.waveformContainer},n.a.createElement(et,{waveformRef:l,peaks:m,scaleCoefficient:o?y:1,onResize:d}),n.a.createElement(Kt,{isPlaybackActive:E,playbackProgress:b,displayedTime:j,downloadFilename:`${r}.volcasample.wav`,wavFile:e,togglePlayback:N}))}var Cn=Sn,On=Object.defineProperty,kn=Object.defineProperties,Dn=Object.getOwnPropertyDescriptors,oa=Object.getOwnPropertySymbols,jn=Object.prototype.hasOwnProperty,Pn=Object.prototype.propertyIsEnumerable,la=(t,e,a)=>e in t?On(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,An=(t,e)=>{for(var a in e||(e={}))jn.call(e,a)&&la(t,a,e[a]);if(oa)for(var a of oa(e))Pn.call(e,a)&&la(t,a,e[a]);return t},Rn=(t,e)=>kn(t,Dn(e));function Mn(t){const e=t.metadata.slotNumber,[a,r]=Object(u.useState)(e);return Object(u.useEffect)(()=>{r(e)},[e]),{sample:Object(u.useMemo)(()=>t&&new Z(Rn(An({id:t.id},t.metadata),{slotNumber:a})),[t,a]),setSlotNumber:r}}function Nn({sample:t,onSampleDuplicate:e}){const{sample:a,setSlotNumber:r}=Mn(t);return n.a.createElement(je.a,{fluid:"sm"},n.a.createElement("h2",null,a.metadata.name),n.a.createElement("p",null,n.a.createElement("strong",null,"Sampled:")," ",Je(new Date(a.metadata.dateSampled))),n.a.createElement(ze.a,{variant:"secondary"},n.a.createElement(ze.a.Heading,null,"This is a factory sample."),n.a.createElement("p",null,"If you want to trim the audio or adjust quality before transferring to the volca sample,"," ",n.a.createElement("span",{className:He.a.buttonLink},n.a.createElement(H.a,{variant:"link",className:He.a.duplicateButtonLink,onClick:()=>e(a.id)},"make a duplicate"),"."))),n.a.createElement("h4",null,"Preview"),n.a.createElement(Cn,{sample:a}),n.a.createElement("h4",null,"Transfer"),n.a.createElement(ra,{slotNumber:a.metadata.slotNumber,onSlotNumberUpdate:r}),n.a.createElement(Jt,{sample:a}))}var Bn=Nn,Ln=f(112),Ce=(t,e,a)=>new Promise((r,o)=>{var s=l=>{try{c(a.next(l))}catch(m){o(m)}},i=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,i);c((a=a.apply(t,e)).next())});let ca;function rt(){const t=At();return ca=ca||new t(navigator.mediaDevices.getSupportedConstraints().sampleRate?{sampleRate:Ae}:{})}function Fn(){return Ce(this,null,function*(){{const r=yield navigator.mediaDevices.getUserMedia({audio:!0,video:!1});for(const o of r.getTracks())o.stop()}const e=(yield navigator.mediaDevices.enumerateDevices()).filter(r=>r.kind==="audioinput"),a=[];for(const r of e){const o=yield navigator.mediaDevices.getUserMedia({audio:{deviceId:r.deviceId,channelCount:2},video:!1}),s=(yield navigator.mediaDevices.enumerateDevices()).find(({deviceId:c})=>r.deviceId===c).label;let i=1;{const c=o.getAudioTracks()[0],l=c.getSettings().channelCount;l?i=l:c.getCapabilities&&(i=(c.getCapabilities().channelCount||{}).max||i)}for(const c of o.getTracks())c.stop();a.push({device:{deviceId:r.deviceId,label:s},channelsAvailable:i})}return a})}let ot;function In(t){return Ce(this,arguments,function*({onData:e,onFinish:a}){const r=rt();ot=ot||r.audioWorklet.addModule("recorderWorkletProcessor.js"),yield ot;const o=new AudioWorkletNode(r,"recorder-worklet",{parameterData:{bufferSize:1024}});o.port.onmessage=i=>{if(i.data.eventType==="data"){const c=i.data.audioChannels;e(c)}i.data.eventType==="stop"&&a()};const s=o.parameters.get("isRecording");return s.setValueAtTime(1,r.currentTime),{recorderNode:o,stop(){s.setValueAtTime(0,r.currentTime)}}})}function xn({channelCount:t,onData:e,onFinish:a}){const o=rt().createScriptProcessor(1024,t,t);let s=!1;return o.onaudioprocess=i=>{const c=Array(t).fill().map((l,m)=>i.inputBuffer.getChannelData(m));e(c),s&&a()},{recorderNode:o,stop(){s=!0}}}function Wn(t){return Ce(this,null,function*(){return typeof AudioWorkletNode=="undefined"?xn(t):yield In(t)})}function Tn(t){return Ce(this,arguments,function*({deviceId:e,channelCount:a,onStart:r,onUpdate:o}){const s=yield navigator.mediaDevices.getUserMedia({audio:{deviceId:e,channelCount:a,sampleRate:Ae,echoCancellation:!1,autoGainControl:!1,noiseSuppression:!1},video:!1}),i=rt(),c=i.createMediaStreamSource(s),{recorderNode:l,stop:m}=yield Wn({channelCount:a,onData:b,onFinish:A});c.connect(l),l.connect(i.destination);const d=10;r(i.sampleRate,d);const p=d*i.sampleRate;let y=0;const E=Array(a).fill([]);function b(B){let C=0;const P=[];for(let g=0;g<a;g++){const M=B[g],S=M.length,O=M.slice(0,Math.min(S,p-y));jt(O),C||(C=O.length),P.push(O)}const D=Aa(P),R=Pt(D);E.push(R),y+=C,y>=p&&m(),o(P)}let j,N;const w=new Promise((B,C)=>{j=B,N=C});let k=!1;function A(){return Ce(this,null,function*(){if(k)return;try{const P=yield new Blob(E).arrayBuffer(),D=new Float32Array(P),R=Et()({channels:a,sampleRate:i.sampleRate,bitDepth:16,dataLength:D.byteLength}),g=new Uint8Array(R.length+D.byteLength);g.set(R),g.set(new Uint8Array(D.buffer),R.length),j(g)}catch(C){N(C)}const B=s.getTracks();for(const C of B)C.stop();l.disconnect(i.destination),c.disconnect(l),k=!0})}return{stop:m,mediaRecording:w}})}var _n=f(46),Oe=f.n(_n),ke=(t,e,a)=>new Promise((r,o)=>{var s=l=>{try{c(a.next(l))}catch(m){o(m)}},i=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,i);c((a=a.apply(t,e)).next())});const sa="capture_device_preference";let ia=null;function Hn(t,e){const a=Object(u.useRef)(JSON.parse(localStorage.getItem(sa)||"null")),[r,o]=Object(u.useState)(ia),[s,i]=Object(u.useState)(r?"ok":"pending"),[c,l]=Object(u.useState)("");Object(u.useEffect)(()=>{ia=r,i("ok")},[r]);const m=Object(u.useCallback)(()=>{let S=!1;return Fn().then(O=>{S||O.length&&(o(new Map(O.map(v=>[v.device.deviceId,v]))),l(v=>v?(a.current=null,v):a.current&&O.find(({device:F})=>a.current.deviceId===F.deviceId)?a.current.deviceId:(a.current=null,O[0].device.deviceId)))}).catch(O=>{if(!S){if(O instanceof DOMException){if(O.name==="NotAllowedError"){i("denied");return}if(O.name==="NotFoundError"){i("unavailable");return}}throw O}}),()=>{S=!0}},[]),[d,p]=Object(u.useState)(1);Object(u.useEffect)(()=>{const S=r&&r.get(c);S&&(a.current&&a.current.deviceId===S.device.deviceId&&a.current.channelCount<=S.channelsAvailable?p(a.current.channelCount):p(S.channelsAvailable),a.current=null)},[r,c]),Object(u.useEffect)(()=>{c&&localStorage.setItem(sa,JSON.stringify({deviceId:c,channelCount:d}))},[c,d]);const[y,E]=Object(u.useState)("ready"),[b,j]=Object(u.useState)(null),[N,w]=Object(u.useState)(!1);Object(u.useEffect)(()=>{y!=="ready"&&w(!1)},[y]);const k=Object(u.useCallback)(()=>{w(!1)},[]),[A,B]=Object(u.useState)({fn(S){}});Object(u.useEffect)(()=>A.fn,[A]);const[C,P]=Object(u.useState)(1/0),[D,R]=Object(u.useState)(0),g=Object(u.useCallback)(()=>ke(this,null,function*(){let S=!1;const O=(V,se)=>Tn({deviceId:V,channelCount:se,onStart:(x,W)=>{const $=W*x;P(x),R($),E("capturing")},onUpdate:t}),v=a.current,{mediaRecording:F,stop:ne}=yield v?(()=>ke(this,null,function*(){try{return O(v.deviceId,v.channelCount)}catch(V){if(V instanceof DOMException&&V.name==="NotFoundError")return O(c,d);throw V}}))():O(c,d);B({fn(V){ne(),V&&(S=!0)}});let re;try{re=yield F}catch(V){j(V),E("error");return}if(S)E("ready");else{E("finalizing");const V=yield e(re);S||(E("ready"),V==="silent"&&w(!0))}}),[c,d,t,e]),M=Object(u.useCallback)(S=>{if(S.target.files&&S.target.files.length){const O=S.target.files[0];O.arrayBuffer().then(v=>ke(this,null,function*(){const F=new Uint8Array(v);let ne;try{ne=yield Ee(F)}catch(V){alert("Unsupported audio format detected");return}if(ne.length>10*ne.sampleRate){alert("Please select an audio file no more than 10 seconds long");return}E("finalizing");const re=yield e(F,O);E("ready"),re==="silent"&&w(!0)}))}},[e]);return{captureDevices:r,accessState:s,selectedCaptureDeviceId:c,selectedChannelCount:d,captureState:y,recordingError:b,showSilenceWarning:N,sampleRate:C,maxSamples:D,refreshCaptureDevices:m,setSelectedCaptureDeviceId:l,setSelectedChannelCount:p,beginRecording:g,stopRecording:A.fn,importFile:M,dismissSilenceWarning:k}}const lt=3;function zn({canvas:t,peaks:e,drawUntil:a,scaleCoefficient:r}){const o="#fff",s=t.getContext("2d");s.imageSmoothingEnabled=!1;const{width:i,height:c}=t;s.clearRect(0,0,i,c),s.fillStyle=o;for(let l=0;l<a&&l<e.length;l++){const m=e[l],d=c*m,p=Math.max(Math.round(r*d),2);s.fillRect(l*lt,c-p,lt-1,p)}}function Vn({onRecordFinish:t}){const e=Object(u.useRef)(null),a=Object(u.useRef)(0),r=Object(u.useRef)(new Float32Array),o=Object(u.useRef)(0),s=Object(u.useRef)([]),i=Object(u.useRef)(1/0),c=Object(u.useRef)(0),[l,m]=Object(u.useState)(0),d=Object(u.useCallback)(v=>ke(this,null,function*(){const F=a.current,ne=r.current,re=s.current;if(re.push(v),c.current+=v[0].length,m(Math.floor(c.current/i.current)),re.reduce((se,[{length:x}])=>se+x,0)>=F){const se=yield Promise.all(v.map((W,$)=>re.reduce((De,oe)=>[...De,oe[$]],[])).map(W=>ke(this,null,function*(){const $=yield new Blob(W).arrayBuffer();return new Float32Array($)}))),x=se.map(W=>pe(new Float32Array(W.buffer,0,F)));ne[o.current++]=Math.max(...x),zn({canvas:e.current,peaks:ne,drawUntil:o.current,scaleCoefficient:.3}),s.current=[se.map(W=>W.slice(F))]}}),[]),{captureDevices:p,accessState:y,selectedCaptureDeviceId:E,selectedChannelCount:b,captureState:j,recordingError:N,showSilenceWarning:w,maxSamples:k,sampleRate:A,refreshCaptureDevices:B,setSelectedCaptureDeviceId:C,setSelectedChannelCount:P,beginRecording:D,stopRecording:R,importFile:g,dismissSilenceWarning:M}=Hn(d,t);i.current=A,Object(u.useEffect)(()=>{const v=e.current;v&&(v.width=v.offsetWidth,v.height=v.offsetHeight)},[y]),Object(u.useLayoutEffect)(()=>{const v=e.current;!v||(j!=="finalizing"&&v.getContext("2d").clearRect(0,0,v.width,v.height),j==="capturing"&&k&&(a.current=Math.floor(lt*k/e.current.width),r.current=new Float32Array(Math.floor(k/a.current)),o.current=0,s.current=[],i.current=1/0,c.current=0,m(0)))},[k,j]);const[S,O]=Object(u.useState)(!1);return Object(u.useEffect)(()=>{S&&B()},[S,B]),n.a.createElement(je.a,{fluid:"sm",className:Oe.a.container},y==="denied"?n.a.createElement("p",null,"Looks like you didn't grant access to your audio input device. Please give Volca Sampler access, then"," ",n.a.createElement(H.a,{type:"button",variant:"secondary",onClick:B},"try again")):y==="unavailable"?n.a.createElement("p",null,"Volca Sampler couldn't find any audio input devices. Please connect one, then"," ",n.a.createElement(H.a,{type:"button",variant:"secondary",onClick:B},"try again")):n.a.createElement(n.a.Fragment,null,n.a.createElement("h2",null,"Send a new sound to your volca sample!"),w&&n.a.createElement("div",{className:Oe.a.alertContainer},n.a.createElement(ze.a,{dismissible:!0,variant:"warning",onClose:M},n.a.createElement(ze.a.Heading,null,"Your recording was totally silent."),n.a.createElement("p",null,"Check the audio input settings and your connections, then try again."))),n.a.createElement(H.a,{className:Oe.a.recordButton,type:"button",variant:"primary",size:"lg",style:{width:250},onClick:j==="capturing"?()=>R():D,disabled:j==="finalizing"},n.a.createElement("canvas",{ref:e}),n.a.createElement("span",{className:Oe.a.mainText},["capturing","finalizing"].includes(j)?"Finished recording":"Start recording"),["capturing","finalizing"].includes(j)&&n.a.createElement("span",{className:Oe.a.timeRecorded},"0:",String(l).padStart(2,"0"))),["capturing","finalizing"].includes(j)?n.a.createElement(n.a.Fragment,null,n.a.createElement(H.a,{style:{width:250},size:"sm",type:"button",variant:"secondary",onClick:()=>R(!0)},"Cancel")):n.a.createElement(n.a.Fragment,null,n.a.createElement(H.a,{style:{width:250},type:"button",variant:"light",size:"sm",onClick:()=>O(v=>!v)},"Audio input settings ",S?"\u25B2":"\u25BC"),n.a.createElement(Ln.a,{in:S},n.a.createElement("div",null,n.a.createElement(K.a.Group,null,n.a.createElement(K.a.Label,null,"Capture Device"),n.a.createElement(K.a.Select,{style:{width:250},value:E,onChange:v=>C(v.target.value)},p&&y==="ok"?[...p].map(([v,{device:F}])=>n.a.createElement("option",{key:v,value:v},F.label||v)):n.a.createElement("option",{value:"",disabled:!0},"Loading devices..."))),n.a.createElement(K.a.Group,null,n.a.createElement(K.a.Label,null,"Input channels"),n.a.createElement(K.a.Select,{style:{width:250},value:b,onChange:v=>P(Number(v.target.value))},[1,2].map(v=>n.a.createElement("option",{key:v,value:v,disabled:!p||!p.has(E)||p.get(E).channelsAvailable<v},v===1?"Mono":"Stereo (summed to mono)")))))))),j==="error"&&N||null,n.a.createElement(H.a,{style:{width:250},type:"button",variant:"secondary",onClick:v=>{const F=v.currentTarget.querySelector("input");F&&v.target!==F&&F.click()}},"Or import an audio file",n.a.createElement("input",{hidden:!0,type:"file",accept:"audio/*,.wav,.mp3,.ogg",onChange:g})))}var Un=Vn,Qn=f(92),ua=f.n(Qn),$n=(t,e,a)=>new Promise((r,o)=>{var s=l=>{try{c(a.next(l))}catch(m){o(m)}},i=l=>{try{c(a.throw(l))}catch(m){o(m)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,i);c((a=a.apply(t,e)).next())});const ct="focused_sample_id";function Gn(){const[t,e]=Object(u.useState)(new Map),[a,r]=Object(u.useState)(new Map),o=Object(u.useMemo)(()=>new Map([...t,...a]),[t,a]);Object(u.useEffect)(()=>{ka().then(r).catch(console.error)},[]);const s=sessionStorage.getItem(ct),[i,c]=Object(u.useState)(s&&typeof s=="string"?s:null);Object(u.useEffect)(()=>{i?sessionStorage.setItem(ct,i):sessionStorage.removeItem(ct)},[i]);const[l,m]=Object(u.useState)(!0);Object(u.useEffect)(()=>{Z.getAllFromStorage().then(C=>{e(P=>new Map([...P,...C.map(D=>[D.id,D])]))}).finally(()=>{m(!1)})},[]);const d=Object(u.useCallback)((C,P)=>$n(this,null,function*(){const D=yield Ee(C),R=[0,0],g=yield qe(D,R);if([...g.positive,...g.negative].every(F=>F===0))return"silent";const M=yield Sa(C);let S="",O="";if(P){const F=P.name.lastIndexOf(".");F>0?(S=P.name.slice(0,F),O=P.name.slice(F)):S=P.name}else S="New sample";const v=new Z.Mutable({name:S,sourceFileId:M,trim:{frames:R,waveformPeaks:g},userFileInfo:P&&{type:P.type,ext:O}});return yield v.persist(),e(F=>new Map([[v.id,v],...F])),c(v.id),"saved"}),[]),p=Object(u.useCallback)((C,P)=>{e(D=>{const R=D.get(C);if(R&&R instanceof Z.Mutable){const g=R.update(P);if(g!==R)return new Map(D).set(R.id,g)}return D})},[]),y=Object(u.useRef)(o);y.current=o;const E=Object(u.useCallback)(C=>{const P=y.current.get(C);if(P){const D=P.duplicate();e(R=>new Map([[D.id,D],...R])),c(D.id)}},[]),b=Object(u.useRef)(t);b.current=t;const j=Object(u.useCallback)(C=>{const P=b.current,D=P.get(C);if(D&&D instanceof Z.Mutable){D.remove();let R=null,g=!1;for(const[,M]of P){if(g){R=M.id;break}if(M.id===C){if(!R){g=!0;continue}break}R=M.id}c(R),e(M=>{const S=new Map(M);return S.delete(D.id),S})}},[]),[N,w]=Object(u.useState)(!1),k=Object(u.useCallback)(C=>{c(C),w(!1)},[]),A=Object(u.useCallback)(()=>w(!0),[]),B=Object(u.useCallback)(()=>c(null),[]);return n.a.createElement("div",null,n.a.createElement(ha,{onMenuOpen:A,onHeaderClick:B}),n.a.createElement(Ge.a,{show:N,onHide:()=>w(!1)},n.a.createElement(Ge.a.Header,{closeButton:!0}),n.a.createElement(Ge.a.Body,null,n.a.createElement(bt.a,null,n.a.createElement(bt.a.Item,{as:"button",onClick:()=>k(null)},"New Sample"),l?"Loading...":null,!l&&n.a.createElement(ue.a,{defaultActiveKey:t.size?"user":"factory"},n.a.createElement(ue.a.Item,{eventKey:"user"},n.a.createElement(ue.a.Header,null,"Your Samples"),n.a.createElement(ue.a.Body,{style:{padding:0}},n.a.createElement($t,{samples:t,selectedSampleId:i,onSampleSelect:k}))),n.a.createElement(ue.a.Item,{eventKey:"factory"},n.a.createElement(ue.a.Header,null,"Factory Samples"),n.a.createElement(ue.a.Body,{style:{padding:0}},n.a.createElement($t,{samples:a,selectedSampleId:i,onSampleSelect:k}))))))),n.a.createElement("div",{className:ua.a.mainLayout},n.a.createElement("div",{className:ua.a.focusedSampleContainer},i&&(()=>{const C=o.get(i)||null;return C?C instanceof Z.Mutable?n.a.createElement(gn,{sample:C,onSampleUpdate:p,onSampleDuplicate:E,onSampleDelete:j}):n.a.createElement(Bn,{sample:C,onSampleDuplicate:E}):null})(),!i&&n.a.createElement(Un,{onRecordFinish:d}))))}var Xn=Gn,Kn=t=>{t&&t instanceof Function&&f.e(3).then(f.bind(null,168)).then(({getCLS:e,getFID:a,getFCP:r,getLCP:o,getTTFB:s})=>{e(t),a(t),r(t),o(t),s(t)})};Blob.prototype.arrayBuffer||(Blob.prototype.arrayBuffer=function(){return new Response(this).arrayBuffer()}),pa.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(Ma,null,n.a.createElement(Xn,null))),document.getElementById("root")),Kn()},22:function(I,X,f){I.exports={"form-switch":"SlotNumberInput_form-switch__39Wtl","form-check-input":"SlotNumberInput_form-check-input__oNf4Z",slotNumberRow:"SlotNumberInput_slotNumberRow__kQwOw",slotNumberContainer:"SlotNumberInput_slotNumberContainer__1q7P1",arrowControls:"SlotNumberInput_arrowControls__1LPAC",slotNumber:"SlotNumberInput_slotNumber__GC-i7",active:"SlotNumberInput_active__2zN4D",digitBlinkEffect:"SlotNumberInput_digitBlinkEffect__1_u8n",point:"SlotNumberInput_point__3pJD3",warning:"SlotNumberInput_warning__3NAeN"}},23:function(I,X,f){I.exports={titleBar:"Header_titleBar__3BLa-",menuIcon:"Header_menuIcon__swn7p",title:"Header_title__R3bRx",titleText:"Header_titleText__3e5ME",titleR:"Header_titleR__3QRgv",titleStarburst:"Header_titleStarburst__1oLYP",titleGraphic:"Header_titleGraphic__3S89F"}},32:function(I,X,f){I.exports={"form-switch":"QualityBitDepthControl_form-switch__3nCZi","form-check-input":"QualityBitDepthControl_form-check-input__2KgZ8",qualityBitDepthWrapper:"QualityBitDepthControl_qualityBitDepthWrapper__2qLOe",label:"QualityBitDepthControl_label___ohmN",ticks:"QualityBitDepthControl_ticks__1u5GH",tickLabel:"QualityBitDepthControl_tickLabel__2jXRm",tickMark:"QualityBitDepthControl_tickMark__24xm0",annotations:"QualityBitDepthControl_annotations__3mXj2"}},44:function(I,X,f){I.exports={"form-switch":"SampleDetail_form-switch__31CS2","form-check-input":"SampleDetail_form-check-input__1NWgi",optionsButton:"SampleDetail_optionsButton__k0UjV",duplicateButtonLink:"SampleDetail_duplicateButtonLink__3CZZy",deleteModalHeader:"SampleDetail_deleteModalHeader__3DiKA",normalizeControlWrapper:"SampleDetail_normalizeControlWrapper__1yc_t",slotNumber:"SampleDetail_slotNumber__3sgS6",point:"SampleDetail_point__3d7qL"}},45:function(I,X,f){I.exports={playbackOverlay:"WaveformPlayback_playbackOverlay__Er0Rh",playbackActive:"WaveformPlayback_playbackActive__1IHxg",playback:"WaveformPlayback_playback__2heRw",playbackButtonContainer:"WaveformPlayback_playbackButtonContainer__Lhahe",downloadButton:"WaveformPlayback_downloadButton__2s-L5"}},46:function(I,X,f){I.exports={container:"SampleRecord_container__3bdq5",alertContainer:"SampleRecord_alertContainer__vjGNP",recordButton:"SampleRecord_recordButton__3R-KX",mainText:"SampleRecord_mainText__2dca6",timeRecorded:"SampleRecord_timeRecorded__3FGTe"}},8:function(I,X,f){I.exports={"form-switch":"WaveformEdit_form-switch__2DZid","form-check-input":"WaveformEdit_form-check-input__2TImp",waveformAdjacentControls:"WaveformEdit_waveformAdjacentControls__12b8z",waveformContainer:"WaveformEdit_waveformContainer__Qq3MI",cursor:"WaveformEdit_cursor__1Ntb3",trim:"WaveformEdit_trim__1GV76",playbackActive:"WaveformEdit_playbackActive__hTwgX",bar:"WaveformEdit_bar__1KFgt",handle:"WaveformEdit_handle__23NoG",time:"WaveformEdit_time__YX5rg",left:"WaveformEdit_left__3Jfpn",right:"WaveformEdit_right__35CjW",waveformOverlay:"WaveformEdit_waveformOverlay__3oZfw"}},85:function(I,X,f){I.exports={"form-switch":"VolcaTransferControl_form-switch__1ZS81","form-check-input":"VolcaTransferControl_form-check-input__REQsM",transferButton:"VolcaTransferControl_transferButton__11MBQ",preTransferModal:"VolcaTransferControl_preTransferModal__fLiiV",progressAnnotation:"VolcaTransferControl_progressAnnotation__2zJ9A"}},92:function(I,X,f){I.exports={"form-switch":"App_form-switch__3Ht4D","form-check-input":"App_form-check-input__19Z6o",mainLayout:"App_mainLayout__3UKwp",focusedSampleContainer:"App_focusedSampleContainer__1lol8"}}},[[149,1,2]]]);

//# sourceMappingURL=main.4f5a3fa8.chunk.js.map